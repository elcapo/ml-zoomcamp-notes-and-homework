<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <link rel="icon" crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/favicon.ico" />
    <!-- Preload is necessary because we show these images when we disconnect from the server,
    but at that point we cannot load these images from the server -->
    <link rel="preload" crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/gradient-yHQUC_QB.png" as="image" />
    <link rel="preload" crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/noise-60BoTA8O.png" as="image" />
    <!-- Preload the fonts -->
    <link rel="preload" crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/Lora-VariableFont_wght-B2ootaw-.ttf" as="font" crossorigin="anonymous" />
    <link rel="preload" crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/PTSans-Regular-CxL0S8W7.ttf" as="font" crossorigin="anonymous" />
    <link rel="preload" crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/PTSans-Bold-D9fedIX3.ttf" as="font" crossorigin="anonymous" />
    <link rel="preload" crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/FiraMono-Regular-BTCkDNvf.ttf" as="font" crossorigin="anonymous" />
    <link rel="preload" crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/FiraMono-Medium-DU3aDxX5.ttf" as="font" crossorigin="anonymous" />
    <link rel="preload" crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/FiraMono-Bold-CLVRCuM9.ttf" as="font" crossorigin="anonymous" />

    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="theme-color" content="#000000" />
    <meta name="description" content="a marimo app" />
    <link rel="apple-touch-icon" crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/apple-touch-icon.png" />
    <link rel="manifest" crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/manifest.json" />

    <script data-marimo="true">
      function __resizeIframe(obj) {
        const scrollbarHeight = 20; // Max between windows, mac, and linux

        function setHeight() {
          // Guard against race condition where iframe isn't ready
          if (!obj.contentWindow?.document?.documentElement) {
            return;
          }
          const element = obj.contentWindow.document.documentElement;
          // If there is no vertical scrollbar, we don't need to resize the iframe
          if (element.scrollHeight === element.clientHeight) {
            return;
          }

          // Create a new height that includes the scrollbar height if it's visible
          const hasHorizontalScrollbar = element.scrollWidth > element.clientWidth;
          const newHeight = element.scrollHeight + (hasHorizontalScrollbar ? scrollbarHeight : 0);

          // Only update the height if it's different from the current height
          if (obj.style.height !== `${newHeight}px`) {
            obj.style.height = `${newHeight}px`;
          }
        }

        // Resize the iframe to the height of the content and bottom scrollbar height
        setHeight();

        // Resize the iframe when the content changes
        const resizeObserver = new ResizeObserver((_entries) => {
          setHeight();
        });
        // Only observe if iframe content is ready
        if (obj.contentWindow?.document?.body) {
          resizeObserver.observe(obj.contentWindow.document.body);
        }
      }
    </script>
    <marimo-filename hidden>homework.py</marimo-filename>
    <!-- TODO(Trevor): Legacy, required by VS Code plugin. Remove when plugin is updated (see marimo/server/_templates/template.py) -->
    <marimo-version data-version="{{ version }}" hidden></marimo-version>
    <marimo-user-config data-config="{{ user_config }}" hidden></marimo-user-config>
    <marimo-server-token data-token="{{ server_token }}" hidden></marimo-server-token>
    <!-- /TODO -->
    <title>homework</title>
    <script type="module" crossorigin crossorigin="anonymous" src="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/index-CXWNxYPw.js"></script>
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/preload-helper-WDmkW-6F.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/chunk-LvLJmgfZ.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/react-XTZdWHwa.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/compiler-runtime-QczY1yfQ.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/useEventListener-BMXqdHZ5.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/react-dom-BZDtXk6t.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/jsx-runtime-B4_2-8Ho.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/Combination-DIF6wDxT.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/clsx-CGw3WJH5.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/cn-f3ruLt4G.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/menu-items-QU91GQzu.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/hotkeys-sK-kaEBC.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/button-BtVgadIf.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/dist-DTKIwXcy.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/createLucideIcon-C9QGcv--.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/check-Pczj-rmu.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/select-Dre1F6mo.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/multi-map-Z_hg0zTh.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/chevron-right-Cn1LhTdd.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/dropdown-menu-DL4QHRL7.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/tooltip-DEUNsdbK.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/_Uint8Array-BGESiCQL.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/_getTag-BWqNuuwU.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/_baseIsEqual-C8v2yRqO.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/jotai-D74Ef_p1.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/invariant-EWlZS5z8.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/isArrayLikeObject-BkJc8lDE.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/merge-DVX6Ez37.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/zod-BBqism5D.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/utils-Clm_pCuX.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/requests-CMMs4cl8.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/once-DF3Ybce_.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/toDate-J43JkZRd.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/isSymbol-BGkTcW3U.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/toString-DlRqgfqz.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/_baseSlice-CskhCEVH.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/_hasUnicode-BC4vb_bF.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/useLifecycle-bYJVBwo9.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/capitalize-HqFs_OK0.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/ai-model-dropdown-BiaBgfSy.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/badge-DjEl44tW.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/use-toast-CTk3v2Fk.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/constants-O0mPFSN0.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/Deferred-cELqHKYi.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/config-ljv4_QXT.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/uuid-DFgsIVBI.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/DeferredRequestRegistry-DUZWfqOX.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/connection-DZfQ0nfK.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/useNonce-BPtPhVM4.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/capabilities-DPEuN0Kv.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/createReducer-uDMmKGBt.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/dist-hQAzR0Cy.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/dist-a5AhnPua.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/dist-BWV-5FQQ.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/dist-BRKC9vDH.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/dist-C2lGLtUJ.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/dist-DjRxw7g7.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/dist-BFZNB01C.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/dist-CiIxDFsH.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/dist-AYL4p4Dn.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/stex-BQjjdb1n.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/cjs-VdEqhsWH.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/_arrayReduce-BPS6ICyD.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/type-Bx7IFbhF.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/_baseProperty-Bl8lQyHQ.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/toNumber-GB_lFVaq.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/now-DBnXnRPe.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/debounce-BzCP2SOK.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/toInteger-Cl1doThW.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/main-B1nOh376.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/cells-XWXpgwpH.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/kbd-BGS9frER.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/renderShortcut-CF5R2n1d.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/useEvent-bc5jSpSz.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/useDeleteCell-D5AVSLUE.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/lazy-ShQ0UXOI.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/defaultLocale-9ao8Dcla.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/precisionRound-BdwMj645.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/defaultLocale-Bu1vZnwX.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/vega-loader.browser-DUgPL0IU.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/tooltip-tPIJZni7.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/ErrorBoundary-Xx3vyups.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/alert-dialog-CYJZg0vV.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/dialog-C-S4uQH4.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/useDebounce-Dz48GAub.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/numbers-BWXaNlZC.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/SSRProvider-DrIPqn2D.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/context-C5uPODSj.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/useNumberFormatter-C1aNc7b4.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/usePress-CuSksPzr.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/input-fjIzfaON.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/ImperativeModal-DD50EU1G.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/cell-link-D4ddCDwe.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/alert-BP5lLEUu.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/links-9tVC0887.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/state-BUWnJ0Ly.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/MarimoErrorOutput-CBrjDxLd.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/copy-CL0ql7QN.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/copy-CGmj_xHa.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/copy-icon-DyWZDAiU.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/spinner-cyqSIlb0.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/dist-CSuUnJvL.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/focus-BLLpcsff.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/popover-CmnWYkoH.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/useRunCells-Ds9oEET1.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/mode-OgOLIWqz.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/purify.es-B1k9qoU6.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/RenderHTML-CDZ5aEc_.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/table-NPSY8_Zm.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/tabs-CWZFOtfb.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/add-missing-import-CtAvQzRq.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/useAsyncData-CWTnKpYp.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/useIframeCapabilities-DeznJSW5.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/LazyAnyLanguageCodeMirror-LOVWlBJF.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/error-banner-BVpxvuDQ.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/formats-C_m3CfBz.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/useTheme-DNzypnwR.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/en-US-DZkKelDe.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/isValid-CB2nX3F0.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/maps-CcaFd04c.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/shim-DZsTM49a.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/download-Yhx6Ym5-.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/extends-r-9mmG40.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/emotion-is-prop-valid.esm-CvS1dbIX.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/useDateFormatter-BQepJAoC.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/katex-BWHK7JiN.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/marked.esm-D2gFq9fv.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/chunk-T7OEMACY-DmsJ7oRM.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/range-CWPLRnRw.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/table-BqDahwx2.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/Output-DaxqEvBr.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/name-cell-input-Czy9kSf0.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/useHotkey-fEzjOJm_.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/dist-C90uzGgn.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/dist-CXTCcHAx.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/dist-yuFtFIvU.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/dist-FxKIA4Su.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/dist-BTwRVGbc.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/dist-Dk-ec10U.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/dist-Bt-XL6sZ.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/dist-CO0hHVso.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/dist-B_1rC47Z.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/dist-Cav6n7Mt.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/dist-BilWanrC.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/dist-Bs4awW3v.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/dist-ByISUkN_.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/apl-P0h8Mr-1.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/asciiarmor-D32nrZfi.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/asn1-BGWFqtof.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/brainfuck-bRbTK_ul.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/clike-CDpf5LdD.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/clojure-BIaW7E1P.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/cmake-Fdo8v8A2.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/cobol-OYTcoAp0.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/coffeescript-DnHAeBoz.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/commonlisp-DZODvuDN.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/crystal-ByGYU1ry.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/css-DQy1ktIn.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/cypher-BqzuHhct.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/d-5Fj8y8Ro.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/diff-K3UuOlLk.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/dtd-COG0IeNI.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/dylan-Dfhc0Kak.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/ecl-BMslxTqn.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/eiffel-DoFPZKgO.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/elm-CWDHfGfn.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/erlang-C0xdvudI.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/simple-mode-Ccflbu9h.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/factor-DEtwqCL8.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/forth-A93hDrjr.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/fortran-CuTjeCKb.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/gas-CiyaCjl_.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/gherkin-BcwByeby.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/groovy-r2-fZFco.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/haskell-7o_rdGTQ.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/haxe-DYRKW28o.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/idl-lxzFEdlJ.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/javascript-BVerENn6.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/julia-BKrwhn35.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/livescript-DXZTF8eQ.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/lua-1kf1Kn_-.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/mathematica-DbM7qeVx.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/mbox-yeyE7jAy.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/mirc-BUIfkQcx.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/mllike-cuHPGaql.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/modelica-DVVkMuX_.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/mscgen-4Argcv2M.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/mumps-BnAFQnrr.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/nsis-BapZHEue.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/ntriples-KcW691KM.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/octave-aZeHY9oT.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/oz-Cp3up0rm.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/pascal-eBaSS2b_.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/perl-DEhUvkqp.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/pig-Bbx0-A3U.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/powershell-C-a2xSWe.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/properties-D4oZTSRw.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/protobuf-vt_-BoIh.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/pug-CuQCjsS0.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/puppet-v_FxnHdD.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/python-Ciz3nOoG.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/q-BAMmJTXP.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/r-BThezCV8.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/rpm-DqZBhvGf.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/ruby-COOWtg59.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/sas-D7AOhztC.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/scheme-CBocbbdR.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/shell-lT1vcZaF.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/sieve-Bp4wNuXd.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/smalltalk-C8zenhWl.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/sparql-Bfstq9Rh.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/stylus-C2Em32WT.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/swift-CQbdtQmS.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/tcl-CgwjN-Du.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/textile-CPuJdR_5.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/toml-DLqKhfOq.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/troff-BaD0cBMB.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/ttcn-cfg-C9NOBlCe.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/ttcn-DOB8C7GW.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/turtle-_7wd09RB.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/vb-E90VhI05.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/vbscript-CtQr8UoL.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/velocity-B4-NqC87.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/verilog-CCpiILSH.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/vhdl-CrGqTZyE.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/webidl-Ct6MbsZC.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/xquery-DNK7TlxO.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/yacas-BK5XHzX2.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/z80-DT8q_Ryr.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/esm-hcUBDEjZ.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/objectWithoutPropertiesLoose-dfl_7i8r.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/esm-DDxkZACy.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/trash-DI_RMnlv.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/ConsoleOutput-1UUGbXpT.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/icons-CVbUY4lM.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/blob-CIREuKO3.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/add-cell-with-ai-CSoCSUxd.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/chart-no-axes-column-Bji-_7ip.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/square-function-DNygr9WL.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/spec-BZnptJuy.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/useInstallPackage-DCDc7NTf.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/column-preview-DN61SPFU.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/useAddCell-BrByzpGu.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/toggle-DAkPAKX9.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/api-2JaIsahG.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/globals-eSrTJiES.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/share-BCjx5a8M.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/dist-CSLSra8C.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/memoize-DN0TMY36.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/_toKey-C5ccFCJm.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/_baseSet-BwKym8Ma.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/utilities.esm-CFYsyNzv.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/floating-outline-Bk6kjZw5.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/eye-off-CkynlJbW.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/plus-CcDW_rEW.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/readonly-python-code-mq6FZbVx.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/file-video-camera-DxwR0TAX.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/file-text-DYJz3QFG.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/file-DdZ6Vgf6.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/types-CKActxHf.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/label-CzgZucd0.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/textarea-d-UPtQ6q.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/circle-x-72ItD0Ur.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/refresh-ccw-BHxANXt5.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/trash-2-DkyoQBeV.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/form-DhU-C-zB.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/field-fjEDxnj7.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/switch-BskylHTJ.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/useBoolean-BKHo47jI.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/useDeepCompareMemoize-CMu624yo.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/types-DBTQaHSP.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/prop-types-8ppFGRBY.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/es-BMRi-PYh.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/VisuallyHidden-B6MGE2am.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/_baseFlatten-CnCoQev7.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/get-DaaGyK0L.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/hasIn-Ddg4IE2d.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/_basePickBy-CPlg9rol.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/pick-DON_s7R5.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/send-BBhGiLCG.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/code-xml-fIuLXB6s.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/download-CRVp7nwp.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/globe-B7EKeryr.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/refresh-cw-DHav_aX8.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/settings-DCyJEp5F.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/square-2ncKmcyv.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/triangle-alert-CITCjWDo.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/dist-x0pnLWWY.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/bundle.esm-CBRGmh5t.js">
    <link rel="stylesheet" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/cells-wU8qigWB.css">
    <link rel="stylesheet" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/Output-DUep6sC9.css">
    <link rel="stylesheet" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/ConsoleOutput-BFFTcC5Y.css">
    <link rel="stylesheet" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.3/dist/assets/index-7bO8TuDm.css">
  
<script data-marimo="true">
    window.__MARIMO_STATIC__ = {};
    window.__MARIMO_STATIC__.files = {};
</script>
</head>
  <body>
    <div id="root"></div>
    <!-- This is a portal for the data editor to render in -->
    <div id="portal" data-testid="glide-portal" style="position: fixed; left: 0; top: 0; z-index: 9999"></div>
    <script data-marimo="true">
      window.__MARIMO_MOUNT_CONFIG__ = {
            "filename": "homework.py",
            "mode": "read",
            "version": "0.18.3",
            "serverToken": "static",
            "config": {"ai": {"models": {"custom_models": [], "displayed_models": []}}, "completion": {"activate_on_typing": true, "copilot": false}, "diagnostics": {"sql_linter": true}, "display": {"cell_output": "below", "code_editor_font_size": 14, "dataframes": "rich", "default_table_max_columns": 50, "default_table_page_size": 10, "default_width": "medium", "reference_highlighting": false, "theme": "light"}, "formatting": {"line_length": 79}, "keymap": {"overrides": {}, "preset": "default"}, "language_servers": {"pylsp": {"enable_flake8": false, "enable_mypy": true, "enable_pydocstyle": false, "enable_pyflakes": false, "enable_pylint": false, "enable_ruff": true, "enabled": false}}, "mcp": {"mcpServers": {}, "presets": []}, "package_management": {"manager": "pip"}, "runtime": {"auto_instantiate": false, "auto_reload": "off", "default_sql_output": "auto", "on_cell_change": "autorun", "output_max_bytes": 8000000, "reactive_tests": true, "std_stream_max_bytes": 1000000, "watcher_on_save": "lazy"}, "save": {"autosave": "after_delay", "autosave_delay": 1000, "format_on_save": false}, "server": {"browser": "default", "follow_symlink": false}, "snippets": {"custom_paths": [], "include_default_snippets": true}},
            "configOverrides": {},
            "appConfig": {"sql_output": "auto", "width": "medium"},
            "view": {"showAppCode": true},
            "notebook": {"cells": [{"code": "import marimo as mo\nimport onnxruntime as ort\nimport numpy as np\nfrom torchvision import transforms\nfrom keras_image_helper import create_preprocessor", "code_hash": "801a03e4f57e02d5908f8e1749e39a68", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "Hbol", "name": "_"}, {"code": "mo.md(r\"\"\"\n# Machine Learning Zoomcamp\n\n## Module 9: **Deploy with AWS Lambda**\n\"\"\")", "code_hash": "d7dcd3b02516f5ba41038295812f5f24", "config": {"column": null, "disabled": false, "hide_code": true}, "id": "MJUe", "name": "_"}, {"code": "mo.md(\n    r\"\"\"\n## Homework\n\nIn this homework, we'll deploy the Straight vs Curly Hair Type model we trained in the\n[previous homework](../08-deep-learning/homework.md).\n\nDownload the model files from here: \n\n* https://github.com/alexeygrigorev/large-datasets/releases/download/hairstyle/hair_classifier_v1.onnx.data\n* https://github.com/alexeygrigorev/large-datasets/releases/download/hairstyle/hair_classifier_v1.onnx\n\nWith wget:\n\n```bash\nPREFIX=\"https://github.com/alexeygrigorev/large-datasets/releases/download/hairstyle\"\nDATA_URL=\"${PREFIX}/hair_classifier_v1.onnx.data\"\nMODEL_URL=\"${PREFIX}/hair_classifier_v1.onnx\"\nwget ${DATA_URL}\nwget ${MODEL_URL}\n```\n\"\"\"\n)", "code_hash": "268fe81f025a8731dfb5e60f8e8943bb", "config": {"column": null, "disabled": false, "hide_code": true}, "id": "vblA", "name": "_"}, {"code": "mo.md(\n    r\"\"\"\n## Question 1\n\nTo be able to use this model, we need to know the name of the input and output nodes. \n\nWhat's the name of the output:\n\n* `output`\n* `sigmoid`\n* `softmax`\n* `prediction`\n\"\"\"\n)", "code_hash": "b0dac05b88181aa2b88b0d12e4aa6f5a", "config": {"column": null, "disabled": false, "hide_code": true}, "id": "bkHC", "name": "_"}, {"code": "session = ort.InferenceSession(\"module-9/homework/hair_classifier_v1.onnx\")\n\ninput_name = session.get_inputs()[0].name\noutput_name = session.get_outputs()[0].name\n\n(input_name, output_name)", "code_hash": "ad7867fc4bfdff5d57a6714dbc73090a", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "lEQa", "name": "_"}, {"code": "mo.md(r\"\"\"\nThe name of the output is **output**.\n\"\"\")", "code_hash": "7263564c396e4328d1bbb8b4910cbab4", "config": {"column": null, "disabled": false, "hide_code": true}, "id": "KYkC", "name": "_"}, {"code": "mo.md(r\"\"\"\n## Preparing the image\n\nYou'll need some code for downloading and resizing images. You can use \nthis code:\n\"\"\")", "code_hash": "899b39252bcc44ab4a786b5ff33ebc5f", "config": {"column": null, "disabled": false, "hide_code": true}, "id": "rvgg", "name": "_"}, {"code": "from io import BytesIO\nfrom urllib import request\nfrom PIL import Image\n\ndef download_image(url):\n    with request.urlopen(url) as resp:\n        buffer = resp.read()\n    stream = BytesIO(buffer)\n    img = Image.open(stream)\n    return img\n\n\ndef prepare_image(img, target_size):\n    if img.mode != 'RGB':\n        img = img.convert('RGB')\n    img = img.resize(target_size, Image.NEAREST)\n    return img", "code_hash": "b1b2b8377b293f26d38774a69f541f32", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "hYWs", "name": "_"}, {"code": "mo.md(r\"\"\"\n## Question 2: Target size\n\nLet's download and resize this image: \n\nhttps://habrastorage.org/webt/yf/_d/ok/yf_dokzqy3vcritme8ggnzqlvwa.jpeg\n\nBased on the previous homework, what should be the target size for the image?\n\n* 64x64\n* 128x128\n* 200x200\n* 256x256\n\"\"\")", "code_hash": "da9e3224cd0689053402f4f53964d247", "config": {"column": null, "disabled": false, "hide_code": true}, "id": "RpzL", "name": "_"}, {"code": "image = download_image(\"https://habrastorage.org/webt/yf/_d/ok/yf_dokzqy3vcritme8ggnzqlvwa.jpeg\")\nprepared_image = prepare_image(image, (200, 200))", "code_hash": "2f846dd7a8004bdf4e1825db95dd8db0", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "gTID", "name": "_"}, {"code": "mo.md(r\"\"\"\nThe target size for the image is **200x200**.\n\"\"\")", "code_hash": "486cd61dc1bc90091de3a2fdd531521a", "config": {"column": null, "disabled": false, "hide_code": true}, "id": "MZox", "name": "_"}, {"code": "mo.md(r\"\"\"\n## Question 3\n\nNow we need to turn the image into numpy array and pre-process it. \n\n\u003E Tip: Check the previous homework. What was the pre-processing \n\u003E we did there?\n\nAfter the pre-processing, what's the value in the first pixel, the R channel?\n\n* -10.73\n* -1.073\n* 1.073\n* 10.73\n\"\"\")", "code_hash": "db3b9a68ccdc39c9f9ac67ea712b49de", "config": {"column": null, "disabled": false, "hide_code": true}, "id": "ghtn", "name": "_"}, {"code": "def preprocess_pytorch(X):\n    # X: shape (1, 299, 299, 3), dtype=float32, values in [0, 255]\n    X = X / 255.0\n\n    mean = np.array([0.485, 0.456, 0.406]).reshape(1, 3, 1, 1)\n    std = np.array([0.229, 0.224, 0.225]).reshape(1, 3, 1, 1)\n\n    # Convert NHWC \u2192 NCHW\n    # from (batch, height, width, channels) \u2192 (batch, channels, height, width)\n    X = X.transpose(0, 3, 1, 2)\n\n    # Normalize\n    X = (X - mean) / std\n\n    return X.astype(np.float32)\n\n\npreprocessor = create_preprocessor(preprocess_pytorch, target_size=(200, 200))\n\nX = preprocessor.from_url(\"https://habrastorage.org/webt/yf/_d/ok/yf_dokzqy3vcritme8ggnzqlvwa.jpeg\")\nX[0][0][0][0]", "code_hash": "4d8784025fa7aebaf7bd6a5ad88b7ad6", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "PsYK", "name": "_"}, {"code": "mo.md(r\"\"\"\nThe value of the R channel of the firs pixel is **-1.073**.\n\"\"\")", "code_hash": "da4fe5734e4abbabc25316106e92e9b5", "config": {"column": null, "disabled": false, "hide_code": true}, "id": "mtPh", "name": "_"}, {"code": "mo.md(r\"\"\"\n## Question 4\n\nNow let's apply this model to this image. What's the output of the model?\n\n* 0.09\n* 0.49\n* 0.69\n* 0.89\n\"\"\")", "code_hash": "4eda1a96fdd78ada3626c502b235d716", "config": {"column": null, "disabled": false, "hide_code": true}, "id": "rnrs", "name": "_"}, {"code": "classes = [\n    'dress',\n    'hat',\n    'longsleeve',\n    'outwear',\n    'pants',\n    'shirt',\n    'shoes',\n    'shorts',\n    'skirt',\n    't-shirt'\n]\n\ndef predict(url):\n    X = preprocessor.from_url(url)\n    result = session.run([output_name], {input_name: X})\n    float_predictions = result[0][0].tolist()\n    return dict(zip(classes, float_predictions))\n\npredict(\"https://habrastorage.org/webt/yf/_d/ok/yf_dokzqy3vcritme8ggnzqlvwa.jpeg\")", "code_hash": "775445d366fc4d12de37cef3a3aa5bee", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "jQUO", "name": "_"}, {"code": "mo.md(r\"\"\"\n## Prepare the lambda code \n\nNow you need to copy all the code into a separate python file. You will \nneed to use this file for the next two questions.\n\nTip: you can test this file locally with `ipython` or Jupyter Notebook \nby importing the file and invoking the function from this file.  \n\n\n## Docker \n\nFor the next two questions, we'll use a Docker image that we already \nprepared. This is the Dockerfile that we used for creating the image:\n\n```docker\nFROM public.ecr.aws/lambda/python:3.13\n\nCOPY hair_classifier_empty.onnx.data .\nCOPY hair_classifier_empty.onnx .\n```\n\nNote that it uses Python 3.13.\n\nThe docker image is published to [`agrigorev/model-2025-hairstyle:v1`](https://hub.docker.com/r/agrigorev/model-2025-hairstyle).\n\nA few notes:\n\n* The image already contains a model and it's not the same model\n  as the one we used for questions 1-4.\n\"\"\")", "code_hash": "37c70c73b27359aa6d044abad6724b88", "config": {"column": null, "disabled": false, "hide_code": true}, "id": "MJJA", "name": "_"}, {"code": "mo.md(r\"\"\"\n## Question 5\n\nDownload the base image `agrigorev/model-2025-hairstyle:v1`. You can do it with [`docker pull`](https://docs.docker.com/engine/reference/commandline/pull/).\n\nSo what's the size of this base image?\n\n* 88 Mb\n* 208 Mb\n* 608 Mb\n* 1208 Mb\n\nYou can get this information when running `docker images` - it'll be in the \"SIZE\" column.\n\"\"\")", "code_hash": "7421ce1560382439f665207787a6d629", "config": {"column": null, "disabled": false, "hide_code": true}, "id": "hoRb", "name": "_"}, {"code": "mo.md(r\"\"\"\n```bash\ndocker pull agrigorev/model-2025-hairstyle:v1\ndocker image ls | grep agrigorev/model-2025-hairstyle\n```\n\n\u003E agrigorev/model-2025-hairstyle - v1 - 4528ad1525d5 - 6 days ago - 608MB\n\"\"\")", "code_hash": "e25f8b5ccb07c6e8efd27d342df08501", "config": {"column": null, "disabled": false, "hide_code": true}, "id": "QnpN", "name": "_"}, {"code": "mo.md(r\"\"\"\nThe size of the downloaded image is **608 Mb**.\n\"\"\")", "code_hash": "ef4ba5b8063215fcb88e78af95df82fb", "config": {"column": null, "disabled": false, "hide_code": true}, "id": "hfoU", "name": "_"}, {"code": "mo.md(r\"\"\"\n## Question 6\n\nNow let's extend this docker image, install all the required libraries\nand add the code for lambda.\n\nYou don't need to include the model in the image. It's already included. \nThe name of the file with the model is `hair_classifier_empty.onnx` and it's \nin the current workdir in the image (see the Dockerfile above for the \nreference). \nThe provided model requires the same preprocessing for images regarding target size and rescaling the value range than used in homework 8.\n\nNow run the container locally.\n\nScore this image: https://habrastorage.org/webt/yf/_d/ok/yf_dokzqy3vcritme8ggnzqlvwa.jpeg\n\nWhat's the output from the model?\n\n* -1.0\n* -0.10\n* 0.10\n* 1.0\n\"\"\")", "code_hash": "c58363116e48476cf038bf7f60040dbf", "config": {"column": null, "disabled": false, "hide_code": true}, "id": "cdOP", "name": "_"}, {"code": "mo.md(r\"\"\"\nThe result is 0.09 which is almost **0.10**.\n\"\"\")", "code_hash": "25e28d70181278a5819b06657212cdde", "config": {"column": null, "disabled": false, "hide_code": true}, "id": "jnFb", "name": "_"}, {"code": "mo.md(\n    r\"\"\"\n## Publishing it to AWS\n\nNow you can deploy your model to AWS!\n\n* Publish your image to ECR\n* Create a lambda function in AWS, use the ECR image\n* Give it more RAM and increase the timeout \n* Test it\n* Expose the lambda function using API Gateway\n\nThis is optional and not graded.\n\n\n## Submit the results\n\n* Submit your results here: https://courses.datatalks.club/ml-zoomcamp-2025/homework/hw09\n* If your answer doesn't match options exactly, select the closest one. If the answer is exactly in between two options, select the higher value.\n\n## Publishing to Docker hub\n\nJust for the reference, this is how we published our image to Docker hub:\n\n```bash\ndocker build -t model-2025-hairstyle -f homework.dockerfile .\ndocker tag model-2025-hairstyle:latest agrigorev/model-2025-hairstyle:v1\ndocker push agrigorev/model-2025-hairstyle:v1\n```\n\n(You don't need to execute this code)\n\"\"\"\n)", "code_hash": "0eddd90a997ad3a39727cb0e5ee5fd32", "config": {"column": null, "disabled": false, "hide_code": true}, "id": "Xref", "name": "_"}], "metadata": {"marimo_version": "0.18.3"}, "version": "1"},
            "session": {"cells": [{"code_hash": "801a03e4f57e02d5908f8e1749e39a68", "console": [], "id": "Hbol", "outputs": [{"data": {"text/plain": ""}, "type": "data"}]}, {"code_hash": "d7dcd3b02516f5ba41038295812f5f24", "console": [], "id": "MJUe", "outputs": [{"data": {"text/markdown": "\u003Cspan class=\"markdown prose dark:prose-invert contents\"\u003E\u003Ch1 id=\"machine-learning-zoomcamp\"\u003EMachine Learning Zoomcamp\u003C/h1\u003E\n\u003Ch2 id=\"module-9-deploy-with-aws-lambda\"\u003EModule 9: \u003Cstrong\u003EDeploy with AWS Lambda\u003C/strong\u003E\u003C/h2\u003E\u003C/span\u003E"}, "type": "data"}]}, {"code_hash": "268fe81f025a8731dfb5e60f8e8943bb", "console": [], "id": "vblA", "outputs": [{"data": {"text/markdown": "\u003Cspan class=\"markdown prose dark:prose-invert contents\"\u003E\u003Ch2 id=\"homework\"\u003EHomework\u003C/h2\u003E\n\u003Cspan class=\"paragraph\"\u003EIn this homework, we'll deploy the Straight vs Curly Hair Type model we trained in the\n\u003Ca href=\"../08-deep-learning/homework.md\"\u003Eprevious homework\u003C/a\u003E.\u003C/span\u003E\n\u003Cspan class=\"paragraph\"\u003EDownload the model files from here:\u003C/span\u003E\n\u003Cul\u003E\n\u003Cli\u003E\u003Ca href=\"https://github.com/alexeygrigorev/large-datasets/releases/download/hairstyle/hair_classifier_v1.onnx.data\" rel=\"noopener noreferrer\" target=\"_blank\"\u003Ehttps://github.com/alexeygrigorev/large-datasets/releases/download/hairstyle/hair_classifier_v1.onnx.data\u003C/a\u003E\u003C/li\u003E\n\u003Cli\u003E\u003Ca href=\"https://github.com/alexeygrigorev/large-datasets/releases/download/hairstyle/hair_classifier_v1.onnx\" rel=\"noopener noreferrer\" target=\"_blank\"\u003Ehttps://github.com/alexeygrigorev/large-datasets/releases/download/hairstyle/hair_classifier_v1.onnx\u003C/a\u003E\u003C/li\u003E\n\u003C/ul\u003E\n\u003Cspan class=\"paragraph\"\u003EWith wget:\u003C/span\u003E\n\u003Cdiv class=\"language-bash codehilite\"\u003E\u003Cpre\u003E\u003Cspan\u003E\u003C/span\u003E\u003Ccode\u003E\u003Cspan class=\"nv\"\u003EPREFIX\u003C/span\u003E\u003Cspan class=\"o\"\u003E=\u003C/span\u003E\u003Cspan class=\"s2\"\u003E\u0026quot;https://github.com/alexeygrigorev/large-datasets/releases/download/hairstyle\u0026quot;\u003C/span\u003E\n\u003Cspan class=\"nv\"\u003EDATA_URL\u003C/span\u003E\u003Cspan class=\"o\"\u003E=\u003C/span\u003E\u003Cspan class=\"s2\"\u003E\u0026quot;\u003C/span\u003E\u003Cspan class=\"si\"\u003E${\u003C/span\u003E\u003Cspan class=\"nv\"\u003EPREFIX\u003C/span\u003E\u003Cspan class=\"si\"\u003E}\u003C/span\u003E\u003Cspan class=\"s2\"\u003E/hair_classifier_v1.onnx.data\u0026quot;\u003C/span\u003E\n\u003Cspan class=\"nv\"\u003EMODEL_URL\u003C/span\u003E\u003Cspan class=\"o\"\u003E=\u003C/span\u003E\u003Cspan class=\"s2\"\u003E\u0026quot;\u003C/span\u003E\u003Cspan class=\"si\"\u003E${\u003C/span\u003E\u003Cspan class=\"nv\"\u003EPREFIX\u003C/span\u003E\u003Cspan class=\"si\"\u003E}\u003C/span\u003E\u003Cspan class=\"s2\"\u003E/hair_classifier_v1.onnx\u0026quot;\u003C/span\u003E\nwget\u003Cspan class=\"w\"\u003E \u003C/span\u003E\u003Cspan class=\"si\"\u003E${\u003C/span\u003E\u003Cspan class=\"nv\"\u003EDATA_URL\u003C/span\u003E\u003Cspan class=\"si\"\u003E}\u003C/span\u003E\nwget\u003Cspan class=\"w\"\u003E \u003C/span\u003E\u003Cspan class=\"si\"\u003E${\u003C/span\u003E\u003Cspan class=\"nv\"\u003EMODEL_URL\u003C/span\u003E\u003Cspan class=\"si\"\u003E}\u003C/span\u003E\n\u003C/code\u003E\u003C/pre\u003E\u003C/div\u003E\u003C/span\u003E"}, "type": "data"}]}, {"code_hash": "b0dac05b88181aa2b88b0d12e4aa6f5a", "console": [], "id": "bkHC", "outputs": [{"data": {"text/markdown": "\u003Cspan class=\"markdown prose dark:prose-invert contents\"\u003E\u003Ch2 id=\"question-1\"\u003EQuestion 1\u003C/h2\u003E\n\u003Cspan class=\"paragraph\"\u003ETo be able to use this model, we need to know the name of the input and output nodes.\u003C/span\u003E\n\u003Cspan class=\"paragraph\"\u003EWhat's the name of the output:\u003C/span\u003E\n\u003Cul\u003E\n\u003Cli\u003E\u003Ccode\u003Eoutput\u003C/code\u003E\u003C/li\u003E\n\u003Cli\u003E\u003Ccode\u003Esigmoid\u003C/code\u003E\u003C/li\u003E\n\u003Cli\u003E\u003Ccode\u003Esoftmax\u003C/code\u003E\u003C/li\u003E\n\u003Cli\u003E\u003Ccode\u003Eprediction\u003C/code\u003E\u003C/li\u003E\n\u003C/ul\u003E\u003C/span\u003E"}, "type": "data"}]}, {"code_hash": "ad7867fc4bfdff5d57a6714dbc73090a", "console": [], "id": "lEQa", "outputs": [{"data": {"application/json": "[\"input\", \"output\"]"}, "type": "data"}]}, {"code_hash": "7263564c396e4328d1bbb8b4910cbab4", "console": [], "id": "KYkC", "outputs": [{"data": {"text/markdown": "\u003Cspan class=\"markdown prose dark:prose-invert contents\"\u003E\u003Cspan class=\"paragraph\"\u003EThe name of the output is \u003Cstrong\u003Eoutput\u003C/strong\u003E.\u003C/span\u003E\u003C/span\u003E"}, "type": "data"}]}, {"code_hash": "899b39252bcc44ab4a786b5ff33ebc5f", "console": [], "id": "rvgg", "outputs": [{"data": {"text/markdown": "\u003Cspan class=\"markdown prose dark:prose-invert contents\"\u003E\u003Ch2 id=\"preparing-the-image\"\u003EPreparing the image\u003C/h2\u003E\n\u003Cspan class=\"paragraph\"\u003EYou'll need some code for downloading and resizing images. You can use \nthis code:\u003C/span\u003E\u003C/span\u003E"}, "type": "data"}]}, {"code_hash": "b1b2b8377b293f26d38774a69f541f32", "console": [], "id": "hYWs", "outputs": [{"data": {"text/plain": ""}, "type": "data"}]}, {"code_hash": "da9e3224cd0689053402f4f53964d247", "console": [], "id": "RpzL", "outputs": [{"data": {"text/markdown": "\u003Cspan class=\"markdown prose dark:prose-invert contents\"\u003E\u003Ch2 id=\"question-2-target-size\"\u003EQuestion 2: Target size\u003C/h2\u003E\n\u003Cspan class=\"paragraph\"\u003ELet's download and resize this image: \u003C/span\u003E\n\u003Cspan class=\"paragraph\"\u003E\u003Ca href=\"https://habrastorage.org/webt/yf/_d/ok/yf_dokzqy3vcritme8ggnzqlvwa.jpeg\" rel=\"noopener noreferrer\" target=\"_blank\"\u003Ehttps://habrastorage.org/webt/yf/_d/ok/yf_dokzqy3vcritme8ggnzqlvwa.jpeg\u003C/a\u003E\u003C/span\u003E\n\u003Cspan class=\"paragraph\"\u003EBased on the previous homework, what should be the target size for the image?\u003C/span\u003E\n\u003Cul\u003E\n\u003Cli\u003E64x64\u003C/li\u003E\n\u003Cli\u003E128x128\u003C/li\u003E\n\u003Cli\u003E200x200\u003C/li\u003E\n\u003Cli\u003E256x256\u003C/li\u003E\n\u003C/ul\u003E\u003C/span\u003E"}, "type": "data"}]}, {"code_hash": "2f846dd7a8004bdf4e1825db95dd8db0", "console": [], "id": "gTID", "outputs": [{"data": {"text/plain": ""}, "type": "data"}]}, {"code_hash": "486cd61dc1bc90091de3a2fdd531521a", "console": [], "id": "MZox", "outputs": [{"data": {"text/markdown": "\u003Cspan class=\"markdown prose dark:prose-invert contents\"\u003E\u003Cspan class=\"paragraph\"\u003EThe target size for the image is \u003Cstrong\u003E200x200\u003C/strong\u003E.\u003C/span\u003E\u003C/span\u003E"}, "type": "data"}]}, {"code_hash": "db3b9a68ccdc39c9f9ac67ea712b49de", "console": [], "id": "ghtn", "outputs": [{"data": {"text/markdown": "\u003Cspan class=\"markdown prose dark:prose-invert contents\"\u003E\u003Ch2 id=\"question-3\"\u003EQuestion 3\u003C/h2\u003E\n\u003Cspan class=\"paragraph\"\u003ENow we need to turn the image into numpy array and pre-process it. \u003C/span\u003E\n\u003Cblockquote\u003E\n\u003Cspan class=\"paragraph\"\u003ETip: Check the previous homework. What was the pre-processing \nwe did there?\u003C/span\u003E\n\u003C/blockquote\u003E\n\u003Cspan class=\"paragraph\"\u003EAfter the pre-processing, what's the value in the first pixel, the R channel?\u003C/span\u003E\n\u003Cul\u003E\n\u003Cli\u003E-10.73\u003C/li\u003E\n\u003Cli\u003E-1.073\u003C/li\u003E\n\u003Cli\u003E1.073\u003C/li\u003E\n\u003Cli\u003E10.73\u003C/li\u003E\n\u003C/ul\u003E\u003C/span\u003E"}, "type": "data"}]}, {"code_hash": "4d8784025fa7aebaf7bd6a5ad88b7ad6", "console": [], "id": "PsYK", "outputs": [{"data": {"text/html": "\u003Cpre class='text-xs'\u003Enp.float32(-1.0732939)\u003C/pre\u003E"}, "type": "data"}]}, {"code_hash": "da4fe5734e4abbabc25316106e92e9b5", "console": [], "id": "mtPh", "outputs": [{"data": {"text/markdown": "\u003Cspan class=\"markdown prose dark:prose-invert contents\"\u003E\u003Cspan class=\"paragraph\"\u003EThe value of the R channel of the firs pixel is \u003Cstrong\u003E-1.073\u003C/strong\u003E.\u003C/span\u003E\u003C/span\u003E"}, "type": "data"}]}, {"code_hash": "4eda1a96fdd78ada3626c502b235d716", "console": [], "id": "rnrs", "outputs": [{"data": {"text/markdown": "\u003Cspan class=\"markdown prose dark:prose-invert contents\"\u003E\u003Ch2 id=\"question-4\"\u003EQuestion 4\u003C/h2\u003E\n\u003Cspan class=\"paragraph\"\u003ENow let's apply this model to this image. What's the output of the model?\u003C/span\u003E\n\u003Cul\u003E\n\u003Cli\u003E0.09\u003C/li\u003E\n\u003Cli\u003E0.49\u003C/li\u003E\n\u003Cli\u003E0.69\u003C/li\u003E\n\u003Cli\u003E0.89\u003C/li\u003E\n\u003C/ul\u003E\u003C/span\u003E"}, "type": "data"}]}, {"code_hash": "775445d366fc4d12de37cef3a3aa5bee", "console": [], "id": "jQUO", "outputs": [{"data": {"application/json": "{\"dress\": \"text/plain+float:0.09156627207994461\"}"}, "type": "data"}]}, {"code_hash": "37c70c73b27359aa6d044abad6724b88", "console": [], "id": "MJJA", "outputs": [{"data": {"text/markdown": "\u003Cspan class=\"markdown prose dark:prose-invert contents\"\u003E\u003Ch2 id=\"prepare-the-lambda-code\"\u003EPrepare the lambda code\u003C/h2\u003E\n\u003Cspan class=\"paragraph\"\u003ENow you need to copy all the code into a separate python file. You will \nneed to use this file for the next two questions.\u003C/span\u003E\n\u003Cspan class=\"paragraph\"\u003ETip: you can test this file locally with \u003Ccode\u003Eipython\u003C/code\u003E or Jupyter Notebook \nby importing the file and invoking the function from this file.  \u003C/span\u003E\n\u003Ch2 id=\"docker\"\u003EDocker\u003C/h2\u003E\n\u003Cspan class=\"paragraph\"\u003EFor the next two questions, we'll use a Docker image that we already \nprepared. This is the Dockerfile that we used for creating the image:\u003C/span\u003E\n\u003Cdiv class=\"language-docker codehilite\"\u003E\u003Cpre\u003E\u003Cspan\u003E\u003C/span\u003E\u003Ccode\u003E\u003Cspan class=\"k\"\u003EFROM\u003C/span\u003E\u003Cspan class=\"w\"\u003E \u003C/span\u003E\u003Cspan class=\"s\"\u003Epublic.ecr.aws/lambda/python:3.13\u003C/span\u003E\n\n\u003Cspan class=\"k\"\u003ECOPY\u003C/span\u003E\u003Cspan class=\"w\"\u003E \u003C/span\u003Ehair_classifier_empty.onnx.data\u003Cspan class=\"w\"\u003E \u003C/span\u003E.\n\u003Cspan class=\"k\"\u003ECOPY\u003C/span\u003E\u003Cspan class=\"w\"\u003E \u003C/span\u003Ehair_classifier_empty.onnx\u003Cspan class=\"w\"\u003E \u003C/span\u003E.\n\u003C/code\u003E\u003C/pre\u003E\u003C/div\u003E\n\u003Cspan class=\"paragraph\"\u003ENote that it uses Python 3.13.\u003C/span\u003E\n\u003Cspan class=\"paragraph\"\u003EThe docker image is published to \u003Ca href=\"https://hub.docker.com/r/agrigorev/model-2025-hairstyle\" rel=\"noopener noreferrer\" target=\"_blank\"\u003E\u003Ccode\u003Eagrigorev/model-2025-hairstyle:v1\u003C/code\u003E\u003C/a\u003E.\u003C/span\u003E\n\u003Cspan class=\"paragraph\"\u003EA few notes:\u003C/span\u003E\n\u003Cul\u003E\n\u003Cli\u003EThe image already contains a model and it's not the same model\n  as the one we used for questions 1-4.\u003C/li\u003E\n\u003C/ul\u003E\u003C/span\u003E"}, "type": "data"}]}, {"code_hash": "7421ce1560382439f665207787a6d629", "console": [], "id": "hoRb", "outputs": [{"data": {"text/markdown": "\u003Cspan class=\"markdown prose dark:prose-invert contents\"\u003E\u003Ch2 id=\"question-5\"\u003EQuestion 5\u003C/h2\u003E\n\u003Cspan class=\"paragraph\"\u003EDownload the base image \u003Ccode\u003Eagrigorev/model-2025-hairstyle:v1\u003C/code\u003E. You can do it with \u003Ca href=\"https://docs.docker.com/engine/reference/commandline/pull/\" rel=\"noopener noreferrer\" target=\"_blank\"\u003E\u003Ccode\u003Edocker pull\u003C/code\u003E\u003C/a\u003E.\u003C/span\u003E\n\u003Cspan class=\"paragraph\"\u003ESo what's the size of this base image?\u003C/span\u003E\n\u003Cul\u003E\n\u003Cli\u003E88 Mb\u003C/li\u003E\n\u003Cli\u003E208 Mb\u003C/li\u003E\n\u003Cli\u003E608 Mb\u003C/li\u003E\n\u003Cli\u003E1208 Mb\u003C/li\u003E\n\u003C/ul\u003E\n\u003Cspan class=\"paragraph\"\u003EYou can get this information when running \u003Ccode\u003Edocker images\u003C/code\u003E - it'll be in the \"SIZE\" column.\u003C/span\u003E\u003C/span\u003E"}, "type": "data"}]}, {"code_hash": "e25f8b5ccb07c6e8efd27d342df08501", "console": [], "id": "QnpN", "outputs": [{"data": {"text/markdown": "\u003Cspan class=\"markdown prose dark:prose-invert contents\"\u003E\u003Cdiv class=\"language-bash codehilite\"\u003E\u003Cpre\u003E\u003Cspan\u003E\u003C/span\u003E\u003Ccode\u003Edocker\u003Cspan class=\"w\"\u003E \u003C/span\u003Epull\u003Cspan class=\"w\"\u003E \u003C/span\u003Eagrigorev/model-2025-hairstyle:v1\ndocker\u003Cspan class=\"w\"\u003E \u003C/span\u003Eimage\u003Cspan class=\"w\"\u003E \u003C/span\u003Els\u003Cspan class=\"w\"\u003E \u003C/span\u003E\u003Cspan class=\"p\"\u003E|\u003C/span\u003E\u003Cspan class=\"w\"\u003E \u003C/span\u003Egrep\u003Cspan class=\"w\"\u003E \u003C/span\u003Eagrigorev/model-2025-hairstyle\n\u003C/code\u003E\u003C/pre\u003E\u003C/div\u003E\n\u003Cblockquote\u003E\n\u003Cspan class=\"paragraph\"\u003Eagrigorev/model-2025-hairstyle - v1 - 4528ad1525d5 - 6 days ago - 608MB\u003C/span\u003E\n\u003C/blockquote\u003E\u003C/span\u003E"}, "type": "data"}]}, {"code_hash": "ef4ba5b8063215fcb88e78af95df82fb", "console": [], "id": "hfoU", "outputs": [{"data": {"text/markdown": "\u003Cspan class=\"markdown prose dark:prose-invert contents\"\u003E\u003Cspan class=\"paragraph\"\u003EThe size of the downloaded image is \u003Cstrong\u003E608 Mb\u003C/strong\u003E.\u003C/span\u003E\u003C/span\u003E"}, "type": "data"}]}, {"code_hash": "c58363116e48476cf038bf7f60040dbf", "console": [], "id": "cdOP", "outputs": [{"data": {"text/markdown": "\u003Cspan class=\"markdown prose dark:prose-invert contents\"\u003E\u003Ch2 id=\"question-6\"\u003EQuestion 6\u003C/h2\u003E\n\u003Cspan class=\"paragraph\"\u003ENow let's extend this docker image, install all the required libraries\nand add the code for lambda.\u003C/span\u003E\n\u003Cspan class=\"paragraph\"\u003EYou don't need to include the model in the image. It's already included. \nThe name of the file with the model is \u003Ccode\u003Ehair_classifier_empty.onnx\u003C/code\u003E and it's \nin the current workdir in the image (see the Dockerfile above for the \nreference). \nThe provided model requires the same preprocessing for images regarding target size and rescaling the value range than used in homework 8.\u003C/span\u003E\n\u003Cspan class=\"paragraph\"\u003ENow run the container locally.\u003C/span\u003E\n\u003Cspan class=\"paragraph\"\u003EScore this image: \u003Ca href=\"https://habrastorage.org/webt/yf/_d/ok/yf_dokzqy3vcritme8ggnzqlvwa.jpeg\" rel=\"noopener noreferrer\" target=\"_blank\"\u003Ehttps://habrastorage.org/webt/yf/_d/ok/yf_dokzqy3vcritme8ggnzqlvwa.jpeg\u003C/a\u003E\u003C/span\u003E\n\u003Cspan class=\"paragraph\"\u003EWhat's the output from the model?\u003C/span\u003E\n\u003Cul\u003E\n\u003Cli\u003E-1.0\u003C/li\u003E\n\u003Cli\u003E-0.10\u003C/li\u003E\n\u003Cli\u003E0.10\u003C/li\u003E\n\u003Cli\u003E1.0\u003C/li\u003E\n\u003C/ul\u003E\u003C/span\u003E"}, "type": "data"}]}, {"code_hash": "25e28d70181278a5819b06657212cdde", "console": [], "id": "jnFb", "outputs": [{"data": {"text/markdown": "\u003Cspan class=\"markdown prose dark:prose-invert contents\"\u003E\u003Cspan class=\"paragraph\"\u003EThe result is 0.09 which is almost \u003Cstrong\u003E0.10\u003C/strong\u003E.\u003C/span\u003E\u003C/span\u003E"}, "type": "data"}]}, {"code_hash": "0eddd90a997ad3a39727cb0e5ee5fd32", "console": [], "id": "Xref", "outputs": [{"data": {"text/markdown": "\u003Cspan class=\"markdown prose dark:prose-invert contents\"\u003E\u003Ch2 id=\"publishing-it-to-aws\"\u003EPublishing it to AWS\u003C/h2\u003E\n\u003Cspan class=\"paragraph\"\u003ENow you can deploy your model to AWS!\u003C/span\u003E\n\u003Cul\u003E\n\u003Cli\u003EPublish your image to ECR\u003C/li\u003E\n\u003Cli\u003ECreate a lambda function in AWS, use the ECR image\u003C/li\u003E\n\u003Cli\u003EGive it more RAM and increase the timeout\u003C/li\u003E\n\u003Cli\u003ETest it\u003C/li\u003E\n\u003Cli\u003EExpose the lambda function using API Gateway\u003C/li\u003E\n\u003C/ul\u003E\n\u003Cspan class=\"paragraph\"\u003EThis is optional and not graded.\u003C/span\u003E\n\u003Ch2 id=\"submit-the-results\"\u003ESubmit the results\u003C/h2\u003E\n\u003Cul\u003E\n\u003Cli\u003ESubmit your results here: \u003Ca href=\"https://courses.datatalks.club/ml-zoomcamp-2025/homework/hw09\" rel=\"noopener noreferrer\" target=\"_blank\"\u003Ehttps://courses.datatalks.club/ml-zoomcamp-2025/homework/hw09\u003C/a\u003E\u003C/li\u003E\n\u003Cli\u003EIf your answer doesn't match options exactly, select the closest one. If the answer is exactly in between two options, select the higher value.\u003C/li\u003E\n\u003C/ul\u003E\n\u003Ch2 id=\"publishing-to-docker-hub\"\u003EPublishing to Docker hub\u003C/h2\u003E\n\u003Cspan class=\"paragraph\"\u003EJust for the reference, this is how we published our image to Docker hub:\u003C/span\u003E\n\u003Cdiv class=\"language-bash codehilite\"\u003E\u003Cpre\u003E\u003Cspan\u003E\u003C/span\u003E\u003Ccode\u003Edocker\u003Cspan class=\"w\"\u003E \u003C/span\u003Ebuild\u003Cspan class=\"w\"\u003E \u003C/span\u003E-t\u003Cspan class=\"w\"\u003E \u003C/span\u003Emodel-2025-hairstyle\u003Cspan class=\"w\"\u003E \u003C/span\u003E-f\u003Cspan class=\"w\"\u003E \u003C/span\u003Ehomework.dockerfile\u003Cspan class=\"w\"\u003E \u003C/span\u003E.\ndocker\u003Cspan class=\"w\"\u003E \u003C/span\u003Etag\u003Cspan class=\"w\"\u003E \u003C/span\u003Emodel-2025-hairstyle:latest\u003Cspan class=\"w\"\u003E \u003C/span\u003Eagrigorev/model-2025-hairstyle:v1\ndocker\u003Cspan class=\"w\"\u003E \u003C/span\u003Epush\u003Cspan class=\"w\"\u003E \u003C/span\u003Eagrigorev/model-2025-hairstyle:v1\n\u003C/code\u003E\u003C/pre\u003E\u003C/div\u003E\n\u003Cspan class=\"paragraph\"\u003E(You don't need to execute this code)\u003C/span\u003E\u003C/span\u003E"}, "type": "data"}]}], "metadata": {"marimo_version": "0.18.3"}, "version": "1"},
            "runtimeConfig": null,
        };
    </script>
  
<marimo-code hidden="">
    import%20marimo%0A%0A__generated_with%20%3D%20%220.18.3%22%0Aapp%20%3D%20marimo.App(width%3D%22medium%22)%0A%0A%0A%40app.cell%0Adef%20_()%3A%0A%20%20%20%20import%20marimo%20as%20mo%0A%20%20%20%20import%20onnxruntime%20as%20ort%0A%20%20%20%20import%20numpy%20as%20np%0A%20%20%20%20from%20torchvision%20import%20transforms%0A%20%20%20%20from%20keras_image_helper%20import%20create_preprocessor%0A%20%20%20%20return%20create_preprocessor%2C%20mo%2C%20np%2C%20ort%0A%0A%0A%40app.cell(hide_code%3DTrue)%0Adef%20_(mo)%3A%0A%20%20%20%20mo.md(r%22%22%22%0A%20%20%20%20%23%20Machine%20Learning%20Zoomcamp%0A%0A%20%20%20%20%23%23%20Module%209%3A%20**Deploy%20with%20AWS%20Lambda**%0A%20%20%20%20%22%22%22)%0A%20%20%20%20return%0A%0A%0A%40app.cell(hide_code%3DTrue)%0Adef%20_(mo)%3A%0A%20%20%20%20mo.md(r%22%22%22%0A%20%20%20%20%23%23%20Homework%0A%0A%20%20%20%20In%20this%20homework%2C%20we'll%20deploy%20the%20Straight%20vs%20Curly%20Hair%20Type%20model%20we%20trained%20in%20the%0A%20%20%20%20%5Bprevious%20homework%5D(..%2F08-deep-learning%2Fhomework.md).%0A%0A%20%20%20%20Download%20the%20model%20files%20from%20here%3A%0A%0A%20%20%20%20*%20https%3A%2F%2Fgithub.com%2Falexeygrigorev%2Flarge-datasets%2Freleases%2Fdownload%2Fhairstyle%2Fhair_classifier_v1.onnx.data%0A%20%20%20%20*%20https%3A%2F%2Fgithub.com%2Falexeygrigorev%2Flarge-datasets%2Freleases%2Fdownload%2Fhairstyle%2Fhair_classifier_v1.onnx%0A%0A%20%20%20%20With%20wget%3A%0A%0A%20%20%20%20%60%60%60bash%0A%20%20%20%20PREFIX%3D%22https%3A%2F%2Fgithub.com%2Falexeygrigorev%2Flarge-datasets%2Freleases%2Fdownload%2Fhairstyle%22%0A%20%20%20%20DATA_URL%3D%22%24%7BPREFIX%7D%2Fhair_classifier_v1.onnx.data%22%0A%20%20%20%20MODEL_URL%3D%22%24%7BPREFIX%7D%2Fhair_classifier_v1.onnx%22%0A%20%20%20%20wget%20%24%7BDATA_URL%7D%0A%20%20%20%20wget%20%24%7BMODEL_URL%7D%0A%20%20%20%20%60%60%60%0A%20%20%20%20%22%22%22)%0A%20%20%20%20return%0A%0A%0A%40app.cell(hide_code%3DTrue)%0Adef%20_(mo)%3A%0A%20%20%20%20mo.md(r%22%22%22%0A%20%20%20%20%23%23%20Question%201%0A%0A%20%20%20%20To%20be%20able%20to%20use%20this%20model%2C%20we%20need%20to%20know%20the%20name%20of%20the%20input%20and%20output%20nodes.%0A%0A%20%20%20%20What's%20the%20name%20of%20the%20output%3A%0A%0A%20%20%20%20*%20%60output%60%0A%20%20%20%20*%20%60sigmoid%60%0A%20%20%20%20*%20%60softmax%60%0A%20%20%20%20*%20%60prediction%60%0A%20%20%20%20%22%22%22)%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(ort)%3A%0A%20%20%20%20session%20%3D%20ort.InferenceSession(%22module-9%2Fhomework%2Fhair_classifier_v1.onnx%22)%0A%0A%20%20%20%20input_name%20%3D%20session.get_inputs()%5B0%5D.name%0A%20%20%20%20output_name%20%3D%20session.get_outputs()%5B0%5D.name%0A%0A%20%20%20%20(input_name%2C%20output_name)%0A%20%20%20%20return%20input_name%2C%20output_name%2C%20session%0A%0A%0A%40app.cell(hide_code%3DTrue)%0Adef%20_(mo)%3A%0A%20%20%20%20mo.md(r%22%22%22%0A%20%20%20%20The%20name%20of%20the%20output%20is%20**output**.%0A%20%20%20%20%22%22%22)%0A%20%20%20%20return%0A%0A%0A%40app.cell(hide_code%3DTrue)%0Adef%20_(mo)%3A%0A%20%20%20%20mo.md(r%22%22%22%0A%20%20%20%20%23%23%20Preparing%20the%20image%0A%0A%20%20%20%20You'll%20need%20some%20code%20for%20downloading%20and%20resizing%20images.%20You%20can%20use%0A%20%20%20%20this%20code%3A%0A%20%20%20%20%22%22%22)%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_()%3A%0A%20%20%20%20from%20io%20import%20BytesIO%0A%20%20%20%20from%20urllib%20import%20request%0A%20%20%20%20from%20PIL%20import%20Image%0A%0A%20%20%20%20def%20download_image(url)%3A%0A%20%20%20%20%20%20%20%20with%20request.urlopen(url)%20as%20resp%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20buffer%20%3D%20resp.read()%0A%20%20%20%20%20%20%20%20stream%20%3D%20BytesIO(buffer)%0A%20%20%20%20%20%20%20%20img%20%3D%20Image.open(stream)%0A%20%20%20%20%20%20%20%20return%20img%0A%0A%0A%20%20%20%20def%20prepare_image(img%2C%20target_size)%3A%0A%20%20%20%20%20%20%20%20if%20img.mode%20!%3D%20'RGB'%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20img%20%3D%20img.convert('RGB')%0A%20%20%20%20%20%20%20%20img%20%3D%20img.resize(target_size%2C%20Image.NEAREST)%0A%20%20%20%20%20%20%20%20return%20img%0A%20%20%20%20return%20download_image%2C%20prepare_image%0A%0A%0A%40app.cell(hide_code%3DTrue)%0Adef%20_(mo)%3A%0A%20%20%20%20mo.md(r%22%22%22%0A%20%20%20%20%23%23%20Question%202%3A%20Target%20size%0A%0A%20%20%20%20Let's%20download%20and%20resize%20this%20image%3A%0A%0A%20%20%20%20https%3A%2F%2Fhabrastorage.org%2Fwebt%2Fyf%2F_d%2Fok%2Fyf_dokzqy3vcritme8ggnzqlvwa.jpeg%0A%0A%20%20%20%20Based%20on%20the%20previous%20homework%2C%20what%20should%20be%20the%20target%20size%20for%20the%20image%3F%0A%0A%20%20%20%20*%2064x64%0A%20%20%20%20*%20128x128%0A%20%20%20%20*%20200x200%0A%20%20%20%20*%20256x256%0A%20%20%20%20%22%22%22)%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(download_image%2C%20prepare_image)%3A%0A%20%20%20%20image%20%3D%20download_image(%22https%3A%2F%2Fhabrastorage.org%2Fwebt%2Fyf%2F_d%2Fok%2Fyf_dokzqy3vcritme8ggnzqlvwa.jpeg%22)%0A%20%20%20%20prepared_image%20%3D%20prepare_image(image%2C%20(200%2C%20200))%0A%20%20%20%20return%0A%0A%0A%40app.cell(hide_code%3DTrue)%0Adef%20_(mo)%3A%0A%20%20%20%20mo.md(r%22%22%22%0A%20%20%20%20The%20target%20size%20for%20the%20image%20is%20**200x200**.%0A%20%20%20%20%22%22%22)%0A%20%20%20%20return%0A%0A%0A%40app.cell(hide_code%3DTrue)%0Adef%20_(mo)%3A%0A%20%20%20%20mo.md(r%22%22%22%0A%20%20%20%20%23%23%20Question%203%0A%0A%20%20%20%20Now%20we%20need%20to%20turn%20the%20image%20into%20numpy%20array%20and%20pre-process%20it.%0A%0A%20%20%20%20%3E%20Tip%3A%20Check%20the%20previous%20homework.%20What%20was%20the%20pre-processing%0A%20%20%20%20%3E%20we%20did%20there%3F%0A%0A%20%20%20%20After%20the%20pre-processing%2C%20what's%20the%20value%20in%20the%20first%20pixel%2C%20the%20R%20channel%3F%0A%0A%20%20%20%20*%20-10.73%0A%20%20%20%20*%20-1.073%0A%20%20%20%20*%201.073%0A%20%20%20%20*%2010.73%0A%20%20%20%20%22%22%22)%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(create_preprocessor%2C%20np)%3A%0A%20%20%20%20def%20preprocess_pytorch(X)%3A%0A%20%20%20%20%20%20%20%20%23%20X%3A%20shape%20(1%2C%20299%2C%20299%2C%203)%2C%20dtype%3Dfloat32%2C%20values%20in%20%5B0%2C%20255%5D%0A%20%20%20%20%20%20%20%20X%20%3D%20X%20%2F%20255.0%0A%0A%20%20%20%20%20%20%20%20mean%20%3D%20np.array(%5B0.485%2C%200.456%2C%200.406%5D).reshape(1%2C%203%2C%201%2C%201)%0A%20%20%20%20%20%20%20%20std%20%3D%20np.array(%5B0.229%2C%200.224%2C%200.225%5D).reshape(1%2C%203%2C%201%2C%201)%0A%0A%20%20%20%20%20%20%20%20%23%20Convert%20NHWC%20%E2%86%92%20NCHW%0A%20%20%20%20%20%20%20%20%23%20from%20(batch%2C%20height%2C%20width%2C%20channels)%20%E2%86%92%20(batch%2C%20channels%2C%20height%2C%20width)%0A%20%20%20%20%20%20%20%20X%20%3D%20X.transpose(0%2C%203%2C%201%2C%202)%0A%0A%20%20%20%20%20%20%20%20%23%20Normalize%0A%20%20%20%20%20%20%20%20X%20%3D%20(X%20-%20mean)%20%2F%20std%0A%0A%20%20%20%20%20%20%20%20return%20X.astype(np.float32)%0A%0A%0A%20%20%20%20preprocessor%20%3D%20create_preprocessor(preprocess_pytorch%2C%20target_size%3D(200%2C%20200))%0A%0A%20%20%20%20X%20%3D%20preprocessor.from_url(%22https%3A%2F%2Fhabrastorage.org%2Fwebt%2Fyf%2F_d%2Fok%2Fyf_dokzqy3vcritme8ggnzqlvwa.jpeg%22)%0A%20%20%20%20X%5B0%5D%5B0%5D%5B0%5D%5B0%5D%0A%20%20%20%20return%20(preprocessor%2C)%0A%0A%0A%40app.cell(hide_code%3DTrue)%0Adef%20_(mo)%3A%0A%20%20%20%20mo.md(r%22%22%22%0A%20%20%20%20The%20value%20of%20the%20R%20channel%20of%20the%20firs%20pixel%20is%20**-1.073**.%0A%20%20%20%20%22%22%22)%0A%20%20%20%20return%0A%0A%0A%40app.cell(hide_code%3DTrue)%0Adef%20_(mo)%3A%0A%20%20%20%20mo.md(r%22%22%22%0A%20%20%20%20%23%23%20Question%204%0A%0A%20%20%20%20Now%20let's%20apply%20this%20model%20to%20this%20image.%20What's%20the%20output%20of%20the%20model%3F%0A%0A%20%20%20%20*%200.09%0A%20%20%20%20*%200.49%0A%20%20%20%20*%200.69%0A%20%20%20%20*%200.89%0A%20%20%20%20%22%22%22)%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(input_name%2C%20output_name%2C%20preprocessor%2C%20session)%3A%0A%20%20%20%20classes%20%3D%20%5B%0A%20%20%20%20%20%20%20%20'dress'%2C%0A%20%20%20%20%20%20%20%20'hat'%2C%0A%20%20%20%20%20%20%20%20'longsleeve'%2C%0A%20%20%20%20%20%20%20%20'outwear'%2C%0A%20%20%20%20%20%20%20%20'pants'%2C%0A%20%20%20%20%20%20%20%20'shirt'%2C%0A%20%20%20%20%20%20%20%20'shoes'%2C%0A%20%20%20%20%20%20%20%20'shorts'%2C%0A%20%20%20%20%20%20%20%20'skirt'%2C%0A%20%20%20%20%20%20%20%20't-shirt'%0A%20%20%20%20%5D%0A%0A%20%20%20%20def%20predict(url)%3A%0A%20%20%20%20%20%20%20%20X%20%3D%20preprocessor.from_url(url)%0A%20%20%20%20%20%20%20%20result%20%3D%20session.run(%5Boutput_name%5D%2C%20%7Binput_name%3A%20X%7D)%0A%20%20%20%20%20%20%20%20float_predictions%20%3D%20result%5B0%5D%5B0%5D.tolist()%0A%20%20%20%20%20%20%20%20return%20dict(zip(classes%2C%20float_predictions))%0A%0A%20%20%20%20predict(%22https%3A%2F%2Fhabrastorage.org%2Fwebt%2Fyf%2F_d%2Fok%2Fyf_dokzqy3vcritme8ggnzqlvwa.jpeg%22)%0A%20%20%20%20return%0A%0A%0A%40app.cell(hide_code%3DTrue)%0Adef%20_(mo)%3A%0A%20%20%20%20mo.md(r%22%22%22%0A%20%20%20%20%23%23%20Prepare%20the%20lambda%20code%0A%0A%20%20%20%20Now%20you%20need%20to%20copy%20all%20the%20code%20into%20a%20separate%20python%20file.%20You%20will%0A%20%20%20%20need%20to%20use%20this%20file%20for%20the%20next%20two%20questions.%0A%0A%20%20%20%20Tip%3A%20you%20can%20test%20this%20file%20locally%20with%20%60ipython%60%20or%20Jupyter%20Notebook%0A%20%20%20%20by%20importing%20the%20file%20and%20invoking%20the%20function%20from%20this%20file.%0A%0A%0A%20%20%20%20%23%23%20Docker%0A%0A%20%20%20%20For%20the%20next%20two%20questions%2C%20we'll%20use%20a%20Docker%20image%20that%20we%20already%0A%20%20%20%20prepared.%20This%20is%20the%20Dockerfile%20that%20we%20used%20for%20creating%20the%20image%3A%0A%0A%20%20%20%20%60%60%60docker%0A%20%20%20%20FROM%20public.ecr.aws%2Flambda%2Fpython%3A3.13%0A%0A%20%20%20%20COPY%20hair_classifier_empty.onnx.data%20.%0A%20%20%20%20COPY%20hair_classifier_empty.onnx%20.%0A%20%20%20%20%60%60%60%0A%0A%20%20%20%20Note%20that%20it%20uses%20Python%203.13.%0A%0A%20%20%20%20The%20docker%20image%20is%20published%20to%20%5B%60agrigorev%2Fmodel-2025-hairstyle%3Av1%60%5D(https%3A%2F%2Fhub.docker.com%2Fr%2Fagrigorev%2Fmodel-2025-hairstyle).%0A%0A%20%20%20%20A%20few%20notes%3A%0A%0A%20%20%20%20*%20The%20image%20already%20contains%20a%20model%20and%20it's%20not%20the%20same%20model%0A%20%20%20%20%20%20as%20the%20one%20we%20used%20for%20questions%201-4.%0A%20%20%20%20%22%22%22)%0A%20%20%20%20return%0A%0A%0A%40app.cell(hide_code%3DTrue)%0Adef%20_(mo)%3A%0A%20%20%20%20mo.md(r%22%22%22%0A%20%20%20%20%23%23%20Question%205%0A%0A%20%20%20%20Download%20the%20base%20image%20%60agrigorev%2Fmodel-2025-hairstyle%3Av1%60.%20You%20can%20do%20it%20with%20%5B%60docker%20pull%60%5D(https%3A%2F%2Fdocs.docker.com%2Fengine%2Freference%2Fcommandline%2Fpull%2F).%0A%0A%20%20%20%20So%20what's%20the%20size%20of%20this%20base%20image%3F%0A%0A%20%20%20%20*%2088%20Mb%0A%20%20%20%20*%20208%20Mb%0A%20%20%20%20*%20608%20Mb%0A%20%20%20%20*%201208%20Mb%0A%0A%20%20%20%20You%20can%20get%20this%20information%20when%20running%20%60docker%20images%60%20-%20it'll%20be%20in%20the%20%22SIZE%22%20column.%0A%20%20%20%20%22%22%22)%0A%20%20%20%20return%0A%0A%0A%40app.cell(hide_code%3DTrue)%0Adef%20_(mo)%3A%0A%20%20%20%20mo.md(r%22%22%22%0A%20%20%20%20%60%60%60bash%0A%20%20%20%20docker%20pull%20agrigorev%2Fmodel-2025-hairstyle%3Av1%0A%20%20%20%20docker%20image%20ls%20%7C%20grep%20agrigorev%2Fmodel-2025-hairstyle%0A%20%20%20%20%60%60%60%0A%0A%20%20%20%20%3E%20agrigorev%2Fmodel-2025-hairstyle%20-%20v1%20-%204528ad1525d5%20-%206%20days%20ago%20-%20608MB%0A%20%20%20%20%22%22%22)%0A%20%20%20%20return%0A%0A%0A%40app.cell(hide_code%3DTrue)%0Adef%20_(mo)%3A%0A%20%20%20%20mo.md(r%22%22%22%0A%20%20%20%20The%20size%20of%20the%20downloaded%20image%20is%20**608%20Mb**.%0A%20%20%20%20%22%22%22)%0A%20%20%20%20return%0A%0A%0A%40app.cell(hide_code%3DTrue)%0Adef%20_(mo)%3A%0A%20%20%20%20mo.md(r%22%22%22%0A%20%20%20%20%23%23%20Question%206%0A%0A%20%20%20%20Now%20let's%20extend%20this%20docker%20image%2C%20install%20all%20the%20required%20libraries%0A%20%20%20%20and%20add%20the%20code%20for%20lambda.%0A%0A%20%20%20%20You%20don't%20need%20to%20include%20the%20model%20in%20the%20image.%20It's%20already%20included.%0A%20%20%20%20The%20name%20of%20the%20file%20with%20the%20model%20is%20%60hair_classifier_empty.onnx%60%20and%20it's%0A%20%20%20%20in%20the%20current%20workdir%20in%20the%20image%20(see%20the%20Dockerfile%20above%20for%20the%0A%20%20%20%20reference).%0A%20%20%20%20The%20provided%20model%20requires%20the%20same%20preprocessing%20for%20images%20regarding%20target%20size%20and%20rescaling%20the%20value%20range%20than%20used%20in%20homework%208.%0A%0A%20%20%20%20Now%20run%20the%20container%20locally.%0A%0A%20%20%20%20Score%20this%20image%3A%20https%3A%2F%2Fhabrastorage.org%2Fwebt%2Fyf%2F_d%2Fok%2Fyf_dokzqy3vcritme8ggnzqlvwa.jpeg%0A%0A%20%20%20%20What's%20the%20output%20from%20the%20model%3F%0A%0A%20%20%20%20*%20-1.0%0A%20%20%20%20*%20-0.10%0A%20%20%20%20*%200.10%0A%20%20%20%20*%201.0%0A%20%20%20%20%22%22%22)%0A%20%20%20%20return%0A%0A%0A%40app.cell(hide_code%3DTrue)%0Adef%20_(mo)%3A%0A%20%20%20%20mo.md(r%22%22%22%0A%20%20%20%20The%20result%20is%200.09%20which%20is%20almost%20**0.10**.%0A%20%20%20%20%22%22%22)%0A%20%20%20%20return%0A%0A%0A%40app.cell(hide_code%3DTrue)%0Adef%20_(mo)%3A%0A%20%20%20%20mo.md(r%22%22%22%0A%20%20%20%20%23%23%20Publishing%20it%20to%20AWS%0A%0A%20%20%20%20Now%20you%20can%20deploy%20your%20model%20to%20AWS!%0A%0A%20%20%20%20*%20Publish%20your%20image%20to%20ECR%0A%20%20%20%20*%20Create%20a%20lambda%20function%20in%20AWS%2C%20use%20the%20ECR%20image%0A%20%20%20%20*%20Give%20it%20more%20RAM%20and%20increase%20the%20timeout%0A%20%20%20%20*%20Test%20it%0A%20%20%20%20*%20Expose%20the%20lambda%20function%20using%20API%20Gateway%0A%0A%20%20%20%20This%20is%20optional%20and%20not%20graded.%0A%0A%0A%20%20%20%20%23%23%20Submit%20the%20results%0A%0A%20%20%20%20*%20Submit%20your%20results%20here%3A%20https%3A%2F%2Fcourses.datatalks.club%2Fml-zoomcamp-2025%2Fhomework%2Fhw09%0A%20%20%20%20*%20If%20your%20answer%20doesn't%20match%20options%20exactly%2C%20select%20the%20closest%20one.%20If%20the%20answer%20is%20exactly%20in%20between%20two%20options%2C%20select%20the%20higher%20value.%0A%0A%20%20%20%20%23%23%20Publishing%20to%20Docker%20hub%0A%0A%20%20%20%20Just%20for%20the%20reference%2C%20this%20is%20how%20we%20published%20our%20image%20to%20Docker%20hub%3A%0A%0A%20%20%20%20%60%60%60bash%0A%20%20%20%20docker%20build%20-t%20model-2025-hairstyle%20-f%20homework.dockerfile%20.%0A%20%20%20%20docker%20tag%20model-2025-hairstyle%3Alatest%20agrigorev%2Fmodel-2025-hairstyle%3Av1%0A%20%20%20%20docker%20push%20agrigorev%2Fmodel-2025-hairstyle%3Av1%0A%20%20%20%20%60%60%60%0A%0A%20%20%20%20(You%20don't%20need%20to%20execute%20this%20code)%0A%20%20%20%20%22%22%22)%0A%20%20%20%20return%0A%0A%0Aif%20__name__%20%3D%3D%20%22__main__%22%3A%0A%20%20%20%20app.run()%0A
</marimo-code>

<marimo-code-hash hidden="">2c963bcca04083647c62effe99506ba8</marimo-code-hash>
</body>
</html>
