<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <link rel="icon" crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.16.0/dist/favicon.ico" />
    <!-- Preload is necessary because we show these images when we disconnect from the server,
    but at that point we cannot load these images from the server -->
    <link rel="preload" crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.16.0/dist/assets/gradient-yHQUC_QB.png" as="image" />
    <link rel="preload" crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.16.0/dist/assets/noise-60BoTA8O.png" as="image" />
    <!-- Preload the fonts -->
    <link rel="preload" crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.16.0/dist/assets/Lora-VariableFont_wght-B2ootaw-.ttf" as="font" crossorigin="anonymous" />
    <link rel="preload" crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.16.0/dist/assets/PTSans-Regular-CxL0S8W7.ttf" as="font" crossorigin="anonymous" />
    <link rel="preload" crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.16.0/dist/assets/PTSans-Bold-D9fedIX3.ttf" as="font" crossorigin="anonymous" />
    <link rel="preload" crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.16.0/dist/assets/FiraMono-Regular-BTCkDNvf.ttf" as="font" crossorigin="anonymous" />
    <link rel="preload" crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.16.0/dist/assets/FiraMono-Medium-DU3aDxX5.ttf" as="font" crossorigin="anonymous" />
    <link rel="preload" crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.16.0/dist/assets/FiraMono-Bold-CLVRCuM9.ttf" as="font" crossorigin="anonymous" />

    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="theme-color" content="#000000" />
    <meta name="description" content="a marimo app" />
    <link rel="apple-touch-icon" crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.16.0/dist/apple-touch-icon.png" />
    <link rel="manifest" crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.16.0/dist/manifest.json" />

    <script data-marimo="true">
      function __resizeIframe(obj) {
        var scrollbarHeight = 20; // Max between windows, mac, and linux

        function setHeight() {
          var element = obj.contentWindow.document.documentElement;
          // If there is no vertical scrollbar, we don't need to resize the iframe
          if (element.scrollHeight === element.clientHeight) {
            return;
          }

          // Create a new height that includes the scrollbar height if it's visible
          var hasHorizontalScrollbar = element.scrollWidth > element.clientWidth;
          var newHeight = element.scrollHeight + (hasHorizontalScrollbar ? scrollbarHeight : 0);

          // Only update the height if it's different from the current height
          if (obj.style.height !== `${newHeight}px`) {
            obj.style.height = `${newHeight}px`;
          }
        }

        // Resize the iframe to the height of the content and bottom scrollbar height
        setHeight();

        // Resize the iframe when the content changes
        const resizeObserver = new ResizeObserver((entries) => {
          setHeight();
        });
        resizeObserver.observe(obj.contentWindow.document.body);
      }
    </script>
    <marimo-filename hidden>notes.py</marimo-filename>
    <!-- TODO(Trevor): Legacy, required by VS Code plugin. Remove when plugin is updated (see marimo/server/_templates/template.py) -->
    <marimo-version data-version="{{ version }}" hidden></marimo-version>
    <marimo-user-config data-config="{{ user_config }}" hidden></marimo-user-config>
    <marimo-server-token data-token="{{ server_token }}" hidden></marimo-server-token>
    <!-- /TODO -->
    <title>notes</title>
    <script type="module" crossorigin crossorigin="anonymous" src="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.16.0/dist/assets/index-DKEudB02.js"></script>
    <link rel="stylesheet" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.16.0/dist/assets/index-Cx0bsY1w.css">
  
<script data-marimo="true">
    window.__MARIMO_STATIC__ = {};
    window.__MARIMO_STATIC__.files = {};
</script>
</head>
  <body>
    <div id="root"></div>
    <!-- This is a portal for the data editor to render in -->
    <div id="portal" data-testid="glide-portal" style="position: fixed; left: 0; top: 0; z-index: 9999"></div>
    <script data-marimo="true">
      window.__MARIMO_MOUNT_CONFIG__ = {
            "filename": "notes.py",
            "mode": "read",
            "version": "0.16.0",
            "serverToken": "static",
            "config": {"ai": {"models": {"custom_models": [], "displayed_models": []}}, "completion": {"activate_on_typing": true, "copilot": false}, "display": {"cell_output": "above", "code_editor_font_size": 14, "dataframes": "rich", "default_table_max_columns": 50, "default_table_page_size": 10, "default_width": "medium", "reference_highlighting": false, "theme": "light"}, "formatting": {"line_length": 79}, "keymap": {"overrides": {}, "preset": "default"}, "language_servers": {"pylsp": {"enable_flake8": false, "enable_mypy": true, "enable_pydocstyle": false, "enable_pyflakes": false, "enable_pylint": false, "enable_ruff": true, "enabled": true}}, "package_management": {"manager": "pip"}, "runtime": {"auto_instantiate": true, "auto_reload": "off", "default_sql_output": "auto", "on_cell_change": "autorun", "output_max_bytes": 8000000, "reactive_tests": true, "std_stream_max_bytes": 1000000, "watcher_on_save": "lazy"}, "save": {"autosave": "after_delay", "autosave_delay": 1000, "format_on_save": false}, "server": {"browser": "default", "follow_symlink": false}, "snippets": {"custom_paths": [], "include_default_snippets": true}},
            "configOverrides": {},
            "appConfig": {"sql_output": "auto", "width": "medium"},
            "view": {"showAppCode": true},
            "notebook": {"cells": [{"code": "import marimo as mo\nimport pandas as pd\nimport numpy as np\nimport matplotlib.pyplot as plt\nimport seaborn as sns", "code_hash": "e76e8dbe4d9bf74eff98fef5f002130b", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "Hbol", "name": "_"}, {"code": "mo.md(\n    r\"\"\"\n# Machine Learning Zoomcamp\n\n## Module 2: **Regression**\n\"\"\"\n)", "code_hash": "304898c62508f9a8d777ca964d688cd0", "config": {"column": null, "disabled": false, "hide_code": true}, "id": "MJUe", "name": "_"}, {"code": "repository_root = \"https://github.com/DataTalksClub/machine-learning-zoomcamp/blob/master/\"\n\nchapters = pd.DataFrame([\n    {\n        \"title\": \"Car price prediction project\",\n        \"youtube_id\": \"vM3SqPNlStE\",\n        \"contents\": repository_root+\"02-regression/01-car-price-intro.md\"\n    },\n    {\n        \"title\": \"Data preparation\",\n        \"youtube_id\": \"Kd74oR4QWGM\",\n        \"contents\": repository_root+\"02-regression/02-data-preparation.md\"\n    },\n    {\n        \"title\": \"Exploratory data analysis\",\n        \"youtube_id\": \"k6k8sQ0GhPM\",\n        \"contents\": repository_root+\"02-regression/03-eda.md\"\n    },\n    {\n        \"title\": \"Setting up the validation framework\",\n        \"youtube_id\": \"ck0IfiPaQi0\",\n        \"contents\": repository_root+\"02-regression/04-validation-framework.md\"\n    },\n    {\n        \"title\": \"Linear regression\",\n        \"youtube_id\": \"Dn1eTQLsOdA\",\n        \"contents\": repository_root+\"02-regression/05-linear-regression-simple.md\"\n    },\n    {\n        \"title\": \"Linear regression: vector form\",\n        \"youtube_id\": \"YkyevnYyAww\",\n        \"contents\": repository_root+\"02-regression/06-linear-regression-vector.md\"\n    },\n    {\n        \"title\": \"Training linear regression: Normal equation\",\n        \"youtube_id\": \"hx6nak-Y11g\",\n        \"contents\": repository_root+\"02-regression/07-linear-regression-training.md\"\n    },\n    {\n        \"title\": \"Baseline model for car price prediction project\",\n        \"youtube_id\": \"SvPpMMYtYbU\",\n        \"contents\": repository_root+\"02-regression/08-baseline-model.md\"\n    },\n    {\n        \"title\": \"Root mean squared error\",\n        \"youtube_id\": \"0LWoFtbzNUM\",\n        \"contents\": repository_root+\"02-regression/09-rmse.md\"\n    },\n    {\n        \"title\": \"Using RMSE on validation data\",\n        \"youtube_id\": \"rawGPXg2ofE\",\n        \"contents\": repository_root+\"02-regression/10-car-price-validation.md\"\n    },\n    {\n        \"title\": \"Feature engineering\",\n        \"youtube_id\": \"-aEShw4ftB0\",\n        \"contents\": repository_root+\"02-regression/11-feature-engineering.md\"\n    },\n    {\n        \"title\": \"Categorical variables\",\n        \"youtube_id\": \"sGLAToAAMa4\",\n        \"contents\": repository_root+\"02-regression/12-categorical-variables.md\"\n    },\n    {\n        \"title\": \"Regularization\",\n        \"youtube_id\": \"91ve3EJlHBc\",\n        \"contents\": repository_root+\"02-regression/13-regularization.md\"\n    },\n    {\n        \"title\": \"Tuning the model\",\n        \"youtube_id\": \"lW-YVxPgzQw\",\n        \"contents\": repository_root+\"02-regression/14-tuning-model.md\"\n    },\n    {\n        \"title\": \"Using the model\",\n        \"youtube_id\": \"KT--uIJozes\",\n        \"contents\": repository_root+\"02-regression/15-using-model.md\"\n    },\n    {\n        \"title\": \"Car price prediction project summary\",\n        \"youtube_id\": \"_qI01YXbyro\",\n        \"contents\": repository_root+\"02-regression/16-summary.md\"\n    },\n    {\n        \"title\": \"Explore more\",\n        \"youtube_id\": None,\n        \"contents\": repository_root+\"02-regression/17-explore-more.md\"\n    },\n    {\n        \"title\": \"Homework\",\n        \"youtube_id\": None,\n        \"contents\": repository_root+\"02-regression/homework.md\"\n    },\n])\n\nchapters.insert(loc=0, column=\"snapshot\", value=\"https://img.youtube.com/vi/\"+chapters.youtube_id.astype(str)+\"/hqdefault.jpg\")\nchapters.insert(loc=2, column=\"youtube\", value=\"https://youtube.com/watch?v=\"+chapters.youtube_id.astype(str))\n\nvideos = chapters[chapters[\"youtube_id\"].notnull()]\nvideos[[\"snapshot\", \"title\", \"youtube\"]]", "code_hash": "25f3c92bce16c0138038289fdce73fb4", "config": {"column": null, "disabled": false, "hide_code": true}, "id": "vblA", "name": "_"}, {"code": "contents = chapters[chapters[\"contents\"].notnull()]\ncontents[[\"title\", \"contents\"]]", "code_hash": "1d3036664588742ca99aa99004e53a08", "config": {"column": null, "disabled": false, "hide_code": true}, "id": "bkHC", "name": "_"}, {"code": "mo.md(\n    r\"\"\"\n## Car Price Prediction Project\n\nIn this chapter we'll be working with the [Car Features and MSRP](https://www.kaggle.com/datasets/CooperUnion/cardataset) Kaggle dataset.\n\n1. Prepare the data and do some Exploratory Data Analysis (EDA)\n2. Use linear regression for predicting price\n3. Understand the internals of linear regression\n4. Evaluate the model using Root Mean Square Error (RMSE)\n5. Do some feature engineering\n6. Regualization\n7. Use the model\n\"\"\"\n)", "code_hash": "7f18baf3bbb896c2170c30755b24a4c7", "config": {"column": null, "disabled": false, "hide_code": true}, "id": "lEQa", "name": "_"}, {"code": "mo.md(\n    r\"\"\"\n## Data Preparation\n\nTo facilitate the analysis, the CSV file has been already downloaded in **data/car-prices.csv**.\n\"\"\"\n)", "code_hash": "f87f1759f940957899367de416ae20b4", "config": {"column": null, "disabled": false, "hide_code": true}, "id": "PKri", "name": "_"}, {"code": "car_prices = pd.read_csv('./module-2/data/car-prices.csv')\ncar_prices.head()", "code_hash": "bb8aa8849a1ed64f21ea7d7a75892bb9", "config": {"column": null, "disabled": false, "hide_code": true}, "id": "Xref", "name": "_"}, {"code": "mo.md(\n    r\"\"\"\n### Standardize Column Names\n\nSome of the columns are named using spaces as separator and other columns were named using underscores as a separator. We'll now standardize their names.\n\"\"\"\n)", "code_hash": "912f15b11e5c98313ec0ab3ddf6e71ca", "config": {"column": null, "disabled": false, "hide_code": true}, "id": "SFPL", "name": "_"}, {"code": "car_prices.columns = car_prices.columns.str.lower().str.replace(' ', '_')\ncar_prices.head()", "code_hash": "0faac80606581212927fe85dc0064f69", "config": {"column": null, "disabled": false, "hide_code": true}, "id": "BYtC", "name": "_"}, {"code": "mo.md(\n    r\"\"\"\n### Standardize Values\n\nFirst we'll get the list of all string columns.\n\"\"\"\n)", "code_hash": "a8fd1747efc75f553a8fbbc6ec5e0ec6", "config": {"column": null, "disabled": false, "hide_code": true}, "id": "RGSE", "name": "_"}, {"code": "def get_string_columns(df):\n    return list(df.dtypes[df.dtypes == 'object'].index)\n\nget_string_columns(car_prices)", "code_hash": "7e5cb5914b82201ad6147702f2d6e925", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "Kclp", "name": "_"}, {"code": "for string_column in get_string_columns(car_prices):\n    car_prices[string_column] = car_prices[string_column].str.lower().str.replace(' ', '_')\n\ncar_prices.head()", "code_hash": "e5aa13818bc96529aa060e851dbd42e4", "config": {"column": null, "disabled": false, "hide_code": true}, "id": "emfo", "name": "_"}, {"code": "mo.md(\n    r\"\"\"\n## Exploratory Data Analysis\n\n### Check Unique Values per Column\n\"\"\"\n)", "code_hash": "6d5010ff652e368df7b670074d9c0d3f", "config": {"column": null, "disabled": false, "hide_code": true}, "id": "Hstk", "name": "_"}, {"code": "def show_unique_values(df):\n    unique_values = {}\n\n    for described_column in df.columns:\n        unique_values[described_column] = {\n            \"sample\": df[described_column].unique()[:5],\n            \"count\": df[described_column].nunique()\n        }\n\n    return unique_values\n\nshow_unique_values(car_prices)", "code_hash": "3d7d45e2e7753cd159b869850470e0b8", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "nWHF", "name": "_"}, {"code": "mo.md(\n    r\"\"\"\n### Check the Price Column\n\nA tiny number of cars with a very high price is ruining our plot.\n\"\"\"\n)", "code_hash": "9ee48e97a45745667c20e61ca1179d8f", "config": {"column": null, "disabled": false, "hide_code": true}, "id": "iLit", "name": "_"}, {"code": "sns.histplot(car_prices.msrp, bins=100)", "code_hash": "e2060c13af97e5753962d9599ef97dcf", "config": {"column": null, "disabled": false, "hide_code": true}, "id": "ZHCJ", "name": "_"}, {"code": "mo.md(r\"\"\"We could filter them to get a better view but that implies making a choice on where to cut. Which could confuse our model.\"\"\")", "code_hash": "17b063052123f6191e5e0454a99d37dc", "config": {"column": null, "disabled": false, "hide_code": true}, "id": "ROlb", "name": "_"}, {"code": "sns.histplot(car_prices.msrp[car_prices.msrp < 100000], bins=100)", "code_hash": "5c0989b50daa5e2a46fe7793965fea12", "config": {"column": null, "disabled": false, "hide_code": true}, "id": "qnkX", "name": "_"}, {"code": "mo.md(r\"\"\"Instead of making a manual cut, we can take the logarithm of the price. By doing so, outlier (few cases with extreme values) are handled in a more elegant way.\"\"\")", "code_hash": "be67f77fe9c3fa8ad3526d8063a8ee15", "config": {"column": null, "disabled": false, "hide_code": true}, "id": "TqIu", "name": "_"}, {"code": "def plot_price_logs(df):\n    price_logs = np.log1p(df.msrp)\n    sns.histplot(price_logs, bins=100)\n\nplot_price_logs(car_prices)", "code_hash": "a55d17f9c98a1c349fab1859be71d865", "config": {"column": null, "disabled": false, "hide_code": true}, "id": "Vxnm", "name": "_"}, {"code": "mo.md(r\"\"\"### Check for Empty Values\"\"\")", "code_hash": "12e115f873256e9ac70b276ab54a7fb8", "config": {"column": null, "disabled": false, "hide_code": true}, "id": "DnEU", "name": "_"}, {"code": "car_prices.isna().sum()[car_prices.isna().any()]", "code_hash": "98a16a9e0c880538c9ada89c6454fce4", "config": {"column": null, "disabled": false, "hide_code": true}, "id": "ulZA", "name": "_"}, {"code": "mo.md(\n    r\"\"\"\n## Setting Up the Validation Framework\n\nWe want to define our feature matrix $X$ and a target variable $y$ and then separate it into our train $X_T$ and $y_T$, validation $X_V$ and $y_V$ and test $X_{test}$ and $t_{test}$ splits.\n\"\"\"\n)", "code_hash": "6f7863f60f4242290a612a5868b6ab9a", "config": {"column": null, "disabled": false, "hide_code": true}, "id": "ecfG", "name": "_"}, {"code": "n = len(car_prices)\nn_val = n_test = int(len(car_prices) * 0.2)\nn_train = len(car_prices) - n_val - n_test\n\n{\"n\": n, \"n_train\": n_train, \"n_val\": n_val, \"n_test\": n_test}", "code_hash": "2ba50adfb09d4f0f4aee0d9cdfdb5920", "config": {"column": null, "disabled": false, "hide_code": true}, "id": "Pvdt", "name": "_"}, {"code": "mo.md(\n    r\"\"\"\nTo avoid spliting the records in the same order they have in the dataset (so that we don't get oddly distributed splits), we'll make a randomized selection.\n\nFirst, we create a list with the identifiers of each sample in a random order.\n\"\"\"\n)", "code_hash": "b668d11b586a25b29b96ea8c0eeddc9f", "config": {"column": null, "disabled": false, "hide_code": true}, "id": "ZBYS", "name": "_"}, {"code": "np.random.seed(2)\nshuffled_indexes = np.arange(n)\nnp.random.shuffle(shuffled_indexes)\n\nshuffled_indexes", "code_hash": "1162fe1261f3c31c6941a28f39ceaed2", "config": {"column": null, "disabled": false, "hide_code": true}, "id": "aLJB", "name": "_"}, {"code": "mo.md(r\"\"\"Then we use that as our reference for creating our splits.\"\"\")", "code_hash": "ca78992023d68b6b6037cfcf27a75caf", "config": {"column": null, "disabled": false, "hide_code": true}, "id": "nHfw", "name": "_"}, {"code": "car_prices_train = car_prices.iloc[shuffled_indexes[:n_train]]\ncar_prices_val = car_prices.iloc[shuffled_indexes[n_train:n_train+n_val]]\ncar_prices_test = car_prices.iloc[shuffled_indexes[n_train+n_val:]]", "code_hash": "ab6c6ddd159058b2754e78c6becf536a", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "xXTn", "name": "_"}, {"code": "mo.md(r\"\"\"As our index column has now a random order, we'll reset it in each of the splits.\"\"\")", "code_hash": "b93ef907b4c5c9b45b2093e3d1b68179", "config": {"column": null, "disabled": false, "hide_code": true}, "id": "AjVT", "name": "_"}, {"code": "car_prices_train.reset_index(drop=True, inplace=True)\ncar_prices_val.reset_index(drop=True, inplace=True)\ncar_prices_test.reset_index(drop=True, inplace=True)", "code_hash": "c57bdbad94234ab00ab9c9f0644ec92b", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "pHFh", "name": "_"}, {"code": "mo.md(r\"\"\"Now, we'll define our target variables adjusting the price column using the logarithm function described above.\"\"\")", "code_hash": "ee8c7e24901ca0bd0a6874e550648aa5", "config": {"column": null, "disabled": false, "hide_code": true}, "id": "NCOB", "name": "_"}, {"code": "y_train = np.log1p(car_prices_train.msrp.values)\ny_val = np.log1p(car_prices_val.msrp.values)\ny_test = np.log1p(car_prices_test.msrp.values)", "code_hash": "2648c49e5f26de3da6ed28291f14e08f", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "aqbW", "name": "_"}, {"code": "mo.md(r\"\"\"And, finally, we'll define our feature matrices.\"\"\")", "code_hash": "dfc74a3eb558a94b7871b9c172f9e7d3", "config": {"column": null, "disabled": false, "hide_code": true}, "id": "TRpd", "name": "_"}, {"code": "X_train = car_prices_train.fillna(0)\nX_val = car_prices_val.fillna(0)\nX_test = car_prices_test.fillna(0)\n\ndel X_train[\"msrp\"]\ndel X_val[\"msrp\"]\ndel X_test[\"msrp\"]", "code_hash": "14a4e50dc8238c23bc7272223a0329f6", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "TXez", "name": "_"}, {"code": "mo.md(r\"\"\"Finally, let's wrap all this into a funciton.\"\"\")", "code_hash": "8320d3c0f7f925afdf7651740783b968", "config": {"column": null, "disabled": false, "hide_code": true}, "id": "dNNg", "name": "_"}, {"code": "def prepare_split(df):\n    df = df.copy()\n    df.reset_index(drop=True, inplace=True)\n\n    y = np.log1p(df.msrp.values)\n\n    del df[\"msrp\"]\n\n    return df, y\n\ndef split_dataset(df):\n    n = len(df)\n    n_val = n_test = int(len(df) * 0.2)\n    n_train = len(df) - n_val - n_test\n\n    np.random.seed(2)\n    shuffled_indexes = np.arange(n)\n    np.random.shuffle(shuffled_indexes)\n\n    train = prepare_split(df.iloc[shuffled_indexes[:n_train]])\n    val = prepare_split(df.iloc[shuffled_indexes[n_train:n_train+n_val]])\n    test = prepare_split(df.iloc[shuffled_indexes[n_train+n_val:]])\n\n    return train, val, test", "code_hash": "0e21079d0aad3c03356b5360480426a1", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "yCnT", "name": "_"}, {"code": "mo.md(\n    r\"\"\"\n## Linear Regression\n\nWe are trying to compute a $g$ estimator function so that given the features of a car $i$:\n\n\\[\n    x_i = (x_{i1}, x_{i2}, ..., x_{in})\n\\]\n\nOur function evaluated with those features approaches the target price:\n\n\\[\n    g_i(x_{i1}, x_{i2}, ..., x_{in}) \\approx y_i\n\\]\n\"\"\"\n)", "code_hash": "b8f1cd202349ce220f767cea3167aee2", "config": {"column": null, "disabled": false, "hide_code": true}, "id": "wlCL", "name": "_"}, {"code": "def raw_linear_regression(x, w):\n    assert len(x) + 1 == len(w), \"The size of the features vector does not match the size of the weights\"\n\n    y_log = w[0] + np.sum([x[i] * w[i + 1] for i in range(len(x))])\n\n    return np.expm1(y_log).astype(int)", "code_hash": "13d223cf2b57785a92400034102f9d89", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "kqZH", "name": "_"}, {"code": "mo.md(r\"\"\"In order to show how linear regression works, we'll manually compute it for a selection of features: `engine_hp`, `city_mpg` and `popularity` of a randomly selected car.\"\"\")", "code_hash": "7ffc48542270230648e6a25fb56e1bf9", "config": {"column": null, "disabled": false, "hide_code": true}, "id": "wAgl", "name": "_"}, {"code": "def select_car(df, id):\n    return df.iloc[id:id + 1]\n\nrandom_car_id = 10\nselect_car(X_train, random_car_id)", "code_hash": "04c0adf03aa7e8fe1a3c64581e6bf4b6", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "rEll", "name": "_"}, {"code": "def select_features(df):\n    return df[[\"engine_hp\", \"city_mpg\", \"popularity\"]].values\n\nselect_features(X_train)", "code_hash": "afa3fa6758ee321f35264dd566fcbcd2", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "dGlV", "name": "_"}, {"code": "def get_random_car():\n    return select_features(select_car(X_train, random_car_id))\n\nget_random_car()", "code_hash": "7d9eea0727ea3dabb628e2d968abf73f", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "SdmI", "name": "_"}, {"code": "mo.md(r\"\"\"Given the \"randomly\" chosen car, we'll extract the selected features and its corresponding price:\"\"\")", "code_hash": "0450cd0eb43a49cd06091167c2d076ea", "config": {"column": null, "disabled": false, "hide_code": true}, "id": "lgWD", "name": "_"}, {"code": "{\n    \"x\": get_random_car()[0],\n    \"y\": np.expm1(y_train[random_car_id:random_car_id + 1]).astype(int)\n}", "code_hash": "91d16321fa7c6a846c70c82f7da86a68", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "yOPj", "name": "_"}, {"code": "mo.md(r\"\"\"Now we need to define some weights. Typically, we'd be running a process that finds the optimal values but for the moment we'll manually assign them some numbers:\"\"\")", "code_hash": "50db720abf4d6a93df4aa415af366a18", "config": {"column": null, "disabled": false, "hide_code": true}, "id": "fwwy", "name": "_"}, {"code": "raw_linear_regression(get_random_car()[0], [7.5, 0.01, 0.07, 0.003])", "code_hash": "f71cbebd2c7bedb66c5edb6006e3fd78", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "LJZf", "name": "_"}, {"code": "mo.md(\n    r\"\"\"\n## Linear Regression in Vector Form\n\nWe want now to generalize our previous linear regression formula so that it works with any number of features:\n\n\\[\n    g_i(x_i) = w_o + \\sum_{j=1}^n x_{ij} w_j\n\\]\n\nAs the right term of the equation corresponds with a dot product, we can rewrite it in a simplified form:\n\n\\[\n    g_i(x_i) = w_0 + \\bold{w}^T \\bold{x}_i\n\\]\n\"\"\"\n)", "code_hash": "58b88beed45e81cac0d3e46897886aaa", "config": {"column": null, "disabled": false, "hide_code": true}, "id": "urSm", "name": "_"}, {"code": "def vectorial_linear_regression(x, w):\n    assert len(x) + 1 == len(w), \"The size of the features vector does not match the size of the weights\"\n\n    y_log = w[0] + np.dot(x, w[1:])\n\n    return np.expm1(y_log).astype(int)", "code_hash": "81fed55bcffe0f1e0310f6d149148e2e", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "jxvo", "name": "_"}, {"code": "vectorial_linear_regression(get_random_car()[0], [7.5, 0.01, 0.07, 0.003])", "code_hash": "918f7d1d62c39ecc546812208d397fbf", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "mWxS", "name": "_"}, {"code": "mo.md(\n    r\"\"\"\nIf we want, we can simplify our expression even further by defining an extra feature that always equals $1$. By doing so, we'd get $\\bold{w}$ and $\\bold{x}$ vectors with $n+1$ elements:\n\n\\[\n    w = [w_0, w_1, ..., w_n]\n\\]\n\n\\[\n    x_i = [1, x_{i1}, x_{i2}, ..., x_{in}]\n\\]\n\nTherefore, our estimator could be written as:\n\n\\[\n    g_i(x_i) = \\bold{w}^T \\bold{x}_i\n\\]\n\"\"\"\n)", "code_hash": "8f5dea037bfce46f5424d07cb4260bcd", "config": {"column": null, "disabled": false, "hide_code": true}, "id": "CcZR", "name": "_"}, {"code": "def final_linear_regression(x, w):\n    assert len(x) + 1 == len(w), \"The size of the features vector does not match the size of the weights\"\n\n    x = np.concat((np.array([1]), np.array(x)))\n    y_log = np.dot(x, w)\n\n    return np.expm1(y_log).astype(int)", "code_hash": "e8309b7e27fc0c90bf983bf69b274468", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "YWSi", "name": "_"}, {"code": "final_linear_regression(get_random_car()[0], [7.5, 0.01, 0.07, 0.003])", "code_hash": "bd2191e4ea0d293920abe067ee13a2b2", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "zlud", "name": "_"}, {"code": "mo.md(\n    r\"\"\"\nWe can write our $g$ function for all samples as a matrix multiplication.\n\n\\[\n\\bold{y_p} = \n\\begin{bmatrix}\n1 & x_{11} & x_{12} & \\cdots & x_{1n} \\\\\n1 & x_{21} & x_{22} & \\cdots & x_{2n} \\\\\n\\vdots & \\vdots & \\vdots & \\ddots & \\vdots \\\\\n1 & x_{m1} & x_{m2} & \\cdots & x_{mn}\n\\end{bmatrix}\n\\begin{bmatrix}\nw_0 \\\\\nw_1 \\\\\nw_2 \\\\\n\\vdots \\\\\nw_n\n\\end{bmatrix}\n=\n\\begin{bmatrix}\n\\bold{x_1}^T \u00b7 \\bold{w} \\\\\n\\bold{x_2}^T \u00b7 \\bold{w} \\\\\n\\vdots \\\\\n\\bold{x_m}^T \u00b7 \\bold{w} \\\\\n\\end{bmatrix}\n\\]\n\"\"\"\n)", "code_hash": "8b7032d2d2a6e17c2cf786d18acac8ca", "config": {"column": null, "disabled": false, "hide_code": true}, "id": "tZnO", "name": "_"}, {"code": "X_matrix = select_features(X_train.iloc[10:15])\nX_matrix = np.c_[np.ones(X_matrix.shape[0]), X_matrix]\n\nX_matrix", "code_hash": "2a4d75b3ef3613b0783fd3307a4dd124", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "xvXZ", "name": "_"}, {"code": "y_matrix = y_train[10:15]\n\nnp.expm1(y_matrix).astype(int)", "code_hash": "a07074f5d180c282b18b9af0c1e143d8", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "CLip", "name": "_"}, {"code": "w = [7.5, 0.01, 0.07, 0.003]\n\nw", "code_hash": "645076ba5755c55b8f0c550cda88a859", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "YECM", "name": "_"}, {"code": "np.expm1(X_matrix.dot(w)).astype(int)", "code_hash": "b3ee810c904262cfed6e544c3b589f60", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "cEAS", "name": "_"}, {"code": "mo.md(\n    r\"\"\"\n## Training a Linear Regression Model\n\nWe already saw that our $g$ estimator looks like this:\n\n\\[\n    \\bold{X} \\bold{w} \\approx \\bold{y}\n\\]\n\nSo now we have to solve $\\bold{w}$ so that we can find the weights.\n\n\\[\n    \\bold{X}^{-1} \\bold{X} \\bold{w} \\approx \\bold{X}^{-1} \\bold{y}\n\\]\n\nWhat gives us:\n\n\\[\n    \\bold{w} \\approx \\bold{X}^{-1} \\bold{y}\n\\]\n\nBut there is an issue: we are working with a rectangular matrix, not with a squared one. So we won't be able to find its inverse.\n\"\"\"\n)", "code_hash": "86af77028e786426b99141ca20ae84ab", "config": {"column": null, "disabled": false, "hide_code": true}, "id": "iXej", "name": "_"}, {"code": "mo.md(\n    r\"\"\"\n### Gram Matrix\n\nThe first thing we can do to try to solve this is to take into account that $X^T X$ is actually an squared matrix, it may have an inverse.\n\nTherefore, we could start with:\n\n\\[\n    \\bold{X}^{T} \\bold{X} \\bold{w} \\approx \\bold{X}^{T} \\bold{y}\n\\]\n\n... and try to solve it with:\n\n\\[\n    (\\bold{X}^{T} \\bold{X})^{-1} \\bold{X}^{T} \\bold{X} \\bold{w} \\approx (\\bold{X}^{T} \\bold{X})^{-1} \\bold{X}^{T} \\bold{y}\n\\]\n\n... which simplifies to:\n\n\\[\n    \\bold{w} \\approx (\\bold{X}^{T} \\bold{X})^{-1} \\bold{X}^{T} \\bold{y}\n\\]\n\"\"\"\n)", "code_hash": "28635777c953143e667f88de51502b37", "config": {"column": null, "disabled": false, "hide_code": true}, "id": "EJmg", "name": "_"}, {"code": "def solve_linear_regression(X, y):\n    return np.linalg.inv(X.T.dot(X)).dot(X.T).dot(y)\n\nsolve_linear_regression(X_matrix, y_matrix)", "code_hash": "bb334fae3d3c02585c613d74f6eee051", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "UmEG", "name": "_"}, {"code": "def predict_price(X, y):\n    w = solve_linear_regression(X, y)\n    y = X.dot(w)\n    return np.expm1(y).astype(int)\n\npredict_price(X_matrix, y_matrix)", "code_hash": "84eda73bfa847c8e90106de98bbe020a", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "vEBW", "name": "_"}, {"code": "mo.md(\n    r\"\"\"\n## Baseline Model for Car Price Prediction Project\n\nWe'll start by selecting all the numerical features from our train dataset.\n\"\"\"\n)", "code_hash": "07280031bd9f72fdb0f0cd494c0f48e0", "config": {"column": null, "disabled": false, "hide_code": true}, "id": "kLmu", "name": "_"}, {"code": "def naive_prepare_X(X):\n    return X.select_dtypes(include=\"number\").values\n\nnaive_prepare_X(X_train)", "code_hash": "1b5c2882ed7c3bbacdffda4c8186281d", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "IpqN", "name": "_"}, {"code": "y_train", "code_hash": "ca7e660269870d38f480de08536fee93", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "dxZZ", "name": "_"}, {"code": "mo.md(r\"\"\"Now, following the same formula we used in the previous section, we define our training function, which will take the features and target variable and return the corresponding weights.\"\"\")", "code_hash": "0af7e931ba22fc56522c57c5688746e7", "config": {"column": null, "disabled": false, "hide_code": true}, "id": "dlnW", "name": "_"}, {"code": "solve_linear_regression(naive_prepare_X(X_train), y_train)", "code_hash": "fdf6e3f3c72dd5e01e55346d24776cfc", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "TTti", "name": "_"}, {"code": "def naive_predict(X, y):\n    w = solve_linear_regression(naive_prepare_X(X), y)\n    return naive_prepare_X(X).dot(w)\n\nnaive_predict(X_train, y_train)", "code_hash": "4973aeb2216c22f3bcecbee3e9350be7", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "RKFZ", "name": "_"}, {"code": "mo.md(r\"\"\"By plotting at the same time the target variable we used during training and our predictions, we can have a first idea about how good our model is.\"\"\")", "code_hash": "3c45a6c707fb43cff6558885fbe4e7c2", "config": {"column": null, "disabled": false, "hide_code": true}, "id": "IaQp", "name": "_"}, {"code": "sns.histplot(y_train, color=\"blue\")\nsns.histplot(naive_predict(X_train, y_train), color=\"red\", alpha=0.5)", "code_hash": "830afd834e08205c63e64a8db506e00c", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "IWgg", "name": "_"}, {"code": "mo.md(\n    r\"\"\"\n## Root Mean Squared Error\n\nIn order to measure how good our model performs, we'll use `RMSE`, which is a metric that will tell us how good (or bad) our model predicted by checking the average of the squared difference between our predictions`g(x_i)` and the target values `y_i`:\n\n\\[\n    RMSE = \\frac{1}{n} \\sum_{i=0}^n (g(x_i) - y_i)^2\n\\]\n\"\"\"\n)", "code_hash": "54dd5430d7a2e9b018abcfbc88e6d70d", "config": {"column": null, "disabled": false, "hide_code": true}, "id": "fCoF", "name": "_"}, {"code": "def rmse(y_predicted, y_real):\n    n = len(y_real)\n    return (((y_predicted - y_real)**2) / n).sum()", "code_hash": "581e84edbe6a12a0027d415cfa464f2d", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "LkGn", "name": "*rmse"}, {"code": "rmse(\n    naive_predict(X_train, y_train),\n    y_train\n)", "code_hash": "62ed0fb29e2a565c432bcc9dee8e0fe4", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "zVRe", "name": "_"}, {"code": "mo.md(\n    r\"\"\"\n## Using RMSE on Validation Data\n\nIn the previous chapter we used `RMSE` on the same dataset we used to train our model, which isn't what we want. Instead, we want to use the validate split we created already.\n\"\"\"\n)", "code_hash": "ad2c707619d4962e58a8ae1bdf0dbc6a", "config": {"column": null, "disabled": false, "hide_code": true}, "id": "woaO", "name": "_"}, {"code": "naive_predict(X_val, y_val)", "code_hash": "0275a99740e0b1bac2cd7210410999d3", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "HnMC", "name": "_"}, {"code": "rmse(\n    naive_predict(X_val, y_val),\n    y_val\n)", "code_hash": "84b16d4da557ea11848ae5ae9ce7737d", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "wadT", "name": "_"}, {"code": "mo.md(\n    r\"\"\"\n## Feature Engineering\n\nLet's add a feature that computes the age of the cars.\n\"\"\"\n)", "code_hash": "1c17a1cad31eb6de3654f28b6c297d98", "config": {"column": null, "disabled": false, "hide_code": true}, "id": "VCRE", "name": "_"}, {"code": "from datetime import datetime\n\ndef feature_prepare_X(X):\n    X = X.copy()\n    X[\"age\"] = datetime.today().year - X.year\n    return X.select_dtypes(include=\"number\").values", "code_hash": "6590f0869d30389878d81ca441d77f23", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "hgqU", "name": "_"}, {"code": "feature_prepare_X(X_train)", "code_hash": "865d1e1b6eef6b02e8a9839fc752197f", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "PSUk", "name": "_"}, {"code": "mo.md(r\"\"\"Retraining our model we can see how it performs better with the additional feature.\"\"\")", "code_hash": "d78ccea0cc594bf6a5f81a187c8435b9", "config": {"column": null, "disabled": false, "hide_code": true}, "id": "mfOT", "name": "_"}, {"code": "def feature_train_and_predict(X_train, y_train, X_val, y_val):\n    w = solve_linear_regression(feature_prepare_X(X_train), y_train)\n    return feature_prepare_X(X_val).dot(w)", "code_hash": "75e8b22c19685a3359646899af058956", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "vGiW", "name": "_"}, {"code": "rmse(\n    feature_train_and_predict(X_train, y_train, X_val, y_val),\n    y_val\n)", "code_hash": "b968b539defe806a265d4aad0c8b2e4a", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "SYQT", "name": "_"}, {"code": "sns.histplot(y_val, color=\"blue\")\nsns.histplot(feature_train_and_predict(X_train, y_train, X_val, y_val), color=\"red\", alpha=0.5)", "code_hash": "f4a6efbe176c532601f0d633b43e7da7", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "bMrW", "name": "_"}, {"code": "mo.md(r\"\"\"## Categorical Variables\"\"\")", "code_hash": "abdb959de1f3c38dc6a30e1760218677", "config": {"column": null, "disabled": false, "hide_code": true}, "id": "PSQn", "name": "_"}, {"code": "def categorize_column(df, column_name, transform=None, drop_first=True):\n    df = df.copy()\n\n    if not transform:\n        unique_values = sorted(df[column_name].unique().astype(str))\n    else:\n        unique_values = sorted(df[column_name].unique())\n\n    # Skip the first value if drop_first is True\n    start_idx = 1 if drop_first else 0\n\n    for value in unique_values[start_idx:]:\n        transformed_value = transform(value) if callable(transform) else value\n        df[column_name + \"_\" + str(transformed_value)] = (df[column_name] == value).astype(int)\n\n    return df\n\ncategorize_column(X_train, \"number_of_doors\", int)", "code_hash": "c09b9a7dd9892caaddd5355c38a78702", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "OfTS", "name": "_"}, {"code": "def categorize_prepare(\n    X,\n    categorical_columns = [\"make\", \"engine_fuel_type\", \"transmission_type\", \"driven_wheels\", \"vehicle_size\", \"vehicle_style\"]\n):\n    X = X.copy()\n    X = X.fillna(0)\n\n    X[\"age\"] = datetime.today().year - X.year\n\n    # We'll ignore model and market category as they are too fragmented\n    if \"model\" in X:\n        del X[\"model\"]\n\n    if \"market_category\" in X:\n        del X[\"market_category\"]\n\n    X = categorize_column(X, \"number_of_doors\", int)\n\n    for categorical_column in categorical_columns:\n        X = categorize_column(X, categorical_column)\n\n    del X[\"number_of_doors\"]\n    del X[\"make\"]\n    del X[\"engine_fuel_type\"]\n    del X[\"transmission_type\"]\n    del X[\"driven_wheels\"]\n    del X[\"vehicle_size\"]\n    del X[\"vehicle_style\"]\n\n    return X\n\ncategorize_prepare(car_prices).head()", "code_hash": "79d6ad92f10389e55103274d17be2168", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "lQxp", "name": "_"}, {"code": "def categorized_train_and_predict(X_train, y_train, X_val, y_val):\n    w = solve_linear_regression(X_train, y_train)\n    return X_val.dot(w)", "code_hash": "9b13987a1f0a6ac4ccf9a6ac2931bcd1", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "Plbk", "name": "_"}, {"code": "mo.md(r\"\"\"At this point we'd expect to solve our system and obtain a better performance. But we'll very likely get a horrible result. Maybe even a _Singular matrix_ error!\"\"\")", "code_hash": "1f1c1aebda99187b0d9e0cda131e4eb2", "config": {"column": null, "disabled": false, "hide_code": true}, "id": "rSYo", "name": "_"}, {"code": "def categorized_eval():\n    df_categorized = categorize_prepare(car_prices, [\"make\", \"vehicle_size\"])\n    df_train, df_val, df_test = split_dataset(df_categorized)\n\n    X_train, y_train = df_train\n    X_val, y_val = df_val\n\n    return rmse(\n        categorized_train_and_predict(X_train, y_train, X_val, y_val),\n        y_val\n    )\n\ncategorized_eval()", "code_hash": "829013f448f8137b9db4a385f7ddf588", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "HuZB", "name": "_"}, {"code": "mo.md(\n    r\"\"\"\n## Regularization\n\nWhen we introduced categorical variables in our model, we also increased the chance of having features that are dependent of each other. For instance, if we had 3 possible values for **number of doors** and we created 3 boolean columns, one for each of the values, then each of the columns could be deduced from the others. In other words, they would be linearly dependent. That means that the inverse of $X^T X$ won't even be defined.\n\nIn order to solve this, one approach is to add a diagonal multiplied by a small factor so that we get a $X^T X + \\delta \\mathbb{I}$ that has an inverse.\n\"\"\"\n)", "code_hash": "3693bf6f6683c49ff010a703c36904d8", "config": {"column": null, "disabled": false, "hide_code": true}, "id": "WfYj", "name": "_"}, {"code": "delta = 0.01", "code_hash": "6fd62b14f3d8f0b23b7fe9e8f3cf8ad3", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "Ynfw", "name": "_"}, {"code": "def regularize_and_solve_linear_regression(X, y, delta):\n    return np.linalg.inv(X.T.dot(X) + delta * np.eye(X.shape[1])).dot(X.T).dot(y)", "code_hash": "abcde37585399a4f7ca234e3b35e6c75", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "LqFA", "name": "_"}, {"code": "def regularized_train_and_predict(X_train, y_train, X_val, y_val, delta):\n    w = regularize_and_solve_linear_regression(X_train, y_train, delta)\n    return X_val.dot(w)", "code_hash": "7f7eb5d0c8ef6418d123f0e78f6748d9", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "uDnK", "name": "_"}, {"code": "def regularize_categorized_eval(delta):\n    df_categorized = categorize_prepare(car_prices)\n    df_train, df_val, df_test = split_dataset(df_categorized)\n\n    X_train, y_train = df_train\n    X_val, y_val = df_val\n\n    return rmse(\n        regularized_train_and_predict(X_train, y_train, X_val, y_val, delta),\n        y_val\n    )\n\nregularize_categorized_eval(delta)", "code_hash": "83eb1cf795c1e8861c7c0ab1ee0d77c1", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "aWBL", "name": "_"}, {"code": "mo.md(\n    r\"\"\"\n## Tuning the Model\n\nTo obtain the best $delta$ for our model, we can start by just trying some values:\n\"\"\"\n)", "code_hash": "9d7e715b5fabbaa1148defa975d8e1b0", "config": {"column": null, "disabled": false, "hide_code": true}, "id": "MIsd", "name": "_"}, {"code": "def find_delta():\n    results = {}\n\n    for n in np.linspace(9.5, 10, 20):\n        delta = 1/(10**n)\n        results[delta] = regularize_categorized_eval(delta)\n\n    return results\n\nregularization_deltas = find_delta()\n\nregularization_deltas", "code_hash": "f754d468b62b0f9c97f3928800a4d532", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "IrqS", "name": "_"}, {"code": "def plot_deltas(regularization_deltas):\n    x = regularization_deltas.keys()\n    y = regularization_deltas.values()\n    plt.plot(x, y)\n    plt.xlabel('\u03b4')\n    plt.ylabel('RMSE')\n    plt.show()\n\nplot_deltas(regularization_deltas)", "code_hash": "1f766eb31f774a42374f5aafebca1e16", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "Lpqv", "name": "_"}, {"code": "def get_min_regularization(regularization_deltas):\n    min_delta = None\n    min_rmse = None\n\n    for delta, rmse in regularization_deltas.items():\n        if min_rmse is None or rmse < min_rmse:\n            min_rmse = rmse\n            min_delta = delta\n\n    return (min_delta, min_rmse)\n\n(regularization_delta, _) = get_min_regularization(regularization_deltas)", "code_hash": "86351dea75bca516482353489cc1ae07", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "upgv", "name": "_"}, {"code": "regularize_categorized_eval(regularization_delta)", "code_hash": "57b67272ee832e83274ac555b455c48b", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "WJUG", "name": "_"}, {"code": "mo.md(\n    r\"\"\"\n## Using the Model\n\nAt this point, we'll train our `g` model on a split that combines the train and validation splits.\n\"\"\"\n)", "code_hash": "fa576db5b206b76103d4345e924c67d4", "config": {"column": null, "disabled": false, "hide_code": true}, "id": "pCao", "name": "_"}, {"code": "mo.md(r\"\"\"### Prepare a Merged Dataset with Train and Validation\"\"\")", "code_hash": "5b6cabc970ce00ee071a6407b61e1f0d", "config": {"column": null, "disabled": false, "hide_code": true}, "id": "wEIy", "name": "_"}, {"code": "def get_full_train():\n    df_categorized = categorize_prepare(car_prices)\n    df_train, df_val, df_test = split_dataset(df_categorized)\n\n    X_train, y_train = df_train\n    X_val, y_val = df_val\n    X_test, y_test = df_test\n\n    X = np.concat([X_train, X_val])\n    y = np.concat([y_train, y_val])\n\n    return X, y, X_test.values, y_test\n\nget_full_train()", "code_hash": "7c6c9a5aca6d18542b1a8b302ab70217", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "wlyU", "name": "_"}, {"code": "mo.md(\n    r\"\"\"\n### Train the Model\n\nHere we are training the model in our merged dataset and displaying its weights.\n\"\"\"\n)", "code_hash": "282a257f8b871539775c2506ddea6dfb", "config": {"column": null, "disabled": false, "hide_code": true}, "id": "PieA", "name": "_"}, {"code": "def solve_full_train(delta):\n    X, y, X_test, y_test = get_full_train()\n\n    return regularize_and_solve_linear_regression(X, y, delta)\n\nsolve_full_train(regularization_delta)", "code_hash": "6b0ffab9d631dadce93e126fa985e07c", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "GrQN", "name": "_"}, {"code": "mo.md(r\"\"\"### Check that we Can Predict Prices\"\"\")", "code_hash": "fda4d73b1b35d24edc211ea34ae1d637", "config": {"column": null, "disabled": false, "hide_code": true}, "id": "Ilkb", "name": "_"}, {"code": "def full_train_and_predict(delta):\n    X, y, X_test, y_test = get_full_train()\n    w = regularize_and_solve_linear_regression(X, y, delta)\n\n    return X.dot(w)\n\nfull_train_and_predict(regularization_delta)", "code_hash": "92bcc7ea233657ff4611a4d0eb3eb5ef", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "mySd", "name": "_"}, {"code": "mo.md(r\"\"\"### Evaluate the Model on the Test Split\"\"\")", "code_hash": "49cdd370845cdc89af9e4a79fbd3b9bf", "config": {"column": null, "disabled": false, "hide_code": true}, "id": "vGkK", "name": "_"}, {"code": "def full_train_eval(delta):\n    X, y, X_test, y_test = get_full_train()\n    w = regularize_and_solve_linear_regression(X, y, delta)\n\n    return rmse(\n        X_test.dot(w),\n        y_test\n    )\n\nfull_train_eval(regularization_delta)", "code_hash": "1f75fe2853e60fa429376422421f714a", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "zmIa", "name": "_"}, {"code": "mo.md(\n    r\"\"\"\n### Use the Model to Predict a Car's Price\n\nNow we can use our model to predict the price of a given car.\n\"\"\"\n)", "code_hash": "5243025876bec61eb475fd13b28e6231", "config": {"column": null, "disabled": false, "hide_code": true}, "id": "NOfw", "name": "_"}, {"code": "def get_test_car_price(car_id, delta):\n    X, y, X_test, y_test = get_full_train()\n    w = regularize_and_solve_linear_regression(X, y, delta)\n\n    return {\n        \"y\": np.expm1(y_test[car_id]),\n        \"y_predicted\": np.expm1(np.array([X_test[car_id]]).dot(w)[0])\n    }\n\ncar_id = 20\nget_test_car_price(car_id, regularization_delta)", "code_hash": "9789c676aa97fd0541b4e34e39ab0dc9", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "jXAc", "name": "_"}], "metadata": {"marimo_version": "0.16.0"}, "version": "1"},
            "session": {"cells": [{"code_hash": "e76e8dbe4d9bf74eff98fef5f002130b", "console": [], "id": "Hbol", "outputs": [{"data": {"text/plain": ""}, "type": "data"}]}, {"code_hash": "304898c62508f9a8d777ca964d688cd0", "console": [], "id": "MJUe", "outputs": [{"data": {"text/html": "<span class=\"markdown prose dark:prose-invert\"><h1 id=\"machine-learning-zoomcamp\">Machine Learning Zoomcamp</h1>\n<h2 id=\"module-2-regression\">Module 2: <strong>Regression</strong></h2></span>"}, "type": "data"}]}, {"code_hash": "25f3c92bce16c0138038289fdce73fb4", "console": [], "id": "vblA", "outputs": [{"data": {"text/html": "<marimo-ui-element object-id='vblA-0' random-id='493f0610-01ee-4049-9604-1012328d2c1a'><marimo-table data-initial-value='[]' data-label='null' data-data='&quot;[{&#92;&quot;&#92;&quot;:0,&#92;&quot;snapshot&#92;&quot;:&#92;&quot;https://img.youtube.com/vi/vM3SqPNlStE/hqdefault.jpg&#92;&quot;,&#92;&quot;title&#92;&quot;:&#92;&quot;Car price prediction project&#92;&quot;,&#92;&quot;youtube&#92;&quot;:&#92;&quot;https://youtube.com/watch?v=vM3SqPNlStE&#92;&quot;},{&#92;&quot;&#92;&quot;:1,&#92;&quot;snapshot&#92;&quot;:&#92;&quot;https://img.youtube.com/vi/Kd74oR4QWGM/hqdefault.jpg&#92;&quot;,&#92;&quot;title&#92;&quot;:&#92;&quot;Data preparation&#92;&quot;,&#92;&quot;youtube&#92;&quot;:&#92;&quot;https://youtube.com/watch?v=Kd74oR4QWGM&#92;&quot;},{&#92;&quot;&#92;&quot;:2,&#92;&quot;snapshot&#92;&quot;:&#92;&quot;https://img.youtube.com/vi/k6k8sQ0GhPM/hqdefault.jpg&#92;&quot;,&#92;&quot;title&#92;&quot;:&#92;&quot;Exploratory data analysis&#92;&quot;,&#92;&quot;youtube&#92;&quot;:&#92;&quot;https://youtube.com/watch?v=k6k8sQ0GhPM&#92;&quot;},{&#92;&quot;&#92;&quot;:3,&#92;&quot;snapshot&#92;&quot;:&#92;&quot;https://img.youtube.com/vi/ck0IfiPaQi0/hqdefault.jpg&#92;&quot;,&#92;&quot;title&#92;&quot;:&#92;&quot;Setting up the validation framework&#92;&quot;,&#92;&quot;youtube&#92;&quot;:&#92;&quot;https://youtube.com/watch?v=ck0IfiPaQi0&#92;&quot;},{&#92;&quot;&#92;&quot;:4,&#92;&quot;snapshot&#92;&quot;:&#92;&quot;https://img.youtube.com/vi/Dn1eTQLsOdA/hqdefault.jpg&#92;&quot;,&#92;&quot;title&#92;&quot;:&#92;&quot;Linear regression&#92;&quot;,&#92;&quot;youtube&#92;&quot;:&#92;&quot;https://youtube.com/watch?v=Dn1eTQLsOdA&#92;&quot;},{&#92;&quot;&#92;&quot;:5,&#92;&quot;snapshot&#92;&quot;:&#92;&quot;https://img.youtube.com/vi/YkyevnYyAww/hqdefault.jpg&#92;&quot;,&#92;&quot;title&#92;&quot;:&#92;&quot;Linear regression: vector form&#92;&quot;,&#92;&quot;youtube&#92;&quot;:&#92;&quot;https://youtube.com/watch?v=YkyevnYyAww&#92;&quot;},{&#92;&quot;&#92;&quot;:6,&#92;&quot;snapshot&#92;&quot;:&#92;&quot;https://img.youtube.com/vi/hx6nak-Y11g/hqdefault.jpg&#92;&quot;,&#92;&quot;title&#92;&quot;:&#92;&quot;Training linear regression: Normal equation&#92;&quot;,&#92;&quot;youtube&#92;&quot;:&#92;&quot;https://youtube.com/watch?v=hx6nak-Y11g&#92;&quot;},{&#92;&quot;&#92;&quot;:7,&#92;&quot;snapshot&#92;&quot;:&#92;&quot;https://img.youtube.com/vi/SvPpMMYtYbU/hqdefault.jpg&#92;&quot;,&#92;&quot;title&#92;&quot;:&#92;&quot;Baseline model for car price prediction project&#92;&quot;,&#92;&quot;youtube&#92;&quot;:&#92;&quot;https://youtube.com/watch?v=SvPpMMYtYbU&#92;&quot;},{&#92;&quot;&#92;&quot;:8,&#92;&quot;snapshot&#92;&quot;:&#92;&quot;https://img.youtube.com/vi/0LWoFtbzNUM/hqdefault.jpg&#92;&quot;,&#92;&quot;title&#92;&quot;:&#92;&quot;Root mean squared error&#92;&quot;,&#92;&quot;youtube&#92;&quot;:&#92;&quot;https://youtube.com/watch?v=0LWoFtbzNUM&#92;&quot;},{&#92;&quot;&#92;&quot;:9,&#92;&quot;snapshot&#92;&quot;:&#92;&quot;https://img.youtube.com/vi/rawGPXg2ofE/hqdefault.jpg&#92;&quot;,&#92;&quot;title&#92;&quot;:&#92;&quot;Using RMSE on validation data&#92;&quot;,&#92;&quot;youtube&#92;&quot;:&#92;&quot;https://youtube.com/watch?v=rawGPXg2ofE&#92;&quot;}]&quot;' data-total-rows='16' data-total-columns='3' data-max-columns='50' data-banner-text='&quot;&quot;' data-pagination='true' data-page-size='10' data-field-types='[[&quot;snapshot&quot;,[&quot;string&quot;,&quot;object&quot;]],[&quot;title&quot;,[&quot;string&quot;,&quot;object&quot;]],[&quot;youtube&quot;,[&quot;string&quot;,&quot;object&quot;]]]' data-show-filters='true' data-show-download='true' data-show-column-summaries='true' data-show-data-types='true' data-show-page-size-selector='true' data-show-column-explorer='true' data-show-chart-builder='true' data-row-headers='[[&quot;&quot;,[&quot;integer&quot;,&quot;int64&quot;]]]' data-has-stable-row-id='false' data-lazy='false' data-preload='false'></marimo-table></marimo-ui-element>"}, "type": "data"}]}, {"code_hash": "1d3036664588742ca99aa99004e53a08", "console": [], "id": "bkHC", "outputs": [{"data": {"text/html": "<marimo-ui-element object-id='bkHC-0' random-id='c520bf66-e3f0-0caa-42f9-bdb6c8b57cfe'><marimo-table data-initial-value='[]' data-label='null' data-data='&quot;[{&#92;&quot;title&#92;&quot;:&#92;&quot;Car price prediction project&#92;&quot;,&#92;&quot;contents&#92;&quot;:&#92;&quot;https://github.com/DataTalksClub/machine-learning-zoomcamp/blob/master/02-regression/01-car-price-intro.md&#92;&quot;},{&#92;&quot;title&#92;&quot;:&#92;&quot;Data preparation&#92;&quot;,&#92;&quot;contents&#92;&quot;:&#92;&quot;https://github.com/DataTalksClub/machine-learning-zoomcamp/blob/master/02-regression/02-data-preparation.md&#92;&quot;},{&#92;&quot;title&#92;&quot;:&#92;&quot;Exploratory data analysis&#92;&quot;,&#92;&quot;contents&#92;&quot;:&#92;&quot;https://github.com/DataTalksClub/machine-learning-zoomcamp/blob/master/02-regression/03-eda.md&#92;&quot;},{&#92;&quot;title&#92;&quot;:&#92;&quot;Setting up the validation framework&#92;&quot;,&#92;&quot;contents&#92;&quot;:&#92;&quot;https://github.com/DataTalksClub/machine-learning-zoomcamp/blob/master/02-regression/04-validation-framework.md&#92;&quot;},{&#92;&quot;title&#92;&quot;:&#92;&quot;Linear regression&#92;&quot;,&#92;&quot;contents&#92;&quot;:&#92;&quot;https://github.com/DataTalksClub/machine-learning-zoomcamp/blob/master/02-regression/05-linear-regression-simple.md&#92;&quot;},{&#92;&quot;title&#92;&quot;:&#92;&quot;Linear regression: vector form&#92;&quot;,&#92;&quot;contents&#92;&quot;:&#92;&quot;https://github.com/DataTalksClub/machine-learning-zoomcamp/blob/master/02-regression/06-linear-regression-vector.md&#92;&quot;},{&#92;&quot;title&#92;&quot;:&#92;&quot;Training linear regression: Normal equation&#92;&quot;,&#92;&quot;contents&#92;&quot;:&#92;&quot;https://github.com/DataTalksClub/machine-learning-zoomcamp/blob/master/02-regression/07-linear-regression-training.md&#92;&quot;},{&#92;&quot;title&#92;&quot;:&#92;&quot;Baseline model for car price prediction project&#92;&quot;,&#92;&quot;contents&#92;&quot;:&#92;&quot;https://github.com/DataTalksClub/machine-learning-zoomcamp/blob/master/02-regression/08-baseline-model.md&#92;&quot;},{&#92;&quot;title&#92;&quot;:&#92;&quot;Root mean squared error&#92;&quot;,&#92;&quot;contents&#92;&quot;:&#92;&quot;https://github.com/DataTalksClub/machine-learning-zoomcamp/blob/master/02-regression/09-rmse.md&#92;&quot;},{&#92;&quot;title&#92;&quot;:&#92;&quot;Using RMSE on validation data&#92;&quot;,&#92;&quot;contents&#92;&quot;:&#92;&quot;https://github.com/DataTalksClub/machine-learning-zoomcamp/blob/master/02-regression/10-car-price-validation.md&#92;&quot;}]&quot;' data-total-rows='18' data-total-columns='2' data-max-columns='50' data-banner-text='&quot;&quot;' data-pagination='true' data-page-size='10' data-field-types='[[&quot;title&quot;,[&quot;string&quot;,&quot;object&quot;]],[&quot;contents&quot;,[&quot;string&quot;,&quot;object&quot;]]]' data-show-filters='true' data-show-download='true' data-show-column-summaries='true' data-show-data-types='true' data-show-page-size-selector='true' data-show-column-explorer='true' data-show-chart-builder='true' data-row-headers='[]' data-has-stable-row-id='false' data-lazy='false' data-preload='false'></marimo-table></marimo-ui-element>"}, "type": "data"}]}, {"code_hash": "7f18baf3bbb896c2170c30755b24a4c7", "console": [], "id": "lEQa", "outputs": [{"data": {"text/html": "<span class=\"markdown prose dark:prose-invert\"><h2 id=\"car-price-prediction-project\">Car Price Prediction Project</h2>\n<span class=\"paragraph\">In this chapter we'll be working with the <a href=\"https://www.kaggle.com/datasets/CooperUnion/cardataset\" rel=\"noopener\" target=\"_blank\">Car Features and MSRP</a> Kaggle dataset.</span>\n<ol>\n<li>Prepare the data and do some Exploratory Data Analysis (EDA)</li>\n<li>Use linear regression for predicting price</li>\n<li>Understand the internals of linear regression</li>\n<li>Evaluate the model using Root Mean Square Error (RMSE)</li>\n<li>Do some feature engineering</li>\n<li>Regualization</li>\n<li>Use the model</li>\n</ol></span>"}, "type": "data"}]}, {"code_hash": "f87f1759f940957899367de416ae20b4", "console": [], "id": "PKri", "outputs": [{"data": {"text/html": "<span class=\"markdown prose dark:prose-invert\"><h2 id=\"data-preparation\">Data Preparation</h2>\n<span class=\"paragraph\">To facilitate the analysis, the CSV file has been already downloaded in <strong>data/car-prices.csv</strong>.</span></span>"}, "type": "data"}]}, {"code_hash": "bb8aa8849a1ed64f21ea7d7a75892bb9", "console": [], "id": "Xref", "outputs": [{"data": {"text/html": "<marimo-ui-element object-id='Xref-0' random-id='135de1ef-1293-01b5-2bba-b6da9ef3e45b'><marimo-table data-initial-value='[]' data-label='null' data-data='&quot;[{&#92;&quot;Make&#92;&quot;:&#92;&quot;BMW&#92;&quot;,&#92;&quot;Model&#92;&quot;:&#92;&quot;1 Series M&#92;&quot;,&#92;&quot;Year&#92;&quot;:2011,&#92;&quot;Engine Fuel Type&#92;&quot;:&#92;&quot;premium unleaded (required)&#92;&quot;,&#92;&quot;Engine HP&#92;&quot;:335.0,&#92;&quot;Engine Cylinders&#92;&quot;:6.0,&#92;&quot;Transmission Type&#92;&quot;:&#92;&quot;MANUAL&#92;&quot;,&#92;&quot;Driven_Wheels&#92;&quot;:&#92;&quot;rear wheel drive&#92;&quot;,&#92;&quot;Number of Doors&#92;&quot;:2.0,&#92;&quot;Market Category&#92;&quot;:&#92;&quot;Factory Tuner,Luxury,High-Performance&#92;&quot;,&#92;&quot;Vehicle Size&#92;&quot;:&#92;&quot;Compact&#92;&quot;,&#92;&quot;Vehicle Style&#92;&quot;:&#92;&quot;Coupe&#92;&quot;,&#92;&quot;highway MPG&#92;&quot;:26,&#92;&quot;city mpg&#92;&quot;:19,&#92;&quot;Popularity&#92;&quot;:3916,&#92;&quot;MSRP&#92;&quot;:46135},{&#92;&quot;Make&#92;&quot;:&#92;&quot;BMW&#92;&quot;,&#92;&quot;Model&#92;&quot;:&#92;&quot;1 Series&#92;&quot;,&#92;&quot;Year&#92;&quot;:2011,&#92;&quot;Engine Fuel Type&#92;&quot;:&#92;&quot;premium unleaded (required)&#92;&quot;,&#92;&quot;Engine HP&#92;&quot;:300.0,&#92;&quot;Engine Cylinders&#92;&quot;:6.0,&#92;&quot;Transmission Type&#92;&quot;:&#92;&quot;MANUAL&#92;&quot;,&#92;&quot;Driven_Wheels&#92;&quot;:&#92;&quot;rear wheel drive&#92;&quot;,&#92;&quot;Number of Doors&#92;&quot;:2.0,&#92;&quot;Market Category&#92;&quot;:&#92;&quot;Luxury,Performance&#92;&quot;,&#92;&quot;Vehicle Size&#92;&quot;:&#92;&quot;Compact&#92;&quot;,&#92;&quot;Vehicle Style&#92;&quot;:&#92;&quot;Convertible&#92;&quot;,&#92;&quot;highway MPG&#92;&quot;:28,&#92;&quot;city mpg&#92;&quot;:19,&#92;&quot;Popularity&#92;&quot;:3916,&#92;&quot;MSRP&#92;&quot;:40650},{&#92;&quot;Make&#92;&quot;:&#92;&quot;BMW&#92;&quot;,&#92;&quot;Model&#92;&quot;:&#92;&quot;1 Series&#92;&quot;,&#92;&quot;Year&#92;&quot;:2011,&#92;&quot;Engine Fuel Type&#92;&quot;:&#92;&quot;premium unleaded (required)&#92;&quot;,&#92;&quot;Engine HP&#92;&quot;:300.0,&#92;&quot;Engine Cylinders&#92;&quot;:6.0,&#92;&quot;Transmission Type&#92;&quot;:&#92;&quot;MANUAL&#92;&quot;,&#92;&quot;Driven_Wheels&#92;&quot;:&#92;&quot;rear wheel drive&#92;&quot;,&#92;&quot;Number of Doors&#92;&quot;:2.0,&#92;&quot;Market Category&#92;&quot;:&#92;&quot;Luxury,High-Performance&#92;&quot;,&#92;&quot;Vehicle Size&#92;&quot;:&#92;&quot;Compact&#92;&quot;,&#92;&quot;Vehicle Style&#92;&quot;:&#92;&quot;Coupe&#92;&quot;,&#92;&quot;highway MPG&#92;&quot;:28,&#92;&quot;city mpg&#92;&quot;:20,&#92;&quot;Popularity&#92;&quot;:3916,&#92;&quot;MSRP&#92;&quot;:36350},{&#92;&quot;Make&#92;&quot;:&#92;&quot;BMW&#92;&quot;,&#92;&quot;Model&#92;&quot;:&#92;&quot;1 Series&#92;&quot;,&#92;&quot;Year&#92;&quot;:2011,&#92;&quot;Engine Fuel Type&#92;&quot;:&#92;&quot;premium unleaded (required)&#92;&quot;,&#92;&quot;Engine HP&#92;&quot;:230.0,&#92;&quot;Engine Cylinders&#92;&quot;:6.0,&#92;&quot;Transmission Type&#92;&quot;:&#92;&quot;MANUAL&#92;&quot;,&#92;&quot;Driven_Wheels&#92;&quot;:&#92;&quot;rear wheel drive&#92;&quot;,&#92;&quot;Number of Doors&#92;&quot;:2.0,&#92;&quot;Market Category&#92;&quot;:&#92;&quot;Luxury,Performance&#92;&quot;,&#92;&quot;Vehicle Size&#92;&quot;:&#92;&quot;Compact&#92;&quot;,&#92;&quot;Vehicle Style&#92;&quot;:&#92;&quot;Coupe&#92;&quot;,&#92;&quot;highway MPG&#92;&quot;:28,&#92;&quot;city mpg&#92;&quot;:18,&#92;&quot;Popularity&#92;&quot;:3916,&#92;&quot;MSRP&#92;&quot;:29450},{&#92;&quot;Make&#92;&quot;:&#92;&quot;BMW&#92;&quot;,&#92;&quot;Model&#92;&quot;:&#92;&quot;1 Series&#92;&quot;,&#92;&quot;Year&#92;&quot;:2011,&#92;&quot;Engine Fuel Type&#92;&quot;:&#92;&quot;premium unleaded (required)&#92;&quot;,&#92;&quot;Engine HP&#92;&quot;:230.0,&#92;&quot;Engine Cylinders&#92;&quot;:6.0,&#92;&quot;Transmission Type&#92;&quot;:&#92;&quot;MANUAL&#92;&quot;,&#92;&quot;Driven_Wheels&#92;&quot;:&#92;&quot;rear wheel drive&#92;&quot;,&#92;&quot;Number of Doors&#92;&quot;:2.0,&#92;&quot;Market Category&#92;&quot;:&#92;&quot;Luxury&#92;&quot;,&#92;&quot;Vehicle Size&#92;&quot;:&#92;&quot;Compact&#92;&quot;,&#92;&quot;Vehicle Style&#92;&quot;:&#92;&quot;Convertible&#92;&quot;,&#92;&quot;highway MPG&#92;&quot;:28,&#92;&quot;city mpg&#92;&quot;:18,&#92;&quot;Popularity&#92;&quot;:3916,&#92;&quot;MSRP&#92;&quot;:34500}]&quot;' data-total-rows='5' data-total-columns='16' data-max-columns='50' data-banner-text='&quot;&quot;' data-pagination='true' data-page-size='10' data-field-types='[[&quot;Make&quot;,[&quot;string&quot;,&quot;object&quot;]],[&quot;Model&quot;,[&quot;string&quot;,&quot;object&quot;]],[&quot;Year&quot;,[&quot;integer&quot;,&quot;int64&quot;]],[&quot;Engine Fuel Type&quot;,[&quot;string&quot;,&quot;object&quot;]],[&quot;Engine HP&quot;,[&quot;number&quot;,&quot;float64&quot;]],[&quot;Engine Cylinders&quot;,[&quot;number&quot;,&quot;float64&quot;]],[&quot;Transmission Type&quot;,[&quot;string&quot;,&quot;object&quot;]],[&quot;Driven_Wheels&quot;,[&quot;string&quot;,&quot;object&quot;]],[&quot;Number of Doors&quot;,[&quot;number&quot;,&quot;float64&quot;]],[&quot;Market Category&quot;,[&quot;string&quot;,&quot;object&quot;]],[&quot;Vehicle Size&quot;,[&quot;string&quot;,&quot;object&quot;]],[&quot;Vehicle Style&quot;,[&quot;string&quot;,&quot;object&quot;]],[&quot;highway MPG&quot;,[&quot;integer&quot;,&quot;int64&quot;]],[&quot;city mpg&quot;,[&quot;integer&quot;,&quot;int64&quot;]],[&quot;Popularity&quot;,[&quot;integer&quot;,&quot;int64&quot;]],[&quot;MSRP&quot;,[&quot;integer&quot;,&quot;int64&quot;]]]' data-show-filters='true' data-show-download='true' data-show-column-summaries='false' data-show-data-types='true' data-show-page-size-selector='false' data-show-column-explorer='true' data-show-chart-builder='true' data-row-headers='[]' data-has-stable-row-id='false' data-lazy='false' data-preload='false'></marimo-table></marimo-ui-element>"}, "type": "data"}]}, {"code_hash": "912f15b11e5c98313ec0ab3ddf6e71ca", "console": [], "id": "SFPL", "outputs": [{"data": {"text/html": "<span class=\"markdown prose dark:prose-invert\"><h3 id=\"standardize-column-names\">Standardize Column Names</h3>\n<span class=\"paragraph\">Some of the columns are named using spaces as separator and other columns were named using underscores as a separator. We'll now standardize their names.</span></span>"}, "type": "data"}]}, {"code_hash": "0faac80606581212927fe85dc0064f69", "console": [], "id": "BYtC", "outputs": [{"data": {"text/html": "<marimo-ui-element object-id='BYtC-0' random-id='2a901ffb-a815-c6c3-215f-2d469c06a050'><marimo-table data-initial-value='[]' data-label='null' data-data='&quot;[{&#92;&quot;make&#92;&quot;:&#92;&quot;BMW&#92;&quot;,&#92;&quot;model&#92;&quot;:&#92;&quot;1 Series M&#92;&quot;,&#92;&quot;year&#92;&quot;:2011,&#92;&quot;engine_fuel_type&#92;&quot;:&#92;&quot;premium unleaded (required)&#92;&quot;,&#92;&quot;engine_hp&#92;&quot;:335.0,&#92;&quot;engine_cylinders&#92;&quot;:6.0,&#92;&quot;transmission_type&#92;&quot;:&#92;&quot;MANUAL&#92;&quot;,&#92;&quot;driven_wheels&#92;&quot;:&#92;&quot;rear wheel drive&#92;&quot;,&#92;&quot;number_of_doors&#92;&quot;:2.0,&#92;&quot;market_category&#92;&quot;:&#92;&quot;Factory Tuner,Luxury,High-Performance&#92;&quot;,&#92;&quot;vehicle_size&#92;&quot;:&#92;&quot;Compact&#92;&quot;,&#92;&quot;vehicle_style&#92;&quot;:&#92;&quot;Coupe&#92;&quot;,&#92;&quot;highway_mpg&#92;&quot;:26,&#92;&quot;city_mpg&#92;&quot;:19,&#92;&quot;popularity&#92;&quot;:3916,&#92;&quot;msrp&#92;&quot;:46135},{&#92;&quot;make&#92;&quot;:&#92;&quot;BMW&#92;&quot;,&#92;&quot;model&#92;&quot;:&#92;&quot;1 Series&#92;&quot;,&#92;&quot;year&#92;&quot;:2011,&#92;&quot;engine_fuel_type&#92;&quot;:&#92;&quot;premium unleaded (required)&#92;&quot;,&#92;&quot;engine_hp&#92;&quot;:300.0,&#92;&quot;engine_cylinders&#92;&quot;:6.0,&#92;&quot;transmission_type&#92;&quot;:&#92;&quot;MANUAL&#92;&quot;,&#92;&quot;driven_wheels&#92;&quot;:&#92;&quot;rear wheel drive&#92;&quot;,&#92;&quot;number_of_doors&#92;&quot;:2.0,&#92;&quot;market_category&#92;&quot;:&#92;&quot;Luxury,Performance&#92;&quot;,&#92;&quot;vehicle_size&#92;&quot;:&#92;&quot;Compact&#92;&quot;,&#92;&quot;vehicle_style&#92;&quot;:&#92;&quot;Convertible&#92;&quot;,&#92;&quot;highway_mpg&#92;&quot;:28,&#92;&quot;city_mpg&#92;&quot;:19,&#92;&quot;popularity&#92;&quot;:3916,&#92;&quot;msrp&#92;&quot;:40650},{&#92;&quot;make&#92;&quot;:&#92;&quot;BMW&#92;&quot;,&#92;&quot;model&#92;&quot;:&#92;&quot;1 Series&#92;&quot;,&#92;&quot;year&#92;&quot;:2011,&#92;&quot;engine_fuel_type&#92;&quot;:&#92;&quot;premium unleaded (required)&#92;&quot;,&#92;&quot;engine_hp&#92;&quot;:300.0,&#92;&quot;engine_cylinders&#92;&quot;:6.0,&#92;&quot;transmission_type&#92;&quot;:&#92;&quot;MANUAL&#92;&quot;,&#92;&quot;driven_wheels&#92;&quot;:&#92;&quot;rear wheel drive&#92;&quot;,&#92;&quot;number_of_doors&#92;&quot;:2.0,&#92;&quot;market_category&#92;&quot;:&#92;&quot;Luxury,High-Performance&#92;&quot;,&#92;&quot;vehicle_size&#92;&quot;:&#92;&quot;Compact&#92;&quot;,&#92;&quot;vehicle_style&#92;&quot;:&#92;&quot;Coupe&#92;&quot;,&#92;&quot;highway_mpg&#92;&quot;:28,&#92;&quot;city_mpg&#92;&quot;:20,&#92;&quot;popularity&#92;&quot;:3916,&#92;&quot;msrp&#92;&quot;:36350},{&#92;&quot;make&#92;&quot;:&#92;&quot;BMW&#92;&quot;,&#92;&quot;model&#92;&quot;:&#92;&quot;1 Series&#92;&quot;,&#92;&quot;year&#92;&quot;:2011,&#92;&quot;engine_fuel_type&#92;&quot;:&#92;&quot;premium unleaded (required)&#92;&quot;,&#92;&quot;engine_hp&#92;&quot;:230.0,&#92;&quot;engine_cylinders&#92;&quot;:6.0,&#92;&quot;transmission_type&#92;&quot;:&#92;&quot;MANUAL&#92;&quot;,&#92;&quot;driven_wheels&#92;&quot;:&#92;&quot;rear wheel drive&#92;&quot;,&#92;&quot;number_of_doors&#92;&quot;:2.0,&#92;&quot;market_category&#92;&quot;:&#92;&quot;Luxury,Performance&#92;&quot;,&#92;&quot;vehicle_size&#92;&quot;:&#92;&quot;Compact&#92;&quot;,&#92;&quot;vehicle_style&#92;&quot;:&#92;&quot;Coupe&#92;&quot;,&#92;&quot;highway_mpg&#92;&quot;:28,&#92;&quot;city_mpg&#92;&quot;:18,&#92;&quot;popularity&#92;&quot;:3916,&#92;&quot;msrp&#92;&quot;:29450},{&#92;&quot;make&#92;&quot;:&#92;&quot;BMW&#92;&quot;,&#92;&quot;model&#92;&quot;:&#92;&quot;1 Series&#92;&quot;,&#92;&quot;year&#92;&quot;:2011,&#92;&quot;engine_fuel_type&#92;&quot;:&#92;&quot;premium unleaded (required)&#92;&quot;,&#92;&quot;engine_hp&#92;&quot;:230.0,&#92;&quot;engine_cylinders&#92;&quot;:6.0,&#92;&quot;transmission_type&#92;&quot;:&#92;&quot;MANUAL&#92;&quot;,&#92;&quot;driven_wheels&#92;&quot;:&#92;&quot;rear wheel drive&#92;&quot;,&#92;&quot;number_of_doors&#92;&quot;:2.0,&#92;&quot;market_category&#92;&quot;:&#92;&quot;Luxury&#92;&quot;,&#92;&quot;vehicle_size&#92;&quot;:&#92;&quot;Compact&#92;&quot;,&#92;&quot;vehicle_style&#92;&quot;:&#92;&quot;Convertible&#92;&quot;,&#92;&quot;highway_mpg&#92;&quot;:28,&#92;&quot;city_mpg&#92;&quot;:18,&#92;&quot;popularity&#92;&quot;:3916,&#92;&quot;msrp&#92;&quot;:34500}]&quot;' data-total-rows='5' data-total-columns='16' data-max-columns='50' data-banner-text='&quot;&quot;' data-pagination='true' data-page-size='10' data-field-types='[[&quot;make&quot;,[&quot;string&quot;,&quot;object&quot;]],[&quot;model&quot;,[&quot;string&quot;,&quot;object&quot;]],[&quot;year&quot;,[&quot;integer&quot;,&quot;int64&quot;]],[&quot;engine_fuel_type&quot;,[&quot;string&quot;,&quot;object&quot;]],[&quot;engine_hp&quot;,[&quot;number&quot;,&quot;float64&quot;]],[&quot;engine_cylinders&quot;,[&quot;number&quot;,&quot;float64&quot;]],[&quot;transmission_type&quot;,[&quot;string&quot;,&quot;object&quot;]],[&quot;driven_wheels&quot;,[&quot;string&quot;,&quot;object&quot;]],[&quot;number_of_doors&quot;,[&quot;number&quot;,&quot;float64&quot;]],[&quot;market_category&quot;,[&quot;string&quot;,&quot;object&quot;]],[&quot;vehicle_size&quot;,[&quot;string&quot;,&quot;object&quot;]],[&quot;vehicle_style&quot;,[&quot;string&quot;,&quot;object&quot;]],[&quot;highway_mpg&quot;,[&quot;integer&quot;,&quot;int64&quot;]],[&quot;city_mpg&quot;,[&quot;integer&quot;,&quot;int64&quot;]],[&quot;popularity&quot;,[&quot;integer&quot;,&quot;int64&quot;]],[&quot;msrp&quot;,[&quot;integer&quot;,&quot;int64&quot;]]]' data-show-filters='true' data-show-download='true' data-show-column-summaries='false' data-show-data-types='true' data-show-page-size-selector='false' data-show-column-explorer='true' data-show-chart-builder='true' data-row-headers='[]' data-has-stable-row-id='false' data-lazy='false' data-preload='false'></marimo-table></marimo-ui-element>"}, "type": "data"}]}, {"code_hash": "a8fd1747efc75f553a8fbbc6ec5e0ec6", "console": [], "id": "RGSE", "outputs": [{"data": {"text/html": "<span class=\"markdown prose dark:prose-invert\"><h3 id=\"standardize-values\">Standardize Values</h3>\n<span class=\"paragraph\">First we'll get the list of all string columns.</span></span>"}, "type": "data"}]}, {"code_hash": "7e5cb5914b82201ad6147702f2d6e925", "console": [], "id": "Kclp", "outputs": [{"data": {"application/json": "[\"make\", \"model\", \"engine_fuel_type\", \"transmission_type\", \"driven_wheels\", \"market_category\", \"vehicle_size\", \"vehicle_style\"]"}, "type": "data"}]}, {"code_hash": "e5aa13818bc96529aa060e851dbd42e4", "console": [], "id": "emfo", "outputs": [{"data": {"text/html": "<marimo-ui-element object-id='emfo-0' random-id='f28fe659-71dd-d9dc-12a0-cf3d9da0a327'><marimo-table data-initial-value='[]' data-label='null' data-data='&quot;[{&#92;&quot;make&#92;&quot;:&#92;&quot;bmw&#92;&quot;,&#92;&quot;model&#92;&quot;:&#92;&quot;1_series_m&#92;&quot;,&#92;&quot;year&#92;&quot;:2011,&#92;&quot;engine_fuel_type&#92;&quot;:&#92;&quot;premium_unleaded_(required)&#92;&quot;,&#92;&quot;engine_hp&#92;&quot;:335.0,&#92;&quot;engine_cylinders&#92;&quot;:6.0,&#92;&quot;transmission_type&#92;&quot;:&#92;&quot;manual&#92;&quot;,&#92;&quot;driven_wheels&#92;&quot;:&#92;&quot;rear_wheel_drive&#92;&quot;,&#92;&quot;number_of_doors&#92;&quot;:2.0,&#92;&quot;market_category&#92;&quot;:&#92;&quot;factory_tuner,luxury,high-performance&#92;&quot;,&#92;&quot;vehicle_size&#92;&quot;:&#92;&quot;compact&#92;&quot;,&#92;&quot;vehicle_style&#92;&quot;:&#92;&quot;coupe&#92;&quot;,&#92;&quot;highway_mpg&#92;&quot;:26,&#92;&quot;city_mpg&#92;&quot;:19,&#92;&quot;popularity&#92;&quot;:3916,&#92;&quot;msrp&#92;&quot;:46135},{&#92;&quot;make&#92;&quot;:&#92;&quot;bmw&#92;&quot;,&#92;&quot;model&#92;&quot;:&#92;&quot;1_series&#92;&quot;,&#92;&quot;year&#92;&quot;:2011,&#92;&quot;engine_fuel_type&#92;&quot;:&#92;&quot;premium_unleaded_(required)&#92;&quot;,&#92;&quot;engine_hp&#92;&quot;:300.0,&#92;&quot;engine_cylinders&#92;&quot;:6.0,&#92;&quot;transmission_type&#92;&quot;:&#92;&quot;manual&#92;&quot;,&#92;&quot;driven_wheels&#92;&quot;:&#92;&quot;rear_wheel_drive&#92;&quot;,&#92;&quot;number_of_doors&#92;&quot;:2.0,&#92;&quot;market_category&#92;&quot;:&#92;&quot;luxury,performance&#92;&quot;,&#92;&quot;vehicle_size&#92;&quot;:&#92;&quot;compact&#92;&quot;,&#92;&quot;vehicle_style&#92;&quot;:&#92;&quot;convertible&#92;&quot;,&#92;&quot;highway_mpg&#92;&quot;:28,&#92;&quot;city_mpg&#92;&quot;:19,&#92;&quot;popularity&#92;&quot;:3916,&#92;&quot;msrp&#92;&quot;:40650},{&#92;&quot;make&#92;&quot;:&#92;&quot;bmw&#92;&quot;,&#92;&quot;model&#92;&quot;:&#92;&quot;1_series&#92;&quot;,&#92;&quot;year&#92;&quot;:2011,&#92;&quot;engine_fuel_type&#92;&quot;:&#92;&quot;premium_unleaded_(required)&#92;&quot;,&#92;&quot;engine_hp&#92;&quot;:300.0,&#92;&quot;engine_cylinders&#92;&quot;:6.0,&#92;&quot;transmission_type&#92;&quot;:&#92;&quot;manual&#92;&quot;,&#92;&quot;driven_wheels&#92;&quot;:&#92;&quot;rear_wheel_drive&#92;&quot;,&#92;&quot;number_of_doors&#92;&quot;:2.0,&#92;&quot;market_category&#92;&quot;:&#92;&quot;luxury,high-performance&#92;&quot;,&#92;&quot;vehicle_size&#92;&quot;:&#92;&quot;compact&#92;&quot;,&#92;&quot;vehicle_style&#92;&quot;:&#92;&quot;coupe&#92;&quot;,&#92;&quot;highway_mpg&#92;&quot;:28,&#92;&quot;city_mpg&#92;&quot;:20,&#92;&quot;popularity&#92;&quot;:3916,&#92;&quot;msrp&#92;&quot;:36350},{&#92;&quot;make&#92;&quot;:&#92;&quot;bmw&#92;&quot;,&#92;&quot;model&#92;&quot;:&#92;&quot;1_series&#92;&quot;,&#92;&quot;year&#92;&quot;:2011,&#92;&quot;engine_fuel_type&#92;&quot;:&#92;&quot;premium_unleaded_(required)&#92;&quot;,&#92;&quot;engine_hp&#92;&quot;:230.0,&#92;&quot;engine_cylinders&#92;&quot;:6.0,&#92;&quot;transmission_type&#92;&quot;:&#92;&quot;manual&#92;&quot;,&#92;&quot;driven_wheels&#92;&quot;:&#92;&quot;rear_wheel_drive&#92;&quot;,&#92;&quot;number_of_doors&#92;&quot;:2.0,&#92;&quot;market_category&#92;&quot;:&#92;&quot;luxury,performance&#92;&quot;,&#92;&quot;vehicle_size&#92;&quot;:&#92;&quot;compact&#92;&quot;,&#92;&quot;vehicle_style&#92;&quot;:&#92;&quot;coupe&#92;&quot;,&#92;&quot;highway_mpg&#92;&quot;:28,&#92;&quot;city_mpg&#92;&quot;:18,&#92;&quot;popularity&#92;&quot;:3916,&#92;&quot;msrp&#92;&quot;:29450},{&#92;&quot;make&#92;&quot;:&#92;&quot;bmw&#92;&quot;,&#92;&quot;model&#92;&quot;:&#92;&quot;1_series&#92;&quot;,&#92;&quot;year&#92;&quot;:2011,&#92;&quot;engine_fuel_type&#92;&quot;:&#92;&quot;premium_unleaded_(required)&#92;&quot;,&#92;&quot;engine_hp&#92;&quot;:230.0,&#92;&quot;engine_cylinders&#92;&quot;:6.0,&#92;&quot;transmission_type&#92;&quot;:&#92;&quot;manual&#92;&quot;,&#92;&quot;driven_wheels&#92;&quot;:&#92;&quot;rear_wheel_drive&#92;&quot;,&#92;&quot;number_of_doors&#92;&quot;:2.0,&#92;&quot;market_category&#92;&quot;:&#92;&quot;luxury&#92;&quot;,&#92;&quot;vehicle_size&#92;&quot;:&#92;&quot;compact&#92;&quot;,&#92;&quot;vehicle_style&#92;&quot;:&#92;&quot;convertible&#92;&quot;,&#92;&quot;highway_mpg&#92;&quot;:28,&#92;&quot;city_mpg&#92;&quot;:18,&#92;&quot;popularity&#92;&quot;:3916,&#92;&quot;msrp&#92;&quot;:34500}]&quot;' data-total-rows='5' data-total-columns='16' data-max-columns='50' data-banner-text='&quot;&quot;' data-pagination='true' data-page-size='10' data-field-types='[[&quot;make&quot;,[&quot;string&quot;,&quot;object&quot;]],[&quot;model&quot;,[&quot;string&quot;,&quot;object&quot;]],[&quot;year&quot;,[&quot;integer&quot;,&quot;int64&quot;]],[&quot;engine_fuel_type&quot;,[&quot;string&quot;,&quot;object&quot;]],[&quot;engine_hp&quot;,[&quot;number&quot;,&quot;float64&quot;]],[&quot;engine_cylinders&quot;,[&quot;number&quot;,&quot;float64&quot;]],[&quot;transmission_type&quot;,[&quot;string&quot;,&quot;object&quot;]],[&quot;driven_wheels&quot;,[&quot;string&quot;,&quot;object&quot;]],[&quot;number_of_doors&quot;,[&quot;number&quot;,&quot;float64&quot;]],[&quot;market_category&quot;,[&quot;string&quot;,&quot;object&quot;]],[&quot;vehicle_size&quot;,[&quot;string&quot;,&quot;object&quot;]],[&quot;vehicle_style&quot;,[&quot;string&quot;,&quot;object&quot;]],[&quot;highway_mpg&quot;,[&quot;integer&quot;,&quot;int64&quot;]],[&quot;city_mpg&quot;,[&quot;integer&quot;,&quot;int64&quot;]],[&quot;popularity&quot;,[&quot;integer&quot;,&quot;int64&quot;]],[&quot;msrp&quot;,[&quot;integer&quot;,&quot;int64&quot;]]]' data-show-filters='true' data-show-download='true' data-show-column-summaries='false' data-show-data-types='true' data-show-page-size-selector='false' data-show-column-explorer='true' data-show-chart-builder='true' data-row-headers='[]' data-has-stable-row-id='false' data-lazy='false' data-preload='false'></marimo-table></marimo-ui-element>"}, "type": "data"}]}, {"code_hash": "6d5010ff652e368df7b670074d9c0d3f", "console": [], "id": "Hstk", "outputs": [{"data": {"text/html": "<span class=\"markdown prose dark:prose-invert\"><h2 id=\"exploratory-data-analysis\">Exploratory Data Analysis</h2>\n<h3 id=\"check-unique-values-per-column\">Check Unique Values per Column</h3></span>"}, "type": "data"}]}, {"code_hash": "3d7d45e2e7753cd159b869850470e0b8", "console": [], "id": "nWHF", "outputs": [{"data": {"application/json": "{\"make\": {\"sample\": \"text/plain:['bmw' 'audi' 'fiat' 'mercedes-benz' 'chrysler']\", \"count\": 48}, \"model\": {\"sample\": \"text/plain:['1_series_m' '1_series' '100' '124_spider' '190-class']\", \"count\": 914}, \"year\": {\"sample\": \"text/plain:[2011 2012 2013 1992 1993]\", \"count\": 28}, \"engine_fuel_type\": {\"sample\": \"text/plain:['premium_unleaded_(required)' 'regular_unleaded'\\n 'premium_unleaded_(recommended)' 'flex-fuel_(unleaded/e85)' 'diesel']\", \"count\": 10}, \"engine_hp\": {\"sample\": \"text/plain:[335. 300. 230. 320. 172.]\", \"count\": 356}, \"engine_cylinders\": {\"sample\": \"text/plain:[ 6.  4.  5.  8. 12.]\", \"count\": 9}, \"transmission_type\": {\"sample\": \"text/plain:['manual' 'automatic' 'automated_manual' 'direct_drive' 'unknown']\", \"count\": 5}, \"driven_wheels\": {\"sample\": \"text/plain:['rear_wheel_drive' 'front_wheel_drive' 'all_wheel_drive'\\n 'four_wheel_drive']\", \"count\": 4}, \"number_of_doors\": {\"sample\": \"text/plain:[ 2.  4.  3. nan]\", \"count\": 3}, \"market_category\": {\"sample\": \"text/plain:['factory_tuner,luxury,high-performance' 'luxury,performance'\\n 'luxury,high-performance' 'luxury' 'performance']\", \"count\": 71}, \"vehicle_size\": {\"sample\": \"text/plain:['compact' 'midsize' 'large']\", \"count\": 3}, \"vehicle_style\": {\"sample\": \"text/plain:['coupe' 'convertible' 'sedan' 'wagon' '4dr_hatchback']\", \"count\": 16}, \"highway_mpg\": {\"sample\": \"text/plain:[26 28 27 25 24]\", \"count\": 59}, \"city_mpg\": {\"sample\": \"text/plain:[19 20 18 17 16]\", \"count\": 69}, \"popularity\": {\"sample\": \"text/plain:[3916 3105  819  617 1013]\", \"count\": 48}, \"msrp\": {\"sample\": \"text/plain:[46135 40650 36350 29450 34500]\", \"count\": 6049}}"}, "type": "data"}]}, {"code_hash": "9ee48e97a45745667c20e61ca1179d8f", "console": [], "id": "iLit", "outputs": [{"data": {"text/html": "<span class=\"markdown prose dark:prose-invert\"><h3 id=\"check-the-price-column\">Check the Price Column</h3>\n<span class=\"paragraph\">A tiny number of cars with a very high price is ruining our plot.</span></span>"}, "type": "data"}]}, {"code_hash": "e2060c13af97e5753962d9599ef97dcf", "console": [], "id": "ZHCJ", "outputs": [{"data": {"image/png": "data:image/png;base64,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KFBiYqJat26tLl26aM6cOTp16pRXzebNmzV8+HDZ7Xb16dNHGRkZdTlsAADQQtXpHqLPP/9cQ4cOlSTt3r3ba642N1h369ZNjz32mC699FJZlqVXX31Vt9xyi3bt2qUBAwZo9uzZyszM1OrVqxUSEqLk5GRNmDBBn3zyiaRffh07MTFR4eHhys7O1uHDhzV16lQFBgbqP//zPyX98hMBiYmJuvfee/XGG28oKytLM2bMUNeuXZWQkFCXwwcAAC2MzbIsy9dNnK5Dhw564okndOutt6pz585avny5br31VknSF198oejoaOXk5GjUqFF6//33ddNNN+nQoUMKCwuT9MsN3w888IB++OEHBQUF6YEHHlBmZqZXcJs0aZJKSkq0bt26i+rJ7XYrJCREpaWlcjgc9Xq82dnZmv/ObnXqPUiS9NXWNQoMCVePIaM8Nf/an6eFtwzkvi0AAGqhNp/fdfrKrCFUVlZqxYoVOn78uJxOp1wulyoqKhQfH++p6d+/v7p3766cnBxJUk5OjgYNGuQJQ5KUkJAgt9utPXv2eGpO30d1TfU+alJWVia32+21AACAlqtOX5mNGTPmvF+Nbdq06aL3lZeXJ6fTqZMnT6pt27Z6++23FRMTo9zcXAUFBSk0NNSrPiwsTIWFhZKkwsJCrzBUPV89d74at9utEydOqFWrVmf1tGjRIi1YsOCijwEAADRvdQpE1fcPVauoqFBubq5279591h99vZB+/fopNzdXpaWl+p//+R9NmzZNW7ZsqUtb9SYtLc3r5nC3263IyEgfdgQAABpSnQLRkiVLahx/5JFHdOzYsVrtKygoSH369JEkxcbGaseOHXrmmWd02223qby8XCUlJV5XiYqKihQeHi5JCg8P1/bt2732V/0U2uk1Zz6ZVlRUJIfDUePVIUmy2+2y2+21Og4AANB81es9RL/73e9+9d8xq6qqUllZmWJjYxUYGKisrCzPXH5+vgoKCuR0OiVJTqdTeXl5Ki4u9tRs3LhRDodDMTExnprT91FdU70PAACAOv9x15rk5OQoODj4ouvT0tI0btw4de/eXUePHtXy5cu1efNmrV+/XiEhIZo+fbpSU1PVoUMHORwOzZo1S06nU6NG/fIE1tixYxUTE6MpU6bo8ccfV2FhoebNm6ekpCTPFZ57771Xzz//vObOnas777xTmzZt0qpVq5SZmVmfhw4AAJqxOgWiCRMmeK1blqXDhw/rs88+00MPPXTR+ykuLtbUqVN1+PBhhYSEaPDgwVq/fr2uv/56Sb98Nefn56eJEyeqrKxMCQkJeuGFFzzb+/v7a+3atZo5c6acTqfatGmjadOmaeHChZ6aqKgoZWZmavbs2XrmmWfUrVs3vfTSS/wGEQAA8KhTIAoJCfFa9/PzU79+/bRw4UKNHTv2ovfz8ssvn3c+ODhY6enpSk9PP2dNjx499N577513P6NHj9auXbsuui8AAGCWOgWiZcuW1XcfAAAAPvOr7iFyuVzat2+fJGnAgAEaNmxYvTQFAADQmOoUiIqLizVp0iRt3rzZ80h8SUmJxowZoxUrVqhz58712SMAAECDqtNj97NmzdLRo0e1Z88eHTlyREeOHNHu3bvldrv1hz/8ob57BAAAaFB1ukK0bt06ffDBB4qOjvaMxcTEKD09vVY3VQMAADQFdbpCVFVVpcDAwLPGAwMDVVVV9aubAgAAaEx1CkTXXnut7rvvPh06dMgz9v3332v27Nm67rrr6q05AACAxlCnQPT888/L7XarZ8+e6t27t3r37q2oqCi53W4999xz9d0jAABAg6rTPUSRkZHauXOnPvjgA33xxReSpOjoaMXHx9drcwAAAI2hVleINm3apJiYGLndbtlsNl1//fWaNWuWZs2apcsvv1wDBgzQRx991FC9AgAANIhaBaKnn35ad911lxwOx1lzISEhuueee7R48eJ6aw4AAKAx1CoQ/fOf/9QNN9xwzvmxY8fK5XL96qYAAAAaU60CUVFRUY2P21cLCAjQDz/88KubAgAAaEy1CkSXXHKJdu/efc75zz//XF27dv3VTQEAADSmWgWiG2+8UQ899JBOnjx51tyJEyf08MMP66abbqq35gAAABpDrR67nzdvnt566y317dtXycnJ6tevnyTpiy++UHp6uiorK/XHP/6xQRoFAABoKLUKRGFhYcrOztbMmTOVlpYmy7IkSTabTQkJCUpPT1dYWFiDNAoAANBQav3DjD169NB7772nn376SV999ZUsy9Kll16q9u3bN0R/AAAADa5Ov1QtSe3bt9fll19en70AAAD4RJ3+lhkAAEBLQiACAADGIxABAADjEYgAAIDxCEQAAMB4BCIAAGA8AhEAADAegQgAABiPQAQAAIxHIAIAAMYjEAEAAOMRiAAAgPEIRAAAwHgEIgAAYDwCEQAAMB6BCAAAGI9ABAAAjEcgAgAAxiMQAQAA4xGIAACA8QhEAADAeAQiAABgPAIRAAAwHoEIAAAYj0AEAACMRyACAADGIxABAADjEYgAAIDxCEQAAMB4BCIAAGA8AhEAADAegQgAABiPQAQAAIzn00C0aNEiXX755WrXrp26dOmi8ePHKz8/36vm5MmTSkpKUseOHdW2bVtNnDhRRUVFXjUFBQVKTExU69at1aVLF82ZM0enTp3yqtm8ebOGDx8uu92uPn36KCMjo6EPDwAANBM+DURbtmxRUlKStm3bpo0bN6qiokJjx47V8ePHPTWzZ8/Wu+++q9WrV2vLli06dOiQJkyY4JmvrKxUYmKiysvLlZ2drVdffVUZGRmaP3++p+bAgQNKTEzUmDFjlJubq5SUFM2YMUPr169v1OMFAABNU4AvX3zdunVe6xkZGerSpYtcLpeuvvpqlZaW6uWXX9by5ct17bXXSpKWLVum6Ohobdu2TaNGjdKGDRu0d+9effDBBwoLC9PQoUP16KOP6oEHHtAjjzyioKAgLV26VFFRUXrqqackSdHR0fr444+1ZMkSJSQknNVXWVmZysrKPOtut7sB/ysAAABfa1L3EJWWlkqSOnToIElyuVyqqKhQfHy8p6Z///7q3r27cnJyJEk5OTkaNGiQwsLCPDUJCQlyu93as2ePp+b0fVTXVO/jTIsWLVJISIhniYyMrL+DBAAATU6TCURVVVVKSUnRFVdcoYEDB0qSCgsLFRQUpNDQUK/asLAwFRYWempOD0PV89Vz56txu906ceLEWb2kpaWptLTUsxw8eLBejhEAADRNPv3K7HRJSUnavXu3Pv74Y1+3IrvdLrvd7us2AABAI2kSV4iSk5O1du1affjhh+rWrZtnPDw8XOXl5SopKfGqLyoqUnh4uKfmzKfOqtcvVONwONSqVav6PhwAANDM+DQQWZal5ORkvf3229q0aZOioqK85mNjYxUYGKisrCzPWH5+vgoKCuR0OiVJTqdTeXl5Ki4u9tRs3LhRDodDMTExnprT91FdU70PAABgNp9+ZZaUlKTly5frnXfeUbt27Tz3/ISEhKhVq1YKCQnR9OnTlZqaqg4dOsjhcGjWrFlyOp0aNWqUJGns2LGKiYnRlClT9Pjjj6uwsFDz5s1TUlKS52uve++9V88//7zmzp2rO++8U5s2bdKqVauUmZnps2MHAABNh0+vEL344osqLS3V6NGj1bVrV8+ycuVKT82SJUt00003aeLEibr66qsVHh6ut956yzPv7++vtWvXyt/fX06nU7/73e80depULVy40FMTFRWlzMxMbdy4UUOGDNFTTz2ll156qcZH7gEAgHl8eoXIsqwL1gQHBys9PV3p6ennrOnRo4fee++98+5n9OjR2rVrV617BAAALV+TuKkaAADAlwhEAADAeAQiAABgPAIRAAAwHoEIAAAYj0AEAACMRyACAADGIxABAADjEYgAAIDxCEQAAMB4BCIAAGA8AhEAADAegQgAABiPQAQAAIxHIAIAAMYjEAEAAOMRiAAAgPEIRAAAwHgBvm4AF1Z1qkJ5eXleY7GxsbLb7T7qCACAloVA1Ay4iwr03DcnFP61TZJU8v1+Pft7KS4uzsedAQDQMhCImol24VHq1HuQr9sAAKBF4h4iAABgPAIRAAAwHoEIAAAYj0AEAACMRyACAADGIxABAADjEYgAAIDxCEQAAMB4BCIAAGA8AhEAADAegQgAABiPQAQAAIxHIAIAAMYjEAEAAOMRiAAAgPEIRAAAwHgEIgAAYDwCEQAAMB6BCAAAGI9ABAAAjEcgAgAAxiMQAQAA4xGIAACA8QhEAADAeAQiAABgPAIRAAAwHoEIAAAYj0AEAACMRyACAADGIxABAADj+TQQbd26VTfffLMiIiJks9m0Zs0ar3nLsjR//nx17dpVrVq1Unx8vL788kuvmiNHjmjy5MlyOBwKDQ3V9OnTdezYMa+azz//XFdddZWCg4MVGRmpxx9/vKEPDQAANCM+DUTHjx/XkCFDlJ6eXuP8448/rmeffVZLly7Vp59+qjZt2ighIUEnT5701EyePFl79uzRxo0btXbtWm3dulV33323Z97tdmvs2LHq0aOHXC6XnnjiCT3yyCP629/+1uDHBwAAmocAX774uHHjNG7cuBrnLMvS008/rXnz5umWW26RJL322msKCwvTmjVrNGnSJO3bt0/r1q3Tjh07dNlll0mSnnvuOd1444168sknFRERoTfeeEPl5eV65ZVXFBQUpAEDBig3N1eLFy/2Ck4AAMBcTfYeogMHDqiwsFDx8fGesZCQEI0cOVI5OTmSpJycHIWGhnrCkCTFx8fL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GRnW3r17rbvvvtsKDQ21CgsLLcuyrClTplgPPvigp/6TTz6xAgICrCeffNLat2+f9fDDD1uBgYFWXl6erw7BSLU9bwsWLLDWr19v7d+/33K5XNakSZOs4OBga8+ePb46BOMcPXrU2rVrl7Vr1y5LkrV48WJr165d1rfffmtZlmU9+OCD1pQpUzz1X3/9tdW6dWtrzpw51r59+6z09HTL39/fWrduna8OwTi1PWdLliyx1qxZY3355ZdWXl6edd9991l+fn7WBx984KtDMM7MmTOtkJAQa/Pmzdbhw4c9y88//+ypac6fawSiBvbcc89Z3bt3t4KCgqwRI0ZY27Zt88xdc8011rRp07zqV61aZfXt29cKCgqyBgwYYGVmZjZyx7Cs2p23lJQUT21YWJh14403Wjt37vRB1+aqfiT7zKX6PE2bNs265pprztpm6NChVlBQkNWrVy9r2bJljd63yWp7zv7yl79YvXv3toKDg60OHTpYo0ePtjZt2uSb5g1V0/mS5PXeac6fazbLsqzGvioFAADQlHAPEQAAMB6BCAAAGI9ABAAAjEcgAgAAxiMQAQAA4xGIAACA8QhEAADAeAQiAADgM1u3btXNN9+siIgI2Ww2rVmzptb7sCxLTz75pPr27Su73a5LLrlEf/7zn2u1D/7aPQAA8Jnjx49ryJAhuvPOOzVhwoQ67eO+++7Thg0b9OSTT2rQoEE6cuSIjhw5Uqt98EvVAACgSbDZbHr77bc1fvx4z1hZWZn++Mc/6r//+79VUlKigQMH6i9/+YtGjx4tSdq3b58GDx6s3bt3q1+/fnV+bb4yA4ALqKio8HULgLGSk5OVk5OjFStW6PPPP9dvfvMb3XDDDfryyy8lSe+++6569eqltWvXKioqSj179tSMGTNqfYWIQASg2Rs9erRmzZqllJQUtW/fXmFhYfr73/+u48eP64477lC7du3Up08fvf/++5Kkn376SZMnT1bnzp3VqlUrXXrppVq2bJkk6ZtvvpHNZtPKlSt1zTXXKDg4WG+88YYyMjIUGhqqNWvW6NJLL1VwcLASEhJ08OBBXx460KIVFBRo2bJlWr16ta666ir17t1b999/v6688krPe/brr7/Wt99+q9WrV+u1115TRkaGXC6Xbr311lq9FoEIQIvw6quvqlOnTtq+fbtmzZqlmTNn6je/+Y3i4uK0c+dOjR07VlOmTNHPP/+shx56SHv37tX777+vffv26cUXX1SnTp289vfggw/qvvvu0759+5SQkCBJ+vnnn/XnP/9Zr732mj755BOVlJRo0qRJvjhcwAh5eXmqrKxU37591bZtW8+yZcsW7d+/X5JUVVWlsrIyvfbaa7rqqqs0evRovfzyy/rwww+Vn59/0a/FTdUAWoQhQ4Zo3rx5kqS0tDQ99thj6tSpk+666y5J0vz58/Xiiy/q888/V0FBgYYNG6bLLrtMktSzZ8+z9peSknLWDZ4VFRV6/vnnNXLkSEm/hLDo6Ght375dI0aMaMCjA8x07Ngx+fv7y+Vyyd/f32uubdu2kqSuXbsqICBAffv29cxFR0dL+uUK08XeV8QVIgAtwuDBgz3/9vf3V8eOHTVo0CDPWFhYmCSpuLhYM2fO1IoVKzR06FDNnTtX2dnZZ+2vOiydLiAgQJdffrlnvX///goNDdW+ffvq81AA/H/Dhg1TZWWliouL1adPH68lPDxcknTFFVfo1KlTnitGkvS///u/kqQePXpc9GsRiAC0CIGBgV7rNpvNa8xms0n65fL6uHHj9O2332r27Nk6dOiQrrvuOt1///1e27dp06bhmwagY8eOKTc3V7m5uZKkAwcOKDc3VwUFBerbt68mT56sqVOn6q233tKBAwe0fft2LVq0SJmZmZKk+Ph4DR8+XHfeead27doll8ule+65R9dff73XVaMLIRABMFLnzp01bdo0vf7663r66af1t7/97YLbnDp1Sp999plnPT8/XyUlJZ7L8wBq77PPPtOwYcM0bNgwSVJqaqqGDRum+fPnS5KWLVumqVOn6j/+4z/Ur18/jR8/Xjt27FD37t0lSX5+fnr33XfVqVMnXX311UpMTFR0dLRWrFhRqz64hwiAcebPn6/Y2FgNGDBAZWVlWrt27UWFmsDAQM2aNUvPPvusAgIClJycrFGjRnH/EPArjB49Wuf7ScTAwEAtWLBACxYsOGdNRESE3nzzzV/VB1eIABgnKChIaWlpGjx4sK6++mr5+/tf1P+bbN26tR544AH99re/1RVXXKG2bdtq5cqVjdAxgIbGL1UDwEXIyMhQSkqKSkpKfN0KgAbAFSIAAGA8AhEAADAeX5kBAADjcYUIAAAYj0AEAACMRyACAADGIxABAADjEYgAAIDxCEQAAMB4BCIAAGA8AhEAADDe/wOrSC7xKaSGEQAAAABJRU5ErkJggg=="}, "type": "data"}]}, {"code_hash": "17b063052123f6191e5e0454a99d37dc", "console": [], "id": "ROlb", "outputs": [{"data": {"text/html": "<span class=\"markdown prose dark:prose-invert\"><span class=\"paragraph\">We could filter them to get a better view but that implies making a choice on where to cut. Which could confuse our model.</span></span>"}, "type": "data"}]}, {"code_hash": "5c0989b50daa5e2a46fe7793965fea12", "console": [], "id": "qnkX", "outputs": [{"data": {"image/png": "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAkgAAAGwCAYAAABSN5pGAAAAOnRFWHRTb2Z0d2FyZQBNYXRwbG90bGliIHZlcnNpb24zLjEwLjYsIGh0dHBzOi8vbWF0cGxvdGxpYi5vcmcvq6yFwwAAAAlwSFlzAAAPYQAAD2EBqD+naQAANu9JREFUeJzt3Xt0VNXB/vEnIVcumRBiZogGiEi5hCCUSAxeqiUv4VKrr7xtqSmllhcsTRCkL2pWAe9i0SJCIxRXubgainUtRUs1GoMalRAgGLk22orCD5ykbUhGUJKQ7N8fbU6Zk4ghTDKT5PtZa9bynL3nnH32yMyTc/Y+J8gYYwQAAABLsL8bAAAAEGgISAAAADYEJAAAABsCEgAAgA0BCQAAwIaABAAAYENAAgAAsAnxdwM6g8bGRp04cUJ9+vRRUFCQv5sDAABawRijzz//XPHx8QoOvrBzQgSkVjhx4oQSEhL83QwAANAGx44d02WXXXZB7yEgtUKfPn0k/auDo6Ki/NwaAADQGh6PRwkJCdbv+IUgILVC02W1qKgoAhIAAJ1MW4bHMEgbAADAhoAEAABgQ0ACAACwISABAADYEJAAAABsCEgAAAA2BCQAAAAbAhIAAIANAQkAAMCGgAQAAGBDQAIAALAhIAEAANgQkAAAAGwISAAAADYh/m5Ad1dbW6vS0lKvdWPHjlV4eLifWgQAAAhIflZaWqo7n35J0ZcOliRVH/+bVv1cGj9+vJ9bBgBA90VACgDRlw5W7OBkfzcDAAD8m1/HIBUVFemmm25SfHy8goKCtHXr1q+s+7Of/UxBQUFauXKl1/qqqiplZmYqKipK0dHRmjVrlk6dOuVVZ9++fbruuusUERGhhIQELV++vB2OBgAAdBV+DUinT5/WlVdeqdzc3PPWe/HFF7Vz507Fx8c3K8vMzNTBgwdVUFCgbdu2qaioSHPmzLHKPR6PJk6cqIEDB6q0tFSPP/647r//fq1bt87nxwMAALoGv15imzx5siZPnnzeOsePH9e8efP02muvaerUqV5lhw8fVn5+vnbv3q2UlBRJ0urVqzVlyhQ98cQTio+PV15enurq6rR+/XqFhYUpKSlJZWVlWrFihVeQOldtba1qa2utZY/Hc5FHCgAAOpOAnubf2NioGTNmaNGiRUpKSmpWXlxcrOjoaCscSVJ6erqCg4NVUlJi1bn++usVFhZm1cnIyFB5eblOnjzZ4n6XLVsmh8NhvRISEnx8ZAAAIJAFdED61a9+pZCQEN15550tlrvdbsXFxXmtCwkJUUxMjNxut1XH6XR61Wlabqpjl5OTo5qaGut17Nixiz0UAADQiQTsLLbS0lI99dRT2rt3r4KCgjp03+Hh4dyHCACAbixgzyC98847qqys1IABAxQSEqKQkBB9+umn+sUvfqFBgwZJklwulyorK73ed/bsWVVVVcnlcll1KioqvOo0LTfVAQAAOFfABqQZM2Zo3759Kisrs17x8fFatGiRXnvtNUlSWlqaqqurve5EvX37djU2Nio1NdWqU1RUpPr6eqtOQUGBhg4dqr59+3bsQQEAgE7Br5fYTp06pb/+9a/W8pEjR1RWVqaYmBgNGDBA/fr186ofGhoql8uloUOHSpKGDx+uSZMmafbs2Vq7dq3q6+uVnZ2t6dOnW7cEuO222/TAAw9o1qxZuueee3TgwAE99dRTevLJJzvuQAEAQKfi14C0Z88e3XjjjdbywoULJUkzZ87Uxo0bW7WNvLw8ZWdna8KECQoODta0adO0atUqq9zhcOj1119XVlaWxo4dq9jYWC1duvQrp/gDAAD4NSDdcMMNMsa0uv4nn3zSbF1MTIw2b9583veNGjVK77zzzoU2DwAAdFMBOwYJAADAXwhIAAAANgQkAAAAGwISAACADQEJAADAhoAEAABgQ0ACAACwISABAADYEJAAAABsCEgAAAA2BCQAAAAbAhIAAIANAQkAAMCGgAQAAGBDQAIAALAhIAEAANgQkAAAAGwISAAAADYEJAAAABsCEgAAgA0BCQAAwIaABAAAYENAAgAAsCEgAQAA2BCQAAAAbAhIAAAANgQkAAAAGwISAACADQEJAADAhoAEAABgQ0ACAACwISABAADYEJAAAABsCEgAAAA2BCQAAAAbAhIAAIANAQkAAMCGgAQAAGDj14BUVFSkm266SfHx8QoKCtLWrVutsvr6et1zzz1KTk5Wr169FB8frx//+Mc6ceKE1zaqqqqUmZmpqKgoRUdHa9asWTp16pRXnX379um6665TRESEEhIStHz58o44PAAA0En5NSCdPn1aV155pXJzc5uVffHFF9q7d6+WLFmivXv36oUXXlB5ebm++93vetXLzMzUwYMHVVBQoG3btqmoqEhz5syxyj0ejyZOnKiBAweqtLRUjz/+uO6//36tW7eu3Y8PAAB0TiH+3PnkyZM1efLkFsscDocKCgq81v3mN7/RuHHjdPToUQ0YMECHDx9Wfn6+du/erZSUFEnS6tWrNWXKFD3xxBOKj49XXl6e6urqtH79eoWFhSkpKUllZWVasWKFV5ACAABo0qnGINXU1CgoKEjR0dGSpOLiYkVHR1vhSJLS09MVHByskpISq87111+vsLAwq05GRobKy8t18uTJFvdTW1srj8fj9QIAAN1HpwlIZ86c0T333KMf/vCHioqKkiS53W7FxcV51QsJCVFMTIzcbrdVx+l0etVpWm6qY7ds2TI5HA7rlZCQ4OvDAQAAAaxTBKT6+np9//vflzFGa9asaff95eTkqKamxnodO3as3fcJAAACh1/HILVGUzj69NNPtX37duvskSS5XC5VVlZ61T979qyqqqrkcrmsOhUVFV51mpab6tiFh4crPDzcl4cBAAA6kYA+g9QUjj766CO98cYb6tevn1d5WlqaqqurVVpaaq3bvn27GhsblZqaatUpKipSfX29VaegoEBDhw5V3759O+ZAAABAp+LXgHTq1CmVlZWprKxMknTkyBGVlZXp6NGjqq+v1//8z/9oz549ysvLU0NDg9xut9xut+rq6iRJw4cP16RJkzR79mzt2rVL7733nrKzszV9+nTFx8dLkm677TaFhYVp1qxZOnjwoJ577jk99dRTWrhwob8OGwAABDi/XmLbs2ePbrzxRmu5KbTMnDlT999/v15++WVJ0ujRo73e9+abb+qGG26QJOXl5Sk7O1sTJkxQcHCwpk2bplWrVll1HQ6HXn/9dWVlZWns2LGKjY3V0qVLmeIPAAC+kl8D0g033CBjzFeWn6+sSUxMjDZv3nzeOqNGjdI777xzwe0DAADdU0CPQQIAAPAHAhIAAIANAQkAAMCGgAQAAGBDQAIAALAhIAEAANgQkAAAAGwISAAAADYEJAAAABsCEgAAgA0BCQAAwIaABAAAYENAAgAAsCEgAQAA2BCQAAAAbAhIAAAANgQkAAAAGwISAACADQEJAADAhoAEAABgQ0ACAACwISABAADYEJAAAABsCEgAAAA2BCQAAAAbAhIAAIANAQkAAMCGgAQAAGBDQAIAALAhIAEAANgQkAAAAGwISAAAADYEJAAAABsCEgAAgA0B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JbbGxkalpKTo0UcflSSNGTNGBw4c0Nq1azVz5sx22294eLjCw8PbbfsAACCwBfQZpP79+2vEiBFe64YPH66jR49KklwulySpoqLCq05FRYVV5nK5VFlZ6VV+9uxZVVVVWXUAAADOFdAB6ZprrlF5ebnXug8//FADBw6U9K8B2y6XS4WFhVa5x+NRSUmJ0tLSJElpaWmqrq5WaWmpVWf79u1qbGxUampqBxwFAADobAL6Ettdd92l8ePH69FHH9X3v/997dq1S+vWrdO6deskSUFBQVqwYIEefvhhDRkyRImJiVqyZIni4+N1yy23SPrXGadJkyZp9uzZWrt2rerr65Wdna3p06e3OIMNAAAgoAPSVVddpRdffFE5OTl68MEHlZiYqJUrVyozM9Oqc/fdd+v06dOaM2eOqqurde211yo/P18RERFWnby8PGVnZ2vChAkKDg7WtGnTtGrVKn8cEgAA6ASCjDHG340IdB6PRw6HQzU1NYqKivLptnfs2KGlLx1Q7OBkSdI//rZfD948UuPHj/fpfgAA6G4u5vc7oMcgAQAA+AMBCQAAwIaABAAAYENAAgAAsCEgAQAA2BCQAAAAbAhIAAAANgQkAAAAGwISAACADQEJAADAhoAEAABgQ0ACAACwISABAADYEJAAAABsCEgAAAA2BCQAAAAbAhIAAIANAQkAAMCGgAQAAGBDQAIAALAhIAEAANgQkAAAAGwISAAAADYEJAAAABsCEgAAgA0BCQAAwIaABAAAYENAAgAAsCEgAQAA2BCQAAAAbAhIAAAANgQkAAAAGwISAACADQEJAADAhoAEAABgQ0ACAACwISABAADYEJAAAABsOlVAeuyxxxQUFKQFCxZY686cOaOsrCz169dPvXv31rRp01RRUeH1vqNHj2rq1Knq2bOn4uLitGjRIp09e7aDWw8AADqLThOQdu/erd/+9rcaNWqU1/q77rpLf/rTn/T888/r7bff1okTJ3Trrbda5Q0NDZo6darq6uq0Y8cObdq0SRs3btTSpUs7+hAAAEAn0SkC0qlTp5SZmalnnnlGffv2tdbX1NTod7/7nVasWKFvf/vbGjt2rDZs2KAdO3Zo586dkqTXX39dhw4d0u9//3uNHj1akydP1kMPPaTc3FzV1dX565AAAEAA6xQBKSsrS1OnTlV6errX+tLSUtXX13utHzZs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IzVkyBBt2LBBkvTJJ58oKChIzz33nL71rW8pIiJCeXl52rhxo6Kjo7V161YNGTJEERERysjI0LFjx/x56ADaCQEJQJewadMmxcbGateuXZo3b57mzp2r733vexo/frz27t2riRMnasaMGfriiy+0ZMkSHTp0SK+++qoOHz6sNWvWKDY21mt79957r+bPn6/Dhw8rIyNDkvTFF1/okUce0bPPPqv33ntP1dXVmj59uj8OF0A7CzLGGH83AgAuxg033KCGhga98847kqSGhgY5HA7deuutevbZZyVJbrdb/fv3V3FxsR599FHFxsZq/fr1zbb1ySefKDExUStXrtT8+fOt9Rs3btTtt9+unTt3KjU1VZL0l7/8RcOHD1dJSYnGjRvXAUcKoKNwBglAlzBq1Cjrv3v06KF+/fopOTnZWud0OiVJlZWVmjt3rrZs2aLRo0fr7rvv1o4dO5ptLyUlpdm6kJAQXXXVVdbysGHDFB0drcOHD/vyUAAEAAISgC4hNDTUazkoKMhrXVBQkCSpsbFRkydP1qeffqq77rpLJ06c0IQJE/R///d/Xu/v1atX+zcaQMAiIAHoli655BLNnDlTv//977Vy5UqtW7fua99z9uxZ7dmzx1ouLy9XdXW1hg8f3p5NBeAHIf5uAAB0tKVLl2rs2LFKSkpSbW2ttm3b1qqQExoaqnnz5mnVqlUKCQlRdna2rr76asYfAV0QZ5AAdDthYWHKycnRqFGjdP3116tHjx7asmXL176vZ8+euueee3TbbbfpmmuuUe/evfXcc891QIsBdDRmsQFAK2zcuFELFixQdXW1v5sCoANwBgkAAMCGgAQAAGDDJTYAAAAbziABAADYEJAAAABsCEgAAAA2BCQAAAAbAhIAAIANAQkAAMCGgAQAAGBDQAIAALD5/7B1FfQP1Y+GAAAAAElFTkSuQmCC"}, "type": "data"}]}, {"code_hash": "be67f77fe9c3fa8ad3526d8063a8ee15", "console": [], "id": "TqIu", "outputs": [{"data": {"text/html": "<span class=\"markdown prose dark:prose-invert\"><span class=\"paragraph\">Instead of making a manual cut, we can take the logarithm of the price. By doing so, outlier (few cases with extreme values) are handled in a more elegant way.</span></span>"}, "type": "data"}]}, {"code_hash": "a55d17f9c98a1c349fab1859be71d865", "console": [], "id": "Vxnm", "outputs": [{"data": {"text/plain": ""}, "type": "data"}]}, {"code_hash": "12e115f873256e9ac70b276ab54a7fb8", "console": [], "id": "DnEU", "outputs": [{"data": {"text/html": "<span class=\"markdown prose dark:prose-invert\"><h3 id=\"check-for-empty-values\">Check for Empty Values</h3></span>"}, "type": "data"}]}, {"code_hash": "98a16a9e0c880538c9ada89c6454fce4", "console": [], "id": "ulZA", "outputs": [{"data": {"text/html": "<marimo-ui-element object-id='ulZA-0' random-id='d05adf03-ce5d-8285-2e4a-7d22eefdee21'><marimo-table data-initial-value='[]' data-label='null' data-data='&quot;[{&#92;&quot;&#92;&quot;:&#92;&quot;engine_fuel_type&#92;&quot;,&#92;&quot;value&#92;&quot;:3},{&#92;&quot;&#92;&quot;:&#92;&quot;engine_hp&#92;&quot;,&#92;&quot;value&#92;&quot;:69},{&#92;&quot;&#92;&quot;:&#92;&quot;engine_cylinders&#92;&quot;,&#92;&quot;value&#92;&quot;:30},{&#92;&quot;&#92;&quot;:&#92;&quot;number_of_doors&#92;&quot;,&#92;&quot;value&#92;&quot;:6},{&#92;&quot;&#92;&quot;:&#92;&quot;market_category&#92;&quot;,&#92;&quot;value&#92;&quot;:3742}]&quot;' data-total-rows='5' data-total-columns='1' data-max-columns='50' data-banner-text='&quot;&quot;' data-pagination='true' data-page-size='10' data-field-types='[[&quot;value&quot;,[&quot;integer&quot;,&quot;int64&quot;]]]' data-show-filters='true' data-show-download='true' data-show-column-summaries='false' data-show-data-types='true' data-show-page-size-selector='false' data-show-column-explorer='true' data-show-chart-builder='true' data-row-headers='[[&quot;&quot;,[&quot;string&quot;,&quot;object&quot;]]]' data-has-stable-row-id='false' data-lazy='false' data-preload='false'></marimo-table></marimo-ui-element>"}, "type": "data"}]}, {"code_hash": "6f7863f60f4242290a612a5868b6ab9a", "console": [], "id": "ecfG", "outputs": [{"data": {"text/html": "<span class=\"markdown prose dark:prose-invert\"><h2 id=\"setting-up-the-validation-framework\">Setting Up the Validation Framework</h2>\n<span class=\"paragraph\">We want to define our feature matrix <marimo-tex class=\"arithmatex\">||(X||)</marimo-tex> and a target variable <marimo-tex class=\"arithmatex\">||(y||)</marimo-tex> and then separate it into our train <marimo-tex class=\"arithmatex\">||(X_T||)</marimo-tex> and <marimo-tex class=\"arithmatex\">||(y_T||)</marimo-tex>, validation <marimo-tex class=\"arithmatex\">||(X_V||)</marimo-tex> and <marimo-tex class=\"arithmatex\">||(y_V||)</marimo-tex> and test <marimo-tex class=\"arithmatex\">||(X_{test}||)</marimo-tex> and <marimo-tex class=\"arithmatex\">||(t_{test}||)</marimo-tex> splits.</span></span>"}, "type": "data"}]}, {"code_hash": "2ba50adfb09d4f0f4aee0d9cdfdb5920", "console": [], "id": "Pvdt", "outputs": [{"data": {"application/json": "{\"n\": 11914, \"n_train\": 7150, \"n_val\": 2382, \"n_test\": 2382}"}, "type": "data"}]}, {"code_hash": "b668d11b586a25b29b96ea8c0eeddc9f", "console": [], "id": "ZBYS", "outputs": [{"data": {"text/html": "<span class=\"markdown prose dark:prose-invert\"><span class=\"paragraph\">To avoid spliting the records in the same order they have in the dataset (so that we don't get oddly distributed splits), we'll make a randomized selection.</span>\n<span class=\"paragraph\">First, we create a list with the identifiers of each sample in a random order.</span></span>"}, "type": "data"}]}, {"code_hash": "1162fe1261f3c31c6941a28f39ceaed2", "console": [], "id": "aLJB", "outputs": [{"data": {"text/html": "<pre style='font-size: 12px'>array([2735, 6720, 5878, ..., 6637, 2575, 7336], shape=(11914,))</pre>"}, "type": "data"}]}, {"code_hash": "ca78992023d68b6b6037cfcf27a75caf", "console": [], "id": "nHfw", "outputs": [{"data": {"text/html": "<span class=\"markdown prose dark:prose-invert\"><span class=\"paragraph\">Then we use that as our reference for creating our splits.</span></span>"}, "type": "data"}]}, {"code_hash": "ab6c6ddd159058b2754e78c6becf536a", "console": [], "id": "xXTn", "outputs": [{"data": {"text/plain": ""}, "type": "data"}]}, {"code_hash": "b93ef907b4c5c9b45b2093e3d1b68179", "console": [], "id": "AjVT", "outputs": [{"data": {"text/html": "<span class=\"markdown prose dark:prose-invert\"><span class=\"paragraph\">As our index column has now a random order, we'll reset it in each of the splits.</span></span>"}, "type": "data"}]}, {"code_hash": "c57bdbad94234ab00ab9c9f0644ec92b", "console": [], "id": "pHFh", "outputs": [{"data": {"text/plain": ""}, "type": "data"}]}, {"code_hash": "ee8c7e24901ca0bd0a6874e550648aa5", "console": [], "id": "NCOB", "outputs": [{"data": {"text/html": "<span class=\"markdown prose dark:prose-invert\"><span class=\"paragraph\">Now, we'll define our target variables adjusting the price column using the logarithm function described above.</span></span>"}, "type": "data"}]}, {"code_hash": "2648c49e5f26de3da6ed28291f14e08f", "console": [], "id": "aqbW", "outputs": [{"data": {"text/plain": ""}, "type": "data"}]}, {"code_hash": "dfc74a3eb558a94b7871b9c172f9e7d3", "console": [], "id": "TRpd", "outputs": [{"data": {"text/html": "<span class=\"markdown prose dark:prose-invert\"><span class=\"paragraph\">And, finally, we'll define our feature matrices.</span></span>"}, "type": "data"}]}, {"code_hash": "14a4e50dc8238c23bc7272223a0329f6", "console": [], "id": "TXez", "outputs": [{"data": {"text/plain": ""}, "type": "data"}]}, {"code_hash": "8320d3c0f7f925afdf7651740783b968", "console": [], "id": "dNNg", "outputs": [{"data": {"text/html": "<span class=\"markdown prose dark:prose-invert\"><span class=\"paragraph\">Finally, let's wrap all this into a funciton.</span></span>"}, "type": "data"}]}, {"code_hash": "0e21079d0aad3c03356b5360480426a1", "console": [], "id": "yCnT", "outputs": [{"data": {"text/plain": ""}, "type": "data"}]}, {"code_hash": "b8f1cd202349ce220f767cea3167aee2", "console": [], "id": "wlCL", "outputs": [{"data": {"text/html": "<span class=\"markdown prose dark:prose-invert\"><h2 id=\"linear-regression\">Linear Regression</h2>\n<span class=\"paragraph\">We are trying to compute a <marimo-tex class=\"arithmatex\">||(g||)</marimo-tex> estimator function so that given the features of a car <marimo-tex class=\"arithmatex\">||(i||)</marimo-tex>:</span>\n<marimo-tex class=\"arithmatex\">||[\n    x_i = (x_{i1}, x_{i2}, ..., x_{in})\n||]</marimo-tex><span class=\"paragraph\">Our function evaluated with those features approaches the target price:</span>\n<marimo-tex class=\"arithmatex\">||[\n    g_i(x_{i1}, x_{i2}, ..., x_{in}) \\approx y_i\n||]</marimo-tex></span>"}, "type": "data"}]}, {"code_hash": "13d223cf2b57785a92400034102f9d89", "console": [], "id": "kqZH", "outputs": [{"data": {"text/plain": ""}, "type": "data"}]}, {"code_hash": "7ffc48542270230648e6a25fb56e1bf9", "console": [], "id": "wAgl", "outputs": [{"data": {"text/html": "<span class=\"markdown prose dark:prose-invert\"><span class=\"paragraph\">In order to show how linear regression works, we'll manually compute it for a selection of features: <code>engine_hp</code>, <code>city_mpg</code> and <code>popularity</code> of a randomly selected car.</span></span>"}, "type": "data"}]}, {"code_hash": "04c0adf03aa7e8fe1a3c64581e6bf4b6", "console": [], "id": "rEll", "outputs": [{"data": {"text/html": "<marimo-ui-element object-id='rEll-0' random-id='b12e2a66-6422-0d55-4dcc-98fb13984922'><marimo-table data-initial-value='[]' data-label='null' data-data='&quot;[{&#92;&quot;make&#92;&quot;:&#92;&quot;rolls-royce&#92;&quot;,&#92;&quot;model&#92;&quot;:&#92;&quot;phantom_drophead_coupe&#92;&quot;,&#92;&quot;year&#92;&quot;:2015,&#92;&quot;engine_fuel_type&#92;&quot;:&#92;&quot;premium_unleaded_(required)&#92;&quot;,&#92;&quot;engine_hp&#92;&quot;:453.0,&#92;&quot;engine_cylinders&#92;&quot;:12.0,&#92;&quot;transmission_type&#92;&quot;:&#92;&quot;automatic&#92;&quot;,&#92;&quot;driven_wheels&#92;&quot;:&#92;&quot;rear_wheel_drive&#92;&quot;,&#92;&quot;number_of_doors&#92;&quot;:2.0,&#92;&quot;market_category&#92;&quot;:&#92;&quot;exotic,luxury,performance&#92;&quot;,&#92;&quot;vehicle_size&#92;&quot;:&#92;&quot;large&#92;&quot;,&#92;&quot;vehicle_style&#92;&quot;:&#92;&quot;convertible&#92;&quot;,&#92;&quot;highway_mpg&#92;&quot;:19,&#92;&quot;city_mpg&#92;&quot;:11,&#92;&quot;popularity&#92;&quot;:86}]&quot;' data-total-rows='1' data-total-columns='15' data-max-columns='50' data-banner-text='&quot;&quot;' data-pagination='true' data-page-size='10' data-field-types='[[&quot;make&quot;,[&quot;string&quot;,&quot;object&quot;]],[&quot;model&quot;,[&quot;string&quot;,&quot;object&quot;]],[&quot;year&quot;,[&quot;integer&quot;,&quot;int64&quot;]],[&quot;engine_fuel_type&quot;,[&quot;string&quot;,&quot;object&quot;]],[&quot;engine_hp&quot;,[&quot;number&quot;,&quot;float64&quot;]],[&quot;engine_cylinders&quot;,[&quot;number&quot;,&quot;float64&quot;]],[&quot;transmission_type&quot;,[&quot;string&quot;,&quot;object&quot;]],[&quot;driven_wheels&quot;,[&quot;string&quot;,&quot;object&quot;]],[&quot;number_of_doors&quot;,[&quot;number&quot;,&quot;float64&quot;]],[&quot;market_category&quot;,[&quot;string&quot;,&quot;object&quot;]],[&quot;vehicle_size&quot;,[&quot;string&quot;,&quot;object&quot;]],[&quot;vehicle_style&quot;,[&quot;string&quot;,&quot;object&quot;]],[&quot;highway_mpg&quot;,[&quot;integer&quot;,&quot;int64&quot;]],[&quot;city_mpg&quot;,[&quot;integer&quot;,&quot;int64&quot;]],[&quot;popularity&quot;,[&quot;integer&quot;,&quot;int64&quot;]]]' data-show-filters='true' data-show-download='true' data-show-column-summaries='false' data-show-data-types='true' data-show-page-size-selector='false' data-show-column-explorer='true' data-show-chart-builder='true' data-row-headers='[]' data-has-stable-row-id='false' data-lazy='false' data-preload='false'></marimo-table></marimo-ui-element>"}, "type": "data"}]}, {"code_hash": "afa3fa6758ee321f35264dd566fcbcd2", "console": [], "id": "dGlV", "outputs": [{"data": {"text/html": "<pre style='font-size: 12px'>array([[ 148.,   24., 1385.],\n       [ 132.,   25., 2031.],\n       [ 148.,   28.,  640.],\n       ...,\n       [ 285.,   17.,  549.],\n       [ 563.,   13.,   86.],\n       [ 200.,   22.,  873.]], shape=(7150, 3))</pre>"}, "type": "data"}]}, {"code_hash": "7d9eea0727ea3dabb628e2d968abf73f", "console": [], "id": "SdmI", "outputs": [{"data": {"text/html": "<pre style='font-size: 12px'>array([[453.,  11.,  86.]])</pre>"}, "type": "data"}]}, {"code_hash": "0450cd0eb43a49cd06091167c2d076ea", "console": [], "id": "lgWD", "outputs": [{"data": {"text/html": "<span class=\"markdown prose dark:prose-invert\"><span class=\"paragraph\">Given the \"randomly\" chosen car, we'll extract the selected features and its corresponding price:</span></span>"}, "type": "data"}]}, {"code_hash": "91d16321fa7c6a846c70c82f7da86a68", "console": [], "id": "yOPj", "outputs": [{"data": {"application/json": "{\"x\": \"text/plain:[453.  11.  86.]\", \"y\": \"text/plain:[479775]\"}"}, "type": "data"}]}, {"code_hash": "50db720abf4d6a93df4aa415af366a18", "console": [], "id": "fwwy", "outputs": [{"data": {"text/html": "<span class=\"markdown prose dark:prose-invert\"><span class=\"paragraph\">Now we need to define some weights. Typically, we'd be running a process that finds the optimal values but for the moment we'll manually assign them some numbers:</span></span>"}, "type": "data"}]}, {"code_hash": "f71cbebd2c7bedb66c5edb6006e3fd78", "console": [], "id": "LJZf", "outputs": [{"data": {"text/html": "<pre style='font-size: 12px'>np.int64(468831)</pre>"}, "type": "data"}]}, {"code_hash": "58b88beed45e81cac0d3e46897886aaa", "console": [], "id": "urSm", "outputs": [{"data": {"text/html": "<span class=\"markdown prose dark:prose-invert\"><h2 id=\"linear-regression-in-vector-form\">Linear Regression in Vector Form</h2>\n<span class=\"paragraph\">We want now to generalize our previous linear regression formula so that it works with any number of features:</span>\n<marimo-tex class=\"arithmatex\">||[\n    g_i(x_i) = w_o + \\sum_{j=1}^n x_{ij} w_j\n||]</marimo-tex><span class=\"paragraph\">As the right term of the equation corresponds with a dot product, we can rewrite it in a simplified form:</span>\n<marimo-tex class=\"arithmatex\">||[\n    g_i(x_i) = w_0 + \\bold{w}^T \\bold{x}_i\n||]</marimo-tex></span>"}, "type": "data"}]}, {"code_hash": "81fed55bcffe0f1e0310f6d149148e2e", "console": [], "id": "jxvo", "outputs": [{"data": {"text/plain": ""}, "type": "data"}]}, {"code_hash": "918f7d1d62c39ecc546812208d397fbf", "console": [], "id": "mWxS", "outputs": [{"data": {"text/html": "<pre style='font-size: 12px'>np.int64(468831)</pre>"}, "type": "data"}]}, {"code_hash": "8f5dea037bfce46f5424d07cb4260bcd", "console": [], "id": "CcZR", "outputs": [{"data": {"text/html": "<span class=\"markdown prose dark:prose-invert\"><span class=\"paragraph\">If we want, we can simplify our expression even further by defining an extra feature that always equals <marimo-tex class=\"arithmatex\">||(1||)</marimo-tex>. By doing so, we'd get <marimo-tex class=\"arithmatex\">||(\\bold{w}||)</marimo-tex> and <marimo-tex class=\"arithmatex\">||(\\bold{x}||)</marimo-tex> vectors with <marimo-tex class=\"arithmatex\">||(n+1||)</marimo-tex> elements:</span>\n<marimo-tex class=\"arithmatex\">||[\n    w = [w_0, w_1, ..., w_n]\n||]</marimo-tex><marimo-tex class=\"arithmatex\">||[\n    x_i = [1, x_{i1}, x_{i2}, ..., x_{in}]\n||]</marimo-tex><span class=\"paragraph\">Therefore, our estimator could be written as:</span>\n<marimo-tex class=\"arithmatex\">||[\n    g_i(x_i) = \\bold{w}^T \\bold{x}_i\n||]</marimo-tex></span>"}, "type": "data"}]}, {"code_hash": "e8309b7e27fc0c90bf983bf69b274468", "console": [], "id": "YWSi", "outputs": [{"data": {"text/plain": ""}, "type": "data"}]}, {"code_hash": "bd2191e4ea0d293920abe067ee13a2b2", "console": [], "id": "zlud", "outputs": [{"data": {"text/html": "<pre style='font-size: 12px'>np.int64(468831)</pre>"}, "type": "data"}]}, {"code_hash": "8b7032d2d2a6e17c2cf786d18acac8ca", "console": [], "id": "tZnO", "outputs": [{"data": {"text/html": "<span class=\"markdown prose dark:prose-invert\"><span class=\"paragraph\">We can write our <marimo-tex class=\"arithmatex\">||(g||)</marimo-tex> function for all samples as a matrix multiplication.</span>\n<marimo-tex class=\"arithmatex\">||[\n\\bold{y_p} = \n\\begin{bmatrix}\n1 &amp; x_{11} &amp; x_{12} &amp; \\cdots &amp; x_{1n} \\\\\n1 &amp; x_{21} &amp; x_{22} &amp; \\cdots &amp; x_{2n} \\\\\n\\vdots &amp; \\vdots &amp; \\vdots &amp; \\ddots &amp; \\vdots \\\\\n1 &amp; x_{m1} &amp; x_{m2} &amp; \\cdots &amp; x_{mn}\n\\end{bmatrix}\n\\begin{bmatrix}\nw_0 \\\\\nw_1 \\\\\nw_2 \\\\\n\\vdots \\\\\nw_n\n\\end{bmatrix}\n=\n\\begin{bmatrix}\n\\bold{x_1}^T \u00b7 \\bold{w} \\\\\n\\bold{x_2}^T \u00b7 \\bold{w} \\\\\n\\vdots \\\\\n\\bold{x_m}^T \u00b7 \\bold{w} \\\\\n\\end{bmatrix}\n||]</marimo-tex></span>"}, "type": "data"}]}, {"code_hash": "2a4d75b3ef3613b0783fd3307a4dd124", "console": [], "id": "xvXZ", "outputs": [{"data": {"text/html": "<pre style='font-size: 12px'>array([[1.000e+00, 4.530e+02, 1.100e+01, 8.600e+01],\n       [1.000e+00, 1.820e+02, 2.000e+01, 1.385e+03],\n       [1.000e+00, 1.620e+02, 2.000e+01, 4.360e+02],\n       [1.000e+00, 5.530e+02, 1.600e+01, 2.774e+03],\n       [1.000e+00, 2.720e+02, 1.800e+01, 3.105e+03]])</pre>"}, "type": "data"}]}, {"code_hash": "a07074f5d180c282b18b9af0c1e143d8", "console": [], "id": "CLip", "outputs": [{"data": {"text/html": "<pre style='font-size: 12px'>array([479775,  33669,  27999, 198972,  53200])</pre>"}, "type": "data"}]}, {"code_hash": "645076ba5755c55b8f0c550cda88a859", "console": [], "id": "YECM", "outputs": [{"data": {"application/json": "[\"text/plain+float:7.5\", \"text/plain+float:0.01\", \"text/plain+float:0.07\", \"text/plain+float:0.003\"]"}, "type": "data"}]}, {"code_hash": "b3ee810c904262cfed6e544c3b589f60", "console": [], "id": "cEAS", "outputs": [{"data": {"text/html": "<pre style='font-size: 12px'>array([    468831,    2884896,     137035, 5747322894, 1074369697])</pre>"}, "type": "data"}]}, {"code_hash": "86af77028e786426b99141ca20ae84ab", "console": [], "id": "iXej", "outputs": [{"data": {"text/html": "<span class=\"markdown prose dark:prose-invert\"><h2 id=\"training-a-linear-regression-model\">Training a Linear Regression Model</h2>\n<span class=\"paragraph\">We already saw that our <marimo-tex class=\"arithmatex\">||(g||)</marimo-tex> estimator looks like this:</span>\n<marimo-tex class=\"arithmatex\">||[\n    \\bold{X} \\bold{w} \\approx \\bold{y}\n||]</marimo-tex><span class=\"paragraph\">So now we have to solve <marimo-tex class=\"arithmatex\">||(\\bold{w}||)</marimo-tex> so that we can find the weights.</span>\n<marimo-tex class=\"arithmatex\">||[\n    \\bold{X}^{-1} \\bold{X} \\bold{w} \\approx \\bold{X}^{-1} \\bold{y}\n||]</marimo-tex><span class=\"paragraph\">What gives us:</span>\n<marimo-tex class=\"arithmatex\">||[\n    \\bold{w} \\approx \\bold{X}^{-1} \\bold{y}\n||]</marimo-tex><span class=\"paragraph\">But there is an issue: we are working with a rectangular matrix, not with a squared one. So we won't be able to find its inverse.</span></span>"}, "type": "data"}]}, {"code_hash": "28635777c953143e667f88de51502b37", "console": [], "id": "EJmg", "outputs": [{"data": {"text/html": "<span class=\"markdown prose dark:prose-invert\"><h3 id=\"gram-matrix\">Gram Matrix</h3>\n<span class=\"paragraph\">The first thing we can do to try to solve this is to take into account that <marimo-tex class=\"arithmatex\">||(X^T X||)</marimo-tex> is actually an squared matrix, it may have an inverse.</span>\n<span class=\"paragraph\">Therefore, we could start with:</span>\n<marimo-tex class=\"arithmatex\">||[\n    \\bold{X}^{T} \\bold{X} \\bold{w} \\approx \\bold{X}^{T} \\bold{y}\n||]</marimo-tex><span class=\"paragraph\">... and try to solve it with:</span>\n<marimo-tex class=\"arithmatex\">||[\n    (\\bold{X}^{T} \\bold{X})^{-1} \\bold{X}^{T} \\bold{X} \\bold{w} \\approx (\\bold{X}^{T} \\bold{X})^{-1} \\bold{X}^{T} \\bold{y}\n||]</marimo-tex><span class=\"paragraph\">... which simplifies to:</span>\n<marimo-tex class=\"arithmatex\">||[\n    \\bold{w} \\approx (\\bold{X}^{T} \\bold{X})^{-1} \\bold{X}^{T} \\bold{y}\n||]</marimo-tex></span>"}, "type": "data"}]}, {"code_hash": "bb334fae3d3c02585c613d74f6eee051", "console": [], "id": "UmEG", "outputs": [{"data": {"text/html": "<pre style='font-size: 12px'>array([ 1.39547397e+01,  3.05557355e-03, -2.05578865e-01, -5.48993909e-05])</pre>"}, "type": "data"}]}, {"code_hash": "84eda73bfa847c8e90106de98bbe020a", "console": [], "id": "vEBW", "outputs": [{"data": {"text/html": "<pre style='font-size: 12px'>array([475833,  30430,  30157, 199369,  54992])</pre>"}, "type": "data"}]}, {"code_hash": "07280031bd9f72fdb0f0cd494c0f48e0", "console": [], "id": "kLmu", "outputs": [{"data": {"text/html": "<span class=\"markdown prose dark:prose-invert\"><h2 id=\"baseline-model-for-car-price-prediction-project\">Baseline Model for Car Price Prediction Project</h2>\n<span class=\"paragraph\">We'll start by selecting all the numerical features from our train dataset.</span></span>"}, "type": "data"}]}, {"code_hash": "1b5c2882ed7c3bbacdffda4c8186281d", "console": [], "id": "IpqN", "outputs": [{"data": {"text/html": "<pre style='font-size: 12px'>array([[2008.,  148.,    4., ...,   33.,   24., 1385.],\n       [2012.,  132.,    4., ...,   32.,   25., 2031.],\n       [2016.,  148.,    4., ...,   37.,   28.,  640.],\n       ...,\n       [2015.,  285.,    6., ...,   22.,   17.,  549.],\n       [2014.,  563.,   12., ...,   21.,   13.,   86.],\n       [2017.,  200.,    4., ...,   31.,   22.,  873.]], shape=(7150, 7))</pre>"}, "type": "data"}]}, {"code_hash": "ca7e660269870d38f480de08536fee93", "console": [], "id": "dxZZ", "outputs": [{"data": {"text/html": "<pre style='font-size: 12px'>array([ 9.57574708,  9.887663  ,  9.89323518, ..., 10.45380308,\n       12.62248099, 10.54061978], shape=(7150,))</pre>"}, "type": "data"}]}, {"code_hash": "0af7e931ba22fc56522c57c5688746e7", "console": [], "id": "dlnW", "outputs": [{"data": {"text/html": "<span class=\"markdown prose dark:prose-invert\"><span class=\"paragraph\">Now, following the same formula we used in the previous section, we define our training function, which will take the features and target variable and return the corresponding weights.</span></span>"}, "type": "data"}]}, {"code_hash": "fdf6e3f3c72dd5e01e55346d24776cfc", "console": [], "id": "TTti", "outputs": [{"data": {"text/html": "<pre style='font-size: 12px'>array([ 3.67275761e-03,  9.47904876e-03, -1.46568227e-01,  1.69913041e-01,\n        1.30267631e-02,  1.39569715e-02, -6.34974935e-06])</pre>"}, "type": "data"}]}, {"code_hash": "4973aeb2216c22f3bcecbee3e9350be7", "console": [], "id": "RKFZ", "outputs": [{"data": {"text/html": "<pre style='font-size: 12px'>array([ 9.28740576,  9.48708636,  9.7692794 , ..., 10.42274956,\n       12.10892828, 10.1024808 ], shape=(7150,))</pre>"}, "type": "data"}]}, {"code_hash": "3c45a6c707fb43cff6558885fbe4e7c2", "console": [], "id": "IaQp", "outputs": [{"data": {"text/html": "<span class=\"markdown prose dark:prose-invert\"><span class=\"paragraph\">By plotting at the same time the target variable we used during training and our predictions, we can have a first idea about how good our model is.</span></span>"}, "type": "data"}]}, {"code_hash": "830afd834e08205c63e64a8db506e00c", "console": [], "id": "IWgg", "outputs": [{"data": {"image/png": "data:image/png;base64,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MmSIvv/97yslJUWDBg3SCy+8YBw/fvy4nE6nMjIyjLbExEQNHTpUeXl5kqS8vDwlJSUZQUeSMjIyFBkZqV27djX4uVVVVXK73UEbAACwJlPDzieffKLnnntON998szZu3KgpU6boF7/4hV566SVJktPplCTZ7fag19ntduOY0+lUSkpK0PGoqCglJycb59S1aNEiJSYmGlu3bt1C3TUAABAmTA07fr9ft912m379619r0KBBevjhh/XQQw9pxYoVLfq5c+bMUWlpqbGdOHGiRT8PAACYx9Sw07VrV/Xt2zeorU+fPioqKpIkpaamSpJcLlfQOS6XyziWmpqq06dPBx33+Xw6e/ascU5dMTExSkhICNoAAIA1mRp2vvnNb6qwsDCo7d///re6d+8uqWawcmpqqrZs2WIcd7vd2rVrlxwOhyTJ4XCopKRE+fn5xjnvvfee/H6/hg4d2gq9AAAA4czU2VgzZszQ8OHD9etf/1o/+MEPtHv3bj3//PN6/vnnJUkRERGaPn26nnzySd18883q0aOH5s2bp7S0NN1///2Saq4E3XPPPcbtL6/Xq6lTp2rs2LHMxAIAAOaGnW984xt68803NWfOHC1YsEA9evTQsmXLNG7cOOOcRx55ROXl5Xr44YdVUlKiESNGaMOGDYqNjTXO+ctf/qKpU6fqrrvuUmRkpMaMGaNnnnnGjC4BAIAwExEIBAJmF2E2t9utxMRElZaWhnT8zvbt2zVtmpSUNMJoKynZrmeflUaMGHGJVwIAgMu50p/fpj8uAgAAoCURdgAAgKURdgAAgKURdgAAgKURdgAAgKURdgAAgKURdgAAgKURdgAAgKURdgAAgKURdgAAgKURdgAAgKURdgAAgKURdgAAgKURdgAAgKURdgAAgKURdgAAgKURdgAAgKURdgAAgKURdgAAgKURdgAAgKURdgAAgKURdgAAgKURdgAAgKURdgAAgKURdgAAgKURdgAAgKURdgAAgKURdgAAgKURdgAAgKURdgAAgKURdgAAgKURdgAAgKURdgAAgKURdgAAgKURdgAAgKURdgAAgKURdgAAgKURdgAAgKURdgAAgKWZGnYef/xxRUREBG29e/c2jldWVionJ0edO3dWhw4dNGbMGLlcrqD3KCoqUnZ2ttq3b6+UlBTNmjVLPp+vtbsCAADCVJTZBfTr10+bN2829qOivippxowZ+sc//qHXX39diYmJmjp1qkaPHq3//d//lSRVV1crOztbqamp2rFjh06dOqUJEybIZrPp17/+dav3BQAAhB/Tw05UVJRSU1PrtZeWlmrlypVas2aN7rzzTknSqlWr1KdPH+3cuVPDhg3Tu+++q8OHD2vz5s2y2+0aOHCgFi5cqNmzZ+vxxx9XdHR0a3cHAACEGdPH7Bw9elRpaWnq2bOnxo0bp6KiIklSfn6+vF6vMjIyjHN79+6t9PR05eXlSZLy8vLUv39/2e1245ysrCy53W4dOnSodTsCAADCkqlXdoYOHarVq1erV69eOnXqlJ544gl961vf0sGDB+V0OhUdHa2kpKSg19jtdjmdTkmS0+kMCjq1x2uPNaaqqkpVVVXGvtvtDlGPAABAuDE17IwcOdL484ABAzR06FB1795df/vb3xQXF9din7to0SI98cQTLfb+AAAgfJh+G+tiSUlJ+vrXv65jx44pNTVVHo9HJSUlQee4XC5jjE9qamq92Vm1+w2NA6o1Z84clZaWGtuJEydC2xEAABA2wirslJWV6eOPP1bXrl01ePBg2Ww2bdmyxTheWFiooqIiORwOSZLD4VBBQYFOnz5tnLNp0yYlJCSob9++jX5OTEyMEhISgjYAAGBNpt7G+u///m/dd9996t69u4qLi/XYY4+pXbt2euCBB5SYmKjJkydr5syZSk5OVkJCgqZNmyaHw6Fhw4ZJkjIzM9W3b1+NHz9eS5YskdPp1Ny5c5WTk6OYmBgzuwYAAMKEqWHns88+0wMPPKAzZ86oS5cuGjFihHbu3KkuXbpIkpYuXarIyEiNGTNGVVVVysrK0vLly43Xt2vXTuvWrdOUKVPkcDgUHx+viRMnasGCBWZ1CQAAhBlTw85rr712yeOxsbHKzc1Vbm5uo+d0795d69evD3VpAADAIsJqzA4AAECoEXYAAIClEXYAAIClEXYAAIClEXYAAIClEXYAAIClEXYAAIClEXYAAIClEXYAAIClEXYAAIClEXYAAIClEXYAAIClEXYAAIClEXYAAIClEXYAAIClEXYAAIClRZldAIAr9/Px41XmctVr72C3a/krr5hQEQCEP8IO0IaUuVx6efjweu0TduwwoRoAaBu4jQUAACyNsAMAACyNsAMAACyNsAMAACyNsAMAACyNsAMAACyNsAMAACyN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+/fvN7a0tDTNmjVLGzduNLu8VvHZZ5/pzJkz6tq1q9mlSOI2Vpt033336amnnlJ6err69eunf/3rX3r66ac1adIks0trERs3blQgEFCvXr107NgxzZo1S71799aDDz5odmlXraysLOg3n+PHj2v//v1KTk5Wenq6pk+frieffFI333yzevTooXnz5iktLU3333+/eUVfhcv19+zZsyoqKjLWmiksLJRUc5WrLV7NulR/u3btqu9973vat2+f1q1bp+rqamMsVnJysqKjo80qu9ku1d/OnTvrqaee0ne/+1117dpVX3zxhXJzc3Xy5El9//vfN7Hq5rnc/8t1g6vNZlNqaqp69erV2qWGxKX6m5ycrCeeeEJjxoxRamqqPv74Yz3yyCO66aablJWVZWLVFzF7Ohiazu12B375y18G0tPTA7GxsYGePXsGHn300UBVVZXZpbWIv/71r4GePXsGoqOjA6mpqYGcnJxASUmJ2WWFxD//+c+ApHrbxIkTA4FAzfTzefPmBex2eyAmJiZw1113BQoLC80t+ipcrr+rVq1q8Phjjz1mat3Ndan+1k6vb2j75z//aXbpzXKp/l64cCHwn//5n4G0tLRAdHR0oGvXroHvfve7gd27d5tddrNc7v/lutr61PNL9beioiKQmZkZ6NKlS8BmswW6d+8eeOihhwJOp9Pssg0RgYBFl90FAAAQY3YAAIDFEXYAAIClEXYAAIClEXYAAIClEXYAAIClEXYAAIClEXYAAIClEXYAAIClEXYAAIClEXYAAIClEXYAAIClEXYAAICl/f8X3PIGcYpR8QAAAABJRU5ErkJggg=="}, "type": "data"}]}, {"code_hash": "54dd5430d7a2e9b018abcfbc88e6d70d", "console": [], "id": "fCoF", "outputs": [{"data": {"text/html": "<span class=\"markdown prose dark:prose-invert\"><h2 id=\"root-mean-squared-error\">Root Mean Squared Error</h2>\n<span class=\"paragraph\">In order to measure how good our model performs, we'll use <code>RMSE</code>, which is a metric that will tell us how good (or bad) our model predicted by checking the average of the squared difference between our predictions<code>g(x_i)</code> and the target values <code>y_i</code>:</span>\n<marimo-tex class=\"arithmatex\">||[\n    RMSE = \\frac{1}{n} \\sum_{i=0}^n (g(x_i) - y_i)^2\n||]</marimo-tex></span>"}, "type": "data"}]}, {"code_hash": "581e84edbe6a12a0027d415cfa464f2d", "console": [], "id": "LkGn", "outputs": [{"data": {"text/plain": ""}, "type": "data"}]}, {"code_hash": "62ed0fb29e2a565c432bcc9dee8e0fe4", "console": [], "id": "zVRe", "outputs": [{"data": {"text/html": "<pre style='font-size: 12px'>np.float64(0.5231390456764362)</pre>"}, "type": "data"}]}, {"code_hash": "ad2c707619d4962e58a8ae1bdf0dbc6a", "console": [], "id": "woaO", "outputs": [{"data": {"text/html": "<span class=\"markdown prose dark:prose-invert\"><h2 id=\"using-rmse-on-validation-data\">Using RMSE on Validation Data</h2>\n<span class=\"paragraph\">In the previous chapter we used <code>RMSE</code> on the same dataset we used to train our model, which isn't what we want. Instead, we want to use the validate split we created already.</span></span>"}, "type": "data"}]}, {"code_hash": "0275a99740e0b1bac2cd7210410999d3", "console": [], "id": "HnMC", "outputs": [{"data": {"text/html": "<pre style='font-size: 12px'>array([ 9.88659101, 10.39074711,  9.9650793 , ..., 10.55958647,\n        9.82649965, 10.50283991], shape=(2382,))</pre>"}, "type": "data"}]}, {"code_hash": "84b16d4da557ea11848ae5ae9ce7737d", "console": [], "id": "wadT", "outputs": [{"data": {"text/html": "<pre style='font-size: 12px'>np.float64(0.5213707592286727)</pre>"}, "type": "data"}]}, {"code_hash": "1c17a1cad31eb6de3654f28b6c297d98", "console": [], "id": "VCRE", "outputs": [{"data": {"text/html": "<span class=\"markdown prose dark:prose-invert\"><h2 id=\"feature-engineering\">Feature Engineering</h2>\n<span class=\"paragraph\">Let's add a feature that computes the age of the cars.</span></span>"}, "type": "data"}]}, {"code_hash": "6590f0869d30389878d81ca441d77f23", "console": [], "id": "hgqU", "outputs": [{"data": {"text/plain": ""}, "type": "data"}]}, {"code_hash": "865d1e1b6eef6b02e8a9839fc752197f", "console": [], "id": "PSUk", "outputs": [{"data": {"text/html": "<pre style='font-size: 12px'>array([[2008.,  148.,    4., ...,   24., 1385.,   17.],\n       [2012.,  132.,    4., ...,   25., 2031.,   13.],\n       [2016.,  148.,    4., ...,   28.,  640.,    9.],\n       ...,\n       [2015.,  285.,    6., ...,   17.,  549.,   10.],\n       [2014.,  563.,   12., ...,   13.,   86.,   11.],\n       [2017.,  200.,    4., ...,   22.,  873.,    8.]], shape=(7150, 8))</pre>"}, "type": "data"}]}, {"code_hash": "d78ccea0cc594bf6a5f81a187c8435b9", "console": [], "id": "mfOT", "outputs": [{"data": {"text/html": "<span class=\"markdown prose dark:prose-invert\"><span class=\"paragraph\">Retraining our model we can see how it performs better with the additional feature.</span></span>"}, "type": "data"}]}, {"code_hash": "75e8b22c19685a3359646899af058956", "console": [], "id": "vGiW", "outputs": [{"data": {"text/plain": ""}, "type": "data"}]}, {"code_hash": "b968b539defe806a265d4aad0c8b2e4a", "console": [], "id": "SYQT", "outputs": [{"data": {"text/html": "<pre style='font-size: 12px'>np.float64(0.26710652513734223)</pre>"}, "type": "data"}]}, {"code_hash": "f4a6efbe176c532601f0d633b43e7da7", "console": [], "id": "bMrW", "outputs": [{"data": {"image/png": "data:image/png;base64,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"}, "type": "data"}]}, {"code_hash": "abdb959de1f3c38dc6a30e1760218677", "console": [], "id": "PSQn", "outputs": [{"data": {"text/html": "<span class=\"markdown prose dark:prose-invert\"><h2 id=\"categorical-variables\">Categorical Variables</h2></span>"}, "type": "data"}]}, {"code_hash": "c09b9a7dd9892caaddd5355c38a78702", "console": [], "id": "OfTS", "outputs": [{"data": {"text/html": "<marimo-ui-element object-id='OfTS-0' random-id='cac06f24-b298-0fa8-4cc9-046a0c879cd8'><marimo-table data-initial-value='[]' data-label='null' data-data='&quot;[{&#92;&quot;make&#92;&quot;:&#92;&quot;chevrolet&#92;&quot;,&#92;&quot;model&#92;&quot;:&#92;&quot;cobalt&#92;&quot;,&#92;&quot;year&#92;&quot;:2008,&#92;&quot;engine_fuel_type&#92;&quot;:&#92;&quot;regular_unleaded&#92;&quot;,&#92;&quot;engine_hp&#92;&quot;:148.0,&#92;&quot;engine_cylinders&#92;&quot;:4.0,&#92;&quot;transmission_type&#92;&quot;:&#92;&quot;manual&#92;&quot;,&#92;&quot;driven_wheels&#92;&quot;:&#92;&quot;front_wheel_drive&#92;&quot;,&#92;&quot;number_of_doors&#92;&quot;:2.0,&#92;&quot;market_category&#92;&quot;:0,&#92;&quot;vehicle_size&#92;&quot;:&#92;&quot;compact&#92;&quot;,&#92;&quot;vehicle_style&#92;&quot;:&#92;&quot;coupe&#92;&quot;,&#92;&quot;highway_mpg&#92;&quot;:33,&#92;&quot;city_mpg&#92;&quot;:24,&#92;&quot;popularity&#92;&quot;:1385,&#92;&quot;number_of_doors_2&#92;&quot;:1,&#92;&quot;number_of_doors_3&#92;&quot;:0,&#92;&quot;number_of_doors_4&#92;&quot;:0},{&#92;&quot;make&#92;&quot;:&#92;&quot;toyota&#92;&quot;,&#92;&quot;model&#92;&quot;:&#92;&quot;matrix&#92;&quot;,&#92;&quot;year&#92;&quot;:2012,&#92;&quot;engine_fuel_type&#92;&quot;:&#92;&quot;regular_unleaded&#92;&quot;,&#92;&quot;engine_hp&#92;&quot;:132.0,&#92;&quot;engine_cylinders&#92;&quot;:4.0,&#92;&quot;transmission_type&#92;&quot;:&#92;&quot;automatic&#92;&quot;,&#92;&quot;driven_wheels&#92;&quot;:&#92;&quot;front_wheel_drive&#92;&quot;,&#92;&quot;number_of_doors&#92;&quot;:4.0,&#92;&quot;market_category&#92;&quot;:&#92;&quot;hatchback&#92;&quot;,&#92;&quot;vehicle_size&#92;&quot;:&#92;&quot;compact&#92;&quot;,&#92;&quot;vehicle_style&#92;&quot;:&#92;&quot;4dr_hatchback&#92;&quot;,&#92;&quot;highway_mpg&#92;&quot;:32,&#92;&quot;city_mpg&#92;&quot;:25,&#92;&quot;popularity&#92;&quot;:2031,&#92;&quot;number_of_doors_2&#92;&quot;:0,&#92;&quot;number_of_doors_3&#92;&quot;:0,&#92;&quot;number_of_doors_4&#92;&quot;:1},{&#92;&quot;make&#92;&quot;:&#92;&quot;subaru&#92;&quot;,&#92;&quot;model&#92;&quot;:&#92;&quot;impreza&#92;&quot;,&#92;&quot;year&#92;&quot;:2016,&#92;&quot;engine_fuel_type&#92;&quot;:&#92;&quot;regular_unleaded&#92;&quot;,&#92;&quot;engine_hp&#92;&quot;:148.0,&#92;&quot;engine_cylinders&#92;&quot;:4.0,&#92;&quot;transmission_type&#92;&quot;:&#92;&quot;automatic&#92;&quot;,&#92;&quot;driven_wheels&#92;&quot;:&#92;&quot;all_wheel_drive&#92;&quot;,&#92;&quot;number_of_doors&#92;&quot;:4.0,&#92;&quot;market_category&#92;&quot;:&#92;&quot;hatchback&#92;&quot;,&#92;&quot;vehicle_size&#92;&quot;:&#92;&quot;compact&#92;&quot;,&#92;&quot;vehicle_style&#92;&quot;:&#92;&quot;4dr_hatchback&#92;&quot;,&#92;&quot;highway_mpg&#92;&quot;:37,&#92;&quot;city_mpg&#92;&quot;:28,&#92;&quot;popularity&#92;&quot;:640,&#92;&quot;number_of_doors_2&#92;&quot;:0,&#92;&quot;number_of_doors_3&#92;&quot;:0,&#92;&quot;number_of_doors_4&#92;&quot;:1},{&#92;&quot;make&#92;&quot;:&#92;&quot;volkswagen&#92;&quot;,&#92;&quot;model&#92;&quot;:&#92;&quot;vanagon&#92;&quot;,&#92;&quot;year&#92;&quot;:1991,&#92;&quot;engine_fuel_type&#92;&quot;:&#92;&quot;regular_unleaded&#92;&quot;,&#92;&quot;engine_hp&#92;&quot;:90.0,&#92;&quot;engine_cylinders&#92;&quot;:4.0,&#92;&quot;transmission_type&#92;&quot;:&#92;&quot;manual&#92;&quot;,&#92;&quot;driven_wheels&#92;&quot;:&#92;&quot;rear_wheel_drive&#92;&quot;,&#92;&quot;number_of_doors&#92;&quot;:3.0,&#92;&quot;market_category&#92;&quot;:0,&#92;&quot;vehicle_size&#92;&quot;:&#92;&quot;large&#92;&quot;,&#92;&quot;vehicle_style&#92;&quot;:&#92;&quot;passenger_minivan&#92;&quot;,&#92;&quot;highway_mpg&#92;&quot;:18,&#92;&quot;city_mpg&#92;&quot;:16,&#92;&quot;popularity&#92;&quot;:873,&#92;&quot;number_of_doors_2&#92;&quot;:0,&#92;&quot;number_of_doors_3&#92;&quot;:1,&#92;&quot;number_of_doors_4&#92;&quot;:0},{&#92;&quot;make&#92;&quot;:&#92;&quot;ford&#92;&quot;,&#92;&quot;model&#92;&quot;:&#92;&quot;f-150&#92;&quot;,&#92;&quot;year&#92;&quot;:2017,&#92;&quot;engine_fuel_type&#92;&quot;:&#92;&quot;flex-fuel_(unleaded/e85)&#92;&quot;,&#92;&quot;engine_hp&#92;&quot;:385.0,&#92;&quot;engine_cylinders&#92;&quot;:8.0,&#92;&quot;transmission_type&#92;&quot;:&#92;&quot;automatic&#92;&quot;,&#92;&quot;driven_wheels&#92;&quot;:&#92;&quot;four_wheel_drive&#92;&quot;,&#92;&quot;number_of_doors&#92;&quot;:4.0,&#92;&quot;market_category&#92;&quot;:&#92;&quot;flex_fuel&#92;&quot;,&#92;&quot;vehicle_size&#92;&quot;:&#92;&quot;large&#92;&quot;,&#92;&quot;vehicle_style&#92;&quot;:&#92;&quot;crew_cab_pickup&#92;&quot;,&#92;&quot;highway_mpg&#92;&quot;:21,&#92;&quot;city_mpg&#92;&quot;:15,&#92;&quot;popularity&#92;&quot;:5657,&#92;&quot;number_of_doors_2&#92;&quot;:0,&#92;&quot;number_of_doors_3&#92;&quot;:0,&#92;&quot;number_of_doors_4&#92;&quot;:1},{&#92;&quot;make&#92;&quot;:&#92;&quot;volkswagen&#92;&quot;,&#92;&quot;model&#92;&quot;:&#92;&quot;rabbit&#92;&quot;,&#92;&quot;year&#92;&quot;:2008,&#92;&quot;engine_fuel_type&#92;&quot;:&#92;&quot;regular_unleaded&#92;&quot;,&#92;&quot;engine_hp&#92;&quot;:170.0,&#92;&quot;engine_cylinders&#92;&quot;:5.0,&#92;&quot;transmission_type&#92;&quot;:&#92;&quot;manual&#92;&quot;,&#92;&quot;driven_wheels&#92;&quot;:&#92;&quot;front_wheel_drive&#92;&quot;,&#92;&quot;number_of_doors&#92;&quot;:4.0,&#92;&quot;market_category&#92;&quot;:&#92;&quot;hatchback&#92;&quot;,&#92;&quot;vehicle_size&#92;&quot;:&#92;&quot;compact&#92;&quot;,&#92;&quot;vehicle_style&#92;&quot;:&#92;&quot;4dr_hatchback&#92;&quot;,&#92;&quot;highway_mpg&#92;&quot;:29,&#92;&quot;city_mpg&#92;&quot;:22,&#92;&quot;popularity&#92;&quot;:873,&#92;&quot;number_of_doors_2&#92;&quot;:0,&#92;&quot;number_of_doors_3&#92;&quot;:0,&#92;&quot;number_of_doors_4&#92;&quot;:1},{&#92;&quot;make&#92;&quot;:&#92;&quot;bentley&#92;&quot;,&#92;&quot;model&#92;&quot;:&#92;&quot;continental_gtc&#92;&quot;,&#92;&quot;year&#92;&quot;:2013,&#92;&quot;engine_fuel_type&#92;&quot;:&#92;&quot;premium_unleaded_(required)&#92;&quot;,&#92;&quot;engine_hp&#92;&quot;:500.0,&#92;&quot;engine_cylinders&#92;&quot;:8.0,&#92;&quot;transmission_type&#92;&quot;:&#92;&quot;automatic&#92;&quot;,&#92;&quot;driven_wheels&#92;&quot;:&#92;&quot;all_wheel_drive&#92;&quot;,&#92;&quot;number_of_doors&#92;&quot;:2.0,&#92;&quot;market_category&#92;&quot;:&#92;&quot;exotic,luxury,high-performance&#92;&quot;,&#92;&quot;vehicle_size&#92;&quot;:&#92;&quot;midsize&#92;&quot;,&#92;&quot;vehicle_style&#92;&quot;:&#92;&quot;convertible&#92;&quot;,&#92;&quot;highway_mpg&#92;&quot;:24,&#92;&quot;city_mpg&#92;&quot;:14,&#92;&quot;popularity&#92;&quot;:520,&#92;&quot;number_of_doors_2&#92;&quot;:1,&#92;&quot;number_of_doors_3&#92;&quot;:0,&#92;&quot;number_of_doors_4&#92;&quot;:0},{&#92;&quot;make&#92;&quot;:&#92;&quot;bmw&#92;&quot;,&#92;&quot;model&#92;&quot;:&#92;&quot;6_series&#92;&quot;,&#92;&quot;year&#92;&quot;:2015,&#92;&quot;engine_fuel_type&#92;&quot;:&#92;&quot;premium_unleaded_(required)&#92;&quot;,&#92;&quot;engine_hp&#92;&quot;:315.0,&#92;&quot;engine_cylinders&#92;&quot;:6.0,&#92;&quot;transmission_type&#92;&quot;:&#92;&quot;automatic&#92;&quot;,&#92;&quot;driven_wheels&#92;&quot;:&#92;&quot;rear_wheel_drive&#92;&quot;,&#92;&quot;number_of_doors&#92;&quot;:2.0,&#92;&quot;market_category&#92;&quot;:&#92;&quot;luxury,performance&#92;&quot;,&#92;&quot;vehicle_size&#92;&quot;:&#92;&quot;midsize&#92;&quot;,&#92;&quot;vehicle_style&#92;&quot;:&#92;&quot;coupe&#92;&quot;,&#92;&quot;highway_mpg&#92;&quot;:32,&#92;&quot;city_mpg&#92;&quot;:21,&#92;&quot;popularity&#92;&quot;:3916,&#92;&quot;number_of_doors_2&#92;&quot;:1,&#92;&quot;number_of_doors_3&#92;&quot;:0,&#92;&quot;number_of_doors_4&#92;&quot;:0},{&#92;&quot;make&#92;&quot;:&#92;&quot;maybach&#92;&quot;,&#92;&quot;model&#92;&quot;:&#92;&quot;57&#92;&quot;,&#92;&quot;year&#92;&quot;:2012,&#92;&quot;engine_fuel_type&#92;&quot;:&#92;&quot;premium_unleaded_(required)&#92;&quot;,&#92;&quot;engine_hp&#92;&quot;:543.0,&#92;&quot;engine_cylinders&#92;&quot;:12.0,&#92;&quot;transmission_type&#92;&quot;:&#92;&quot;automatic&#92;&quot;,&#92;&quot;driven_wheels&#92;&quot;:&#92;&quot;rear_wheel_drive&#92;&quot;,&#92;&quot;number_of_doors&#92;&quot;:4.0,&#92;&quot;market_category&#92;&quot;:&#92;&quot;exotic,luxury&#92;&quot;,&#92;&quot;vehicle_size&#92;&quot;:&#92;&quot;large&#92;&quot;,&#92;&quot;vehicle_style&#92;&quot;:&#92;&quot;sedan&#92;&quot;,&#92;&quot;highway_mpg&#92;&quot;:16,&#92;&quot;city_mpg&#92;&quot;:10,&#92;&quot;popularity&#92;&quot;:67,&#92;&quot;number_of_doors_2&#92;&quot;:0,&#92;&quot;number_of_doors_3&#92;&quot;:0,&#92;&quot;number_of_doors_4&#92;&quot;:1},{&#92;&quot;make&#92;&quot;:&#92;&quot;ford&#92;&quot;,&#92;&quot;model&#92;&quot;:&#92;&quot;f-150_heritage&#92;&quot;,&#92;&quot;year&#92;&quot;:2004,&#92;&quot;engine_fuel_type&#92;&quot;:&#92;&quot;regular_unleaded&#92;&quot;,&#92;&quot;engine_hp&#92;&quot;:202.0,&#92;&quot;engine_cylinders&#92;&quot;:6.0,&#92;&quot;transmission_type&#92;&quot;:&#92;&quot;manual&#92;&quot;,&#92;&quot;driven_wheels&#92;&quot;:&#92;&quot;four_wheel_drive&#92;&quot;,&#92;&quot;number_of_doors&#92;&quot;:2.0,&#92;&quot;market_category&#92;&quot;:0,&#92;&quot;vehicle_size&#92;&quot;:&#92;&quot;large&#92;&quot;,&#92;&quot;vehicle_style&#92;&quot;:&#92;&quot;regular_cab_pickup&#92;&quot;,&#92;&quot;highway_mpg&#92;&quot;:18,&#92;&quot;city_mpg&#92;&quot;:13,&#92;&quot;popularity&#92;&quot;:5657,&#92;&quot;number_of_doors_2&#92;&quot;:1,&#92;&quot;number_of_doors_3&#92;&quot;:0,&#92;&quot;number_of_doors_4&#92;&quot;:0}]&quot;' data-total-rows='7150' data-total-columns='18' data-max-columns='50' data-banner-text='&quot;&quot;' data-pagination='true' data-page-size='10' data-field-types='[[&quot;make&quot;,[&quot;string&quot;,&quot;object&quot;]],[&quot;model&quot;,[&quot;string&quot;,&quot;object&quot;]],[&quot;year&quot;,[&quot;integer&quot;,&quot;int64&quot;]],[&quot;engine_fuel_type&quot;,[&quot;string&quot;,&quot;object&quot;]],[&quot;engine_hp&quot;,[&quot;number&quot;,&quot;float64&quot;]],[&quot;engine_cylinders&quot;,[&quot;number&quot;,&quot;float64&quot;]],[&quot;transmission_type&quot;,[&quot;string&quot;,&quot;object&quot;]],[&quot;driven_wheels&quot;,[&quot;string&quot;,&quot;object&quot;]],[&quot;number_of_doors&quot;,[&quot;number&quot;,&quot;float64&quot;]],[&quot;market_category&quot;,[&quot;string&quot;,&quot;object&quot;]],[&quot;vehicle_size&quot;,[&quot;string&quot;,&quot;object&quot;]],[&quot;vehicle_style&quot;,[&quot;string&quot;,&quot;object&quot;]],[&quot;highway_mpg&quot;,[&quot;integer&quot;,&quot;int64&quot;]],[&quot;city_mpg&quot;,[&quot;integer&quot;,&quot;int64&quot;]],[&quot;popularity&quot;,[&quot;integer&quot;,&quot;int64&quot;]],[&quot;number_of_doors_2&quot;,[&quot;integer&quot;,&quot;int64&quot;]],[&quot;number_of_doors_3&quot;,[&quot;integer&quot;,&quot;int64&quot;]],[&quot;number_of_doors_4&quot;,[&quot;integer&quot;,&quot;int64&quot;]]]' data-show-filters='true' data-show-download='true' data-show-column-summaries='true' data-show-data-types='true' data-show-page-size-selector='true' data-show-column-explorer='true' data-show-chart-builder='true' data-row-headers='[]' data-has-stable-row-id='false' data-lazy='false' data-preload='false'></marimo-table></marimo-ui-element>"}, "type": "data"}]}, {"code_hash": "79d6ad92f10389e55103274d17be2168", "console": [], "id": "lQxp", "outputs": [{"data": {"text/html": "<marimo-ui-element object-id='lQxp-0' random-id='259c349c-1575-53c4-b086-e37860f7ca3c'><marimo-table data-initial-value='[]' data-label='null' data-data='&quot;[{&#92;&quot;year&#92;&quot;:2011,&#92;&quot;engine_hp&#92;&quot;:335.0,&#92;&quot;engine_cylinders&#92;&quot;:6.0,&#92;&quot;highway_mpg&#92;&quot;:26,&#92;&quot;city_mpg&#92;&quot;:19,&#92;&quot;popularity&#92;&quot;:3916,&#92;&quot;msrp&#92;&quot;:46135,&#92;&quot;age&#92;&quot;:14,&#92;&quot;number_of_doors_2&#92;&quot;:1,&#92;&quot;number_of_doors_3&#92;&quot;:0,&#92;&quot;number_of_doors_4&#92;&quot;:0,&#92;&quot;make_alfa_romeo&#92;&quot;:0,&#92;&quot;make_aston_martin&#92;&quot;:0,&#92;&quot;make_audi&#92;&quot;:0,&#92;&quot;make_bentley&#92;&quot;:0,&#92;&quot;make_bmw&#92;&quot;:1,&#92;&quot;make_bugatti&#92;&quot;:0,&#92;&quot;make_buick&#92;&quot;:0,&#92;&quot;make_cadillac&#92;&quot;:0,&#92;&quot;make_chevrolet&#92;&quot;:0,&#92;&quot;make_chrysler&#92;&quot;:0,&#92;&quot;make_dodge&#92;&quot;:0,&#92;&quot;make_ferrari&#92;&quot;:0,&#92;&quot;make_fiat&#92;&quot;:0,&#92;&quot;make_ford&#92;&quot;:0,&#92;&quot;make_genesis&#92;&quot;:0,&#92;&quot;make_gmc&#92;&quot;:0,&#92;&quot;make_honda&#92;&quot;:0,&#92;&quot;make_hummer&#92;&quot;:0,&#92;&quot;make_hyundai&#92;&quot;:0,&#92;&quot;make_infiniti&#92;&quot;:0,&#92;&quot;make_kia&#92;&quot;:0,&#92;&quot;make_lamborghini&#92;&quot;:0,&#92;&quot;make_land_rover&#92;&quot;:0,&#92;&quot;make_lexus&#92;&quot;:0,&#92;&quot;make_lincoln&#92;&quot;:0,&#92;&quot;make_lotus&#92;&quot;:0,&#92;&quot;make_maserati&#92;&quot;:0,&#92;&quot;make_maybach&#92;&quot;:0,&#92;&quot;make_mazda&#92;&quot;:0,&#92;&quot;make_mclaren&#92;&quot;:0,&#92;&quot;make_mercedes-benz&#92;&quot;:0,&#92;&quot;make_mitsubishi&#92;&quot;:0,&#92;&quot;make_nissan&#92;&quot;:0,&#92;&quot;make_oldsmobile&#92;&quot;:0,&#92;&quot;make_plymouth&#92;&quot;:0,&#92;&quot;make_pontiac&#92;&quot;:0,&#92;&quot;make_porsche&#92;&quot;:0,&#92;&quot;make_rolls-royce&#92;&quot;:0,&#92;&quot;make_saab&#92;&quot;:0},{&#92;&quot;year&#92;&quot;:2011,&#92;&quot;engine_hp&#92;&quot;:300.0,&#92;&quot;engine_cylinders&#92;&quot;:6.0,&#92;&quot;highway_mpg&#92;&quot;:28,&#92;&quot;city_mpg&#92;&quot;:19,&#92;&quot;popularity&#92;&quot;:3916,&#92;&quot;msrp&#92;&quot;:40650,&#92;&quot;age&#92;&quot;:14,&#92;&quot;number_of_doors_2&#92;&quot;:1,&#92;&quot;number_of_doors_3&#92;&quot;:0,&#92;&quot;number_of_doors_4&#92;&quot;:0,&#92;&quot;make_alfa_romeo&#92;&quot;:0,&#92;&quot;make_aston_martin&#92;&quot;:0,&#92;&quot;make_audi&#92;&quot;:0,&#92;&quot;make_bentley&#92;&quot;:0,&#92;&quot;make_bmw&#92;&quot;:1,&#92;&quot;make_bugatti&#92;&quot;:0,&#92;&quot;make_buick&#92;&quot;:0,&#92;&quot;make_cadillac&#92;&quot;:0,&#92;&quot;make_chevrolet&#92;&quot;:0,&#92;&quot;make_chrysler&#92;&quot;:0,&#92;&quot;make_dodge&#92;&quot;:0,&#92;&quot;make_ferrari&#92;&quot;:0,&#92;&quot;make_fiat&#92;&quot;:0,&#92;&quot;make_ford&#92;&quot;:0,&#92;&quot;make_genesis&#92;&quot;:0,&#92;&quot;make_gmc&#92;&quot;:0,&#92;&quot;make_honda&#92;&quot;:0,&#92;&quot;make_hummer&#92;&quot;:0,&#92;&quot;make_hyundai&#92;&quot;:0,&#92;&quot;make_infiniti&#92;&quot;:0,&#92;&quot;make_kia&#92;&quot;:0,&#92;&quot;make_lamborghini&#92;&quot;:0,&#92;&quot;make_land_rover&#92;&quot;:0,&#92;&quot;make_lexus&#92;&quot;:0,&#92;&quot;make_lincoln&#92;&quot;:0,&#92;&quot;make_lotus&#92;&quot;:0,&#92;&quot;make_maserati&#92;&quot;:0,&#92;&quot;make_maybach&#92;&quot;:0,&#92;&quot;make_mazda&#92;&quot;:0,&#92;&quot;make_mclaren&#92;&quot;:0,&#92;&quot;make_mercedes-benz&#92;&quot;:0,&#92;&quot;make_mitsubishi&#92;&quot;:0,&#92;&quot;make_nissan&#92;&quot;:0,&#92;&quot;make_oldsmobile&#92;&quot;:0,&#92;&quot;make_plymouth&#92;&quot;:0,&#92;&quot;make_pontiac&#92;&quot;:0,&#92;&quot;make_porsche&#92;&quot;:0,&#92;&quot;make_rolls-royce&#92;&quot;:0,&#92;&quot;make_saab&#92;&quot;:0},{&#92;&quot;year&#92;&quot;:2011,&#92;&quot;engine_hp&#92;&quot;:300.0,&#92;&quot;engine_cylinders&#92;&quot;:6.0,&#92;&quot;highway_mpg&#92;&quot;:28,&#92;&quot;city_mpg&#92;&quot;:20,&#92;&quot;popularity&#92;&quot;:3916,&#92;&quot;msrp&#92;&quot;:36350,&#92;&quot;age&#92;&quot;:14,&#92;&quot;number_of_doors_2&#92;&quot;:1,&#92;&quot;number_of_doors_3&#92;&quot;:0,&#92;&quot;number_of_doors_4&#92;&quot;:0,&#92;&quot;make_alfa_romeo&#92;&quot;:0,&#92;&quot;make_aston_martin&#92;&quot;:0,&#92;&quot;make_audi&#92;&quot;:0,&#92;&quot;make_bentley&#92;&quot;:0,&#92;&quot;make_bmw&#92;&quot;:1,&#92;&quot;make_bugatti&#92;&quot;:0,&#92;&quot;make_buick&#92;&quot;:0,&#92;&quot;make_cadillac&#92;&quot;:0,&#92;&quot;make_chevrolet&#92;&quot;:0,&#92;&quot;make_chrysler&#92;&quot;:0,&#92;&quot;make_dodge&#92;&quot;:0,&#92;&quot;make_ferrari&#92;&quot;:0,&#92;&quot;make_fiat&#92;&quot;:0,&#92;&quot;make_ford&#92;&quot;:0,&#92;&quot;make_genesis&#92;&quot;:0,&#92;&quot;make_gmc&#92;&quot;:0,&#92;&quot;make_honda&#92;&quot;:0,&#92;&quot;make_hummer&#92;&quot;:0,&#92;&quot;make_hyundai&#92;&quot;:0,&#92;&quot;make_infiniti&#92;&quot;:0,&#92;&quot;make_kia&#92;&quot;:0,&#92;&quot;make_lamborghini&#92;&quot;:0,&#92;&quot;make_land_rover&#92;&quot;:0,&#92;&quot;make_lexus&#92;&quot;:0,&#92;&quot;make_lincoln&#92;&quot;:0,&#92;&quot;make_lotus&#92;&quot;:0,&#92;&quot;make_maserati&#92;&quot;:0,&#92;&quot;make_maybach&#92;&quot;:0,&#92;&quot;make_mazda&#92;&quot;:0,&#92;&quot;make_mclaren&#92;&quot;:0,&#92;&quot;make_mercedes-benz&#92;&quot;:0,&#92;&quot;make_mitsubishi&#92;&quot;:0,&#92;&quot;make_nissan&#92;&quot;:0,&#92;&quot;make_oldsmobile&#92;&quot;:0,&#92;&quot;make_plymouth&#92;&quot;:0,&#92;&quot;make_pontiac&#92;&quot;:0,&#92;&quot;make_porsche&#92;&quot;:0,&#92;&quot;make_rolls-royce&#92;&quot;:0,&#92;&quot;make_saab&#92;&quot;:0},{&#92;&quot;year&#92;&quot;:2011,&#92;&quot;engine_hp&#92;&quot;:230.0,&#92;&quot;engine_cylinders&#92;&quot;:6.0,&#92;&quot;highway_mpg&#92;&quot;:28,&#92;&quot;city_mpg&#92;&quot;:18,&#92;&quot;popularity&#92;&quot;:3916,&#92;&quot;msrp&#92;&quot;:29450,&#92;&quot;age&#92;&quot;:14,&#92;&quot;number_of_doors_2&#92;&quot;:1,&#92;&quot;number_of_doors_3&#92;&quot;:0,&#92;&quot;number_of_doors_4&#92;&quot;:0,&#92;&quot;make_alfa_romeo&#92;&quot;:0,&#92;&quot;make_aston_martin&#92;&quot;:0,&#92;&quot;make_audi&#92;&quot;:0,&#92;&quot;make_bentley&#92;&quot;:0,&#92;&quot;make_bmw&#92;&quot;:1,&#92;&quot;make_bugatti&#92;&quot;:0,&#92;&quot;make_buick&#92;&quot;:0,&#92;&quot;make_cadillac&#92;&quot;:0,&#92;&quot;make_chevrolet&#92;&quot;:0,&#92;&quot;make_chrysler&#92;&quot;:0,&#92;&quot;make_dodge&#92;&quot;:0,&#92;&quot;make_ferrari&#92;&quot;:0,&#92;&quot;make_fiat&#92;&quot;:0,&#92;&quot;make_ford&#92;&quot;:0,&#92;&quot;make_genesis&#92;&quot;:0,&#92;&quot;make_gmc&#92;&quot;:0,&#92;&quot;make_honda&#92;&quot;:0,&#92;&quot;make_hummer&#92;&quot;:0,&#92;&quot;make_hyundai&#92;&quot;:0,&#92;&quot;make_infiniti&#92;&quot;:0,&#92;&quot;make_kia&#92;&quot;:0,&#92;&quot;make_lamborghini&#92;&quot;:0,&#92;&quot;make_land_rover&#92;&quot;:0,&#92;&quot;make_lexus&#92;&quot;:0,&#92;&quot;make_lincoln&#92;&quot;:0,&#92;&quot;make_lotus&#92;&quot;:0,&#92;&quot;make_maserati&#92;&quot;:0,&#92;&quot;make_maybach&#92;&quot;:0,&#92;&quot;make_mazda&#92;&quot;:0,&#92;&quot;make_mclaren&#92;&quot;:0,&#92;&quot;make_mercedes-benz&#92;&quot;:0,&#92;&quot;make_mitsubishi&#92;&quot;:0,&#92;&quot;make_nissan&#92;&quot;:0,&#92;&quot;make_oldsmobile&#92;&quot;:0,&#92;&quot;make_plymouth&#92;&quot;:0,&#92;&quot;make_pontiac&#92;&quot;:0,&#92;&quot;make_porsche&#92;&quot;:0,&#92;&quot;make_rolls-royce&#92;&quot;:0,&#92;&quot;make_saab&#92;&quot;:0},{&#92;&quot;year&#92;&quot;:2011,&#92;&quot;engine_hp&#92;&quot;:230.0,&#92;&quot;engine_cylinders&#92;&quot;:6.0,&#92;&quot;highway_mpg&#92;&quot;:28,&#92;&quot;city_mpg&#92;&quot;:18,&#92;&quot;popularity&#92;&quot;:3916,&#92;&quot;msrp&#92;&quot;:34500,&#92;&quot;age&#92;&quot;:14,&#92;&quot;number_of_doors_2&#92;&quot;:1,&#92;&quot;number_of_doors_3&#92;&quot;:0,&#92;&quot;number_of_doors_4&#92;&quot;:0,&#92;&quot;make_alfa_romeo&#92;&quot;:0,&#92;&quot;make_aston_martin&#92;&quot;:0,&#92;&quot;make_audi&#92;&quot;:0,&#92;&quot;make_bentley&#92;&quot;:0,&#92;&quot;make_bmw&#92;&quot;:1,&#92;&quot;make_bugatti&#92;&quot;:0,&#92;&quot;make_buick&#92;&quot;:0,&#92;&quot;make_cadillac&#92;&quot;:0,&#92;&quot;make_chevrolet&#92;&quot;:0,&#92;&quot;make_chrysler&#92;&quot;:0,&#92;&quot;make_dodge&#92;&quot;:0,&#92;&quot;make_ferrari&#92;&quot;:0,&#92;&quot;make_fiat&#92;&quot;:0,&#92;&quot;make_ford&#92;&quot;:0,&#92;&quot;make_genesis&#92;&quot;:0,&#92;&quot;make_gmc&#92;&quot;:0,&#92;&quot;make_honda&#92;&quot;:0,&#92;&quot;make_hummer&#92;&quot;:0,&#92;&quot;make_hyundai&#92;&quot;:0,&#92;&quot;make_infiniti&#92;&quot;:0,&#92;&quot;make_kia&#92;&quot;:0,&#92;&quot;make_lamborghini&#92;&quot;:0,&#92;&quot;make_land_rover&#92;&quot;:0,&#92;&quot;make_lexus&#92;&quot;:0,&#92;&quot;make_lincoln&#92;&quot;:0,&#92;&quot;make_lotus&#92;&quot;:0,&#92;&quot;make_maserati&#92;&quot;:0,&#92;&quot;make_maybach&#92;&quot;:0,&#92;&quot;make_mazda&#92;&quot;:0,&#92;&quot;make_mclaren&#92;&quot;:0,&#92;&quot;make_mercedes-benz&#92;&quot;:0,&#92;&quot;make_mitsubishi&#92;&quot;:0,&#92;&quot;make_nissan&#92;&quot;:0,&#92;&quot;make_oldsmobile&#92;&quot;:0,&#92;&quot;make_plymouth&#92;&quot;:0,&#92;&quot;make_pontiac&#92;&quot;:0,&#92;&quot;make_porsche&#92;&quot;:0,&#92;&quot;make_rolls-royce&#92;&quot;:0,&#92;&quot;make_saab&#92;&quot;:0}]&quot;' data-total-rows='5' data-total-columns='92' data-max-columns='50' data-banner-text='&quot;Only showing 50 of 92 columns.&quot;' data-pagination='true' data-page-size='10' data-field-types='[[&quot;year&quot;,[&quot;integer&quot;,&quot;int64&quot;]],[&quot;engine_hp&quot;,[&quot;number&quot;,&quot;float64&quot;]],[&quot;engine_cylinders&quot;,[&quot;number&quot;,&quot;float64&quot;]],[&quot;highway_mpg&quot;,[&quot;integer&quot;,&quot;int64&quot;]],[&quot;city_mpg&quot;,[&quot;integer&quot;,&quot;int64&quot;]],[&quot;popularity&quot;,[&quot;integer&quot;,&quot;int64&quot;]],[&quot;msrp&quot;,[&quot;integer&quot;,&quot;int64&quot;]],[&quot;age&quot;,[&quot;integer&quot;,&quot;int64&quot;]],[&quot;number_of_doors_2&quot;,[&quot;integer&quot;,&quot;int64&quot;]],[&quot;number_of_doors_3&quot;,[&quot;integer&quot;,&quot;int64&quot;]],[&quot;number_of_doors_4&quot;,[&quot;integer&quot;,&quot;int64&quot;]],[&quot;make_alfa_romeo&quot;,[&quot;integer&quot;,&quot;int64&quot;]],[&quot;make_aston_martin&quot;,[&quot;integer&quot;,&quot;int64&quot;]],[&quot;make_audi&quot;,[&quot;integer&quot;,&quot;int64&quot;]],[&quot;make_bentley&quot;,[&quot;integer&quot;,&quot;int64&quot;]],[&quot;make_bmw&quot;,[&quot;integer&quot;,&quot;int64&quot;]],[&quot;make_bugatti&quot;,[&quot;integer&quot;,&quot;int64&quot;]],[&quot;make_buick&quot;,[&quot;integer&quot;,&quot;int64&quot;]],[&quot;make_cadillac&quot;,[&quot;integer&quot;,&quot;int64&quot;]],[&quot;make_chevrolet&quot;,[&quot;integer&quot;,&quot;int64&quot;]],[&quot;make_chrysler&quot;,[&quot;integer&quot;,&quot;int64&quot;]],[&quot;make_dodge&quot;,[&quot;integer&quot;,&quot;int64&quot;]],[&quot;make_ferrari&quot;,[&quot;integer&quot;,&quot;int64&quot;]],[&quot;make_fiat&quot;,[&quot;integer&quot;,&quot;int64&quot;]],[&quot;make_ford&quot;,[&quot;integer&quot;,&quot;int64&quot;]],[&quot;make_genesis&quot;,[&quot;integer&quot;,&quot;int64&quot;]],[&quot;make_gmc&quot;,[&quot;integer&quot;,&quot;int64&quot;]],[&quot;make_honda&quot;,[&quot;integer&quot;,&quot;int64&quot;]],[&quot;make_hummer&quot;,[&quot;integer&quot;,&quot;int64&quot;]],[&quot;make_hyundai&quot;,[&quot;integer&quot;,&quot;int64&quot;]],[&quot;make_infiniti&quot;,[&quot;integer&quot;,&quot;int64&quot;]],[&quot;make_kia&quot;,[&quot;integer&quot;,&quot;int64&quot;]],[&quot;make_lamborghini&quot;,[&quot;integer&quot;,&quot;int64&quot;]],[&quot;make_land_rover&quot;,[&quot;integer&quot;,&quot;int64&quot;]],[&quot;make_lexus&quot;,[&quot;integer&quot;,&quot;int64&quot;]],[&quot;make_lincoln&quot;,[&quot;integer&quot;,&quot;int64&quot;]],[&quot;make_lotus&quot;,[&quot;integer&quot;,&quot;int64&quot;]],[&quot;make_maserati&quot;,[&quot;integer&quot;,&quot;int64&quot;]],[&quot;make_maybach&quot;,[&quot;integer&quot;,&quot;int64&quot;]],[&quot;make_mazda&quot;,[&quot;integer&quot;,&quot;int64&quot;]],[&quot;make_mclaren&quot;,[&quot;integer&quot;,&quot;int64&quot;]],[&quot;make_mercedes-benz&quot;,[&quot;integer&quot;,&quot;int64&quot;]],[&quot;make_mitsubishi&quot;,[&quot;integer&quot;,&quot;int64&quot;]],[&quot;make_nissan&quot;,[&quot;integer&quot;,&quot;int64&quot;]],[&quot;make_oldsmobile&quot;,[&quot;integer&quot;,&quot;int64&quot;]],[&quot;make_plymouth&quot;,[&quot;integer&quot;,&quot;int64&quot;]],[&quot;make_pontiac&quot;,[&quot;integer&quot;,&quot;int64&quot;]],[&quot;make_porsche&quot;,[&quot;integer&quot;,&quot;int64&quot;]],[&quot;make_rolls-royce&quot;,[&quot;integer&quot;,&quot;int64&quot;]],[&quot;make_saab&quot;,[&quot;integer&quot;,&quot;int64&quot;]],[&quot;make_scion&quot;,[&quot;integer&quot;,&quot;int64&quot;]],[&quot;make_spyker&quot;,[&quot;integer&quot;,&quot;int64&quot;]],[&quot;make_subaru&quot;,[&quot;integer&quot;,&quot;int64&quot;]],[&quot;make_suzuki&quot;,[&quot;integer&quot;,&quot;int64&quot;]],[&quot;make_tesla&quot;,[&quot;integer&quot;,&quot;int64&quot;]],[&quot;make_toyota&quot;,[&quot;integer&quot;,&quot;int64&quot;]],[&quot;make_volkswagen&quot;,[&quot;integer&quot;,&quot;int64&quot;]],[&quot;make_volvo&quot;,[&quot;integer&quot;,&quot;int64&quot;]],[&quot;engine_fuel_type_diesel&quot;,[&quot;integer&quot;,&quot;int64&quot;]],[&quot;engine_fuel_type_electric&quot;,[&quot;integer&quot;,&quot;int64&quot;]],[&quot;engine_fuel_type_flex-fuel_(premium_unleaded_recommended/e85)&quot;,[&quot;integer&quot;,&quot;int64&quot;]],[&quot;engine_fuel_type_flex-fuel_(premium_unleaded_required/e85)&quot;,[&quot;integer&quot;,&quot;int64&quot;]],[&quot;engine_fuel_type_flex-fuel_(unleaded/e85)&quot;,[&quot;integer&quot;,&quot;int64&quot;]],[&quot;engine_fuel_type_flex-fuel_(unleaded/natural_gas)&quot;,[&quot;integer&quot;,&quot;int64&quot;]],[&quot;engine_fuel_type_natural_gas&quot;,[&quot;integer&quot;,&quot;int64&quot;]],[&quot;engine_fuel_type_premium_unleaded_(recommended)&quot;,[&quot;integer&quot;,&quot;int64&quot;]],[&quot;engine_fuel_type_premium_unleaded_(required)&quot;,[&quot;integer&quot;,&quot;int64&quot;]],[&quot;engine_fuel_type_regular_unleaded&quot;,[&quot;integer&quot;,&quot;int64&quot;]],[&quot;transmission_type_automatic&quot;,[&quot;integer&quot;,&quot;int64&quot;]],[&quot;transmission_type_direct_drive&quot;,[&quot;integer&quot;,&quot;int64&quot;]],[&quot;transmission_type_manual&quot;,[&quot;integer&quot;,&quot;int64&quot;]],[&quot;transmission_type_unknown&quot;,[&quot;integer&quot;,&quot;int64&quot;]],[&quot;driven_wheels_four_wheel_drive&quot;,[&quot;integer&quot;,&quot;int64&quot;]],[&quot;driven_wheels_front_wheel_drive&quot;,[&quot;integer&quot;,&quot;int64&quot;]],[&quot;driven_wheels_rear_wheel_drive&quot;,[&quot;integer&quot;,&quot;int64&quot;]],[&quot;vehicle_size_large&quot;,[&quot;integer&quot;,&quot;int64&quot;]],[&quot;vehicle_size_midsize&quot;,[&quot;integer&quot;,&quot;int64&quot;]],[&quot;vehicle_style_2dr_suv&quot;,[&quot;integer&quot;,&quot;int64&quot;]],[&quot;vehicle_style_4dr_hatchback&quot;,[&quot;integer&quot;,&quot;int64&quot;]],[&quot;vehicle_style_4dr_suv&quot;,[&quot;integer&quot;,&quot;int64&quot;]],[&quot;vehicle_style_cargo_minivan&quot;,[&quot;integer&quot;,&quot;int64&quot;]],[&quot;vehicle_style_cargo_van&quot;,[&quot;integer&quot;,&quot;int64&quot;]],[&quot;vehicle_style_convertible&quot;,[&quot;integer&quot;,&quot;int64&quot;]],[&quot;vehicle_style_convertible_suv&quot;,[&quot;integer&quot;,&quot;int64&quot;]],[&quot;vehicle_style_coupe&quot;,[&quot;integer&quot;,&quot;int64&quot;]],[&quot;vehicle_style_crew_cab_pickup&quot;,[&quot;integer&quot;,&quot;int64&quot;]],[&quot;vehicle_style_extended_cab_pickup&quot;,[&quot;integer&quot;,&quot;int64&quot;]],[&quot;vehicle_style_passenger_minivan&quot;,[&quot;integer&quot;,&quot;int64&quot;]],[&quot;vehicle_style_passenger_van&quot;,[&quot;integer&quot;,&quot;int64&quot;]],[&quot;vehicle_style_regular_cab_pickup&quot;,[&quot;integer&quot;,&quot;int64&quot;]],[&quot;vehicle_style_sedan&quot;,[&quot;integer&quot;,&quot;int64&quot;]],[&quot;vehicle_style_wagon&quot;,[&quot;integer&quot;,&quot;int64&quot;]]]' data-show-filters='true' data-show-download='true' data-show-column-summaries='false' data-show-data-types='true' data-show-page-size-selector='false' data-show-column-explorer='true' data-show-chart-builder='true' data-row-headers='[]' data-has-stable-row-id='false' data-lazy='false' data-preload='false'></marimo-table></marimo-ui-element>"}, "type": "data"}]}, {"code_hash": "9b13987a1f0a6ac4ccf9a6ac2931bcd1", "console": [], "id": "Plbk", "outputs": [{"data": {"text/plain": ""}, "type": "data"}]}, {"code_hash": "1f1c1aebda99187b0d9e0cda131e4eb2", "console": [], "id": "rSYo", "outputs": [{"data": {"text/html": "<span class=\"markdown prose dark:prose-invert\"><span class=\"paragraph\">At this point we'd expect to solve our system and obtain a better performance. But we'll very likely get a horrible result. Maybe even a <em>Singular matrix</em> error!</span></span>"}, "type": "data"}]}, {"code_hash": "829013f448f8137b9db4a385f7ddf588", "console": [], "id": "HuZB", "outputs": [{"data": {"text/html": "<pre style='font-size: 12px'>np.float64(321493.58329181524)</pre>"}, "type": "data"}]}, {"code_hash": "3693bf6f6683c49ff010a703c36904d8", "console": [], "id": "WfYj", "outputs": [{"data": {"text/html": "<span class=\"markdown prose dark:prose-invert\"><h2 id=\"regularization\">Regularization</h2>\n<span class=\"paragraph\">When we introduced categorical variables in our model, we also increased the chance of having features that are dependent of each other. For instance, if we had 3 possible values for <strong>number of doors</strong> and we created 3 boolean columns, one for each of the values, then each of the columns could be deduced from the others. In other words, they would be linearly dependent. That means that the inverse of <marimo-tex class=\"arithmatex\">||(X^T X||)</marimo-tex> won't even be defined.</span>\n<span class=\"paragraph\">In order to solve this, one approach is to add a diagonal multiplied by a small factor so that we get a <marimo-tex class=\"arithmatex\">||(X^T X + \\delta \\mathbb{I}||)</marimo-tex> that has an inverse.</span></span>"}, "type": "data"}]}, {"code_hash": "6fd62b14f3d8f0b23b7fe9e8f3cf8ad3", "console": [], "id": "Ynfw", "outputs": [{"data": {"text/plain": ""}, "type": "data"}]}, {"code_hash": "abcde37585399a4f7ca234e3b35e6c75", "console": [], "id": "LqFA", "outputs": [{"data": {"text/plain": ""}, "type": "data"}]}, {"code_hash": "7f7eb5d0c8ef6418d123f0e78f6748d9", "console": [], "id": "uDnK", "outputs": [{"data": {"text/plain": ""}, "type": "data"}]}, {"code_hash": "83eb1cf795c1e8861c7c0ab1ee0d77c1", "console": [], "id": "aWBL", "outputs": [{"data": {"text/html": "<pre style='font-size: 12px'>np.float64(0.1748308382409074)</pre>"}, "type": "data"}]}, {"code_hash": "9d7e715b5fabbaa1148defa975d8e1b0", "console": [], "id": "MIsd", "outputs": [{"data": {"text/html": "<span class=\"markdown prose dark:prose-invert\"><h2 id=\"tuning-the-model\">Tuning the Model</h2>\n<span class=\"paragraph\">To obtain the best <marimo-tex class=\"arithmatex\">||(delta||)</marimo-tex> for our model, we can start by just trying some values:</span></span>"}, "type": "data"}]}, {"code_hash": "f754d468b62b0f9c97f3928800a4d532", "console": [], "id": "IrqS", "outputs": [{"data": {"application/json": "{\"3.1622776601683795e-10\": \"text/plain+float:0.17667290872914287\", \"2.9763514416313135e-10\": \"text/plain+float:0.17782263855721192\", \"2.80135676119887e-10\": \"text/plain+float:0.1770631106611098\", \"2.6366508987303556e-10\": \"text/plain+float:0.1779331549399834\", \"2.4816289228368287e-10\": \"text/plain+float:0.17819806187522352\", \"2.3357214690901213e-10\": \"text/plain+float:0.19949601331686415\", \"2.1983926488622937e-10\": \"text/plain+float:0.19061683703872923\", \"2.06913808111479e-10\": \"text/plain+float:0.18602769815494966\", \"1.947483039908753e-10\": \"text/plain+float:0.17697243526927464\", \"1.8329807108324377e-10\": \"text/plain+float:0.19148228864460162\", \"1.725210549942039e-10\": \"text/plain+float:0.18202191452026112\", \"1.6237767391887243e-10\": \"text/plain+float:0.18045219507062643\", \"1.5283067326587686e-10\": \"text/plain+float:0.17783275541631616\", \"1.438449888287666e-10\": \"text/plain+float:0.18980499126967865\", \"1.3538761800225447e-10\": \"text/plain+float:0.18639747210860858\", \"1.2742749857031323e-10\": \"text/plain+float:0.19738388554244174\", \"1.1993539462092356e-10\": \"text/plain+float:0.19723713394754694\", \"1.1288378916846884e-10\": \"text/plain+float:0.18063324000393485\", \"1.0624678308940432e-10\": \"text/plain+float:0.39891489426601345\", \"1e-10\": \"text/plain+float:0.2557244203973466\"}"}, "type": "data"}]}, {"code_hash": "1f766eb31f774a42374f5aafebca1e16", "console": [{"data": "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAj8AAAGwCAYAAABGogSnAAAAOnRFWHRTb2Z0d2FyZQBNYXRwbG90bGliIHZlcnNpb24zLjEwLjYsIGh0dHBzOi8vbWF0cGxvdGxpYi5vcmcvq6yFwwAAAAlwSFlzAAAPYQAAD2EBqD+naQAARytJREFUeJzt3Xt8k+X9//F3kjZJW2g5dPQARY4CIlCk0uERtQrOqTjn0DmBeppM953rnINNYE73A51Tv04Up4KCOtR52HfOobMDnFpgggg4YIAgxxbKoekxbZP790ebtJUecmoTktfz8cij9M6dO1cMMW+u63Ndl8kwDEMAAAAxwhzuBgAAAHQlwg8AAIgphB8AABBTCD8AACCmEH4AAEBMIfwAAICYQvgBAAAxJS7cDYhEbrdbBw8eVPfu3WUymcLdHAAA4APDMFReXq7MzEyZzW337xB+WnHw4EFlZWWFuxkAACAA+/btU79+/dq8n/DTiu7du0tq+I+XnJwc5tYAAABfOBwOZWVleb/H20L4aYVnqCs5OZnwAwDAKaajkhUKngEAQEwh/AAAgJhC+AEAADGF8AMAAGIK4QcAAMQUwg8AAIgphB8AABBTCD8AACCmEH4AAEBMCXv4WbhwoQYMGCC73a7c3FytW7fOp8ctX75cJpNJU6ZMaXHcMAzNnTtXGRkZSkhIUF5ennbs2NEJLQcAAKeisIafV199VQUFBZo3b542bNigMWPGaNKkSTp8+HC7j9uzZ4/uuecenX/++Sfd9/DDD+uJJ57QokWLtHbtWiUlJWnSpEmqqanprJcBAABOISbDMIxwPXlubq7OPvtsPfnkk5Ikt9utrKws/fjHP9asWbNafYzL5dIFF1ygm2++Wf/617904sQJvf3225Iaen0yMzP1s5/9TPfcc48kqaysTGlpaXrhhRd0/fXXt3pNp9Mpp9Pp/d2zMVpZWRl7ewEAcIpwOBxKSUnp8Ps7bD0/tbW1Wr9+vfLy8poaYzYrLy9PRUVFbT7uN7/5jfr06aNbbrnlpPt2796t4uLiFtdMSUlRbm5uu9ecP3++UlJSvLesrKwAX1XnqK51hbsJAABEjbCFn9LSUrlcLqWlpbU4npaWpuLi4lYf89FHH+n555/Xs88+2+r9nsf5c01Jmj17tsrKyry3ffv2+fNSOtXrn+7Tmb9+T3/ffCjcTQEAICrEhbsBviovL9dNN92kZ599VqmpqSG9ts1mk81mC+k1Q+XTPcflchv6bN8JXT4qI9zNAQDglBe28JOamiqLxaKSkpIWx0tKSpSenn7S+bt27dKePXt05ZVXeo+53W5JUlxcnLZv3+59XElJiTIymoJCSUmJsrOzO+FVdL5yZ50khr4AAAiVsA17Wa1WjRs3ToWFhd5jbrdbhYWFmjBhwknnDx8+XJs3b9bGjRu9t6uuukoXXXSRNm7cqKysLA0cOFDp6ektrulwOLR27dpWr3kqKK+plyRVEX4AAAiJsA57FRQUaPr06crJydH48eP1+OOPq7KyUvn5+ZKkadOmqW/fvpo/f77sdrvOPPPMFo/v0aOHJLU4fvfdd+vBBx/U0KFDNXDgQM2ZM0eZmZknrQd0qnBUN/b81NWHuSUAAESHsIafqVOn6siRI5o7d66Ki4uVnZ2tFStWeAuW9+7dK7PZv86pe++9V5WVlbr99tt14sQJnXfeeVqxYoXsdntnvIRO5+n5YdgLAIDQCOs6P5HK13UCukLOg/9QaUWtcgf20qs/PDWH7gAA6AoRv84PfOPw9PzU0fMDAEAoEH4iWE2dS7X1DTPaKHgGACA0CD8RzFPvI1HzAwBAqBB+Ilh5TZ33zwx7AQAQGoSfCOZo1vNTVctUdwAAQoHwE8Ga9/zU1LnldjMxDwCAYBF+Iljzmh9Jqqln6AsAgGARfiKYZ3VnD2Z8AQAQPMJPBPt6zw8zvgAACB7hJ4I5auj5AQAg1Ag/Eeyknh+muwMAEDTCTwQ7ueeH6e4AAASL8BPBHNXU/AAAEGqEnwhWTs0PAAAhR/iJYJ4VnuPMJknU/AAAEAqEnwjm6fn5RnebJIa9AAAIBcJPBPPM9kpLtkti2AsAgFAg/EQowzC8PT9pyY09Pwx7AQAQNMJPhKqsdcmzj6mn56eaqe4AAASN8BOhPPt6xVtM6plolcSwFwAAoUD4iVCeep/u9nglWi2SKHgGACAUCD8RylPv090e1xR+qPkBACBohJ8I5dnaItkerwRrnCSGvQAACAXCT4RqGvaKU0I8w14AAIQK4SdCeQqek5vV/FTVMdsLAIBgEX4ilKN5zw8FzwAAhAzhJ0Ix2wsAgM5B+IlQ3oLnhKaanypmewEAEDTCT4Rq3vPjGfZithcAAMEj/ESopoLnOCU2TnWvrXfL5dnzAgAABITwE6GaFjmM9w57SSx0CABAsAg/Ecoz7JVsj5M93iyTqeF4FZubAgAQFMJPhGoqeI6XyWRioUMAAEKE8BOhmq/wLIn9vQAACBHCTwSqc7m9M7uS7fGSJHs8M74AAAgFwk8Eqqhpquvp9vWeH8IPAABBIfxEIM+QV0K8RfGWhrfIs7M74QcAgOAQfiJQ89WdPRJZ5RkAgJAg/EQgR7M1fjyaNjdlqjsAAMEg/EQgR3XTGj8ebHEBAEBoEH4iUHkrPT+eYS+mugMAEBzCTwT6+ho/ErO9AAAIFcJPBGq+urOHnWEvAABCgvATgVrt+Ylv+DPhBwCA4BB+IpCjurHnp3nNT2PPTw01PwAABIXwE4Ga7+ju0TTbi6nuAAAEg/ATgcqdrazzw95eAACEBOEnAnnX+UlgthcAAKFG+IlAra3z413hmZofAACCQviJQA5vzc/Jw170/AAAEBzCT4QxDKNZz0/zYS+mugMAEAqEnwhTU+dWncuQ1DL8MOwFAEBoEH4ijKfXx2ySkqwUPAMAEGqEnwjjqffpZouT2WzyHvfU/NS63Kp3ucPSNgAAogHhJ8K0tq+X1DTsJUlVDH0BABAwwk+EadrXq2X4scWZ5ekIqmHoCwCAgBF+IoxnX6/mxc6SZDKZmPEFAEAIEH4iTHkra/x42NniAgCAoBF+Ioxntlfy13p+pGYzvurY3BQAgEARfiJMWwXPUvPp7sz2AgAgUISfCNNU8Hxyz49nxldVLT0/AAAEivATYdoqeJaa7e/FVHcAAAJG+Ikw7RU8J1opeAYAIFiEnwjT1jo/kpTQONWdLS4AAAhc2MPPwoULNWDAANntduXm5mrdunVtnvvmm28qJydHPXr0UFJSkrKzs7Vs2bIW58yYMUMmk6nFbfLkyZ39MkKmqeC5ldleDHsBABC0k79hu9Crr76qgoICLVq0SLm5uXr88cc1adIkbd++XX369Dnp/F69eulXv/qVhg8fLqvVqnfeeUf5+fnq06ePJk2a5D1v8uTJWrJkifd3m83WJa8nFNrv+aHgGQCAYIW15+fRRx/Vbbfdpvz8fJ1xxhlatGiREhMTtXjx4lbPnzhxoq655hqNGDFCgwcP1k9+8hONHj1aH330UYvzbDab0tPTvbeePXt2xcsJiXYLnqn5AQAgaGELP7W1tVq/fr3y8vKaGmM2Ky8vT0VFRR0+3jAMFRYWavv27brgggta3Ldq1Sr16dNHw4YN08yZM3X06NF2r+V0OuVwOFrcwsHtNlRR207Bc+OwVw3DXgAABCxsw16lpaVyuVxKS0trcTwtLU3btm1r83FlZWXq27evnE6nLBaLnnrqKV166aXe+ydPnqzvfOc7GjhwoHbt2qVf/vKXuvzyy1VUVCSLxdLqNefPn6/7778/NC8sCBW19TKMhj/T8wMAQOcIa81PILp3766NGzeqoqJChYWFKigo0KBBgzRx4kRJ0vXXX+89d9SoURo9erQGDx6sVatW6ZJLLmn1mrNnz1ZBQYH3d4fDoaysrE59Ha3xDHlZ48zefbyaI/wAABC8sIWf1NRUWSwWlZSUtDheUlKi9PT0Nh9nNps1ZMgQSVJ2dra2bt2q+fPne8PP1w0aNEipqanauXNnm+HHZrNFRFF00xo/rb8tnnV+GPYCACBwYav5sVqtGjdunAoLC73H3G63CgsLNWHCBJ+v43a75XQ627x///79Onr0qDIyMoJqb1fw9Py0Vu8jSQnxDaGInh8AAAIX1mGvgoICTZ8+XTk5ORo/frwef/xxVVZWKj8/X5I0bdo09e3bV/Pnz5fUUJuTk5OjwYMHy+l06t1339WyZcv09NNPS5IqKip0//3369prr1V6erp27dqle++9V0OGDGkxFT5Stbevl8SwFwAAoRDW8DN16lQdOXJEc+fOVXFxsbKzs7VixQpvEfTevXtlNjd1TlVWVupHP/qR9u/fr4SEBA0fPlwvvfSSpk6dKkmyWCzatGmTXnzxRZ04cUKZmZm67LLL9MADD0TEsFZHyp2eae6t9/w07erOOj8AAATKZBie+UXwcDgcSklJUVlZmZKTk7vseV/8ZI/m/d8X+taodD1147iT7t9yoEzf/sNHSku2ae0v81q5AgAAscvX7++wb2+BJuWNW1t0t7Xf88OwFwAAgSP8RBCHZ7ZXK/t6SU01P2xsCgBA4Ag/EcTb89NWzU/jbK96t6HaeneXtQsAgGhC+IkgDh9ne0ns7A4AQKAIPxGko3V+rHFmxZlNkhj6AgAgUISfCNLROj+SlBDvKXpmujsAAIEg/EQQR2PNT3JC6z0/EgsdAgAQLMJPBPGl54f9vQAACA7hJ4J4Znu1VfMjybvbOz0/AAAEhvATIWrr3aqpa5i+3l74YaFDAACCQ/iJEJ5eH0nq1u6wV8N91XUUPAMAEAjCT4TwrPHTzRYnS+N09tY0rfLMIocAAASC8BMhmlZ3brvXR2KqOwAAwSL8RAhfZnpJTTU/LHIIAEBgCD8RoqPVnT28w15MdQcAICCEnwjhb88Ps70AAAgM4SdC+LK6s9RU88OwFwAAgSH8RIiOdnT3SGic6l7FsBcAAAEh/ESIptle7ff8UPAMAEBwCD8RwlHd0PPTUcGzN/ywyCEAAAEh/EQIX9f5YW8vAACCQ/iJEL4WPDPsBQBAcAg/EcLvRQ4peAYAICCEnwjhCT/JHW5v0Tjbi54fAAACQviJEN5hL19XeCb8AAAQEMJPBDAMo9mwl281P1W19TIMo9PbBgBAtCH8RICqWpdc7oYgk5zQ0SKHDeHHbUi1Lnentw0AgGhD+IkAnl4fi9nk3b6iLc3vZ+gLAAD/EX4iQPM1fkwmU7vnxlvMirc0nEPRMwAA/iP8RABfi509vJubMt0dAAC/EX4igK+bmnokNm5uyrAXAAD+I/xEAEe1nz0/Vra4AAAgUISfCODr6s4eCfFN090BAIB/CD8RwNc1fjw8a/3UUPMDAIDfCD8RoGlTUx97fhj2AgAgYISfCNA01d2/2V6EHwAA/Ef4iQCOat82NfVIZH8vAAACRviJAOX+rvPjmepOzQ8AAH4j/EQAf2d7JVLzAwBAwAg/EaCp4NnPFZ6Z6g4AgN8IPxHA73V+6PkBACBghJ8I4O8Kz96CZ2p+AADwG+EnzFxuQ5WNPTj+rvDMbC8AAPxH+Amzipqmuh2f1/lh2AsAgIARfsLMU+xsjzfLGufb2+HZ1b2KYS8AAPxG+Akzh5+rO0vN9vai5wcAAL8RfsLM39WdJcnu2d6ijqnuAAD4i/ATZv7u6yWxvQUAAMEg/ISZZ40fXxc4lAg/AAAEg/ATZk01P74Pe3lne9W5ZBhGp7QLAIBoRfgJM2/Pjz/hp7HmxzAkZ727U9oFAEC0IvyEmb+rO0tNU90l1voBAMBfhJ8w83dfL0mymE3eNYHY4gIAAP8QfsKs3Onfju4eTUXPTHcHAMAfhJ8w86zz40/Pj9RU98OwFwAA/iH8hJl3nR+bfz0/7O8FAEBgCD9h5ghgnR+p2bAXNT8AAPiF8BNm5QGs8yNJifEN57PQIQAA/iH8hFmgPT92hr0AAAgI4SeMaupcqm1cpND/nh9mewEAEAjCTxh51vgxmaRuVj/DDzU/AAAEhPATRp59vbrZ4mQ2m/x6LMNeAAAEhvATRk37evlX7yM1H/Yi/AAA4A/CTxgFOtNLahr2oucHAAD/EH7CyLO6cyA9PwmNNULU/AAA4J+wh5+FCxdqwIABstvtys3N1bp169o8980331ROTo569OihpKQkZWdna9myZS3OMQxDc+fOVUZGhhISEpSXl6cdO3Z09ssISDA9PwnxjRub0vMDAIBfwhp+Xn31VRUUFGjevHnasGGDxowZo0mTJunw4cOtnt+rVy/96le/UlFRkTZt2qT8/Hzl5+frvffe857z8MMP64knntCiRYu0du1aJSUladKkSaqpqemql+UzT8Gzv2v8SFJiY89PFVPdAQDwS1jDz6OPPqrbbrtN+fn5OuOMM7Ro0SIlJiZq8eLFrZ4/ceJEXXPNNRoxYoQGDx6sn/zkJxo9erQ++ugjSQ29Po8//rjuu+8+XX311Ro9erSWLl2qgwcP6u23326zHU6nUw6Ho8WtK3gKngPq+WGqOwAAAQlb+KmtrdX69euVl5fX1BizWXl5eSoqKurw8YZhqLCwUNu3b9cFF1wgSdq9e7eKi4tbXDMlJUW5ubntXnP+/PlKSUnx3rKysoJ4Zb4LaraXldleAAAEImzhp7S0VC6XS2lpaS2Op6Wlqbi4uM3HlZWVqVu3brJarbriiiv0hz/8QZdeeqkkeR/n7zVnz56tsrIy723fvn2Bviy/OKqDqflhthcAAIHw/1s3zLp3766NGzeqoqJChYWFKigo0KBBgzRx4sSAr2mz2WSz2ULXSB85vMNegcz2IvwAABAIv3p+2ipE9qivr293tlZzqampslgsKikpaXG8pKRE6enpbT7ObDZryJAhys7O1s9+9jN997vf1fz58yXJ+zh/rxkuTQXPgazz0/CYGmp+AADwi1/hJyMjo0UAGjVqVIshoqNHj2rChAk+XctqtWrcuHEqLCz0HnO73SosLPT5Gp7HOJ1OSdLAgQOVnp7e4poOh0Nr167165pdpTyInh8WOQQAIDB+dTkYhtHi9z179qiurq7dc9pTUFCg6dOnKycnR+PHj9fjjz+uyspK5efnS5KmTZumvn37ent25s+fr5ycHA0ePFhOp1Pvvvuuli1bpqefflqSZDKZdPfdd+vBBx/U0KFDNXDgQM2ZM0eZmZmaMmWKPy+1S3jW+UkOoObHHt8028vtNvzeGwwAgFgV8pofk8n3L+GpU6fqyJEjmjt3roqLi5Wdna0VK1Z4C5b37t0rs7mpc6qyslI/+tGPtH//fiUkJGj48OF66aWXNHXqVO859957ryorK3X77bfrxIkTOu+887RixQrZ7fbQvcgQaSp4DrznR5Jq6l3eYTAAANA+k+FHV43ZbFZxcbH69OkjqaH4+PPPP9egQYMkNdTWZGZmyuU6tYdiHA6HUlJSVFZWpuTk5E55Drfb0JBfvSu3Ia375SXqk+xfOHO7DQ365buSpPX35al3t64v2AYAIJL4+v3tV3eByWRSeXm57Ha7DMOQyWRSRUWFd1HArlocMBpU1tbL3Rg7A1nh2Ww2yRZnlrPerapal3qHuH0AAEQrv2t+Tj/99Ba/jx07tsXv/gx7xTJPsXO8pSHEBCLRapGz3s0qzwAA+MGv8LNy5crOakfMab66c6CBMdEap+NVdcz4AgDAD36FnwsvvLCz2hFzHEHs6O6RwBYXAAD4za9v3vr6erlcrharIZeUlGjRokWqrKzUVVddpfPOOy/kjYxG5TWBz/TySPBOd2dndwAAfOVX+LnttttktVr1zDPPSJLKy8t19tlnq6amRhkZGXrsscf0l7/8Rd/61rc6pbHRxFHdOOwVwOrOHmxxAQCA//yqtP3444917bXXen9funSpXC6XduzYoc8//1wFBQX63e9+F/JGRiNvz48t8J4fdnYHAMB/foWfAwcOaOjQod7fCwsLde211yolJUWSNH36dH3xxRehbWGU8mxqGkzPjzf8MNsLAACf+RV+7Ha7qqurvb+vWbNGubm5Le6vqKgIXeuimCMENT+eLS4Y9gIAwHd+hZ/s7GwtW7ZMkvSvf/1LJSUluvjii73379q1S5mZmaFtYZRq2tQ0+J4fwg8AAL7z65t37ty5uvzyy/Xaa6/p0KFDmjFjhjIyMrz3v/XWWzr33HND3sho5NnXKzmInh/Pfl41DHsBAOAzv9f5Wb9+vd5//32lp6fruuuua3F/dna2xo8fH9IGRqtQ9PwkeIe9mOoOAICv/P7mHTFihEaMGNHqfbfffnvQDYoVntlegezr5cFUdwAA/OdX+Pnwww99Ou+CCy4IqDGxxBHCmh+mugMA4Du/vnknTpzo3YfKMIxWzzGZTHK5+DLuiLfnJyQrPPPfGwAAX/kVfnr27Knu3btrxowZuummm5SamtpZ7Yp63hWeQ1DwzLAXAAC+82uq+6FDh/TQQw+pqKhIo0aN0i233KJPPvlEycnJSklJ8d7QvjqX29tbE9zGpg1vH8NeAAD4zq/wY7VaNXXqVL333nvatm2bRo8erbvuuktZWVn61a9+pfp6Zh35oqKm6b9TcLO9PD0//HcHAMBXfoWf5vr376+5c+fqgw8+0Omnn64FCxbI4XCEsm1Ry7O6c6LVojhLwG+Bt+C5ps4dknYBABALAvrmdTqdeuWVV5SXl6czzzxTqamp+tvf/qZevXqFun1RybPGTzD1PlLzqe70/AAA4Cu/xlzWrVunJUuWaPny5RowYIDy8/P12muvEXr85FndOZghL6n5IofU/AAA4Cu/vn2/+c1vqn///vqf//kfjRs3TpL00UcfnXTeVVddFZrWRalQrPEjNQ17OevdcrkNWcymoNsGAEC08/vbd+/evXrggQfavJ91fjoWitWdpaap7lLD/l5JtuDCFAAAscCvb0u3u+PC2qqqqoAbEyuaen6CCz+2uKaSrapawg8AAL4IfKrR1zidTj366KMaNGhQqC4ZtZpWdw4urJjNpqZVnqn7AQDAJ36FH6fTqdmzZysnJ0fnnHOO3n77bUnS4sWLNXDgQD322GP66U9/2hntjCqe1Z2D7fmRmu3vxRYXAAD4xK+uh7lz5+qZZ55RXl6ePvnkE1133XXKz8/XmjVr9Oijj+q6666TxWLprLZGDU/PT7AFz1LjdPdKprsDAOArv759X3/9dS1dulRXXXWVtmzZotGjR6u+vl6ff/65d8NTdMy7zk+QBc+SGPYCAMBPfg177d+/3zvF/cwzz5TNZtNPf/pTgo+fHCGq+ZGahr1Y6wcAAN/4FX5cLpesVqv397i4OHXr1i3kjYp2oVrhWWpa5ZmaHwAAfONX14NhGJoxY4ZsNpskqaamRnfccYeSkpJanPfmm2+GroVRyBHCmh/PWj8MewEA4Bu/vn2nT5/e4vcf/OAHIW1MrCgP0To/UvMtLih4BgDAF36FnyVLlnRWO2KGYRjNVngO0WwvSVUMewEA4JOQLXII39TUuVXnMiSFdp2fGoa9AADwCeGni3l6fcwmKcka/JpICcz2AgDAL4SfLtZU7BwfkiUCvDU/DHsBAOATwk8Xa9rUNDSbkHq3t6DnBwAAnxB+ulgo1/iRpASmugMA4BfCTxdzVIdujR+JYS8AAPxF+OliodzXS2o+7MU6PwAA+ILw08VCubqzxGwvAAD8RfjpYt4FDkNU85MYz95eAAD4g/DTxZoKnkPb80PBMwAAviH8dLGmgufQ1vww7AUAgG8IP12sqeA5VD0/jVPdGfYCAMAnhJ8u1nyF51Dw1PzU1rvlchshuSYAANGM8NPFykO8wnNCs/3BqpjuDgBAhwg/XSzUKzzb4szybBFG0TMAAB0j/HSxUK/wbDKZmO4OAIAfCD9dyO02VFEb2hWepaaiZ2Z8AQDQMcJPFyp31storEkOVc+PJCVYG95Gwg8AAB0j/HQhz+rO1jizbHGWDs72XWI8O7sDAOArwk8XCnWxs4d3lWdqfgAA6BDhpwt5ip1DtbWFR0K8Z5VnproDANARwk8X8q7xE8JiZ6lpiwuGvQAA6Bjhpws5ajqp54f9vQAA8BnhpwuFenVnj0RqfgAA8BnhpwuVe3t+QlzwHM+wFwAAviL8dCFHJ/X8sMghAAC+I/x0oc7q+Wka9mK2FwAAHQltFwTa9e3RmRqYmqScAb1Cel1mewEA4DvCTxc6d0iqzh2SGvLr2uOZ7QUAgK8Y9ooCzPYCAMB3hJ8owLAXAAC+C3v4WbhwoQYMGCC73a7c3FytW7euzXOfffZZnX/++erZs6d69uypvLy8k86fMWOGTCZTi9vkyZM7+2WEFbO9AADwXVjDz6uvvqqCggLNmzdPGzZs0JgxYzRp0iQdPny41fNXrVqlG264QStXrlRRUZGysrJ02WWX6cCBAy3Omzx5sg4dOuS9/elPf+qKlxM23nV+GPYCAKBDYQ0/jz76qG677Tbl5+frjDPO0KJFi5SYmKjFixe3ev7LL7+sH/3oR8rOztbw4cP13HPPye12q7CwsMV5NptN6enp3lvPnj274uWETaKVjU0BAPBV2MJPbW2t1q9fr7y8vKbGmM3Ky8tTUVGRT9eoqqpSXV2devVqOXV81apV6tOnj4YNG6aZM2fq6NGj7V7H6XTK4XC0uJ1KEqj5AQDAZ2ELP6WlpXK5XEpLS2txPC0tTcXFxT5d4xe/+IUyMzNbBKjJkydr6dKlKiws1EMPPaTVq1fr8ssvl8vVdjCYP3++UlJSvLesrKzAXlSYMNsLAADfnbLr/CxYsEDLly/XqlWrZLfbvcevv/56759HjRql0aNHa/DgwVq1apUuueSSVq81e/ZsFRQUeH93OBynVADy1PzUuQzVudyKt4S9jh0AgIgVtm/J1NRUWSwWlZSUtDheUlKi9PT0dh/7yCOPaMGCBXr//fc1evTods8dNGiQUlNTtXPnzjbPsdlsSk5ObnE7lXiGvSRmfAEA0JGwhR+r1apx48a1KFb2FC9PmDChzcc9/PDDeuCBB7RixQrl5OR0+Dz79+/X0aNHlZGREZJ2RyKrxSyL2SRJqmHoCwCAdoV1fKSgoEDPPvusXnzxRW3dulUzZ85UZWWl8vPzJUnTpk3T7Nmzvec/9NBDmjNnjhYvXqwBAwaouLhYxcXFqqiokCRVVFTo5z//udasWaM9e/aosLBQV199tYYMGaJJkyaF5TV2BZPJ5B36oucHAID2hbXmZ+rUqTpy5Ijmzp2r4uJiZWdna8WKFd4i6L1798psbspnTz/9tGpra/Xd7363xXXmzZunX//617JYLNq0aZNefPFFnThxQpmZmbrsssv0wAMPyGazdelr62oJVosqnPVMdwcAoAMmwzCMcDci0jgcDqWkpKisrOyUqf+58Hcr9dXRKv35jgkh3zUeAIBTga/f30wLihKs8gwAgG8IP1EiwUrNDwAAviD8RAl2dgcAwDeEnyiREN9Qu86wFwAA7SP8RIlEhr0AAPAJ4SdKeAuemeoOAEC7CD9RgoJnAAB8Q/iJEuzsDgCAbwg/UYLZXgAA+IbwEyXs7O0FAIBPCD9RItHaMNWd8AMAQPsIP1HCM+xVQ80PAADtIvxEiaZhL6a6AwDQHsJPlGCRQwAAfEP4iRJMdQcAwDeEnyiRwFR3AAB8QviJEk3bWxB+AABoD+EnSninute5ZBhGmFsDAEDkIvxECc+wl8ttqNblDnNrAACIXISfKOEpeJakmlrCDwAAbSH8RIl4i1lxZpMkqaqOtX4AAGgL4SeKJLDWDwAAHSL8RBF2dgcAoGOEnyjimfHFQocAALSN8BNFmvb3IvwAANAWwk8UaRr2ouAZAIC2EH6iCPt7AQDQMcJPFElg2AsAgA4RfqIIm5sCANAxwk8USWSdHwAAOkT4iSIJ8Ux1BwCgI4SfKJJgbXg7GfYCAKBthJ8o4lnksIqp7gAAtInwE0WY7QUAQMcIP1HEU/BcQ80PAABtIvxEEXZ1BwCgY4SfKMKwFwAAHSP8RBHvru6EHwAA2kT4iSIJ7O0FAECHCD9RhGEvAAA6RviJIt5d3VnnBwCANhF+okhis2EvwzDC3BoAACIT4SeKeGp+3IbkrHeHuTUAAEQmwk8U8dT8SMz4AgCgLYSfKBJnMctqaXhLq5jxBQBAqwg/UcY73Z2eHwAAWkX4iTKJhB8AANpF+IkyTWv9MN0dAIDWEH6ijHdzU2p+AABoFeEnyniGvWoY9gIAoFWEnyhjZ4sLAADaRfiJMokMewEA0C7CT5RJtMZJYn8vAADaQviJMk3r/LC9BQAArSH8RBnvVPc6en4AAGgN4SfKsMghAADtI/xEGba3AACgfYSfKJMYz2wvAADaQ/iJMvT8AADQPsJPlElonOrO3l4AALSO8BNlPMNe1XVMdQcAoDWEnyjTNNuLnh8AAFpD+Ikydit7ewEA0B7CT5RhnR8AANpH+IkyifGNe3sx1R0AgFaFPfwsXLhQAwYMkN1uV25urtatW9fmuc8++6zOP/989ezZUz179lReXt5J5xuGoblz5yojI0MJCQnKy8vTjh07OvtlRAy7teEtra5zyTCMMLcGAIDIE9bw8+qrr6qgoEDz5s3Thg0bNGbMGE2aNEmHDx9u9fxVq1bphhtu0MqVK1VUVKSsrCxddtllOnDggPechx9+WE888YQWLVqktWvXKikpSZMmTVJNTU1Xvayw8uzqbhhSDTO+AAA4ickIY/dAbm6uzj77bD355JOSJLfbraysLP34xz/WrFmzOny8y+VSz5499eSTT2ratGkyDEOZmZn62c9+pnvuuUeSVFZWprS0NL3wwgu6/vrrfWqXw+FQSkqKysrKlJycHPgLDAOX29DgX74rSVp/X556d7OFuUUAAHQNX7+/w9bzU1tbq/Xr1ysvL6+pMWaz8vLyVFRU5NM1qqqqVFdXp169ekmSdu/ereLi4hbXTElJUW5ubrvXdDqdcjgcLW6nKovZJFtc09AXgOh2tMKphSt3atmarxjqBnwUF64nLi0tlcvlUlpaWovjaWlp2rZtm0/X+MUvfqHMzExv2CkuLvZe4+vX9NzXmvnz5+v+++/3p/kRLcFqkbPezYwvIIrtP16l5/61W8v/vdc7xF1a7tRPLz09zC0DIl/Ywk+wFixYoOXLl2vVqlWy2+1BXWv27NkqKCjw/u5wOJSVlRVsE8MmMd6iE6pjrR8gCm0vLtczq3fpL58flMvd0NMzKDVJX5ZW6n8Ld6ibLU63XTAozK0EIlvYwk9qaqosFotKSkpaHC8pKVF6enq7j33kkUe0YMECffDBBxo9erT3uOdxJSUlysjIaHHN7OzsNq9ns9lks0VPbUxCkAsdHq+s1e6jlXK5DdW7DLkNQ/VuQ253w0+X2y2XW6p3uxvua3aOy23IYjZp0sh0pVJvBITM+q+O6elVu/TB1qYJIecO6a2ZFw7RuUN666lVu/S797brt+9uVZItTt/P7R/G1gKRLWzhx2q1aty4cSosLNSUKVMkNRQ8FxYW6q677mrzcQ8//LB++9vf6r333lNOTk6L+wYOHKj09HQVFhZ6w47D4dDatWs1c+bMznopEccz46smgJqf45W1uvSxD1Va4QyqDU+t3KXlt39TWb0Sg7oOEMsMw9Cq7Uf09KpdWrfnmCTJZJImj0zXHRcO1pisHt5z77xoiCqc9Xp61S796u3NSrJZdHV23zC1HIhsYR32Kigo0PTp05WTk6Px48fr8ccfV2VlpfLz8yVJ06ZNU9++fTV//nxJ0kMPPaS5c+fqlVde0YABA7x1PN26dVO3bt1kMpl0991368EHH9TQoUM1cOBAzZkzR5mZmd6AFQsS4gPv+Xn0H/9VaYVT3W1x+kZ3m8xmk+LMJplNJsVZTLKYTbKYGn7GWRqPmxuPm02KM5u16cAJ7TtWrev/uIYABASg3uXW3zYf0tOrdmlbcbkkKd5i0nfG9tPtFw7S4G90a/Vx904apoqaei1b85UKXvtcidY4XXpGWqvnArEsrOFn6tSpOnLkiObOnavi4mJlZ2drxYoV3oLlvXv3ymxumpD29NNPq7a2Vt/97ndbXGfevHn69a9/LUm69957VVlZqdtvv10nTpzQeeedpxUrVgRdF3QqaRr28m9z0/8cdOjltV9Jkv44LUcTBvcO6PkPO2p0/R/X6MvSSgIQ4IeaOpde/3Sf/vivL7XvWLUkKclq0fdz++uW8wYpPaX9/4+ZTCbdf9VIVTrr9eZnB3TnKxu0ZMbZOndIalc0HzhlhHWdn0h1Kq/zI0kzX1qvv28p1gNXj9RNEwb49BjDMDT1j2u0bvcxXTE6Qwu/f1ZQbWgegPr2SCAAAe0oq67TS2u+0pKPd6u0olaS1CvJqvxzBuimCaepR6LVr+vVu9y685UNeu+LEiVaLVp2S67GndazM5oORJSIX+cHnSeQgud3Nh3Sut3HZI8365ffGhF0G/ok27X89m9qUGqSDpxoGALbd6wq6OsC0aTEUaP5727VuQv+qd+9t12lFbXq2yNB9181Uh//4mL9+JKhfgcfSYqzmPXEDWN1/tBUVdW6lL9knf5z8NRdvwwINcJPFPK35qeqtl7/792tkqQfTRyivj0SQtIOAhDQut2llZr95iad/9BKPfPhl6pw1uv0tG56bOoYrfr5RE0/Z4D3HzGBssVZ9MxN45RzWk85auo1bfFa7TpSEaJXAJzaCD9RKLHxf5q+rvD89KpdOlRWo349E3R7iNcHIQABTTbvL9OdL2/Qxb9fpT+t26dal1vjTuup56fnaMVPLtA1Y/sp3hK6/y0nWuO0OP9sndk3WaUVtfrBc2u1/zifP4DwE4USGqe6+7LC875jVXrmwy8lSfddcYbs8cH9a7M1BCDEMsMw9MnOUt30/Fpd+eRH+tvmQzIM6eLhffT6HRP0xsxzdMmINJnNpk55/mR7vF7MH68hfbrpUFmNbnxurQ47YmOjZ6AthJ8olOhHzc+Df/uPauvdOm9IqiaN7LwpsX2S7foTAeiU9MnOUr2xfr/cbuZG+MPtNrRiyyFNWfixvv/cWv1rR6ksZpOmZGfq7z85X4tnnK2zB/Tqkrb07mbTS7fkKqtXgr46WqWbnl+n45W1XfLcQCQ6Zbe3QNs8NT/Vde1Pdf/XjiN674sSWcwmzbvyDJlMnfMvT4+0xgB0A9PgTwlHyp26/69f6J1NhyQ1/H353XVjQjosE42qauv1zueHtOjDXfrySKUkyRZn1tSzs3Tb+YPC9vc9PcWul2/5pq575hNtLynXjCXr9NKtuepujw9Le4BwIvxEIV9me9W53Lr/r/+RJE2bcJqGpnXvkrYRgCKfYRh6/dP9+u27W1VWXSezSTKbTHp740GVVdfpqRvHBV2MG02c9S59tveEPtl1VEW7SrVx3wnVuRp6yZLtcZo2YYBmnDsgIrZ76d87US/dkqupf1yjz/eX6ZYXP9WL+eN5PxFzCD9RyFvw3E74WVr0lXYerlCvJKvuzuvaXaA7MwCV19Tpox2lWrn9sD7aUarhGcn6ww1jlWTjr7ovdpdW6pdvblbRl0clSSMzk7XgO6NVWunUzJfWa+X2I/rB82v1/PScgKZgR4N6l1ubD5Q1hp2j+veeY3LWu1uc069ngqZNOE03jO8fcT0rQ9O6a+nN43VD47peM19erz/elCNrHD16iB0sctiKU32Rw8KtJbrlxU81ul+K/u+u8066v7TCqYt+t0rlznot+M4oXT8+PBsgljhqvAEo0IUQDcPQriOVWrntsFZuP6x/7znm/Ve3x1n9e+iFm8crOcK+hCJJncutP374pf63cIdq692yx5v107zTdct5AxXXOMy1/qtjyl/ybzlq6jUsrbuW3jJeacnRv3K6221oa7FDRbuO6pNdR7Vu9zFVOFsOKad2s2nC4N46p/HWv1dipw8jB+vfe47ppufXqqbOrStGZeiJG8bK0klF10BX8fX7m/DTilM9/Hyyq1Tff3athvTppg8KLjzp/l/8eZNe/XSfRvVN0dt3nhvW/+GVNK4EvduPAFRT59KaL482Bp4j2vu1wulBqUm6aHgfjchI1m/++oUcNfUa3S9FS28eH7O9Fe3ZuO+EZr2xybuH1PlDU/XbKaPUv/fJ78O2YoemPb9Oh8ud6tczQctuydXA1KSubnKn8gTqol2lDb07Xx7Viaq6Fuck2+Maw06qzhncW0P6dIv4sNOaD/97RLe++KlqXW5dN66fHrp2dKfNOgO6AuEnCKd6+Nm474SmLPxYfXsk6ONZF7e47/N9JzTlqY9lGNIbMydo3GldM9ukPb4EoIMnqrVy+2Gt3HZYH+882mINI6vFrNxBvXTx8D66aFgfDWj2ZbzlQJluen6tjlfVaXh6d710a25E1F5EgkpnvR55f7te+GSPDEPqmRivOd8+Q9eM7dvuF/m+Y1W66fm12nO0SqndrHohf7zO7JvShS0PvX3HqvTJrlJv787hcmeL+xOtFo0f2KuxZydVIzKSo6aXZMWWYt35yga53IZmnDOgSyY/AJ2F8BOEUz38/LekXJc99qF6JVm1Yc6l3uNut6FrF32iz/ae0HfG9tWjU7PD18iv+XoAeuW2XB0ud+qf2xoCj6dXwiM92a6Lhn9DFw3ro3OHpLZb0/PfknJ9/9m1Kq1wakifbnr51tyYGK5pz8pth3Xf21t04ETD5pnXjO2r+64Yod4+BsMj5U7NWLJOXxx0qJstTs8GsRFuOJQ4ahqDTkPvzv7j1S3ut8aZlXNaT50zuLcmDE7V6H4pUT3L7c0N+1Xw2ueSpP+5eIgKLhsW5hYBgSH8BOFUDz/7jlXp/IdXyh5v1rYHLvcef2P9fv3s9c+VZLXon/dMjLgA0DwAfZ3ZJI3t39PbuzMio7tf/zr98kiFbnxurQ6V1WhA70S9fNs3Q7aNx6nkSLlTv3nnP/rr5wclNRTm/vaaUbrw9G/4fS1HTZ1ue/FTrd19TNY4s/5ww1hNGpke6iaHRE2dSyu3HdYnjYFn15GWf8fizCaNyerRGHZ666z+PTtlwc9Itqxoj+b85QtJ0uzLh+uHFw4Oc4sA/xF+gnCqh5/SCqdyHvxAkvTl//uWzGaTymvqdPHvV+tIuVOzLh+uOyL0f2zNi6B7JMbrwtO/oYuH99EFQ7+hnknB1evsO1alG55do/3Hq9W3R4L+dNs3W61riUatTV+/5byB+umlpyvRGvhMuJo6l/7nT5/p/f+UyGySFlw7Wt/LyQphy4Pjcht6Y/1+PfbBf3WorGlVY5NJOjMzRRMaw87ZA3qpGzMC9fSqXXpoxTZJ0m+vOVM35p4W5hYB/vH1+5tPexRKbLZmR3WdS0m2OD35z506Uu7UwNQk5Z87IHyN60Basl3/9+PztKe0MuR1FVm9EvXaDyfoxufWandppb73TJFevi1Xg7/RLWTPEYnamr4+ql/wdTr2eIueuvEs/fKtzXrt0/2698+bdLyyNuy9BoZhqHDrYT20Ypt2HG7YzDMjxa5JI9M1YXBvfXNgb6UkMvvv62ZOHKwKZ50Wrtyl+97eoiRrnKaM7RvuZgEhR/iJQva4luGn2FGjxR/vliTN/fYZssVFdnd+N1tcpxXQZvZI0Ku3f1M3PrdWOw5XaOoza/Tyrbkalt41izx2Jc/09ScKd8jZxvT1UIizmPXQtaPVM8mqZ1Z/qfl/36ajlbWaffnwsBTOrv/qmBb8fZv+vee4JKlHYrzuumiIfvDN02JuKCsQ91w2TBU19Xqx6Cv97PXPlWi16LIIHc4EAhW9FXwxzGw2yR7f8NZW17r0m7/+R3Uuo6FeZnifMLcu/DwbrY7ISFZphVPX/7FIWw6UhbtZIbVx3wld+YeP9Lv3tsvZuHfb+3dfqB9eODikwcfDZDJp9uUj9MtvDZck/fHDL3Xvnzep3uXu4JGhs/NwuW5f+qmufbpI/95zXLY4s2ZOHKzVP79It54/iODjI5PJpHlXjtR3zuorl9vQXa98po92lIa7WUBIEX6ilKeO46+bDmr1f48o3mLSnG+fEeZWRY7e3Wz60225GtMvRcer6vT9Z9fos73Hw92soFU663X/X7/Qd576WNuKy9UzMV6/v26Mlt0yvkvqm26/YLAe/u5oWcwmvb5+v2a+vEE1dR1vsBuM4rIazXpjky577ENv7dH1Z2dp9c8v0i8mD1dKAsNb/jKbTXr42tGaPDJdtS63blv6qdZ/dSzczQJChoLnVpzqBc+SdO6Cf+rAiWrZ4sxy1rt1x4WDNevy4eFuVsRx1NQpf8m/tf6r4+pmi9OS/K7baTtUDMPQscpa/XvPcT3wzn8Cnr4eSv/4T4nufGWDauvdGj+wl56bnhPyFbbLquu0aPUuLf5ot3d7icvOSNO9k4dpSJ/oG8YMB2e9S7ctXa8P/3tE3e1xWn77NzUy89Re0wnRjdleQYiG8HPpo6u9hZ59utv0z3smMpulDZXOet364qcq+vKoEuItem56js4dkhruZklqCDYnqup0qKxGh8qqdbCsRodOVKu4rEYHy6obj9eottneUsFMXw+lNV8e1W0vfqpyZ73OyEjWizeP1ze6Bx/EaupcemnNV3py5U7vyss5p/XU7G8Nj4hFO6NNda1L0xev07o9x9Q7yapXfzhBQ/pE9yQBnLoIP0GIhvBz1ZMfadP+hjqWR783Rt85q1+YWxTZaupcun1Zw79wrXFmPXPTOF00rHProwzDkKOmXofKqnXoRE1TwDnR8NMTcGrqfKub6dPdpmvG9tVP8oYGNX09lLYcKNOMJetUWlGrAb0TteyW3IA3sHW5Db392QE9+o//enu3hvbppnsnD1feiD6sStyJHDV1uvHZtdp8oEzpyXa9fseEkGxEDIQa4ScI0RB+pj5TpLW7j+ms/j305zvOYb8eHzjrXbrz5c/0wdYSxVtMevL7Z4Vs0T5HTZ22HCjTlgNl2nzAoW2HHDp4olqVtb7Vw/ROsiqjh10ZKQnKSGn4mdns97Rke8Tuyr2ntFI/eH6t9h+vVp/uNi29ZbyGp/v+uTIMQ6u2H9FDK7Z5V/pOT7ar4NLT9Z2z+nZKATdOdqyyVlOfKdKOwxXq3ytRr98xIeIWSgUIP0GIhvDz0pqvtOTj3Xry+2dpRMap+RrCoc7l1t3LN+pvmw/JYjbp8anZunJMpl/XKKuq05aDZdrcGHa2HCjTnqNVbZ7fMzG+KdT0aAo26ckNP9OS7af8TKUSR42mPb9O20vKlWyP0+IZZyvHh9qqz/Ye14K/b9Pa3Q3Ftt3tcbrzoiGacc6AU/6/yamoxFGj6xYVae+xKg3t002v/nCCegW5+CgQSoSfIERD+EHg6l1u3fvnTXrzswMym6SHvztG3x3X+rDhiapabTng8AadzQfKTtpl3qNfzwSN6puiM/umaGRmsvr3SlRGSoISrLHxJV5WVadbXvy3Pv3quOzxZj1141m6eHhaq+d+eaRCj7y/Xe9uLpbUsNfWjHMG6EcTB6tHIl+24bTvWJWuW1SkYkeNRvVN0Su35ap7iIvZgUARfoJA+IHbbeiXb23W8n/vkyT9v2tG6fIz07X5QFmLoPP1DTE9sno1BZ1RfVN0ZmZK0NtzRIPqWpd+9PJ6rdx+RBazSY9cN1rXjG0KlocdNfrfwh1a/u99crkNmUzStWf1008vPT0m92KLVDsPl+t7z6zRscpa5ZzWU1dnZ8psNsliMslibrqZTU0/4zzHGs8zmyWLyaQ4S8vzmj/ec73mj4kzm5se33ie1WKm5guSCD9BIfxAaghA9//1C71Y9FW75/Xvldgy6PRNpneiHXWNPWtvfXZAUsOq49fl9NMfP/xSz/1rt6ob1wW6ZHgf/XzyML/qg9B1thwo0w3PrlF5TX24myJJsseblRBvUUK8RXarRfY4ixKsjb/HN/zZHmdu85i98bHN/3zSOXGWoOsnXW5DtfVuOetdcta7VVPX8NNZ13TMWe9q/L3ZsRb3u+Wsa/bnxvNrvva4OpchW2Pbk6xxjT8tSrDGKclqUaLVokRbXMNPq+dnyz8n2RoelxhvOSXq6wg/QSD8wMMwDC1YsU3PrP5SkjSgd6I35Izqm6KRmSnsERUAt9vQA3/7j5Z8vEdSw5YmFc6GL9Gx/Xto1uThyh3UO4wthC+2HCjTC5/sUVVtvepdhtyGIZfbkMtoeI/r3W653ZKr8bj3fs/NMORu/OlyNf50q93zwv2NZWsWhJqCUsMxs8nUYUipc526X7nWOHNjaDo5KLUIWLa2wlRcY6BqCGC9Eq0hH/Yn/ASB8IOv211aqV5JVlYLDiHDMLRw5U498v5/JUmDUpN07+RhmjQynSEMtMkblhrDVH1jT0p1rUs1dS5V17lUU+dWdZ2rxbHqWpdq6l2qqW38vc6l6lp3K8cawkp1s2PN19EKJYvZJHucWbZ4i2xx5sabRbb4Zn+OMzf+3uycVs63t/K4+DiznHVuVdbWq7rW1fTT6VJVXb2qnC5V1bpUVVuvqlpXy3Maj1XVuuRyd05M+M3VIzVtwoCQXpNd3YEQGpiaFO4mRB2TyaS7Lh6qMzKTVV5TrytGZZwS3eoIL7PZJLNM6srJfi63IWe9yxuIapoFp+bHXG5Ddm8w6TjEnAp/3w3DUK3L3RCU6lyqcjaEoqaQ5FJ1s6BUVVuvSufJQarp3KZglRDGGZuEHwBh1daMLyBSWMymxiGb2PvKNJlMjYHNop4hvnY4B54iP3YCAICoE87hbcIPAACIKYQfAAAQUwg/AAAgphB+AABATCH8AACAmEL4AQAAMYXwAwAAYgrhBwAAxBTCDwAAiCmEHwAAEFMIPwAAIKYQfgAAQEwh/AAAgJgSF+4GRCLDMCRJDocjzC0BAAC+8nxve77H20L4aUV5ebkkKSsrK8wtAQAA/iovL1dKSkqb95uMjuJRDHK73Tp48KC6d+8uk8kUsus6HA5lZWVp3759Sk5ODtl1ETq8R5GN9yey8f5Evmh/jwzDUHl5uTIzM2U2t13ZQ89PK8xms/r169dp109OTo7Kv3TRhPcosvH+RDben8gXze9Rez0+HhQ8AwCAmEL4AQAAMYXw04VsNpvmzZsnm80W7qagDbxHkY33J7Lx/kQ+3qMGFDwDAICYQs8PAACIKYQfAAAQUwg/AAAgphB+AABATCH8hNCHH36oK6+8UpmZmTKZTHr77bc7fMyqVat01llnyWazaciQIXrhhRc6vZ2xyt/3Z9WqVTKZTCfdiouLu6bBMWb+/Pk6++yz1b17d/Xp00dTpkzR9u3bO3zc66+/ruHDh8tut2vUqFF69913u6C1sSeQ9+eFF1446fNjt9u7qMWx5+mnn9bo0aO9CxhOmDBBf//739t9TKx+fgg/IVRZWakxY8Zo4cKFPp2/e/duXXHFFbrooou0ceNG3X333br11lv13nvvdXJLY5O/74/H9u3bdejQIe+tT58+ndTC2LZ69WrdeeedWrNmjf7xj3+orq5Ol112mSorK9t8zCeffKIbbrhBt9xyiz777DNNmTJFU6ZM0ZYtW7qw5bEhkPdHalhJuPnn56uvvuqiFseefv36acGCBVq/fr0+/fRTXXzxxbr66qv1xRdftHp+TH9+DHQKScZbb73V7jn33nuvMXLkyBbHpk6dakyaNKkTWwbD8O39WblypSHJOH78eJe0CS0dPnzYkGSsXr26zXO+973vGVdccUWLY7m5ucYPf/jDzm5ezPPl/VmyZImRkpLSdY3CSXr27Gk899xzrd4Xy58fen7CqKioSHl5eS2OTZo0SUVFRWFqEVqTnZ2tjIwMXXrppfr444/D3ZyYUVZWJknq1atXm+fwGQofX94fSaqoqNBpp52mrKysdnshEFoul0vLly9XZWWlJkyY0Oo5sfz5IfyEUXFxsdLS0locS0tLk8PhUHV1dZhaBY+MjAwtWrRIb7zxht544w1lZWVp4sSJ2rBhQ7ibFvXcbrfuvvtunXvuuTrzzDPbPK+tzxB1WZ3L1/dn2LBhWrx4sf7yl7/opZdektvt1jnnnKP9+/d3YWtjy+bNm9WtWzfZbDbdcccdeuutt3TGGWe0em4sf37Y1R1ow7BhwzRs2DDv7+ecc4527dqlxx57TMuWLQtjy6LfnXfeqS1btuijjz4Kd1PQCl/fnwkTJrTodTjnnHM0YsQIPfPMM3rggQc6u5kxadiwYdq4caPKysr05z//WdOnT9fq1avbDECxip6fMEpPT1dJSUmLYyUlJUpOTlZCQkKYWoX2jB8/Xjt37gx3M6LaXXfdpXfeeUcrV65Uv3792j23rc9Qenp6ZzYxpvnz/nxdfHy8xo4dy2eoE1mtVg0ZMkTjxo3T/PnzNWbMGP3v//5vq+fG8ueH8BNGEyZMUGFhYYtj//jHP9ocn0X4bdy4URkZGeFuRlQyDEN33XWX3nrrLf3zn//UwIEDO3wMn6GuE8j783Uul0ubN2/mM9SF3G63nE5nq/fF9Ocn3BXX0aS8vNz47LPPjM8++8yQZDz66KPGZ599Znz11VeGYRjGrFmzjJtuusl7/pdffmkkJiYaP//5z42tW7caCxcuNCwWi7FixYpwvYSo5u/789hjjxlvv/22sWPHDmPz5s3GT37yE8NsNhsffPBBuF5CVJs5c6aRkpJirFq1yjh06JD3VlVV5T3npptuMmbNmuX9/eOPPzbi4uKMRx55xNi6dasxb948Iz4+3ti8eXM4XkJUC+T9uf/++4333nvP2LVrl7F+/Xrj+uuvN+x2u/HFF1+E4yVEvVmzZhmrV682du/ebWzatMmYNWuWYTKZjPfff98wDD4/zRF+QsgzNfrrt+nTpxuGYRjTp083LrzwwpMek52dbVitVmPQoEHGkiVLurzdscLf9+ehhx4yBg8ebNjtdqNXr17GxIkTjX/+85/haXwMaO29kdTiM3HhhRd63y+P1157zTj99NMNq9VqjBw50vjb3/7WtQ2PEYG8P3fffbfRv39/w2q1Gmlpaca3vvUtY8OGDV3f+Bhx8803G6eddpphtVqNb3zjG8Yll1ziDT6GweenOZNhGEbX9TMBAACEFzU/AAAgphB+AABATCH8AACAmEL4AQAAMYXwAwAAYgrhBwAAxBTCDwAAiCmEHwAA0KoPP/xQV155pTIzM2UymfT222+H/fkMw9DcuXOVkZGhhIQE5eXlaceOHX49D+EHAAC0qrKyUmPGjNHChQsj5vkefvhhPfHEE1q0aJHWrl2rpKQkTZo0STU1NT4/D+EHQEyoqKjQjBkzlJaWJpvNpr59++o3v/lNuJsFRLTLL79cDz74oK655ppW73c6nbrnnnvUt29fJSUlKTc3V6tWreq05zMMQ48//rjuu+8+XX311Ro9erSWLl2qgwcP+tUrRfgBEBNeeOEF/fWvf9Vbb72lnTt3asWKFTrrrLPC3SzglHbXXXepqKhIy5cv16ZNm3Tddddp8uTJfg9D+Wr37t0qLi5WXl6e91hKSopyc3NVVFTk83UIPwBiwsiRI1VRUaHXXntNW7du1ZAhQ/Ttb3873M0CTll79+7VkiVL9Prrr+v888/X4MGDdc899+i8887TkiVLOuU5i4uLJUlpaWktjqelpXnv8wXhB0BMGDNmjG699Vbdd999Sk1N1c0336zHHnss3M0CTlmbN2+Wy+XS6aefrm7dunlvq1ev1q5duyRJ27Ztk8lkavc2a9asLm97XJc/IwCEQX5+vn74wx8qNTVVqampWrJkiQYPHqxRo0a16EIH4JuKigpZLBatX79eFoulxX3dunWTJA0aNEhbt25t9zq9e/f2+TnT09MlSSUlJcrIyPAeLykpUXZ2ts/XIfwAiHoHDhzQ//3f/+mpp57yHrPb7Ro/frzeeecdwg8QgLFjx8rlcunw4cM6//zzWz3HarVq+PDhIXvOgQMHKj09XYWFhd6w43A4tHbtWs2cOdPn6xB+AES9Q4cOSZJqa2tbHDcMQ6WlpeFoEnBKqKio0M6dO72/7969Wxs3blSvXr10+umn68Ybb9S0adP0+9//XmPHjtWRI0dUWFio0aNH64orrgjp8/Xv318mk0l33323HnzwQQ0dOlQDBw7UnDlzlJmZqSlTpvj+RAYARLnjx48bJpPJWLp0qfeY0+k00tPTjXnz5oWvYUCEW7lypSHppNv06dMNwzCM2tpaY+7cucaAAQOM+Ph4IyMjw7jmmmuMTZs2dcrzGYZhuN1uY86cOUZaWpphs9mMSy65xNi+fbtfz2MyDMPwO5oBwCkmPz9f7733np5//nmddtppmj9/vt566y1t375dffv2DXfzAHQhwg+AmFBdXa05c+boz3/+s44fP66xY8fq97//vcaNGxfupgHoYoQfAAAQU1jnBwAAxBTCDwAAiCmEHwAAEFMIPwAAIKYQfgAAQEwh/AAAgJhC+AEAADGF8AMAAGIK4QcAAMQUwg8AAIgphB8AABBT/j9gThvlBXZ9KAAAAABJRU5ErkJggg==", "mimetype": "image/png", "name": "media", "type": "streamMedia"}], "id": "Lpqv", "outputs": [{"data": {"text/plain": ""}, "type": "data"}]}, {"code_hash": "86351dea75bca516482353489cc1ae07", "console": [], "id": "upgv", "outputs": [{"data": {"text/plain": ""}, "type": "data"}]}, {"code_hash": "57b67272ee832e83274ac555b455c48b", "console": [], "id": "WJUG", "outputs": [{"data": {"text/html": "<pre style='font-size: 12px'>np.float64(0.17667290872914287)</pre>"}, "type": "data"}]}, {"code_hash": "fa576db5b206b76103d4345e924c67d4", "console": [], "id": "pCao", "outputs": [{"data": {"text/html": "<span class=\"markdown prose dark:prose-invert\"><h2 id=\"using-the-model\">Using the Model</h2>\n<span class=\"paragraph\">At this point, we'll train our <code>g</code> model on a split that combines the train and validation splits.</span></span>"}, "type": "data"}]}, {"code_hash": "5b6cabc970ce00ee071a6407b61e1f0d", "console": [], "id": "wEIy", "outputs": [{"data": {"text/html": "<span class=\"markdown prose dark:prose-invert\"><h3 id=\"prepare-a-merged-dataset-with-train-and-validation\">Prepare a Merged Dataset with Train and Validation</h3></span>"}, "type": "data"}]}, {"code_hash": "7c6c9a5aca6d18542b1a8b302ab70217", "console": [], "id": "wlyU", "outputs": [{"data": {"application/json": "[\"text/plain:[[2.008e+03 1.480e+02 4.000e+00 ... 0.000e+00 0.000e+00 0.000e+00]\\n [2.012e+03 1.320e+02 4.000e+00 ... 0.000e+00 0.000e+00 0.000e+00]\\n [2.016e+03 1.480e+02 4.000e+00 ... 0.000e+00 0.000e+00 0.000e+00]\\n ...\\n [2.013e+03 3.320e+02 8.000e+00 ... 0.000e+00 0.000e+00 0.000e+00]\\n [2.016e+03 1.480e+02 4.000e+00 ... 0.000e+00 1.000e+00 0.000e+00]\\n [2.015e+03 2.900e+02 6.000e+00 ... 0.000e+00 0.000e+00 0.000e+00]]\", \"text/plain:[ 9.57574708  9.887663    9.89323518 ... 11.21756062  9.77542688\\n 10.1924563 ]\", \"text/plain:[[1.994e+03 1.650e+02 6.000e+00 ... 0.000e+00 0.000e+00 0.000e+00]\\n [1.993e+03 3.890e+02 1.200e+01 ... 0.000e+00 0.000e+00 0.000e+00]\\n [2.013e+03 2.680e+02 6.000e+00 ... 0.000e+00 0.000e+00 1.000e+00]\\n ...\\n [2.006e+03 2.500e+02 6.000e+00 ... 0.000e+00 0.000e+00 1.000e+00]\\n [2.016e+03 1.740e+02 4.000e+00 ... 0.000e+00 1.000e+00 0.000e+00]\\n [2.015e+03 2.560e+02 6.000e+00 ... 0.000e+00 0.000e+00 0.000e+00]]\", \"text/plain:[ 7.60140233  8.07464908 10.34563811 ... 10.27852782 10.00789261\\n 10.40414162]\"]"}, "type": "data"}]}, {"code_hash": "282a257f8b871539775c2506ddea6dfb", "console": [], "id": "PieA", "outputs": [{"data": {"text/html": "<span class=\"markdown prose dark:prose-invert\"><h3 id=\"train-the-model\">Train the Model</h3>\n<span class=\"paragraph\">Here we are training the model in our merged dataset and displaying its weights.</span></span>"}, "type": "data"}]}, {"code_hash": "6b0ffab9d631dadce93e126fa985e07c", "console": [], "id": "GrQN", "outputs": [{"data": {"text/html": "<pre style='font-size: 12px'>array([ 5.73028261e-03,  1.89230971e-03,  2.12406116e-02, -7.48286075e-03,\n       -4.54107061e-03,  3.57798818e-05, -9.26072960e-02,  1.14791231e-02,\n        9.31202263e-02,  2.76500838e-01,  1.89378828e-01,  5.46092574e-01,\n       -1.94599411e-01,  9.86341972e-01, -2.07061124e-01,  2.14207303e+00,\n       -1.17220976e-01,  1.22036708e-01, -1.04731716e-01, -7.52716497e-02,\n       -1.65470491e-01,  1.20875088e+00, -4.44776228e-01, -2.71203238e-01,\n       -1.93409174e-01,  1.62743657e-02, -1.62333990e-01,  4.22652251e-01,\n       -1.94088631e-01,  5.60520776e-03, -2.61862140e-01,  8.14814088e-01,\n        2.24617428e-01, -2.26905571e-02,  1.33580818e-01,  6.70067096e-01,\n        3.77335160e-01,  1.49324432e+00, -3.27435461e-02,  4.48292711e-01,\n       -2.07892981e-01, -7.42575648e-02, -3.57972412e-01, -1.94324391e-01,\n       -6.63103204e-01,  1.80356725e-01,  2.01832832e-01,  1.10301729e+00,\n       -3.16243665e-02, -2.14511118e-01,  1.48788140e+00, -2.11937599e-01,\n        1.40635060e-01,  8.27945562e-01, -2.53309106e-01, -7.93744551e-02,\n       -1.94179067e-01,  1.84749190e-03,  1.16205366e+00, -5.84036249e-02,\n       -2.53738352e-01, -4.09632200e-01, -1.61379629e-01, -2.05354160e-01,\n       -2.33442419e-01,  8.04212843e-02, -3.94154955e-01,  5.84193989e-02,\n        1.77290081e-01, -1.17807027e-01, -5.28484426e-01,  2.18710024e-02,\n       -1.46838578e-02, -4.31096158e-02, -6.88750930e-02, -5.51451878e-02,\n       -2.65179457e-01, -3.73188310e-01, -2.34539936e-01, -2.12662377e-01,\n       -6.08312737e-01,  1.60522210e-01,  1.01059672e-01,  5.13153365e-03,\n       -2.98493428e-01, -3.50642284e-01, -7.08494832e-02, -4.38094796e-01,\n       -2.26281134e-01, -3.00128210e-01, -1.78790710e-01])</pre>"}, "type": "data"}]}, {"code_hash": "fda4d73b1b35d24edc211ea34ae1d637", "console": [], "id": "Ilkb", "outputs": [{"data": {"text/html": "<span class=\"markdown prose dark:prose-invert\"><h3 id=\"check-that-we-can-predict-prices\">Check that we Can Predict Prices</h3></span>"}, "type": "data"}]}, {"code_hash": "92bcc7ea233657ff4611a4d0eb3eb5ef", "console": [], "id": "mySd", "outputs": [{"data": {"text/html": "<pre style='font-size: 12px'>array([ 9.37597587,  9.67945573, 10.05833104, ..., 10.73339973,\n       10.11147465, 10.46392475], shape=(9532,))</pre>"}, "type": "data"}]}, {"code_hash": "49cdd370845cdc89af9e4a79fbd3b9bf", "console": [], "id": "vGkK", "outputs": [{"data": {"text/html": "<span class=\"markdown prose dark:prose-invert\"><h3 id=\"evaluate-the-model-on-the-test-split\">Evaluate the Model on the Test Split</h3></span>"}, "type": "data"}]}, {"code_hash": "1f75fe2853e60fa429376422421f714a", "console": [], "id": "zmIa", "outputs": [{"data": {"text/html": "<pre style='font-size: 12px'>np.float64(0.17326926018849598)</pre>"}, "type": "data"}]}, {"code_hash": "5243025876bec61eb475fd13b28e6231", "console": [], "id": "NOfw", "outputs": [{"data": {"text/html": "<span class=\"markdown prose dark:prose-invert\"><h3 id=\"use-the-model-to-predict-a-cars-price\">Use the Model to Predict a Car's Price</h3>\n<span class=\"paragraph\">Now we can use our model to predict the price of a given car.</span></span>"}, "type": "data"}]}, {"code_hash": "9789c676aa97fd0541b4e34e39ab0dc9", "console": [], "id": "jXAc", "outputs": [{"data": {"application/json": "{\"y\": \"text/plain+float:35000.00000000001\", \"y_predicted\": \"text/plain+float:39661.06412963779\"}"}, "type": "data"}]}], "metadata": {"marimo_version": "0.16.0"}, "version": "1"},
            "runtimeConfig": null,
        };
    </script>
  
<marimo-code hidden="">
    import%20marimo%0A%0A__generated_with%20%3D%20%220.16.0%22%0Aapp%20%3D%20marimo.App(width%3D%22medium%22)%0A%0A%0A%40app.cell%0Adef%20_()%3A%0A%20%20%20%20import%20marimo%20as%20mo%0A%20%20%20%20import%20pandas%20as%20pd%0A%20%20%20%20import%20numpy%20as%20np%0A%20%20%20%20import%20matplotlib.pyplot%20as%20plt%0A%20%20%20%20import%20seaborn%20as%20sns%0A%20%20%20%20return%20mo%2C%20np%2C%20pd%2C%20plt%2C%20sns%0A%0A%0A%40app.cell(hide_code%3DTrue)%0Adef%20_(mo)%3A%0A%20%20%20%20mo.md(%0A%20%20%20%20%20%20%20%20r%22%22%22%0A%20%20%20%20%23%20Machine%20Learning%20Zoomcamp%0A%0A%20%20%20%20%23%23%20Module%202%3A%20**Regression**%0A%20%20%20%20%22%22%22%0A%20%20%20%20)%0A%20%20%20%20return%0A%0A%0A%40app.cell(hide_code%3DTrue)%0Adef%20_(pd)%3A%0A%20%20%20%20repository_root%20%3D%20%22https%3A%2F%2Fgithub.com%2FDataTalksClub%2Fmachine-learning-zoomcamp%2Fblob%2Fmaster%2F%22%0A%0A%20%20%20%20chapters%20%3D%20pd.DataFrame(%5B%0A%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%22title%22%3A%20%22Car%20price%20prediction%20project%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%22youtube_id%22%3A%20%22vM3SqPNlStE%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%22contents%22%3A%20repository_root%2B%2202-regression%2F01-car-price-intro.md%22%0A%20%20%20%20%20%20%20%20%7D%2C%0A%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%22title%22%3A%20%22Data%20preparation%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%22youtube_id%22%3A%20%22Kd74oR4QWGM%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%22contents%22%3A%20repository_root%2B%2202-regression%2F02-data-preparation.md%22%0A%20%20%20%20%20%20%20%20%7D%2C%0A%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%22title%22%3A%20%22Exploratory%20data%20analysis%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%22youtube_id%22%3A%20%22k6k8sQ0GhPM%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%22contents%22%3A%20repository_root%2B%2202-regression%2F03-eda.md%22%0A%20%20%20%20%20%20%20%20%7D%2C%0A%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%22title%22%3A%20%22Setting%20up%20the%20validation%20framework%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%22youtube_id%22%3A%20%22ck0IfiPaQi0%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%22contents%22%3A%20repository_root%2B%2202-regression%2F04-validation-framework.md%22%0A%20%20%20%20%20%20%20%20%7D%2C%0A%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%22title%22%3A%20%22Linear%20regression%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%22youtube_id%22%3A%20%22Dn1eTQLsOdA%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%22contents%22%3A%20repository_root%2B%2202-regression%2F05-linear-regression-simple.md%22%0A%20%20%20%20%20%20%20%20%7D%2C%0A%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%22title%22%3A%20%22Linear%20regression%3A%20vector%20form%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%22youtube_id%22%3A%20%22YkyevnYyAww%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%22contents%22%3A%20repository_root%2B%2202-regression%2F06-linear-regression-vector.md%22%0A%20%20%20%20%20%20%20%20%7D%2C%0A%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%22title%22%3A%20%22Training%20linear%20regression%3A%20Normal%20equation%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%22youtube_id%22%3A%20%22hx6nak-Y11g%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%22contents%22%3A%20repository_root%2B%2202-regression%2F07-linear-regression-training.md%22%0A%20%20%20%20%20%20%20%20%7D%2C%0A%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%22title%22%3A%20%22Baseline%20model%20for%20car%20price%20prediction%20project%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%22youtube_id%22%3A%20%22SvPpMMYtYbU%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%22contents%22%3A%20repository_root%2B%2202-regression%2F08-baseline-model.md%22%0A%20%20%20%20%20%20%20%20%7D%2C%0A%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%22title%22%3A%20%22Root%20mean%20squared%20error%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%22youtube_id%22%3A%20%220LWoFtbzNUM%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%22contents%22%3A%20repository_root%2B%2202-regression%2F09-rmse.md%22%0A%20%20%20%20%20%20%20%20%7D%2C%0A%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%22title%22%3A%20%22Using%20RMSE%20on%20validation%20data%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%22youtube_id%22%3A%20%22rawGPXg2ofE%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%22contents%22%3A%20repository_root%2B%2202-regression%2F10-car-price-validation.md%22%0A%20%20%20%20%20%20%20%20%7D%2C%0A%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%22title%22%3A%20%22Feature%20engineering%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%22youtube_id%22%3A%20%22-aEShw4ftB0%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%22contents%22%3A%20repository_root%2B%2202-regression%2F11-feature-engineering.md%22%0A%20%20%20%20%20%20%20%20%7D%2C%0A%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%22title%22%3A%20%22Categorical%20variables%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%22youtube_id%22%3A%20%22sGLAToAAMa4%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%22contents%22%3A%20repository_root%2B%2202-regression%2F12-categorical-variables.md%22%0A%20%20%20%20%20%20%20%20%7D%2C%0A%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%22title%22%3A%20%22Regularization%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%22youtube_id%22%3A%20%2291ve3EJlHBc%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%22contents%22%3A%20repository_root%2B%2202-regression%2F13-regularization.md%22%0A%20%20%20%20%20%20%20%20%7D%2C%0A%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%22title%22%3A%20%22Tuning%20the%20model%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%22youtube_id%22%3A%20%22lW-YVxPgzQw%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%22contents%22%3A%20repository_root%2B%2202-regression%2F14-tuning-model.md%22%0A%20%20%20%20%20%20%20%20%7D%2C%0A%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%22title%22%3A%20%22Using%20the%20model%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%22youtube_id%22%3A%20%22KT--uIJozes%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%22contents%22%3A%20repository_root%2B%2202-regression%2F15-using-model.md%22%0A%20%20%20%20%20%20%20%20%7D%2C%0A%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%22title%22%3A%20%22Car%20price%20prediction%20project%20summary%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%22youtube_id%22%3A%20%22_qI01YXbyro%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%22contents%22%3A%20repository_root%2B%2202-regression%2F16-summary.md%22%0A%20%20%20%20%20%20%20%20%7D%2C%0A%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%22title%22%3A%20%22Explore%20more%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%22youtube_id%22%3A%20None%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%22contents%22%3A%20repository_root%2B%2202-regression%2F17-explore-more.md%22%0A%20%20%20%20%20%20%20%20%7D%2C%0A%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%22title%22%3A%20%22Homework%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%22youtube_id%22%3A%20None%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%22contents%22%3A%20repository_root%2B%2202-regression%2Fhomework.md%22%0A%20%20%20%20%20%20%20%20%7D%2C%0A%20%20%20%20%5D)%0A%0A%20%20%20%20chapters.insert(loc%3D0%2C%20column%3D%22snapshot%22%2C%20value%3D%22https%3A%2F%2Fimg.youtube.com%2Fvi%2F%22%2Bchapters.youtube_id.astype(str)%2B%22%2Fhqdefault.jpg%22)%0A%20%20%20%20chapters.insert(loc%3D2%2C%20column%3D%22youtube%22%2C%20value%3D%22https%3A%2F%2Fyoutube.com%2Fwatch%3Fv%3D%22%2Bchapters.youtube_id.astype(str))%0A%0A%20%20%20%20videos%20%3D%20chapters%5Bchapters%5B%22youtube_id%22%5D.notnull()%5D%0A%20%20%20%20videos%5B%5B%22snapshot%22%2C%20%22title%22%2C%20%22youtube%22%5D%5D%0A%20%20%20%20return%20(chapters%2C)%0A%0A%0A%40app.cell(hide_code%3DTrue)%0Adef%20_(chapters)%3A%0A%20%20%20%20contents%20%3D%20chapters%5Bchapters%5B%22contents%22%5D.notnull()%5D%0A%20%20%20%20contents%5B%5B%22title%22%2C%20%22contents%22%5D%5D%0A%20%20%20%20return%0A%0A%0A%40app.cell(hide_code%3DTrue)%0Adef%20_(mo)%3A%0A%20%20%20%20mo.md(%0A%20%20%20%20%20%20%20%20r%22%22%22%0A%20%20%20%20%23%23%20Car%20Price%20Prediction%20Project%0A%0A%20%20%20%20In%20this%20chapter%20we'll%20be%20working%20with%20the%20%5BCar%20Features%20and%20MSRP%5D(https%3A%2F%2Fwww.kaggle.com%2Fdatasets%2FCooperUnion%2Fcardataset)%20Kaggle%20dataset.%0A%0A%20%20%20%201.%20Prepare%20the%20data%20and%20do%20some%20Exploratory%20Data%20Analysis%20(EDA)%0A%20%20%20%202.%20Use%20linear%20regression%20for%20predicting%20price%0A%20%20%20%203.%20Understand%20the%20internals%20of%20linear%20regression%0A%20%20%20%204.%20Evaluate%20the%20model%20using%20Root%20Mean%20Square%20Error%20(RMSE)%0A%20%20%20%205.%20Do%20some%20feature%20engineering%0A%20%20%20%206.%20Regualization%0A%20%20%20%207.%20Use%20the%20model%0A%20%20%20%20%22%22%22%0A%20%20%20%20)%0A%20%20%20%20return%0A%0A%0A%40app.cell(hide_code%3DTrue)%0Adef%20_(mo)%3A%0A%20%20%20%20mo.md(%0A%20%20%20%20%20%20%20%20r%22%22%22%0A%20%20%20%20%23%23%20Data%20Preparation%0A%0A%20%20%20%20To%20facilitate%20the%20analysis%2C%20the%20CSV%20file%20has%20been%20already%20downloaded%20in%20**data%2Fcar-prices.csv**.%0A%20%20%20%20%22%22%22%0A%20%20%20%20)%0A%20%20%20%20return%0A%0A%0A%40app.cell(hide_code%3DTrue)%0Adef%20_(pd)%3A%0A%20%20%20%20car_prices%20%3D%20pd.read_csv('.%2Fmodule-2%2Fdata%2Fcar-prices.csv')%0A%20%20%20%20car_prices.head()%0A%20%20%20%20return%20(car_prices%2C)%0A%0A%0A%40app.cell(hide_code%3DTrue)%0Adef%20_(mo)%3A%0A%20%20%20%20mo.md(%0A%20%20%20%20%20%20%20%20r%22%22%22%0A%20%20%20%20%23%23%23%20Standardize%20Column%20Names%0A%0A%20%20%20%20Some%20of%20the%20columns%20are%20named%20using%20spaces%20as%20separator%20and%20other%20columns%20were%20named%20using%20underscores%20as%20a%20separator.%20We'll%20now%20standardize%20their%20names.%0A%20%20%20%20%22%22%22%0A%20%20%20%20)%0A%20%20%20%20return%0A%0A%0A%40app.cell(hide_code%3DTrue)%0Adef%20_(car_prices)%3A%0A%20%20%20%20car_prices.columns%20%3D%20car_prices.columns.str.lower().str.replace('%20'%2C%20'_')%0A%20%20%20%20car_prices.head()%0A%20%20%20%20return%0A%0A%0A%40app.cell(hide_code%3DTrue)%0Adef%20_(mo)%3A%0A%20%20%20%20mo.md(%0A%20%20%20%20%20%20%20%20r%22%22%22%0A%20%20%20%20%23%23%23%20Standardize%20Values%0A%0A%20%20%20%20First%20we'll%20get%20the%20list%20of%20all%20string%20columns.%0A%20%20%20%20%22%22%22%0A%20%20%20%20)%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(car_prices)%3A%0A%20%20%20%20def%20get_string_columns(df)%3A%0A%20%20%20%20%20%20%20%20return%20list(df.dtypes%5Bdf.dtypes%20%3D%3D%20'object'%5D.index)%0A%0A%20%20%20%20get_string_columns(car_prices)%0A%20%20%20%20return%20(get_string_columns%2C)%0A%0A%0A%40app.cell(hide_code%3DTrue)%0Adef%20_(car_prices%2C%20get_string_columns)%3A%0A%20%20%20%20for%20string_column%20in%20get_string_columns(car_prices)%3A%0A%20%20%20%20%20%20%20%20car_prices%5Bstring_column%5D%20%3D%20car_prices%5Bstring_column%5D.str.lower().str.replace('%20'%2C%20'_')%0A%0A%20%20%20%20car_prices.head()%0A%20%20%20%20return%0A%0A%0A%40app.cell(hide_code%3DTrue)%0Adef%20_(mo)%3A%0A%20%20%20%20mo.md(%0A%20%20%20%20%20%20%20%20r%22%22%22%0A%20%20%20%20%23%23%20Exploratory%20Data%20Analysis%0A%0A%20%20%20%20%23%23%23%20Check%20Unique%20Values%20per%20Column%0A%20%20%20%20%22%22%22%0A%20%20%20%20)%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(car_prices)%3A%0A%20%20%20%20def%20show_unique_values(df)%3A%0A%20%20%20%20%20%20%20%20unique_values%20%3D%20%7B%7D%0A%0A%20%20%20%20%20%20%20%20for%20described_column%20in%20df.columns%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20unique_values%5Bdescribed_column%5D%20%3D%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%22sample%22%3A%20df%5Bdescribed_column%5D.unique()%5B%3A5%5D%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%22count%22%3A%20df%5Bdescribed_column%5D.nunique()%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%0A%20%20%20%20%20%20%20%20return%20unique_values%0A%0A%20%20%20%20show_unique_values(car_prices)%0A%20%20%20%20return%0A%0A%0A%40app.cell(hide_code%3DTrue)%0Adef%20_(mo)%3A%0A%20%20%20%20mo.md(%0A%20%20%20%20%20%20%20%20r%22%22%22%0A%20%20%20%20%23%23%23%20Check%20the%20Price%20Column%0A%0A%20%20%20%20A%20tiny%20number%20of%20cars%20with%20a%20very%20high%20price%20is%20ruining%20our%20plot.%0A%20%20%20%20%22%22%22%0A%20%20%20%20)%0A%20%20%20%20return%0A%0A%0A%40app.cell(hide_code%3DTrue)%0Adef%20_(car_prices%2C%20sns)%3A%0A%20%20%20%20sns.histplot(car_prices.msrp%2C%20bins%3D100)%0A%20%20%20%20return%0A%0A%0A%40app.cell(hide_code%3DTrue)%0Adef%20_(mo)%3A%0A%20%20%20%20mo.md(r%22%22%22We%20could%20filter%20them%20to%20get%20a%20better%20view%20but%20that%20implies%20making%20a%20choice%20on%20where%20to%20cut.%20Which%20could%20confuse%20our%20model.%22%22%22)%0A%20%20%20%20return%0A%0A%0A%40app.cell(hide_code%3DTrue)%0Adef%20_(car_prices%2C%20sns)%3A%0A%20%20%20%20sns.histplot(car_prices.msrp%5Bcar_prices.msrp%20%3C%20100000%5D%2C%20bins%3D100)%0A%20%20%20%20return%0A%0A%0A%40app.cell(hide_code%3DTrue)%0Adef%20_(mo)%3A%0A%20%20%20%20mo.md(r%22%22%22Instead%20of%20making%20a%20manual%20cut%2C%20we%20can%20take%20the%20logarithm%20of%20the%20price.%20By%20doing%20so%2C%20outlier%20(few%20cases%20with%20extreme%20values)%20are%20handled%20in%20a%20more%20elegant%20way.%22%22%22)%0A%20%20%20%20return%0A%0A%0A%40app.cell(hide_code%3DTrue)%0Adef%20_(car_prices%2C%20np%2C%20sns)%3A%0A%20%20%20%20def%20plot_price_logs(df)%3A%0A%20%20%20%20%20%20%20%20price_logs%20%3D%20np.log1p(df.msrp)%0A%20%20%20%20%20%20%20%20sns.histplot(price_logs%2C%20bins%3D100)%0A%0A%20%20%20%20plot_price_logs(car_prices)%0A%20%20%20%20return%0A%0A%0A%40app.cell(hide_code%3DTrue)%0Adef%20_(mo)%3A%0A%20%20%20%20mo.md(r%22%22%22%23%23%23%20Check%20for%20Empty%20Values%22%22%22)%0A%20%20%20%20return%0A%0A%0A%40app.cell(hide_code%3DTrue)%0Adef%20_(car_prices)%3A%0A%20%20%20%20car_prices.isna().sum()%5Bcar_prices.isna().any()%5D%0A%20%20%20%20return%0A%0A%0A%40app.cell(hide_code%3DTrue)%0Adef%20_(mo)%3A%0A%20%20%20%20mo.md(%0A%20%20%20%20%20%20%20%20r%22%22%22%0A%20%20%20%20%23%23%20Setting%20Up%20the%20Validation%20Framework%0A%0A%20%20%20%20We%20want%20to%20define%20our%20feature%20matrix%20%24X%24%20and%20a%20target%20variable%20%24y%24%20and%20then%20separate%20it%20into%20our%20train%20%24X_T%24%20and%20%24y_T%24%2C%20validation%20%24X_V%24%20and%20%24y_V%24%20and%20test%20%24X_%7Btest%7D%24%20and%20%24t_%7Btest%7D%24%20splits.%0A%20%20%20%20%22%22%22%0A%20%20%20%20)%0A%20%20%20%20return%0A%0A%0A%40app.cell(hide_code%3DTrue)%0Adef%20_(car_prices)%3A%0A%20%20%20%20n%20%3D%20len(car_prices)%0A%20%20%20%20n_val%20%3D%20n_test%20%3D%20int(len(car_prices)%20*%200.2)%0A%20%20%20%20n_train%20%3D%20len(car_prices)%20-%20n_val%20-%20n_test%0A%0A%20%20%20%20%7B%22n%22%3A%20n%2C%20%22n_train%22%3A%20n_train%2C%20%22n_val%22%3A%20n_val%2C%20%22n_test%22%3A%20n_test%7D%0A%20%20%20%20return%20n%2C%20n_train%2C%20n_val%0A%0A%0A%40app.cell(hide_code%3DTrue)%0Adef%20_(mo)%3A%0A%20%20%20%20mo.md(%0A%20%20%20%20%20%20%20%20r%22%22%22%0A%20%20%20%20To%20avoid%20spliting%20the%20records%20in%20the%20same%20order%20they%20have%20in%20the%20dataset%20(so%20that%20we%20don't%20get%20oddly%20distributed%20splits)%2C%20we'll%20make%20a%20randomized%20selection.%0A%0A%20%20%20%20First%2C%20we%20create%20a%20list%20with%20the%20identifiers%20of%20each%20sample%20in%20a%20random%20order.%0A%20%20%20%20%22%22%22%0A%20%20%20%20)%0A%20%20%20%20return%0A%0A%0A%40app.cell(hide_code%3DTrue)%0Adef%20_(n%2C%20np)%3A%0A%20%20%20%20np.random.seed(2)%0A%20%20%20%20shuffled_indexes%20%3D%20np.arange(n)%0A%20%20%20%20np.random.shuffle(shuffled_indexes)%0A%0A%20%20%20%20shuffled_indexes%0A%20%20%20%20return%20(shuffled_indexes%2C)%0A%0A%0A%40app.cell(hide_code%3DTrue)%0Adef%20_(mo)%3A%0A%20%20%20%20mo.md(r%22%22%22Then%20we%20use%20that%20as%20our%20reference%20for%20creating%20our%20splits.%22%22%22)%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(car_prices%2C%20n_train%2C%20n_val%2C%20shuffled_indexes)%3A%0A%20%20%20%20car_prices_train%20%3D%20car_prices.iloc%5Bshuffled_indexes%5B%3An_train%5D%5D%0A%20%20%20%20car_prices_val%20%3D%20car_prices.iloc%5Bshuffled_indexes%5Bn_train%3An_train%2Bn_val%5D%5D%0A%20%20%20%20car_prices_test%20%3D%20car_prices.iloc%5Bshuffled_indexes%5Bn_train%2Bn_val%3A%5D%5D%0A%20%20%20%20return%20car_prices_test%2C%20car_prices_train%2C%20car_prices_val%0A%0A%0A%40app.cell(hide_code%3DTrue)%0Adef%20_(mo)%3A%0A%20%20%20%20mo.md(r%22%22%22As%20our%20index%20column%20has%20now%20a%20random%20order%2C%20we'll%20reset%20it%20in%20each%20of%20the%20splits.%22%22%22)%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(car_prices_test%2C%20car_prices_train%2C%20car_prices_val)%3A%0A%20%20%20%20car_prices_train.reset_index(drop%3DTrue%2C%20inplace%3DTrue)%0A%20%20%20%20car_prices_val.reset_index(drop%3DTrue%2C%20inplace%3DTrue)%0A%20%20%20%20car_prices_test.reset_index(drop%3DTrue%2C%20inplace%3DTrue)%0A%20%20%20%20return%0A%0A%0A%40app.cell(hide_code%3DTrue)%0Adef%20_(mo)%3A%0A%20%20%20%20mo.md(r%22%22%22Now%2C%20we'll%20define%20our%20target%20variables%20adjusting%20the%20price%20column%20using%20the%20logarithm%20function%20described%20above.%22%22%22)%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(car_prices_test%2C%20car_prices_train%2C%20car_prices_val%2C%20np)%3A%0A%20%20%20%20y_train%20%3D%20np.log1p(car_prices_train.msrp.values)%0A%20%20%20%20y_val%20%3D%20np.log1p(car_prices_val.msrp.values)%0A%20%20%20%20y_test%20%3D%20np.log1p(car_prices_test.msrp.values)%0A%20%20%20%20return%20y_train%2C%20y_val%0A%0A%0A%40app.cell(hide_code%3DTrue)%0Adef%20_(mo)%3A%0A%20%20%20%20mo.md(r%22%22%22And%2C%20finally%2C%20we'll%20define%20our%20feature%20matrices.%22%22%22)%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(car_prices_test%2C%20car_prices_train%2C%20car_prices_val)%3A%0A%20%20%20%20X_train%20%3D%20car_prices_train.fillna(0)%0A%20%20%20%20X_val%20%3D%20car_prices_val.fillna(0)%0A%20%20%20%20X_test%20%3D%20car_prices_test.fillna(0)%0A%0A%20%20%20%20del%20X_train%5B%22msrp%22%5D%0A%20%20%20%20del%20X_val%5B%22msrp%22%5D%0A%20%20%20%20del%20X_test%5B%22msrp%22%5D%0A%20%20%20%20return%20X_train%2C%20X_val%0A%0A%0A%40app.cell(hide_code%3DTrue)%0Adef%20_(mo)%3A%0A%20%20%20%20mo.md(r%22%22%22Finally%2C%20let's%20wrap%20all%20this%20into%20a%20funciton.%22%22%22)%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(np)%3A%0A%20%20%20%20def%20prepare_split(df)%3A%0A%20%20%20%20%20%20%20%20df%20%3D%20df.copy()%0A%20%20%20%20%20%20%20%20df.reset_index(drop%3DTrue%2C%20inplace%3DTrue)%0A%0A%20%20%20%20%20%20%20%20y%20%3D%20np.log1p(df.msrp.values)%0A%0A%20%20%20%20%20%20%20%20del%20df%5B%22msrp%22%5D%0A%0A%20%20%20%20%20%20%20%20return%20df%2C%20y%0A%0A%20%20%20%20def%20split_dataset(df)%3A%0A%20%20%20%20%20%20%20%20n%20%3D%20len(df)%0A%20%20%20%20%20%20%20%20n_val%20%3D%20n_test%20%3D%20int(len(df)%20*%200.2)%0A%20%20%20%20%20%20%20%20n_train%20%3D%20len(df)%20-%20n_val%20-%20n_test%0A%0A%20%20%20%20%20%20%20%20np.random.seed(2)%0A%20%20%20%20%20%20%20%20shuffled_indexes%20%3D%20np.arange(n)%0A%20%20%20%20%20%20%20%20np.random.shuffle(shuffled_indexes)%0A%0A%20%20%20%20%20%20%20%20train%20%3D%20prepare_split(df.iloc%5Bshuffled_indexes%5B%3An_train%5D%5D)%0A%20%20%20%20%20%20%20%20val%20%3D%20prepare_split(df.iloc%5Bshuffled_indexes%5Bn_train%3An_train%2Bn_val%5D%5D)%0A%20%20%20%20%20%20%20%20test%20%3D%20prepare_split(df.iloc%5Bshuffled_indexes%5Bn_train%2Bn_val%3A%5D%5D)%0A%0A%20%20%20%20%20%20%20%20return%20train%2C%20val%2C%20test%0A%20%20%20%20return%20(split_dataset%2C)%0A%0A%0A%40app.cell(hide_code%3DTrue)%0Adef%20_(mo)%3A%0A%20%20%20%20mo.md(%0A%20%20%20%20%20%20%20%20r%22%22%22%0A%20%20%20%20%23%23%20Linear%20Regression%0A%0A%20%20%20%20We%20are%20trying%20to%20compute%20a%20%24g%24%20estimator%20function%20so%20that%20given%20the%20features%20of%20a%20car%20%24i%24%3A%0A%0A%20%20%20%20%5C%5B%0A%20%20%20%20%20%20%20%20x_i%20%3D%20(x_%7Bi1%7D%2C%20x_%7Bi2%7D%2C%20...%2C%20x_%7Bin%7D)%0A%20%20%20%20%5C%5D%0A%0A%20%20%20%20Our%20function%20evaluated%20with%20those%20features%20approaches%20the%20target%20price%3A%0A%0A%20%20%20%20%5C%5B%0A%20%20%20%20%20%20%20%20g_i(x_%7Bi1%7D%2C%20x_%7Bi2%7D%2C%20...%2C%20x_%7Bin%7D)%20%5Capprox%20y_i%0A%20%20%20%20%5C%5D%0A%20%20%20%20%22%22%22%0A%20%20%20%20)%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(np)%3A%0A%20%20%20%20def%20raw_linear_regression(x%2C%20w)%3A%0A%20%20%20%20%20%20%20%20assert%20len(x)%20%2B%201%20%3D%3D%20len(w)%2C%20%22The%20size%20of%20the%20features%20vector%20does%20not%20match%20the%20size%20of%20the%20weights%22%0A%0A%20%20%20%20%20%20%20%20y_log%20%3D%20w%5B0%5D%20%2B%20np.sum(%5Bx%5Bi%5D%20*%20w%5Bi%20%2B%201%5D%20for%20i%20in%20range(len(x))%5D)%0A%0A%20%20%20%20%20%20%20%20return%20np.expm1(y_log).astype(int)%0A%20%20%20%20return%20(raw_linear_regression%2C)%0A%0A%0A%40app.cell(hide_code%3DTrue)%0Adef%20_(mo)%3A%0A%20%20%20%20mo.md(r%22%22%22In%20order%20to%20show%20how%20linear%20regression%20works%2C%20we'll%20manually%20compute%20it%20for%20a%20selection%20of%20features%3A%20%60engine_hp%60%2C%20%60city_mpg%60%20and%20%60popularity%60%20of%20a%20randomly%20selected%20car.%22%22%22)%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(X_train)%3A%0A%20%20%20%20def%20select_car(df%2C%20id)%3A%0A%20%20%20%20%20%20%20%20return%20df.iloc%5Bid%3Aid%20%2B%201%5D%0A%0A%20%20%20%20random_car_id%20%3D%2010%0A%20%20%20%20select_car(X_train%2C%20random_car_id)%0A%20%20%20%20return%20random_car_id%2C%20select_car%0A%0A%0A%40app.cell%0Adef%20_(X_train)%3A%0A%20%20%20%20def%20select_features(df)%3A%0A%20%20%20%20%20%20%20%20return%20df%5B%5B%22engine_hp%22%2C%20%22city_mpg%22%2C%20%22popularity%22%5D%5D.values%0A%0A%20%20%20%20select_features(X_train)%0A%20%20%20%20return%20(select_features%2C)%0A%0A%0A%40app.cell%0Adef%20_(X_train%2C%20random_car_id%2C%20select_car%2C%20select_features)%3A%0A%20%20%20%20def%20get_random_car()%3A%0A%20%20%20%20%20%20%20%20return%20select_features(select_car(X_train%2C%20random_car_id))%0A%0A%20%20%20%20get_random_car()%0A%20%20%20%20return%20(get_random_car%2C)%0A%0A%0A%40app.cell(hide_code%3DTrue)%0Adef%20_(mo)%3A%0A%20%20%20%20mo.md(r%22%22%22Given%20the%20%22randomly%22%20chosen%20car%2C%20we'll%20extract%20the%20selected%20features%20and%20its%20corresponding%20price%3A%22%22%22)%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(get_random_car%2C%20np%2C%20random_car_id%2C%20y_train)%3A%0A%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%22x%22%3A%20get_random_car()%5B0%5D%2C%0A%20%20%20%20%20%20%20%20%22y%22%3A%20np.expm1(y_train%5Brandom_car_id%3Arandom_car_id%20%2B%201%5D).astype(int)%0A%20%20%20%20%7D%0A%20%20%20%20return%0A%0A%0A%40app.cell(hide_code%3DTrue)%0Adef%20_(mo)%3A%0A%20%20%20%20mo.md(r%22%22%22Now%20we%20need%20to%20define%20some%20weights.%20Typically%2C%20we'd%20be%20running%20a%20process%20that%20finds%20the%20optimal%20values%20but%20for%20the%20moment%20we'll%20manually%20assign%20them%20some%20numbers%3A%22%22%22)%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(get_random_car%2C%20raw_linear_regression)%3A%0A%20%20%20%20raw_linear_regression(get_random_car()%5B0%5D%2C%20%5B7.5%2C%200.01%2C%200.07%2C%200.003%5D)%0A%20%20%20%20return%0A%0A%0A%40app.cell(hide_code%3DTrue)%0Adef%20_(mo)%3A%0A%20%20%20%20mo.md(%0A%20%20%20%20%20%20%20%20r%22%22%22%0A%20%20%20%20%23%23%20Linear%20Regression%20in%20Vector%20Form%0A%0A%20%20%20%20We%20want%20now%20to%20generalize%20our%20previous%20linear%20regression%20formula%20so%20that%20it%20works%20with%20any%20number%20of%20features%3A%0A%0A%20%20%20%20%5C%5B%0A%20%20%20%20%20%20%20%20g_i(x_i)%20%3D%20w_o%20%2B%20%5Csum_%7Bj%3D1%7D%5En%20x_%7Bij%7D%20w_j%0A%20%20%20%20%5C%5D%0A%0A%20%20%20%20As%20the%20right%20term%20of%20the%20equation%20corresponds%20with%20a%20dot%20product%2C%20we%20can%20rewrite%20it%20in%20a%20simplified%20form%3A%0A%0A%20%20%20%20%5C%5B%0A%20%20%20%20%20%20%20%20g_i(x_i)%20%3D%20w_0%20%2B%20%5Cbold%7Bw%7D%5ET%20%5Cbold%7Bx%7D_i%0A%20%20%20%20%5C%5D%0A%20%20%20%20%22%22%22%0A%20%20%20%20)%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(np)%3A%0A%20%20%20%20def%20vectorial_linear_regression(x%2C%20w)%3A%0A%20%20%20%20%20%20%20%20assert%20len(x)%20%2B%201%20%3D%3D%20len(w)%2C%20%22The%20size%20of%20the%20features%20vector%20does%20not%20match%20the%20size%20of%20the%20weights%22%0A%0A%20%20%20%20%20%20%20%20y_log%20%3D%20w%5B0%5D%20%2B%20np.dot(x%2C%20w%5B1%3A%5D)%0A%0A%20%20%20%20%20%20%20%20return%20np.expm1(y_log).astype(int)%0A%20%20%20%20return%20(vectorial_linear_regression%2C)%0A%0A%0A%40app.cell%0Adef%20_(get_random_car%2C%20vectorial_linear_regression)%3A%0A%20%20%20%20vectorial_linear_regression(get_random_car()%5B0%5D%2C%20%5B7.5%2C%200.01%2C%200.07%2C%200.003%5D)%0A%20%20%20%20return%0A%0A%0A%40app.cell(hide_code%3DTrue)%0Adef%20_(mo)%3A%0A%20%20%20%20mo.md(%0A%20%20%20%20%20%20%20%20r%22%22%22%0A%20%20%20%20If%20we%20want%2C%20we%20can%20simplify%20our%20expression%20even%20further%20by%20defining%20an%20extra%20feature%20that%20always%20equals%20%241%24.%20By%20doing%20so%2C%20we'd%20get%20%24%5Cbold%7Bw%7D%24%20and%20%24%5Cbold%7Bx%7D%24%20vectors%20with%20%24n%2B1%24%20elements%3A%0A%0A%20%20%20%20%5C%5B%0A%20%20%20%20%20%20%20%20w%20%3D%20%5Bw_0%2C%20w_1%2C%20...%2C%20w_n%5D%0A%20%20%20%20%5C%5D%0A%0A%20%20%20%20%5C%5B%0A%20%20%20%20%20%20%20%20x_i%20%3D%20%5B1%2C%20x_%7Bi1%7D%2C%20x_%7Bi2%7D%2C%20...%2C%20x_%7Bin%7D%5D%0A%20%20%20%20%5C%5D%0A%0A%20%20%20%20Therefore%2C%20our%20estimator%20could%20be%20written%20as%3A%0A%0A%20%20%20%20%5C%5B%0A%20%20%20%20%20%20%20%20g_i(x_i)%20%3D%20%5Cbold%7Bw%7D%5ET%20%5Cbold%7Bx%7D_i%0A%20%20%20%20%5C%5D%0A%20%20%20%20%22%22%22%0A%20%20%20%20)%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(np)%3A%0A%20%20%20%20def%20final_linear_regression(x%2C%20w)%3A%0A%20%20%20%20%20%20%20%20assert%20len(x)%20%2B%201%20%3D%3D%20len(w)%2C%20%22The%20size%20of%20the%20features%20vector%20does%20not%20match%20the%20size%20of%20the%20weights%22%0A%0A%20%20%20%20%20%20%20%20x%20%3D%20np.concat((np.array(%5B1%5D)%2C%20np.array(x)))%0A%20%20%20%20%20%20%20%20y_log%20%3D%20np.dot(x%2C%20w)%0A%0A%20%20%20%20%20%20%20%20return%20np.expm1(y_log).astype(int)%0A%20%20%20%20return%20(final_linear_regression%2C)%0A%0A%0A%40app.cell%0Adef%20_(final_linear_regression%2C%20get_random_car)%3A%0A%20%20%20%20final_linear_regression(get_random_car()%5B0%5D%2C%20%5B7.5%2C%200.01%2C%200.07%2C%200.003%5D)%0A%20%20%20%20return%0A%0A%0A%40app.cell(hide_code%3DTrue)%0Adef%20_(mo)%3A%0A%20%20%20%20mo.md(%0A%20%20%20%20%20%20%20%20r%22%22%22%0A%20%20%20%20We%20can%20write%20our%20%24g%24%20function%20for%20all%20samples%20as%20a%20matrix%20multiplication.%0A%0A%20%20%20%20%5C%5B%0A%20%20%20%20%5Cbold%7By_p%7D%20%3D%20%0A%20%20%20%20%5Cbegin%7Bbmatrix%7D%0A%20%20%20%201%20%26%20x_%7B11%7D%20%26%20x_%7B12%7D%20%26%20%5Ccdots%20%26%20x_%7B1n%7D%20%5C%5C%0A%20%20%20%201%20%26%20x_%7B21%7D%20%26%20x_%7B22%7D%20%26%20%5Ccdots%20%26%20x_%7B2n%7D%20%5C%5C%0A%20%20%20%20%5Cvdots%20%26%20%5Cvdots%20%26%20%5Cvdots%20%26%20%5Cddots%20%26%20%5Cvdots%20%5C%5C%0A%20%20%20%201%20%26%20x_%7Bm1%7D%20%26%20x_%7Bm2%7D%20%26%20%5Ccdots%20%26%20x_%7Bmn%7D%0A%20%20%20%20%5Cend%7Bbmatrix%7D%0A%20%20%20%20%5Cbegin%7Bbmatrix%7D%0A%20%20%20%20w_0%20%5C%5C%0A%20%20%20%20w_1%20%5C%5C%0A%20%20%20%20w_2%20%5C%5C%0A%20%20%20%20%5Cvdots%20%5C%5C%0A%20%20%20%20w_n%0A%20%20%20%20%5Cend%7Bbmatrix%7D%0A%20%20%20%20%3D%0A%20%20%20%20%5Cbegin%7Bbmatrix%7D%0A%20%20%20%20%5Cbold%7Bx_1%7D%5ET%20%C2%B7%20%5Cbold%7Bw%7D%20%5C%5C%0A%20%20%20%20%5Cbold%7Bx_2%7D%5ET%20%C2%B7%20%5Cbold%7Bw%7D%20%5C%5C%0A%20%20%20%20%5Cvdots%20%5C%5C%0A%20%20%20%20%5Cbold%7Bx_m%7D%5ET%20%C2%B7%20%5Cbold%7Bw%7D%20%5C%5C%0A%20%20%20%20%5Cend%7Bbmatrix%7D%0A%20%20%20%20%5C%5D%0A%20%20%20%20%22%22%22%0A%20%20%20%20)%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(X_train%2C%20np%2C%20select_features)%3A%0A%20%20%20%20X_matrix%20%3D%20select_features(X_train.iloc%5B10%3A15%5D)%0A%20%20%20%20X_matrix%20%3D%20np.c_%5Bnp.ones(X_matrix.shape%5B0%5D)%2C%20X_matrix%5D%0A%0A%20%20%20%20X_matrix%0A%20%20%20%20return%20(X_matrix%2C)%0A%0A%0A%40app.cell%0Adef%20_(np%2C%20y_train)%3A%0A%20%20%20%20y_matrix%20%3D%20y_train%5B10%3A15%5D%0A%0A%20%20%20%20np.expm1(y_matrix).astype(int)%0A%20%20%20%20return%20(y_matrix%2C)%0A%0A%0A%40app.cell%0Adef%20_()%3A%0A%20%20%20%20w%20%3D%20%5B7.5%2C%200.01%2C%200.07%2C%200.003%5D%0A%0A%20%20%20%20w%0A%20%20%20%20return%20(w%2C)%0A%0A%0A%40app.cell%0Adef%20_(X_matrix%2C%20np%2C%20w)%3A%0A%20%20%20%20np.expm1(X_matrix.dot(w)).astype(int)%0A%20%20%20%20return%0A%0A%0A%40app.cell(hide_code%3DTrue)%0Adef%20_(mo)%3A%0A%20%20%20%20mo.md(%0A%20%20%20%20%20%20%20%20r%22%22%22%0A%20%20%20%20%23%23%20Training%20a%20Linear%20Regression%20Model%0A%0A%20%20%20%20We%20already%20saw%20that%20our%20%24g%24%20estimator%20looks%20like%20this%3A%0A%0A%20%20%20%20%5C%5B%0A%20%20%20%20%20%20%20%20%5Cbold%7BX%7D%20%5Cbold%7Bw%7D%20%5Capprox%20%5Cbold%7By%7D%0A%20%20%20%20%5C%5D%0A%0A%20%20%20%20So%20now%20we%20have%20to%20solve%20%24%5Cbold%7Bw%7D%24%20so%20that%20we%20can%20find%20the%20weights.%0A%0A%20%20%20%20%5C%5B%0A%20%20%20%20%20%20%20%20%5Cbold%7BX%7D%5E%7B-1%7D%20%5Cbold%7BX%7D%20%5Cbold%7Bw%7D%20%5Capprox%20%5Cbold%7BX%7D%5E%7B-1%7D%20%5Cbold%7By%7D%0A%20%20%20%20%5C%5D%0A%0A%20%20%20%20What%20gives%20us%3A%0A%0A%20%20%20%20%5C%5B%0A%20%20%20%20%20%20%20%20%5Cbold%7Bw%7D%20%5Capprox%20%5Cbold%7BX%7D%5E%7B-1%7D%20%5Cbold%7By%7D%0A%20%20%20%20%5C%5D%0A%0A%20%20%20%20But%20there%20is%20an%20issue%3A%20we%20are%20working%20with%20a%20rectangular%20matrix%2C%20not%20with%20a%20squared%20one.%20So%20we%20won't%20be%20able%20to%20find%20its%20inverse.%0A%20%20%20%20%22%22%22%0A%20%20%20%20)%0A%20%20%20%20return%0A%0A%0A%40app.cell(hide_code%3DTrue)%0Adef%20_(mo)%3A%0A%20%20%20%20mo.md(%0A%20%20%20%20%20%20%20%20r%22%22%22%0A%20%20%20%20%23%23%23%20Gram%20Matrix%0A%0A%20%20%20%20The%20first%20thing%20we%20can%20do%20to%20try%20to%20solve%20this%20is%20to%20take%20into%20account%20that%20%24X%5ET%20X%24%20is%20actually%20an%20squared%20matrix%2C%20it%20may%20have%20an%20inverse.%0A%0A%20%20%20%20Therefore%2C%20we%20could%20start%20with%3A%0A%0A%20%20%20%20%5C%5B%0A%20%20%20%20%20%20%20%20%5Cbold%7BX%7D%5E%7BT%7D%20%5Cbold%7BX%7D%20%5Cbold%7Bw%7D%20%5Capprox%20%5Cbold%7BX%7D%5E%7BT%7D%20%5Cbold%7By%7D%0A%20%20%20%20%5C%5D%0A%0A%20%20%20%20...%20and%20try%20to%20solve%20it%20with%3A%0A%0A%20%20%20%20%5C%5B%0A%20%20%20%20%20%20%20%20(%5Cbold%7BX%7D%5E%7BT%7D%20%5Cbold%7BX%7D)%5E%7B-1%7D%20%5Cbold%7BX%7D%5E%7BT%7D%20%5Cbold%7BX%7D%20%5Cbold%7Bw%7D%20%5Capprox%20(%5Cbold%7BX%7D%5E%7BT%7D%20%5Cbold%7BX%7D)%5E%7B-1%7D%20%5Cbold%7BX%7D%5E%7BT%7D%20%5Cbold%7By%7D%0A%20%20%20%20%5C%5D%0A%0A%20%20%20%20...%20which%20simplifies%20to%3A%0A%0A%20%20%20%20%5C%5B%0A%20%20%20%20%20%20%20%20%5Cbold%7Bw%7D%20%5Capprox%20(%5Cbold%7BX%7D%5E%7BT%7D%20%5Cbold%7BX%7D)%5E%7B-1%7D%20%5Cbold%7BX%7D%5E%7BT%7D%20%5Cbold%7By%7D%0A%20%20%20%20%5C%5D%0A%20%20%20%20%22%22%22%0A%20%20%20%20)%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(X_matrix%2C%20np%2C%20y_matrix)%3A%0A%20%20%20%20def%20solve_linear_regression(X%2C%20y)%3A%0A%20%20%20%20%20%20%20%20return%20np.linalg.inv(X.T.dot(X)).dot(X.T).dot(y)%0A%0A%20%20%20%20solve_linear_regression(X_matrix%2C%20y_matrix)%0A%20%20%20%20return%20(solve_linear_regression%2C)%0A%0A%0A%40app.cell%0Adef%20_(X_matrix%2C%20np%2C%20solve_linear_regression%2C%20y_matrix)%3A%0A%20%20%20%20def%20predict_price(X%2C%20y)%3A%0A%20%20%20%20%20%20%20%20w%20%3D%20solve_linear_regression(X%2C%20y)%0A%20%20%20%20%20%20%20%20y%20%3D%20X.dot(w)%0A%20%20%20%20%20%20%20%20return%20np.expm1(y).astype(int)%0A%0A%20%20%20%20predict_price(X_matrix%2C%20y_matrix)%0A%20%20%20%20return%0A%0A%0A%40app.cell(hide_code%3DTrue)%0Adef%20_(mo)%3A%0A%20%20%20%20mo.md(%0A%20%20%20%20%20%20%20%20r%22%22%22%0A%20%20%20%20%23%23%20Baseline%20Model%20for%20Car%20Price%20Prediction%20Project%0A%0A%20%20%20%20We'll%20start%20by%20selecting%20all%20the%20numerical%20features%20from%20our%20train%20dataset.%0A%20%20%20%20%22%22%22%0A%20%20%20%20)%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(X_train)%3A%0A%20%20%20%20def%20naive_prepare_X(X)%3A%0A%20%20%20%20%20%20%20%20return%20X.select_dtypes(include%3D%22number%22).values%0A%0A%20%20%20%20naive_prepare_X(X_train)%0A%20%20%20%20return%20(naive_prepare_X%2C)%0A%0A%0A%40app.cell%0Adef%20_(y_train)%3A%0A%20%20%20%20y_train%0A%20%20%20%20return%0A%0A%0A%40app.cell(hide_code%3DTrue)%0Adef%20_(mo)%3A%0A%20%20%20%20mo.md(r%22%22%22Now%2C%20following%20the%20same%20formula%20we%20used%20in%20the%20previous%20section%2C%20we%20define%20our%20training%20function%2C%20which%20will%20take%20the%20features%20and%20target%20variable%20and%20return%20the%20corresponding%20weights.%22%22%22)%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(X_train%2C%20naive_prepare_X%2C%20solve_linear_regression%2C%20y_train)%3A%0A%20%20%20%20solve_linear_regression(naive_prepare_X(X_train)%2C%20y_train)%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(X_train%2C%20naive_prepare_X%2C%20solve_linear_regression%2C%20y_train)%3A%0A%20%20%20%20def%20naive_predict(X%2C%20y)%3A%0A%20%20%20%20%20%20%20%20w%20%3D%20solve_linear_regression(naive_prepare_X(X)%2C%20y)%0A%20%20%20%20%20%20%20%20return%20naive_prepare_X(X).dot(w)%0A%0A%20%20%20%20naive_predict(X_train%2C%20y_train)%0A%20%20%20%20return%20(naive_predict%2C)%0A%0A%0A%40app.cell(hide_code%3DTrue)%0Adef%20_(mo)%3A%0A%20%20%20%20mo.md(r%22%22%22By%20plotting%20at%20the%20same%20time%20the%20target%20variable%20we%20used%20during%20training%20and%20our%20predictions%2C%20we%20can%20have%20a%20first%20idea%20about%20how%20good%20our%20model%20is.%22%22%22)%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(X_train%2C%20naive_predict%2C%20sns%2C%20y_train)%3A%0A%20%20%20%20sns.histplot(y_train%2C%20color%3D%22blue%22)%0A%20%20%20%20sns.histplot(naive_predict(X_train%2C%20y_train)%2C%20color%3D%22red%22%2C%20alpha%3D0.5)%0A%20%20%20%20return%0A%0A%0A%40app.cell(hide_code%3DTrue)%0Adef%20_(mo)%3A%0A%20%20%20%20mo.md(%0A%20%20%20%20%20%20%20%20r%22%22%22%0A%20%20%20%20%23%23%20Root%20Mean%20Squared%20Error%0A%0A%20%20%20%20In%20order%20to%20measure%20how%20good%20our%20model%20performs%2C%20we'll%20use%20%60RMSE%60%2C%20which%20is%20a%20metric%20that%20will%20tell%20us%20how%20good%20(or%20bad)%20our%20model%20predicted%20by%20checking%20the%20average%20of%20the%20squared%20difference%20between%20our%20predictions%60g(x_i)%60%20and%20the%20target%20values%20%60y_i%60%3A%0A%0A%20%20%20%20%5C%5B%0A%20%20%20%20%20%20%20%20RMSE%20%3D%20%5Cfrac%7B1%7D%7Bn%7D%20%5Csum_%7Bi%3D0%7D%5En%20(g(x_i)%20-%20y_i)%5E2%0A%20%20%20%20%5C%5D%0A%20%20%20%20%22%22%22%0A%20%20%20%20)%0A%20%20%20%20return%0A%0A%0A%40app.function%0Adef%20rmse(y_predicted%2C%20y_real)%3A%0A%20%20%20%20n%20%3D%20len(y_real)%0A%20%20%20%20return%20(((y_predicted%20-%20y_real)**2)%20%2F%20n).sum()%0A%0A%0A%40app.cell%0Adef%20_(X_train%2C%20naive_predict%2C%20y_train)%3A%0A%20%20%20%20rmse(%0A%20%20%20%20%20%20%20%20naive_predict(X_train%2C%20y_train)%2C%0A%20%20%20%20%20%20%20%20y_train%0A%20%20%20%20)%0A%20%20%20%20return%0A%0A%0A%40app.cell(hide_code%3DTrue)%0Adef%20_(mo)%3A%0A%20%20%20%20mo.md(%0A%20%20%20%20%20%20%20%20r%22%22%22%0A%20%20%20%20%23%23%20Using%20RMSE%20on%20Validation%20Data%0A%0A%20%20%20%20In%20the%20previous%20chapter%20we%20used%20%60RMSE%60%20on%20the%20same%20dataset%20we%20used%20to%20train%20our%20model%2C%20which%20isn't%20what%20we%20want.%20Instead%2C%20we%20want%20to%20use%20the%20validate%20split%20we%20created%20already.%0A%20%20%20%20%22%22%22%0A%20%20%20%20)%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(X_val%2C%20naive_predict%2C%20y_val)%3A%0A%20%20%20%20naive_predict(X_val%2C%20y_val)%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(X_val%2C%20naive_predict%2C%20y_val)%3A%0A%20%20%20%20rmse(%0A%20%20%20%20%20%20%20%20naive_predict(X_val%2C%20y_val)%2C%0A%20%20%20%20%20%20%20%20y_val%0A%20%20%20%20)%0A%20%20%20%20return%0A%0A%0A%40app.cell(hide_code%3DTrue)%0Adef%20_(mo)%3A%0A%20%20%20%20mo.md(%0A%20%20%20%20%20%20%20%20r%22%22%22%0A%20%20%20%20%23%23%20Feature%20Engineering%0A%0A%20%20%20%20Let's%20add%20a%20feature%20that%20computes%20the%20age%20of%20the%20cars.%0A%20%20%20%20%22%22%22%0A%20%20%20%20)%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_()%3A%0A%20%20%20%20from%20datetime%20import%20datetime%0A%0A%20%20%20%20def%20feature_prepare_X(X)%3A%0A%20%20%20%20%20%20%20%20X%20%3D%20X.copy()%0A%20%20%20%20%20%20%20%20X%5B%22age%22%5D%20%3D%20datetime.today().year%20-%20X.year%0A%20%20%20%20%20%20%20%20return%20X.select_dtypes(include%3D%22number%22).values%0A%20%20%20%20return%20datetime%2C%20feature_prepare_X%0A%0A%0A%40app.cell%0Adef%20_(X_train%2C%20feature_prepare_X)%3A%0A%20%20%20%20feature_prepare_X(X_train)%0A%20%20%20%20return%0A%0A%0A%40app.cell(hide_code%3DTrue)%0Adef%20_(mo)%3A%0A%20%20%20%20mo.md(r%22%22%22Retraining%20our%20model%20we%20can%20see%20how%20it%20performs%20better%20with%20the%20additional%20feature.%22%22%22)%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(feature_prepare_X%2C%20solve_linear_regression)%3A%0A%20%20%20%20def%20feature_train_and_predict(X_train%2C%20y_train%2C%20X_val%2C%20y_val)%3A%0A%20%20%20%20%20%20%20%20w%20%3D%20solve_linear_regression(feature_prepare_X(X_train)%2C%20y_train)%0A%20%20%20%20%20%20%20%20return%20feature_prepare_X(X_val).dot(w)%0A%20%20%20%20return%20(feature_train_and_predict%2C)%0A%0A%0A%40app.cell%0Adef%20_(X_train%2C%20X_val%2C%20feature_train_and_predict%2C%20y_train%2C%20y_val)%3A%0A%20%20%20%20rmse(%0A%20%20%20%20%20%20%20%20feature_train_and_predict(X_train%2C%20y_train%2C%20X_val%2C%20y_val)%2C%0A%20%20%20%20%20%20%20%20y_val%0A%20%20%20%20)%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(X_train%2C%20X_val%2C%20feature_train_and_predict%2C%20sns%2C%20y_train%2C%20y_val)%3A%0A%20%20%20%20sns.histplot(y_val%2C%20color%3D%22blue%22)%0A%20%20%20%20sns.histplot(feature_train_and_predict(X_train%2C%20y_train%2C%20X_val%2C%20y_val)%2C%20color%3D%22red%22%2C%20alpha%3D0.5)%0A%20%20%20%20return%0A%0A%0A%40app.cell(hide_code%3DTrue)%0Adef%20_(mo)%3A%0A%20%20%20%20mo.md(r%22%22%22%23%23%20Categorical%20Variables%22%22%22)%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(X_train)%3A%0A%20%20%20%20def%20categorize_column(df%2C%20column_name%2C%20transform%3DNone%2C%20drop_first%3DTrue)%3A%0A%20%20%20%20%20%20%20%20df%20%3D%20df.copy()%0A%0A%20%20%20%20%20%20%20%20if%20not%20transform%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20unique_values%20%3D%20sorted(df%5Bcolumn_name%5D.unique().astype(str))%0A%20%20%20%20%20%20%20%20else%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20unique_values%20%3D%20sorted(df%5Bcolumn_name%5D.unique())%0A%0A%20%20%20%20%20%20%20%20%23%20Skip%20the%20first%20value%20if%20drop_first%20is%20True%0A%20%20%20%20%20%20%20%20start_idx%20%3D%201%20if%20drop_first%20else%200%0A%0A%20%20%20%20%20%20%20%20for%20value%20in%20unique_values%5Bstart_idx%3A%5D%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20transformed_value%20%3D%20transform(value)%20if%20callable(transform)%20else%20value%0A%20%20%20%20%20%20%20%20%20%20%20%20df%5Bcolumn_name%20%2B%20%22_%22%20%2B%20str(transformed_value)%5D%20%3D%20(df%5Bcolumn_name%5D%20%3D%3D%20value).astype(int)%0A%0A%20%20%20%20%20%20%20%20return%20df%0A%0A%20%20%20%20categorize_column(X_train%2C%20%22number_of_doors%22%2C%20int)%0A%20%20%20%20return%20(categorize_column%2C)%0A%0A%0A%40app.cell%0Adef%20_(car_prices%2C%20categorize_column%2C%20datetime)%3A%0A%20%20%20%20def%20categorize_prepare(%0A%20%20%20%20%20%20%20%20X%2C%0A%20%20%20%20%20%20%20%20categorical_columns%20%3D%20%5B%22make%22%2C%20%22engine_fuel_type%22%2C%20%22transmission_type%22%2C%20%22driven_wheels%22%2C%20%22vehicle_size%22%2C%20%22vehicle_style%22%5D%0A%20%20%20%20)%3A%0A%20%20%20%20%20%20%20%20X%20%3D%20X.copy()%0A%20%20%20%20%20%20%20%20X%20%3D%20X.fillna(0)%0A%0A%20%20%20%20%20%20%20%20X%5B%22age%22%5D%20%3D%20datetime.today().year%20-%20X.year%0A%0A%20%20%20%20%20%20%20%20%23%20We'll%20ignore%20model%20and%20market%20category%20as%20they%20are%20too%20fragmented%0A%20%20%20%20%20%20%20%20if%20%22model%22%20in%20X%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20del%20X%5B%22model%22%5D%0A%0A%20%20%20%20%20%20%20%20if%20%22market_category%22%20in%20X%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20del%20X%5B%22market_category%22%5D%0A%0A%20%20%20%20%20%20%20%20X%20%3D%20categorize_column(X%2C%20%22number_of_doors%22%2C%20int)%0A%0A%20%20%20%20%20%20%20%20for%20categorical_column%20in%20categorical_columns%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20X%20%3D%20categorize_column(X%2C%20categorical_column)%0A%0A%20%20%20%20%20%20%20%20del%20X%5B%22number_of_doors%22%5D%0A%20%20%20%20%20%20%20%20del%20X%5B%22make%22%5D%0A%20%20%20%20%20%20%20%20del%20X%5B%22engine_fuel_type%22%5D%0A%20%20%20%20%20%20%20%20del%20X%5B%22transmission_type%22%5D%0A%20%20%20%20%20%20%20%20del%20X%5B%22driven_wheels%22%5D%0A%20%20%20%20%20%20%20%20del%20X%5B%22vehicle_size%22%5D%0A%20%20%20%20%20%20%20%20del%20X%5B%22vehicle_style%22%5D%0A%0A%20%20%20%20%20%20%20%20return%20X%0A%0A%20%20%20%20categorize_prepare(car_prices).head()%0A%20%20%20%20return%20(categorize_prepare%2C)%0A%0A%0A%40app.cell%0Adef%20_(solve_linear_regression)%3A%0A%20%20%20%20def%20categorized_train_and_predict(X_train%2C%20y_train%2C%20X_val%2C%20y_val)%3A%0A%20%20%20%20%20%20%20%20w%20%3D%20solve_linear_regression(X_train%2C%20y_train)%0A%20%20%20%20%20%20%20%20return%20X_val.dot(w)%0A%20%20%20%20return%20(categorized_train_and_predict%2C)%0A%0A%0A%40app.cell(hide_code%3DTrue)%0Adef%20_(mo)%3A%0A%20%20%20%20mo.md(r%22%22%22At%20this%20point%20we'd%20expect%20to%20solve%20our%20system%20and%20obtain%20a%20better%20performance.%20But%20we'll%20very%20likely%20get%20a%20horrible%20result.%20Maybe%20even%20a%20_Singular%20matrix_%20error!%22%22%22)%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(%0A%20%20%20%20car_prices%2C%0A%20%20%20%20categorize_prepare%2C%0A%20%20%20%20categorized_train_and_predict%2C%0A%20%20%20%20split_dataset%2C%0A)%3A%0A%20%20%20%20def%20categorized_eval()%3A%0A%20%20%20%20%20%20%20%20df_categorized%20%3D%20categorize_prepare(car_prices%2C%20%5B%22make%22%2C%20%22vehicle_size%22%5D)%0A%20%20%20%20%20%20%20%20df_train%2C%20df_val%2C%20df_test%20%3D%20split_dataset(df_categorized)%0A%0A%20%20%20%20%20%20%20%20X_train%2C%20y_train%20%3D%20df_train%0A%20%20%20%20%20%20%20%20X_val%2C%20y_val%20%3D%20df_val%0A%0A%20%20%20%20%20%20%20%20return%20rmse(%0A%20%20%20%20%20%20%20%20%20%20%20%20categorized_train_and_predict(X_train%2C%20y_train%2C%20X_val%2C%20y_val)%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20y_val%0A%20%20%20%20%20%20%20%20)%0A%0A%20%20%20%20categorized_eval()%0A%20%20%20%20return%0A%0A%0A%40app.cell(hide_code%3DTrue)%0Adef%20_(mo)%3A%0A%20%20%20%20mo.md(%0A%20%20%20%20%20%20%20%20r%22%22%22%0A%20%20%20%20%23%23%20Regularization%0A%0A%20%20%20%20When%20we%20introduced%20categorical%20variables%20in%20our%20model%2C%20we%20also%20increased%20the%20chance%20of%20having%20features%20that%20are%20dependent%20of%20each%20other.%20For%20instance%2C%20if%20we%20had%203%20possible%20values%20for%20**number%20of%20doors**%20and%20we%20created%203%20boolean%20columns%2C%20one%20for%20each%20of%20the%20values%2C%20then%20each%20of%20the%20columns%20could%20be%20deduced%20from%20the%20others.%20In%20other%20words%2C%20they%20would%20be%20linearly%20dependent.%20That%20means%20that%20the%20inverse%20of%20%24X%5ET%20X%24%20won't%20even%20be%20defined.%0A%0A%20%20%20%20In%20order%20to%20solve%20this%2C%20one%20approach%20is%20to%20add%20a%20diagonal%20multiplied%20by%20a%20small%20factor%20so%20that%20we%20get%20a%20%24X%5ET%20X%20%2B%20%5Cdelta%20%5Cmathbb%7BI%7D%24%20that%20has%20an%20inverse.%0A%20%20%20%20%22%22%22%0A%20%20%20%20)%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_()%3A%0A%20%20%20%20delta%20%3D%200.01%0A%20%20%20%20return%20(delta%2C)%0A%0A%0A%40app.cell%0Adef%20_(np)%3A%0A%20%20%20%20def%20regularize_and_solve_linear_regression(X%2C%20y%2C%20delta)%3A%0A%20%20%20%20%20%20%20%20return%20np.linalg.inv(X.T.dot(X)%20%2B%20delta%20*%20np.eye(X.shape%5B1%5D)).dot(X.T).dot(y)%0A%20%20%20%20return%20(regularize_and_solve_linear_regression%2C)%0A%0A%0A%40app.cell%0Adef%20_(regularize_and_solve_linear_regression)%3A%0A%20%20%20%20def%20regularized_train_and_predict(X_train%2C%20y_train%2C%20X_val%2C%20y_val%2C%20delta)%3A%0A%20%20%20%20%20%20%20%20w%20%3D%20regularize_and_solve_linear_regression(X_train%2C%20y_train%2C%20delta)%0A%20%20%20%20%20%20%20%20return%20X_val.dot(w)%0A%20%20%20%20return%20(regularized_train_and_predict%2C)%0A%0A%0A%40app.cell%0Adef%20_(%0A%20%20%20%20car_prices%2C%0A%20%20%20%20categorize_prepare%2C%0A%20%20%20%20delta%2C%0A%20%20%20%20regularized_train_and_predict%2C%0A%20%20%20%20split_dataset%2C%0A)%3A%0A%20%20%20%20def%20regularize_categorized_eval(delta)%3A%0A%20%20%20%20%20%20%20%20df_categorized%20%3D%20categorize_prepare(car_prices)%0A%20%20%20%20%20%20%20%20df_train%2C%20df_val%2C%20df_test%20%3D%20split_dataset(df_categorized)%0A%0A%20%20%20%20%20%20%20%20X_train%2C%20y_train%20%3D%20df_train%0A%20%20%20%20%20%20%20%20X_val%2C%20y_val%20%3D%20df_val%0A%0A%20%20%20%20%20%20%20%20return%20rmse(%0A%20%20%20%20%20%20%20%20%20%20%20%20regularized_train_and_predict(X_train%2C%20y_train%2C%20X_val%2C%20y_val%2C%20delta)%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20y_val%0A%20%20%20%20%20%20%20%20)%0A%0A%20%20%20%20regularize_categorized_eval(delta)%0A%20%20%20%20return%20(regularize_categorized_eval%2C)%0A%0A%0A%40app.cell(hide_code%3DTrue)%0Adef%20_(mo)%3A%0A%20%20%20%20mo.md(%0A%20%20%20%20%20%20%20%20r%22%22%22%0A%20%20%20%20%23%23%20Tuning%20the%20Model%0A%0A%20%20%20%20To%20obtain%20the%20best%20%24delta%24%20for%20our%20model%2C%20we%20can%20start%20by%20just%20trying%20some%20values%3A%0A%20%20%20%20%22%22%22%0A%20%20%20%20)%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(np%2C%20regularize_categorized_eval)%3A%0A%20%20%20%20def%20find_delta()%3A%0A%20%20%20%20%20%20%20%20results%20%3D%20%7B%7D%0A%0A%20%20%20%20%20%20%20%20for%20n%20in%20np.linspace(9.5%2C%2010%2C%2020)%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20delta%20%3D%201%2F(10**n)%0A%20%20%20%20%20%20%20%20%20%20%20%20results%5Bdelta%5D%20%3D%20regularize_categorized_eval(delta)%0A%0A%20%20%20%20%20%20%20%20return%20results%0A%0A%20%20%20%20regularization_deltas%20%3D%20find_delta()%0A%0A%20%20%20%20regularization_deltas%0A%20%20%20%20return%20(regularization_deltas%2C)%0A%0A%0A%40app.cell%0Adef%20_(plt%2C%20regularization_deltas)%3A%0A%20%20%20%20def%20plot_deltas(regularization_deltas)%3A%0A%20%20%20%20%20%20%20%20x%20%3D%20regularization_deltas.keys()%0A%20%20%20%20%20%20%20%20y%20%3D%20regularization_deltas.values()%0A%20%20%20%20%20%20%20%20plt.plot(x%2C%20y)%0A%20%20%20%20%20%20%20%20plt.xlabel('%CE%B4')%0A%20%20%20%20%20%20%20%20plt.ylabel('RMSE')%0A%20%20%20%20%20%20%20%20plt.show()%0A%0A%20%20%20%20plot_deltas(regularization_deltas)%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(regularization_deltas)%3A%0A%20%20%20%20def%20get_min_regularization(regularization_deltas)%3A%0A%20%20%20%20%20%20%20%20min_delta%20%3D%20None%0A%20%20%20%20%20%20%20%20min_rmse%20%3D%20None%0A%0A%20%20%20%20%20%20%20%20for%20delta%2C%20rmse%20in%20regularization_deltas.items()%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20min_rmse%20is%20None%20or%20rmse%20%3C%20min_rmse%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20min_rmse%20%3D%20rmse%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20min_delta%20%3D%20delta%0A%0A%20%20%20%20%20%20%20%20return%20(min_delta%2C%20min_rmse)%0A%0A%20%20%20%20(regularization_delta%2C%20_)%20%3D%20get_min_regularization(regularization_deltas)%0A%20%20%20%20return%20(regularization_delta%2C)%0A%0A%0A%40app.cell%0Adef%20_(regularization_delta%2C%20regularize_categorized_eval)%3A%0A%20%20%20%20regularize_categorized_eval(regularization_delta)%0A%20%20%20%20return%0A%0A%0A%40app.cell(hide_code%3DTrue)%0Adef%20_(mo)%3A%0A%20%20%20%20mo.md(%0A%20%20%20%20%20%20%20%20r%22%22%22%0A%20%20%20%20%23%23%20Using%20the%20Model%0A%0A%20%20%20%20At%20this%20point%2C%20we'll%20train%20our%20%60g%60%20model%20on%20a%20split%20that%20combines%20the%20train%20and%20validation%20splits.%0A%20%20%20%20%22%22%22%0A%20%20%20%20)%0A%20%20%20%20return%0A%0A%0A%40app.cell(hide_code%3DTrue)%0Adef%20_(mo)%3A%0A%20%20%20%20mo.md(r%22%22%22%23%23%23%20Prepare%20a%20Merged%20Dataset%20with%20Train%20and%20Validation%22%22%22)%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(car_prices%2C%20categorize_prepare%2C%20np%2C%20split_dataset)%3A%0A%20%20%20%20def%20get_full_train()%3A%0A%20%20%20%20%20%20%20%20df_categorized%20%3D%20categorize_prepare(car_prices)%0A%20%20%20%20%20%20%20%20df_train%2C%20df_val%2C%20df_test%20%3D%20split_dataset(df_categorized)%0A%0A%20%20%20%20%20%20%20%20X_train%2C%20y_train%20%3D%20df_train%0A%20%20%20%20%20%20%20%20X_val%2C%20y_val%20%3D%20df_val%0A%20%20%20%20%20%20%20%20X_test%2C%20y_test%20%3D%20df_test%0A%0A%20%20%20%20%20%20%20%20X%20%3D%20np.concat(%5BX_train%2C%20X_val%5D)%0A%20%20%20%20%20%20%20%20y%20%3D%20np.concat(%5By_train%2C%20y_val%5D)%0A%0A%20%20%20%20%20%20%20%20return%20X%2C%20y%2C%20X_test.values%2C%20y_test%0A%0A%20%20%20%20get_full_train()%0A%20%20%20%20return%20(get_full_train%2C)%0A%0A%0A%40app.cell(hide_code%3DTrue)%0Adef%20_(mo)%3A%0A%20%20%20%20mo.md(%0A%20%20%20%20%20%20%20%20r%22%22%22%0A%20%20%20%20%23%23%23%20Train%20the%20Model%0A%0A%20%20%20%20Here%20we%20are%20training%20the%20model%20in%20our%20merged%20dataset%20and%20displaying%20its%20weights.%0A%20%20%20%20%22%22%22%0A%20%20%20%20)%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(%0A%20%20%20%20get_full_train%2C%0A%20%20%20%20regularization_delta%2C%0A%20%20%20%20regularize_and_solve_linear_regression%2C%0A)%3A%0A%20%20%20%20def%20solve_full_train(delta)%3A%0A%20%20%20%20%20%20%20%20X%2C%20y%2C%20X_test%2C%20y_test%20%3D%20get_full_train()%0A%0A%20%20%20%20%20%20%20%20return%20regularize_and_solve_linear_regression(X%2C%20y%2C%20delta)%0A%0A%20%20%20%20solve_full_train(regularization_delta)%0A%20%20%20%20return%0A%0A%0A%40app.cell(hide_code%3DTrue)%0Adef%20_(mo)%3A%0A%20%20%20%20mo.md(r%22%22%22%23%23%23%20Check%20that%20we%20Can%20Predict%20Prices%22%22%22)%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(%0A%20%20%20%20get_full_train%2C%0A%20%20%20%20regularization_delta%2C%0A%20%20%20%20regularize_and_solve_linear_regression%2C%0A)%3A%0A%20%20%20%20def%20full_train_and_predict(delta)%3A%0A%20%20%20%20%20%20%20%20X%2C%20y%2C%20X_test%2C%20y_test%20%3D%20get_full_train()%0A%20%20%20%20%20%20%20%20w%20%3D%20regularize_and_solve_linear_regression(X%2C%20y%2C%20delta)%0A%0A%20%20%20%20%20%20%20%20return%20X.dot(w)%0A%0A%20%20%20%20full_train_and_predict(regularization_delta)%0A%20%20%20%20return%0A%0A%0A%40app.cell(hide_code%3DTrue)%0Adef%20_(mo)%3A%0A%20%20%20%20mo.md(r%22%22%22%23%23%23%20Evaluate%20the%20Model%20on%20the%20Test%20Split%22%22%22)%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(%0A%20%20%20%20get_full_train%2C%0A%20%20%20%20regularization_delta%2C%0A%20%20%20%20regularize_and_solve_linear_regression%2C%0A)%3A%0A%20%20%20%20def%20full_train_eval(delta)%3A%0A%20%20%20%20%20%20%20%20X%2C%20y%2C%20X_test%2C%20y_test%20%3D%20get_full_train()%0A%20%20%20%20%20%20%20%20w%20%3D%20regularize_and_solve_linear_regression(X%2C%20y%2C%20delta)%0A%0A%20%20%20%20%20%20%20%20return%20rmse(%0A%20%20%20%20%20%20%20%20%20%20%20%20X_test.dot(w)%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20y_test%0A%20%20%20%20%20%20%20%20)%0A%0A%20%20%20%20full_train_eval(regularization_delta)%0A%20%20%20%20return%0A%0A%0A%40app.cell(hide_code%3DTrue)%0Adef%20_(mo)%3A%0A%20%20%20%20mo.md(%0A%20%20%20%20%20%20%20%20r%22%22%22%0A%20%20%20%20%23%23%23%20Use%20the%20Model%20to%20Predict%20a%20Car's%20Price%0A%0A%20%20%20%20Now%20we%20can%20use%20our%20model%20to%20predict%20the%20price%20of%20a%20given%20car.%0A%20%20%20%20%22%22%22%0A%20%20%20%20)%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(%0A%20%20%20%20get_full_train%2C%0A%20%20%20%20np%2C%0A%20%20%20%20regularization_delta%2C%0A%20%20%20%20regularize_and_solve_linear_regression%2C%0A)%3A%0A%20%20%20%20def%20get_test_car_price(car_id%2C%20delta)%3A%0A%20%20%20%20%20%20%20%20X%2C%20y%2C%20X_test%2C%20y_test%20%3D%20get_full_train()%0A%20%20%20%20%20%20%20%20w%20%3D%20regularize_and_solve_linear_regression(X%2C%20y%2C%20delta)%0A%0A%20%20%20%20%20%20%20%20return%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%22y%22%3A%20np.expm1(y_test%5Bcar_id%5D)%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%22y_predicted%22%3A%20np.expm1(np.array(%5BX_test%5Bcar_id%5D%5D).dot(w)%5B0%5D)%0A%20%20%20%20%20%20%20%20%7D%0A%0A%20%20%20%20car_id%20%3D%2020%0A%20%20%20%20get_test_car_price(car_id%2C%20regularization_delta)%0A%20%20%20%20return%0A%0A%0Aif%20__name__%20%3D%3D%20%22__main__%22%3A%0A%20%20%20%20app.run()%0A
</marimo-code>

<marimo-code-hash hidden="">1836ec8860466c3f57e4fecc8b89227083e56c633c163664d1a4880b56cb8ecc</marimo-code-hash>
</body>
</html>
