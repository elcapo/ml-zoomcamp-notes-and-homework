<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <link rel="icon" crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.16.0/dist/favicon.ico" />
    <!-- Preload is necessary because we show these images when we disconnect from the server,
    but at that point we cannot load these images from the server -->
    <link rel="preload" crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.16.0/dist/assets/gradient-yHQUC_QB.png" as="image" />
    <link rel="preload" crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.16.0/dist/assets/noise-60BoTA8O.png" as="image" />
    <!-- Preload the fonts -->
    <link rel="preload" crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.16.0/dist/assets/Lora-VariableFont_wght-B2ootaw-.ttf" as="font" crossorigin="anonymous" />
    <link rel="preload" crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.16.0/dist/assets/PTSans-Regular-CxL0S8W7.ttf" as="font" crossorigin="anonymous" />
    <link rel="preload" crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.16.0/dist/assets/PTSans-Bold-D9fedIX3.ttf" as="font" crossorigin="anonymous" />
    <link rel="preload" crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.16.0/dist/assets/FiraMono-Regular-BTCkDNvf.ttf" as="font" crossorigin="anonymous" />
    <link rel="preload" crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.16.0/dist/assets/FiraMono-Medium-DU3aDxX5.ttf" as="font" crossorigin="anonymous" />
    <link rel="preload" crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.16.0/dist/assets/FiraMono-Bold-CLVRCuM9.ttf" as="font" crossorigin="anonymous" />

    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="theme-color" content="#000000" />
    <meta name="description" content="a marimo app" />
    <link rel="apple-touch-icon" crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.16.0/dist/apple-touch-icon.png" />
    <link rel="manifest" crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.16.0/dist/manifest.json" />

    <script data-marimo="true">
      function __resizeIframe(obj) {
        var scrollbarHeight = 20; // Max between windows, mac, and linux

        function setHeight() {
          var element = obj.contentWindow.document.documentElement;
          // If there is no vertical scrollbar, we don't need to resize the iframe
          if (element.scrollHeight === element.clientHeight) {
            return;
          }

          // Create a new height that includes the scrollbar height if it's visible
          var hasHorizontalScrollbar = element.scrollWidth > element.clientWidth;
          var newHeight = element.scrollHeight + (hasHorizontalScrollbar ? scrollbarHeight : 0);

          // Only update the height if it's different from the current height
          if (obj.style.height !== `${newHeight}px`) {
            obj.style.height = `${newHeight}px`;
          }
        }

        // Resize the iframe to the height of the content and bottom scrollbar height
        setHeight();

        // Resize the iframe when the content changes
        const resizeObserver = new ResizeObserver((entries) => {
          setHeight();
        });
        resizeObserver.observe(obj.contentWindow.document.body);
      }
    </script>
    <marimo-filename hidden>notes.py</marimo-filename>
    <!-- TODO(Trevor): Legacy, required by VS Code plugin. Remove when plugin is updated (see marimo/server/_templates/template.py) -->
    <marimo-version data-version="{{ version }}" hidden></marimo-version>
    <marimo-user-config data-config="{{ user_config }}" hidden></marimo-user-config>
    <marimo-server-token data-token="{{ server_token }}" hidden></marimo-server-token>
    <!-- /TODO -->
    <title>notes</title>
    <script type="module" crossorigin crossorigin="anonymous" src="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.16.0/dist/assets/index-DKEudB02.js"></script>
    <link rel="stylesheet" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.16.0/dist/assets/index-Cx0bsY1w.css">
  
<script data-marimo="true">
    window.__MARIMO_STATIC__ = {};
    window.__MARIMO_STATIC__.files = {};
</script>
</head>
  <body>
    <div id="root"></div>
    <!-- This is a portal for the data editor to render in -->
    <div id="portal" data-testid="glide-portal" style="position: fixed; left: 0; top: 0; z-index: 9999"></div>
    <script data-marimo="true">
      window.__MARIMO_MOUNT_CONFIG__ = {
            "filename": "notes.py",
            "mode": "read",
            "version": "0.16.0",
            "serverToken": "static",
            "config": {"ai": {"models": {"custom_models": [], "displayed_models": []}}, "completion": {"activate_on_typing": true, "copilot": false}, "display": {"cell_output": "above", "code_editor_font_size": 14, "dataframes": "rich", "default_table_max_columns": 50, "default_table_page_size": 10, "default_width": "medium", "reference_highlighting": false, "theme": "light"}, "formatting": {"line_length": 79}, "keymap": {"overrides": {}, "preset": "default"}, "language_servers": {"pylsp": {"enable_flake8": false, "enable_mypy": true, "enable_pydocstyle": false, "enable_pyflakes": false, "enable_pylint": false, "enable_ruff": true, "enabled": true}}, "package_management": {"manager": "pip"}, "runtime": {"auto_instantiate": true, "auto_reload": "off", "default_sql_output": "auto", "on_cell_change": "autorun", "output_max_bytes": 8000000, "reactive_tests": true, "std_stream_max_bytes": 1000000, "watcher_on_save": "lazy"}, "save": {"autosave": "after_delay", "autosave_delay": 1000, "format_on_save": false}, "server": {"browser": "default", "follow_symlink": false}, "snippets": {"custom_paths": [], "include_default_snippets": true}},
            "configOverrides": {},
            "appConfig": {"sql_output": "auto", "width": "medium"},
            "view": {"showAppCode": true},
            "notebook": {"cells": [{"code": "import marimo as mo\nimport pandas as pd\nimport numpy as np\nimport matplotlib.pyplot as plt\nimport seaborn as sns", "code_hash": "e76e8dbe4d9bf74eff98fef5f002130b", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "Hbol", "name": "_"}, {"code": "mo.md(\n    r\"\"\"\n# Machine Learning Zoomcamp\n\n## Module 2: **Regression**\n\"\"\"\n)", "code_hash": "304898c62508f9a8d777ca964d688cd0", "config": {"column": null, "disabled": false, "hide_code": true}, "id": "MJUe", "name": "_"}, {"code": "repository_root = \"https://github.com/DataTalksClub/machine-learning-zoomcamp/blob/master/\"\n\nchapters = pd.DataFrame([\n    {\n        \"title\": \"Car price prediction project\",\n        \"youtube_id\": \"vM3SqPNlStE\",\n        \"contents\": repository_root+\"02-regression/01-car-price-intro.md\"\n    },\n    {\n        \"title\": \"Data preparation\",\n        \"youtube_id\": \"Kd74oR4QWGM\",\n        \"contents\": repository_root+\"02-regression/02-data-preparation.md\"\n    },\n    {\n        \"title\": \"Exploratory data analysis\",\n        \"youtube_id\": \"k6k8sQ0GhPM\",\n        \"contents\": repository_root+\"02-regression/03-eda.md\"\n    },\n    {\n        \"title\": \"Setting up the validation framework\",\n        \"youtube_id\": \"ck0IfiPaQi0\",\n        \"contents\": repository_root+\"02-regression/04-validation-framework.md\"\n    },\n    {\n        \"title\": \"Linear regression\",\n        \"youtube_id\": \"Dn1eTQLsOdA\",\n        \"contents\": repository_root+\"02-regression/05-linear-regression-simple.md\"\n    },\n    {\n        \"title\": \"Linear regression: vector form\",\n        \"youtube_id\": \"YkyevnYyAww\",\n        \"contents\": repository_root+\"02-regression/06-linear-regression-vector.md\"\n    },\n    {\n        \"title\": \"Training linear regression: Normal equation\",\n        \"youtube_id\": \"hx6nak-Y11g\",\n        \"contents\": repository_root+\"02-regression/07-linear-regression-training.md\"\n    },\n    {\n        \"title\": \"Baseline model for car price prediction project\",\n        \"youtube_id\": \"SvPpMMYtYbU\",\n        \"contents\": repository_root+\"02-regression/08-baseline-model.md\"\n    },\n    {\n        \"title\": \"Root mean squared error\",\n        \"youtube_id\": \"0LWoFtbzNUM\",\n        \"contents\": repository_root+\"02-regression/09-rmse.md\"\n    },\n    {\n        \"title\": \"Using RMSE on validation data\",\n        \"youtube_id\": \"rawGPXg2ofE\",\n        \"contents\": repository_root+\"02-regression/10-car-price-validation.md\"\n    },\n    {\n        \"title\": \"Feature engineering\",\n        \"youtube_id\": \"-aEShw4ftB0\",\n        \"contents\": repository_root+\"02-regression/11-feature-engineering.md\"\n    },\n    {\n        \"title\": \"Categorical variables\",\n        \"youtube_id\": \"sGLAToAAMa4\",\n        \"contents\": repository_root+\"02-regression/12-categorical-variables.md\"\n    },\n    {\n        \"title\": \"Regularization\",\n        \"youtube_id\": \"91ve3EJlHBc\",\n        \"contents\": repository_root+\"02-regression/13-regularization.md\"\n    },\n    {\n        \"title\": \"Tuning the model\",\n        \"youtube_id\": \"lW-YVxPgzQw\",\n        \"contents\": repository_root+\"02-regression/14-tuning-model.md\"\n    },\n    {\n        \"title\": \"Using the model\",\n        \"youtube_id\": \"KT--uIJozes\",\n        \"contents\": repository_root+\"02-regression/15-using-model.md\"\n    },\n    {\n        \"title\": \"Car price prediction project summary\",\n        \"youtube_id\": \"_qI01YXbyro\",\n        \"contents\": repository_root+\"02-regression/16-summary.md\"\n    },\n    {\n        \"title\": \"Explore more\",\n        \"youtube_id\": \"\",\n        \"contents\": repository_root+\"02-regression/17-explore-more.md\"\n    },\n    {\n        \"title\": \"Homework\",\n        \"youtube_id\": \"\",\n        \"contents\": repository_root+\"02-regression/homework.md\"\n    },\n])\n\nchapters.insert(loc=0, column=\"snapshot\", value=\"https://img.youtube.com/vi/\"+chapters.youtube_id.astype(str)+\"/hqdefault.jpg\")\nchapters.insert(loc=2, column=\"youtube\", value=\"https://youtube.com/watch?v=\"+chapters.youtube_id.astype(str))\n\nvideos = chapters[chapters[\"youtube_id\"].notnull()]\nvideos[[\"snapshot\", \"title\", \"youtube\"]]", "code_hash": "6f7aef2235c52da5f7c3b675cca2862d", "config": {"column": null, "disabled": false, "hide_code": true}, "id": "vblA", "name": "_"}, {"code": "contents = chapters[chapters[\"contents\"].notnull()]\ncontents[[\"title\", \"contents\"]]", "code_hash": "1d3036664588742ca99aa99004e53a08", "config": {"column": null, "disabled": false, "hide_code": true}, "id": "bkHC", "name": "_"}, {"code": "mo.md(\n    r\"\"\"\n## Car Price Prediction Project\n\nIn this chapter we'll be working with the [Car Features and MSRP](https://www.kaggle.com/datasets/CooperUnion/cardataset) Kaggle dataset.\n\n1. Prepare the data and do some Exploratory Data Analysis (EDA)\n2. Use linear regression for predicting price\n3. Understand the internals of linear regression\n4. Evaluate the model using Root Mean Square Error (RMSE)\n5. Do some feature engineering\n6. Regualization\n7. Use the model\n\"\"\"\n)", "code_hash": "7f18baf3bbb896c2170c30755b24a4c7", "config": {"column": null, "disabled": false, "hide_code": true}, "id": "lEQa", "name": "_"}, {"code": "mo.md(\n    r\"\"\"\n## Data Preparation\n\nTo facilitate the analysis, the CSV file has been already downloaded in **data/car-prices.csv**.\n\"\"\"\n)", "code_hash": "f87f1759f940957899367de416ae20b4", "config": {"column": null, "disabled": false, "hide_code": true}, "id": "PKri", "name": "_"}, {"code": "car_prices = pd.read_csv('./module-2/data/car-prices.csv')\ncar_prices.head()", "code_hash": "bb8aa8849a1ed64f21ea7d7a75892bb9", "config": {"column": null, "disabled": false, "hide_code": true}, "id": "Xref", "name": "_"}, {"code": "mo.md(\n    r\"\"\"\n### Standardize Column Names\n\nSome of the columns are named using spaces as separator and other columns were named using underscores as a separator. We'll now standardize their names.\n\"\"\"\n)", "code_hash": "912f15b11e5c98313ec0ab3ddf6e71ca", "config": {"column": null, "disabled": false, "hide_code": true}, "id": "SFPL", "name": "_"}, {"code": "car_prices.columns = car_prices.columns.str.lower().str.replace(' ', '_')\ncar_prices.head()", "code_hash": "0faac80606581212927fe85dc0064f69", "config": {"column": null, "disabled": false, "hide_code": true}, "id": "BYtC", "name": "_"}, {"code": "mo.md(\n    r\"\"\"\n### Standardize Values\n\nFirst we'll get the list of all string columns.\n\"\"\"\n)", "code_hash": "a8fd1747efc75f553a8fbbc6ec5e0ec6", "config": {"column": null, "disabled": false, "hide_code": true}, "id": "RGSE", "name": "_"}, {"code": "string_columns = list(car_prices.dtypes[car_prices.dtypes == 'object'].index)\nstring_columns", "code_hash": "ad720e3bfb7c47ad367a1dde9b5a33b1", "config": {"column": null, "disabled": false, "hide_code": true}, "id": "Kclp", "name": "_"}, {"code": "for string_column in string_columns:\n    car_prices[string_column] = car_prices[string_column].str.lower().str.replace(' ', '_')\ncar_prices.head()", "code_hash": "dce44a41405e788fe629687dc8a99a4e", "config": {"column": null, "disabled": false, "hide_code": true}, "id": "emfo", "name": "_"}, {"code": "mo.md(\n    r\"\"\"\n## Exploratory Data Analysis\n\n### Check Unique Values per Column\n\"\"\"\n)", "code_hash": "6d5010ff652e368df7b670074d9c0d3f", "config": {"column": null, "disabled": false, "hide_code": true}, "id": "Hstk", "name": "_"}, {"code": "unique_values = {}\n\nfor described_column in car_prices.columns:\n    unique_values[described_column] = {\n        \"sample\": car_prices[described_column].unique()[:5],\n        \"count\": car_prices[described_column].nunique()\n    }\n\nunique_values", "code_hash": "79f009049d480fe18ff2b7e61711ac0e", "config": {"column": null, "disabled": false, "hide_code": true}, "id": "nWHF", "name": "_"}, {"code": "mo.md(\n    r\"\"\"\n### Check the Price Column\n\nA tiny number of cars with a very high price is ruining our plot.\n\"\"\"\n)", "code_hash": "9ee48e97a45745667c20e61ca1179d8f", "config": {"column": null, "disabled": false, "hide_code": true}, "id": "iLit", "name": "_"}, {"code": "sns.histplot(car_prices.msrp, bins=100)", "code_hash": "e2060c13af97e5753962d9599ef97dcf", "config": {"column": null, "disabled": false, "hide_code": true}, "id": "ZHCJ", "name": "_"}, {"code": "mo.md(r\"\"\"We could filter them to get a better view but that implies making a choice on where to cut. Which could confuse our model.\"\"\")", "code_hash": "17b063052123f6191e5e0454a99d37dc", "config": {"column": null, "disabled": false, "hide_code": true}, "id": "ROlb", "name": "_"}, {"code": "sns.histplot(car_prices.msrp[car_prices.msrp < 100000], bins=100)", "code_hash": "5c0989b50daa5e2a46fe7793965fea12", "config": {"column": null, "disabled": false, "hide_code": true}, "id": "qnkX", "name": "_"}, {"code": "mo.md(r\"\"\"Instead of making a manual cut, we can take the logarithm of the price. By doing so, outlier (few cases with extreme values) are handled in a more elegant way.\"\"\")", "code_hash": "be67f77fe9c3fa8ad3526d8063a8ee15", "config": {"column": null, "disabled": false, "hide_code": true}, "id": "TqIu", "name": "_"}, {"code": "price_logs = np.log1p(car_prices.msrp)\n\nsns.histplot(price_logs, bins=100)", "code_hash": "5a976750f915df8ddbd13c90434aad5d", "config": {"column": null, "disabled": false, "hide_code": true}, "id": "Vxnm", "name": "_"}, {"code": "mo.md(r\"\"\"### Check for Empty Values\"\"\")", "code_hash": "12e115f873256e9ac70b276ab54a7fb8", "config": {"column": null, "disabled": false, "hide_code": true}, "id": "DnEU", "name": "_"}, {"code": "car_prices.isna().sum()[car_prices.isna().any()]", "code_hash": "98a16a9e0c880538c9ada89c6454fce4", "config": {"column": null, "disabled": false, "hide_code": true}, "id": "ulZA", "name": "_"}, {"code": "mo.md(\n    r\"\"\"\n## Setting Up the Validation Framework\n\nWe want to define our feature matrix $X$ and a target variable $y$ and then separate it into our train $X_T$ and $y_T$, validation $X_V$ and $y_V$ and test $X_{test}$ and $t_{test}$ splits.\n\"\"\"\n)", "code_hash": "6f7863f60f4242290a612a5868b6ab9a", "config": {"column": null, "disabled": false, "hide_code": true}, "id": "ecfG", "name": "_"}, {"code": "n = len(car_prices)\nn_val = n_test = int(len(car_prices) * 0.2)\nn_train = len(car_prices) - n_val - n_test\n\n{\"n\": n, \"n_train\": n_train, \"n_val\": n_val, \"n_test\": n_test}", "code_hash": "2ba50adfb09d4f0f4aee0d9cdfdb5920", "config": {"column": null, "disabled": false, "hide_code": true}, "id": "Pvdt", "name": "_"}, {"code": "mo.md(\n    r\"\"\"\nTo avoid spliting the records in the same order they have in the dataset (so that we don't get oddly distributed splits), we'll make a randomized selection.\n\nFirst, we create a list with the identifiers of each sample in a random order.\n\"\"\"\n)", "code_hash": "b668d11b586a25b29b96ea8c0eeddc9f", "config": {"column": null, "disabled": false, "hide_code": true}, "id": "ZBYS", "name": "_"}, {"code": "np.random.seed(2)\nshuffled_indexes = np.arange(n)\nnp.random.shuffle(shuffled_indexes)\n\nshuffled_indexes", "code_hash": "1162fe1261f3c31c6941a28f39ceaed2", "config": {"column": null, "disabled": false, "hide_code": true}, "id": "aLJB", "name": "_"}, {"code": "mo.md(r\"\"\"Then we use that as our reference for creating our splits.\"\"\")", "code_hash": "ca78992023d68b6b6037cfcf27a75caf", "config": {"column": null, "disabled": false, "hide_code": true}, "id": "nHfw", "name": "_"}, {"code": "car_prices_train = car_prices.iloc[shuffled_indexes[:n_train]]\ncar_prices_val = car_prices.iloc[shuffled_indexes[n_train:n_train+n_val]]\ncar_prices_test = car_prices.iloc[shuffled_indexes[n_train+n_val:]]", "code_hash": "ab6c6ddd159058b2754e78c6becf536a", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "xXTn", "name": "_"}, {"code": "mo.md(r\"\"\"As our index column has now a random order, we'll reset it in each of the splits.\"\"\")", "code_hash": "b93ef907b4c5c9b45b2093e3d1b68179", "config": {"column": null, "disabled": false, "hide_code": true}, "id": "AjVT", "name": "_"}, {"code": "car_prices_train.reset_index(drop=True, inplace=True)\ncar_prices_val.reset_index(drop=True, inplace=True)\ncar_prices_test.reset_index(drop=True, inplace=True)", "code_hash": "c57bdbad94234ab00ab9c9f0644ec92b", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "pHFh", "name": "_"}, {"code": "mo.md(r\"\"\"Now, we'll define our target variables adjusting the price column using the logarithm function described above.\"\"\")", "code_hash": "ee8c7e24901ca0bd0a6874e550648aa5", "config": {"column": null, "disabled": false, "hide_code": true}, "id": "NCOB", "name": "_"}, {"code": "y_train = np.log1p(car_prices_train.msrp.values)\ny_val = np.log1p(car_prices_val.msrp.values)\ny_test = np.log1p(car_prices_test.msrp.values)", "code_hash": "2648c49e5f26de3da6ed28291f14e08f", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "aqbW", "name": "_"}, {"code": "mo.md(r\"\"\"And, finally, we'll define our feature matrices.\"\"\")", "code_hash": "dfc74a3eb558a94b7871b9c172f9e7d3", "config": {"column": null, "disabled": false, "hide_code": true}, "id": "TRpd", "name": "_"}, {"code": "X_train = car_prices_train\nX_val = car_prices_val\nX_test = car_prices_test\n\ndel X_train[\"msrp\"]\ndel X_val[\"msrp\"]\ndel X_test[\"msrp\"]", "code_hash": "83ac5f280874e244b0dc418c1bcc3e67", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "TXez", "name": "_"}, {"code": "mo.md(\n    r\"\"\"\n## Linear Regression\n\nWe are trying to compute a $g$ estimator function so that given the features of a car $i$:\n\n\\[\n    x_i = (x_{i1}, x_{i2}, ..., x_{in})\n\\]\n\nOur function evaluated with those features approaches the target price:\n\n\\[\n    g_i(x_{i1}, x_{i2}, ..., x_{in}) \\approx y_i\n\\]\n\"\"\"\n)", "code_hash": "b8f1cd202349ce220f767cea3167aee2", "config": {"column": null, "disabled": false, "hide_code": true}, "id": "dNNg", "name": "_"}, {"code": "def raw_linear_regression(x, w):\n    assert len(x) + 1 == len(w), \"The size of the features vector does not match the size of the weights\"\n\n    y_log = w[0] + np.sum([x[i] * w[i + 1] for i in range(len(x))])\n\n    return np.expm1(y_log).astype(int)", "code_hash": "13d223cf2b57785a92400034102f9d89", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "yCnT", "name": "_"}, {"code": "mo.md(r\"\"\"In order to show how linear regression works, we'll manually compute it for a selection of features: `engine_hp`, `city_mpg` and `popularity`.\"\"\")", "code_hash": "dae63e87aaf90eee5682f12c3a37b991", "config": {"column": null, "disabled": false, "hide_code": true}, "id": "wlCL", "name": "_"}, {"code": "X_train.iloc[10:11][[\"make\", \"model\", \"engine_hp\", \"city_mpg\", \"popularity\"]]", "code_hash": "75428cac41eff0ae7e7434d8180f1c7f", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "kqZH", "name": "_"}, {"code": "mo.md(r\"\"\"Given the \"randomly\" chosen car, we'll extract the selected features and its corresponding price:\"\"\")", "code_hash": "0450cd0eb43a49cd06091167c2d076ea", "config": {"column": null, "disabled": false, "hide_code": true}, "id": "wAgl", "name": "_"}, {"code": "x = X_train.iloc[10:11][[\"engine_hp\", \"city_mpg\", \"popularity\"]].values[0]\n\n{\n    \"x\": x,\n    \"y\": np.expm1(y_train[10:11]).astype(int)\n}", "code_hash": "c8900d04d0f934164873f5c5e85ed06d", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "rEll", "name": "_"}, {"code": "mo.md(r\"\"\"Now we need to define some weights. Typically, we'd be running a process that finds the optimal values but for the moment we'll manually assign them some numbers:\"\"\")", "code_hash": "50db720abf4d6a93df4aa415af366a18", "config": {"column": null, "disabled": false, "hide_code": true}, "id": "dGlV", "name": "_"}, {"code": "raw_linear_regression(x, [7.5, 0.01, 0.07, 0.003])", "code_hash": "ba3e8e752c9e1797763fca8de746cfc6", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "SdmI", "name": "_"}, {"code": "mo.md(\n    r\"\"\"\n## Linear Regression in Vector Form\n\nWe want now to generalize our previous linear regression formula so that it works with any number of features:\n\n\\[\n    g_i(x_i) = w_o + \\sum_{j=1}^n x_{ij} w_j\n\\]\n\nAs the right term of the equation corresponds with a dot product, we can rewrite it in a simplified form:\n\n\\[\n    g_i(x_i) = w_0 + \\bold{w}^T \\bold{x}_i\n\\]\n\"\"\"\n)", "code_hash": "58b88beed45e81cac0d3e46897886aaa", "config": {"column": null, "disabled": false, "hide_code": true}, "id": "lgWD", "name": "_"}, {"code": "def vectorial_linear_regression(x, w):\n    assert len(x) + 1 == len(w), \"The size of the features vector does not match the size of the weights\"\n\n    y_log = w[0] + np.dot(x, w[1:])\n\n    return np.expm1(y_log).astype(int)", "code_hash": "81fed55bcffe0f1e0310f6d149148e2e", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "yOPj", "name": "_"}, {"code": "vectorial_linear_regression(x, [7.5, 0.01, 0.07, 0.003])", "code_hash": "9911399e1f260ca661c4857dd3dc2278", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "fwwy", "name": "_"}, {"code": "mo.md(\n    r\"\"\"\nIf we want, we can simplify our expression even further by defining an extra feature that always equals $1$. By doing so, we'd get $\\bold{w}$ and $\\bold{x}$ vectors with $n+1$ elements:\n\n\\[\n    w = [w_0, w_1, ..., w_n]\n\\]\n\n\\[\n    x_i = [1, x_{i1}, x_{i2}, ..., x_{in}]\n\\]\n\nTherefore, our estimator could be written as:\n\n\\[\n    g_i(x_i) = \\bold{w}^T \\bold{x}_i\n\\]\n\"\"\"\n)", "code_hash": "8f5dea037bfce46f5424d07cb4260bcd", "config": {"column": null, "disabled": false, "hide_code": true}, "id": "LJZf", "name": "_"}, {"code": "def final_linear_regression(x, w):\n    assert len(x) + 1 == len(w), \"The size of the features vector does not match the size of the weights\"\n\n    x = np.concat((np.array([1]), np.array(x)))\n    y_log = np.dot(x, w)\n\n    return np.expm1(y_log).astype(int)", "code_hash": "e8309b7e27fc0c90bf983bf69b274468", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "urSm", "name": "_"}, {"code": "final_linear_regression(x, [7.5, 0.01, 0.07, 0.003])", "code_hash": "c06ecaa40bdd9992811734d44513cd89", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "jxvo", "name": "_"}, {"code": "mo.md(\n    r\"\"\"\nWe can write our $g$ function for all samples as a matrix multiplication.\n\n\\[\n\\bold{y_p} = \n\\begin{bmatrix}\n1 & x_{11} & x_{12} & \\cdots & x_{1n} \\\\\n1 & x_{21} & x_{22} & \\cdots & x_{2n} \\\\\n\\vdots & \\vdots & \\vdots & \\ddots & \\vdots \\\\\n1 & x_{m1} & x_{m2} & \\cdots & x_{mn}\n\\end{bmatrix}\n\\begin{bmatrix}\nw_0 \\\\\nw_1 \\\\\nw_2 \\\\\n\\vdots \\\\\nw_n\n\\end{bmatrix}\n=\n\\begin{bmatrix}\n\\bold{x_1}^T \u00b7 \\bold{w} \\\\\n\\bold{x_2}^T \u00b7 \\bold{w} \\\\\n\\vdots \\\\\n\\bold{x_m}^T \u00b7 \\bold{w} \\\\\n\\end{bmatrix}\n\\]\n\"\"\"\n)", "code_hash": "8b7032d2d2a6e17c2cf786d18acac8ca", "config": {"column": null, "disabled": false, "hide_code": true}, "id": "mWxS", "name": "_"}, {"code": "X_matrix = X_train.iloc[10:15][[\"engine_hp\", \"city_mpg\", \"popularity\"]].values\nX_matrix = np.c_[np.ones(X_matrix.shape[0]), X_matrix]\n\nX_matrix", "code_hash": "1fe65f3e38345a23bdc6bacc8d5c1790", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "CcZR", "name": "_"}, {"code": "y_matrix = y_train[10:15]\n\nnp.expm1(y_matrix).astype(int)", "code_hash": "a07074f5d180c282b18b9af0c1e143d8", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "YWSi", "name": "_"}, {"code": "w = [7.5, 0.01, 0.07, 0.003]\n\nw", "code_hash": "645076ba5755c55b8f0c550cda88a859", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "zlud", "name": "_"}, {"code": "np.expm1(X_matrix.dot(w)).astype(int)", "code_hash": "b3ee810c904262cfed6e544c3b589f60", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "tZnO", "name": "_"}, {"code": "mo.md(\n    r\"\"\"\n## Training a Linear Regression Model\n\nWe already saw that our $g$ estimator looks like this:\n\n\\[\n    \\bold{X} \\bold{w} \\approx \\bold{y}\n\\]\n\nSo now we have to solve $\\bold{w}$ so that we can find the weights.\n\n\\[\n    \\bold{X}^{-1} \\bold{X} \\bold{w} \\approx \\bold{X}^{-1} \\bold{y}\n\\]\n\nWhat gives us:\n\n\\[\n    \\bold{w} \\approx \\bold{X}^{-1} \\bold{y}\n\\]\n\nBut there is an issue: we are working with a rectangular matrix, not with a squared one. So we won't be able to find its inverse.\n\"\"\"\n)", "code_hash": "86af77028e786426b99141ca20ae84ab", "config": {"column": null, "disabled": false, "hide_code": true}, "id": "xvXZ", "name": "_"}, {"code": "mo.md(\n    r\"\"\"\n### Gram Matrix\n\nThe first thing we can do to try to solve this is to take into account that $X^T X$ is actually an squared matrix, it may have an inverse.\n\nTherefore, we could start with:\n\n\\[\n    \\bold{X}^{T} \\bold{X} \\bold{w} \\approx \\bold{X}^{T} \\bold{y}\n\\]\n\n... and try to solve it with:\n\n\\[\n    (\\bold{X}^{T} \\bold{X})^{-1} \\bold{X}^{T} \\bold{X} \\bold{w} \\approx (\\bold{X}^{T} \\bold{X})^{-1} \\bold{X}^{T} \\bold{y}\n\\]\n\n... which simplifies to:\n\n\\[\n    \\bold{w} \\approx (\\bold{X}^{T} \\bold{X})^{-1} \\bold{X}^{T} \\bold{y}\n\\]\n\"\"\"\n)", "code_hash": "28635777c953143e667f88de51502b37", "config": {"column": null, "disabled": false, "hide_code": true}, "id": "CLip", "name": "_"}, {"code": "w_solved = np.linalg.inv(X_matrix.T.dot(X_matrix)).dot(X_matrix.T).dot(y_matrix)\n\nw_solved", "code_hash": "6f7a2578f98ce8ca53626a95eb150ada", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "YECM", "name": "_"}, {"code": "y_solved = X_matrix.dot(w_solved)\n\nnp.expm1(y_solved).astype(int)", "code_hash": "4929953b27f161e47e986a06c3ddc70f", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "cEAS", "name": "_"}], "metadata": {"marimo_version": "0.16.0"}, "version": "1"},
            "session": {"cells": [{"code_hash": "e76e8dbe4d9bf74eff98fef5f002130b", "console": [], "id": "Hbol", "outputs": [{"data": {"text/plain": ""}, "type": "data"}]}, {"code_hash": "304898c62508f9a8d777ca964d688cd0", "console": [], "id": "MJUe", "outputs": [{"data": {"text/html": "<span class=\"markdown prose dark:prose-invert\"><h1 id=\"machine-learning-zoomcamp\">Machine Learning Zoomcamp</h1>\n<h2 id=\"module-2-regression\">Module 2: <strong>Regression</strong></h2></span>"}, "type": "data"}]}, {"code_hash": "6f7aef2235c52da5f7c3b675cca2862d", "console": [], "id": "vblA", "outputs": [{"data": {"text/html": "<marimo-ui-element object-id='vblA-0' random-id='0cb5f09c-2e83-3040-6aae-614e91352fb6'><marimo-table data-initial-value='[]' data-label='null' data-data='&quot;[{&#92;&quot;snapshot&#92;&quot;:&#92;&quot;https://img.youtube.com/vi/vM3SqPNlStE/hqdefault.jpg&#92;&quot;,&#92;&quot;title&#92;&quot;:&#92;&quot;Car price prediction project&#92;&quot;,&#92;&quot;youtube&#92;&quot;:&#92;&quot;https://youtube.com/watch?v=vM3SqPNlStE&#92;&quot;},{&#92;&quot;snapshot&#92;&quot;:&#92;&quot;https://img.youtube.com/vi/Kd74oR4QWGM/hqdefault.jpg&#92;&quot;,&#92;&quot;title&#92;&quot;:&#92;&quot;Data preparation&#92;&quot;,&#92;&quot;youtube&#92;&quot;:&#92;&quot;https://youtube.com/watch?v=Kd74oR4QWGM&#92;&quot;},{&#92;&quot;snapshot&#92;&quot;:&#92;&quot;https://img.youtube.com/vi/k6k8sQ0GhPM/hqdefault.jpg&#92;&quot;,&#92;&quot;title&#92;&quot;:&#92;&quot;Exploratory data analysis&#92;&quot;,&#92;&quot;youtube&#92;&quot;:&#92;&quot;https://youtube.com/watch?v=k6k8sQ0GhPM&#92;&quot;},{&#92;&quot;snapshot&#92;&quot;:&#92;&quot;https://img.youtube.com/vi/ck0IfiPaQi0/hqdefault.jpg&#92;&quot;,&#92;&quot;title&#92;&quot;:&#92;&quot;Setting up the validation framework&#92;&quot;,&#92;&quot;youtube&#92;&quot;:&#92;&quot;https://youtube.com/watch?v=ck0IfiPaQi0&#92;&quot;},{&#92;&quot;snapshot&#92;&quot;:&#92;&quot;https://img.youtube.com/vi/Dn1eTQLsOdA/hqdefault.jpg&#92;&quot;,&#92;&quot;title&#92;&quot;:&#92;&quot;Linear regression&#92;&quot;,&#92;&quot;youtube&#92;&quot;:&#92;&quot;https://youtube.com/watch?v=Dn1eTQLsOdA&#92;&quot;},{&#92;&quot;snapshot&#92;&quot;:&#92;&quot;https://img.youtube.com/vi/YkyevnYyAww/hqdefault.jpg&#92;&quot;,&#92;&quot;title&#92;&quot;:&#92;&quot;Linear regression: vector form&#92;&quot;,&#92;&quot;youtube&#92;&quot;:&#92;&quot;https://youtube.com/watch?v=YkyevnYyAww&#92;&quot;},{&#92;&quot;snapshot&#92;&quot;:&#92;&quot;https://img.youtube.com/vi/hx6nak-Y11g/hqdefault.jpg&#92;&quot;,&#92;&quot;title&#92;&quot;:&#92;&quot;Training linear regression: Normal equation&#92;&quot;,&#92;&quot;youtube&#92;&quot;:&#92;&quot;https://youtube.com/watch?v=hx6nak-Y11g&#92;&quot;},{&#92;&quot;snapshot&#92;&quot;:&#92;&quot;https://img.youtube.com/vi/SvPpMMYtYbU/hqdefault.jpg&#92;&quot;,&#92;&quot;title&#92;&quot;:&#92;&quot;Baseline model for car price prediction project&#92;&quot;,&#92;&quot;youtube&#92;&quot;:&#92;&quot;https://youtube.com/watch?v=SvPpMMYtYbU&#92;&quot;},{&#92;&quot;snapshot&#92;&quot;:&#92;&quot;https://img.youtube.com/vi/0LWoFtbzNUM/hqdefault.jpg&#92;&quot;,&#92;&quot;title&#92;&quot;:&#92;&quot;Root mean squared error&#92;&quot;,&#92;&quot;youtube&#92;&quot;:&#92;&quot;https://youtube.com/watch?v=0LWoFtbzNUM&#92;&quot;},{&#92;&quot;snapshot&#92;&quot;:&#92;&quot;https://img.youtube.com/vi/rawGPXg2ofE/hqdefault.jpg&#92;&quot;,&#92;&quot;title&#92;&quot;:&#92;&quot;Using RMSE on validation data&#92;&quot;,&#92;&quot;youtube&#92;&quot;:&#92;&quot;https://youtube.com/watch?v=rawGPXg2ofE&#92;&quot;}]&quot;' data-total-rows='18' data-total-columns='3' data-max-columns='50' data-banner-text='&quot;&quot;' data-pagination='true' data-page-size='10' data-field-types='[[&quot;snapshot&quot;,[&quot;string&quot;,&quot;object&quot;]],[&quot;title&quot;,[&quot;string&quot;,&quot;object&quot;]],[&quot;youtube&quot;,[&quot;string&quot;,&quot;object&quot;]]]' data-show-filters='true' data-show-download='true' data-show-column-summaries='true' data-show-data-types='true' data-show-page-size-selector='true' data-show-column-explorer='true' data-show-chart-builder='true' data-row-headers='[]' data-has-stable-row-id='false' data-lazy='false' data-preload='false'></marimo-table></marimo-ui-element>"}, "type": "data"}]}, {"code_hash": "1d3036664588742ca99aa99004e53a08", "console": [], "id": "bkHC", "outputs": [{"data": {"text/html": "<marimo-ui-element object-id='bkHC-0' random-id='2d8e42d4-c087-6b43-cb35-b8f3cd2a877e'><marimo-table data-initial-value='[]' data-label='null' data-data='&quot;[{&#92;&quot;title&#92;&quot;:&#92;&quot;Car price prediction project&#92;&quot;,&#92;&quot;contents&#92;&quot;:&#92;&quot;https://github.com/DataTalksClub/machine-learning-zoomcamp/blob/master/02-regression/01-car-price-intro.md&#92;&quot;},{&#92;&quot;title&#92;&quot;:&#92;&quot;Data preparation&#92;&quot;,&#92;&quot;contents&#92;&quot;:&#92;&quot;https://github.com/DataTalksClub/machine-learning-zoomcamp/blob/master/02-regression/02-data-preparation.md&#92;&quot;},{&#92;&quot;title&#92;&quot;:&#92;&quot;Exploratory data analysis&#92;&quot;,&#92;&quot;contents&#92;&quot;:&#92;&quot;https://github.com/DataTalksClub/machine-learning-zoomcamp/blob/master/02-regression/03-eda.md&#92;&quot;},{&#92;&quot;title&#92;&quot;:&#92;&quot;Setting up the validation framework&#92;&quot;,&#92;&quot;contents&#92;&quot;:&#92;&quot;https://github.com/DataTalksClub/machine-learning-zoomcamp/blob/master/02-regression/04-validation-framework.md&#92;&quot;},{&#92;&quot;title&#92;&quot;:&#92;&quot;Linear regression&#92;&quot;,&#92;&quot;contents&#92;&quot;:&#92;&quot;https://github.com/DataTalksClub/machine-learning-zoomcamp/blob/master/02-regression/05-linear-regression-simple.md&#92;&quot;},{&#92;&quot;title&#92;&quot;:&#92;&quot;Linear regression: vector form&#92;&quot;,&#92;&quot;contents&#92;&quot;:&#92;&quot;https://github.com/DataTalksClub/machine-learning-zoomcamp/blob/master/02-regression/06-linear-regression-vector.md&#92;&quot;},{&#92;&quot;title&#92;&quot;:&#92;&quot;Training linear regression: Normal equation&#92;&quot;,&#92;&quot;contents&#92;&quot;:&#92;&quot;https://github.com/DataTalksClub/machine-learning-zoomcamp/blob/master/02-regression/07-linear-regression-training.md&#92;&quot;},{&#92;&quot;title&#92;&quot;:&#92;&quot;Baseline model for car price prediction project&#92;&quot;,&#92;&quot;contents&#92;&quot;:&#92;&quot;https://github.com/DataTalksClub/machine-learning-zoomcamp/blob/master/02-regression/08-baseline-model.md&#92;&quot;},{&#92;&quot;title&#92;&quot;:&#92;&quot;Root mean squared error&#92;&quot;,&#92;&quot;contents&#92;&quot;:&#92;&quot;https://github.com/DataTalksClub/machine-learning-zoomcamp/blob/master/02-regression/09-rmse.md&#92;&quot;},{&#92;&quot;title&#92;&quot;:&#92;&quot;Using RMSE on validation data&#92;&quot;,&#92;&quot;contents&#92;&quot;:&#92;&quot;https://github.com/DataTalksClub/machine-learning-zoomcamp/blob/master/02-regression/10-car-price-validation.md&#92;&quot;}]&quot;' data-total-rows='18' data-total-columns='2' data-max-columns='50' data-banner-text='&quot;&quot;' data-pagination='true' data-page-size='10' data-field-types='[[&quot;title&quot;,[&quot;string&quot;,&quot;object&quot;]],[&quot;contents&quot;,[&quot;string&quot;,&quot;object&quot;]]]' data-show-filters='true' data-show-download='true' data-show-column-summaries='true' data-show-data-types='true' data-show-page-size-selector='true' data-show-column-explorer='true' data-show-chart-builder='true' data-row-headers='[]' data-has-stable-row-id='false' data-lazy='false' data-preload='false'></marimo-table></marimo-ui-element>"}, "type": "data"}]}, {"code_hash": "7f18baf3bbb896c2170c30755b24a4c7", "console": [], "id": "lEQa", "outputs": [{"data": {"text/html": "<span class=\"markdown prose dark:prose-invert\"><h2 id=\"car-price-prediction-project\">Car Price Prediction Project</h2>\n<span class=\"paragraph\">In this chapter we'll be working with the <a href=\"https://www.kaggle.com/datasets/CooperUnion/cardataset\" rel=\"noopener\" target=\"_blank\">Car Features and MSRP</a> Kaggle dataset.</span>\n<ol>\n<li>Prepare the data and do some Exploratory Data Analysis (EDA)</li>\n<li>Use linear regression for predicting price</li>\n<li>Understand the internals of linear regression</li>\n<li>Evaluate the model using Root Mean Square Error (RMSE)</li>\n<li>Do some feature engineering</li>\n<li>Regualization</li>\n<li>Use the model</li>\n</ol></span>"}, "type": "data"}]}, {"code_hash": "f87f1759f940957899367de416ae20b4", "console": [], "id": "PKri", "outputs": [{"data": {"text/html": "<span class=\"markdown prose dark:prose-invert\"><h2 id=\"data-preparation\">Data Preparation</h2>\n<span class=\"paragraph\">To facilitate the analysis, the CSV file has been already downloaded in <strong>data/car-prices.csv</strong>.</span></span>"}, "type": "data"}]}, {"code_hash": "bb8aa8849a1ed64f21ea7d7a75892bb9", "console": [], "id": "Xref", "outputs": [{"data": {"text/html": "<marimo-ui-element object-id='Xref-0' random-id='1a73dbd7-6f34-0847-03cc-0cff99f4fa8c'><marimo-table data-initial-value='[]' data-label='null' data-data='&quot;[{&#92;&quot;Make&#92;&quot;:&#92;&quot;BMW&#92;&quot;,&#92;&quot;Model&#92;&quot;:&#92;&quot;1 Series M&#92;&quot;,&#92;&quot;Year&#92;&quot;:2011,&#92;&quot;Engine Fuel Type&#92;&quot;:&#92;&quot;premium unleaded (required)&#92;&quot;,&#92;&quot;Engine HP&#92;&quot;:335.0,&#92;&quot;Engine Cylinders&#92;&quot;:6.0,&#92;&quot;Transmission Type&#92;&quot;:&#92;&quot;MANUAL&#92;&quot;,&#92;&quot;Driven_Wheels&#92;&quot;:&#92;&quot;rear wheel drive&#92;&quot;,&#92;&quot;Number of Doors&#92;&quot;:2.0,&#92;&quot;Market Category&#92;&quot;:&#92;&quot;Factory Tuner,Luxury,High-Performance&#92;&quot;,&#92;&quot;Vehicle Size&#92;&quot;:&#92;&quot;Compact&#92;&quot;,&#92;&quot;Vehicle Style&#92;&quot;:&#92;&quot;Coupe&#92;&quot;,&#92;&quot;highway MPG&#92;&quot;:26,&#92;&quot;city mpg&#92;&quot;:19,&#92;&quot;Popularity&#92;&quot;:3916,&#92;&quot;MSRP&#92;&quot;:46135},{&#92;&quot;Make&#92;&quot;:&#92;&quot;BMW&#92;&quot;,&#92;&quot;Model&#92;&quot;:&#92;&quot;1 Series&#92;&quot;,&#92;&quot;Year&#92;&quot;:2011,&#92;&quot;Engine Fuel Type&#92;&quot;:&#92;&quot;premium unleaded (required)&#92;&quot;,&#92;&quot;Engine HP&#92;&quot;:300.0,&#92;&quot;Engine Cylinders&#92;&quot;:6.0,&#92;&quot;Transmission Type&#92;&quot;:&#92;&quot;MANUAL&#92;&quot;,&#92;&quot;Driven_Wheels&#92;&quot;:&#92;&quot;rear wheel drive&#92;&quot;,&#92;&quot;Number of Doors&#92;&quot;:2.0,&#92;&quot;Market Category&#92;&quot;:&#92;&quot;Luxury,Performance&#92;&quot;,&#92;&quot;Vehicle Size&#92;&quot;:&#92;&quot;Compact&#92;&quot;,&#92;&quot;Vehicle Style&#92;&quot;:&#92;&quot;Convertible&#92;&quot;,&#92;&quot;highway MPG&#92;&quot;:28,&#92;&quot;city mpg&#92;&quot;:19,&#92;&quot;Popularity&#92;&quot;:3916,&#92;&quot;MSRP&#92;&quot;:40650},{&#92;&quot;Make&#92;&quot;:&#92;&quot;BMW&#92;&quot;,&#92;&quot;Model&#92;&quot;:&#92;&quot;1 Series&#92;&quot;,&#92;&quot;Year&#92;&quot;:2011,&#92;&quot;Engine Fuel Type&#92;&quot;:&#92;&quot;premium unleaded (required)&#92;&quot;,&#92;&quot;Engine HP&#92;&quot;:300.0,&#92;&quot;Engine Cylinders&#92;&quot;:6.0,&#92;&quot;Transmission Type&#92;&quot;:&#92;&quot;MANUAL&#92;&quot;,&#92;&quot;Driven_Wheels&#92;&quot;:&#92;&quot;rear wheel drive&#92;&quot;,&#92;&quot;Number of Doors&#92;&quot;:2.0,&#92;&quot;Market Category&#92;&quot;:&#92;&quot;Luxury,High-Performance&#92;&quot;,&#92;&quot;Vehicle Size&#92;&quot;:&#92;&quot;Compact&#92;&quot;,&#92;&quot;Vehicle Style&#92;&quot;:&#92;&quot;Coupe&#92;&quot;,&#92;&quot;highway MPG&#92;&quot;:28,&#92;&quot;city mpg&#92;&quot;:20,&#92;&quot;Popularity&#92;&quot;:3916,&#92;&quot;MSRP&#92;&quot;:36350},{&#92;&quot;Make&#92;&quot;:&#92;&quot;BMW&#92;&quot;,&#92;&quot;Model&#92;&quot;:&#92;&quot;1 Series&#92;&quot;,&#92;&quot;Year&#92;&quot;:2011,&#92;&quot;Engine Fuel Type&#92;&quot;:&#92;&quot;premium unleaded (required)&#92;&quot;,&#92;&quot;Engine HP&#92;&quot;:230.0,&#92;&quot;Engine Cylinders&#92;&quot;:6.0,&#92;&quot;Transmission Type&#92;&quot;:&#92;&quot;MANUAL&#92;&quot;,&#92;&quot;Driven_Wheels&#92;&quot;:&#92;&quot;rear wheel drive&#92;&quot;,&#92;&quot;Number of Doors&#92;&quot;:2.0,&#92;&quot;Market Category&#92;&quot;:&#92;&quot;Luxury,Performance&#92;&quot;,&#92;&quot;Vehicle Size&#92;&quot;:&#92;&quot;Compact&#92;&quot;,&#92;&quot;Vehicle Style&#92;&quot;:&#92;&quot;Coupe&#92;&quot;,&#92;&quot;highway MPG&#92;&quot;:28,&#92;&quot;city mpg&#92;&quot;:18,&#92;&quot;Popularity&#92;&quot;:3916,&#92;&quot;MSRP&#92;&quot;:29450},{&#92;&quot;Make&#92;&quot;:&#92;&quot;BMW&#92;&quot;,&#92;&quot;Model&#92;&quot;:&#92;&quot;1 Series&#92;&quot;,&#92;&quot;Year&#92;&quot;:2011,&#92;&quot;Engine Fuel Type&#92;&quot;:&#92;&quot;premium unleaded (required)&#92;&quot;,&#92;&quot;Engine HP&#92;&quot;:230.0,&#92;&quot;Engine Cylinders&#92;&quot;:6.0,&#92;&quot;Transmission Type&#92;&quot;:&#92;&quot;MANUAL&#92;&quot;,&#92;&quot;Driven_Wheels&#92;&quot;:&#92;&quot;rear wheel drive&#92;&quot;,&#92;&quot;Number of Doors&#92;&quot;:2.0,&#92;&quot;Market Category&#92;&quot;:&#92;&quot;Luxury&#92;&quot;,&#92;&quot;Vehicle Size&#92;&quot;:&#92;&quot;Compact&#92;&quot;,&#92;&quot;Vehicle Style&#92;&quot;:&#92;&quot;Convertible&#92;&quot;,&#92;&quot;highway MPG&#92;&quot;:28,&#92;&quot;city mpg&#92;&quot;:18,&#92;&quot;Popularity&#92;&quot;:3916,&#92;&quot;MSRP&#92;&quot;:34500}]&quot;' data-total-rows='5' data-total-columns='16' data-max-columns='50' data-banner-text='&quot;&quot;' data-pagination='true' data-page-size='10' data-field-types='[[&quot;Make&quot;,[&quot;string&quot;,&quot;object&quot;]],[&quot;Model&quot;,[&quot;string&quot;,&quot;object&quot;]],[&quot;Year&quot;,[&quot;integer&quot;,&quot;int64&quot;]],[&quot;Engine Fuel Type&quot;,[&quot;string&quot;,&quot;object&quot;]],[&quot;Engine HP&quot;,[&quot;number&quot;,&quot;float64&quot;]],[&quot;Engine Cylinders&quot;,[&quot;number&quot;,&quot;float64&quot;]],[&quot;Transmission Type&quot;,[&quot;string&quot;,&quot;object&quot;]],[&quot;Driven_Wheels&quot;,[&quot;string&quot;,&quot;object&quot;]],[&quot;Number of Doors&quot;,[&quot;number&quot;,&quot;float64&quot;]],[&quot;Market Category&quot;,[&quot;string&quot;,&quot;object&quot;]],[&quot;Vehicle Size&quot;,[&quot;string&quot;,&quot;object&quot;]],[&quot;Vehicle Style&quot;,[&quot;string&quot;,&quot;object&quot;]],[&quot;highway MPG&quot;,[&quot;integer&quot;,&quot;int64&quot;]],[&quot;city mpg&quot;,[&quot;integer&quot;,&quot;int64&quot;]],[&quot;Popularity&quot;,[&quot;integer&quot;,&quot;int64&quot;]],[&quot;MSRP&quot;,[&quot;integer&quot;,&quot;int64&quot;]]]' data-show-filters='true' data-show-download='true' data-show-column-summaries='false' data-show-data-types='true' data-show-page-size-selector='false' data-show-column-explorer='true' data-show-chart-builder='true' data-row-headers='[]' data-has-stable-row-id='false' data-lazy='false' data-preload='false'></marimo-table></marimo-ui-element>"}, "type": "data"}]}, {"code_hash": "912f15b11e5c98313ec0ab3ddf6e71ca", "console": [], "id": "SFPL", "outputs": [{"data": {"text/html": "<span class=\"markdown prose dark:prose-invert\"><h3 id=\"standardize-column-names\">Standardize Column Names</h3>\n<span class=\"paragraph\">Some of the columns are named using spaces as separator and other columns were named using underscores as a separator. We'll now standardize their names.</span></span>"}, "type": "data"}]}, {"code_hash": "0faac80606581212927fe85dc0064f69", "console": [], "id": "BYtC", "outputs": [{"data": {"text/html": "<marimo-ui-element object-id='BYtC-0' random-id='ad7fe05c-cbb0-f146-e718-f7395f1a063a'><marimo-table data-initial-value='[]' data-label='null' data-data='&quot;[{&#92;&quot;make&#92;&quot;:&#92;&quot;BMW&#92;&quot;,&#92;&quot;model&#92;&quot;:&#92;&quot;1 Series M&#92;&quot;,&#92;&quot;year&#92;&quot;:2011,&#92;&quot;engine_fuel_type&#92;&quot;:&#92;&quot;premium unleaded (required)&#92;&quot;,&#92;&quot;engine_hp&#92;&quot;:335.0,&#92;&quot;engine_cylinders&#92;&quot;:6.0,&#92;&quot;transmission_type&#92;&quot;:&#92;&quot;MANUAL&#92;&quot;,&#92;&quot;driven_wheels&#92;&quot;:&#92;&quot;rear wheel drive&#92;&quot;,&#92;&quot;number_of_doors&#92;&quot;:2.0,&#92;&quot;market_category&#92;&quot;:&#92;&quot;Factory Tuner,Luxury,High-Performance&#92;&quot;,&#92;&quot;vehicle_size&#92;&quot;:&#92;&quot;Compact&#92;&quot;,&#92;&quot;vehicle_style&#92;&quot;:&#92;&quot;Coupe&#92;&quot;,&#92;&quot;highway_mpg&#92;&quot;:26,&#92;&quot;city_mpg&#92;&quot;:19,&#92;&quot;popularity&#92;&quot;:3916,&#92;&quot;msrp&#92;&quot;:46135},{&#92;&quot;make&#92;&quot;:&#92;&quot;BMW&#92;&quot;,&#92;&quot;model&#92;&quot;:&#92;&quot;1 Series&#92;&quot;,&#92;&quot;year&#92;&quot;:2011,&#92;&quot;engine_fuel_type&#92;&quot;:&#92;&quot;premium unleaded (required)&#92;&quot;,&#92;&quot;engine_hp&#92;&quot;:300.0,&#92;&quot;engine_cylinders&#92;&quot;:6.0,&#92;&quot;transmission_type&#92;&quot;:&#92;&quot;MANUAL&#92;&quot;,&#92;&quot;driven_wheels&#92;&quot;:&#92;&quot;rear wheel drive&#92;&quot;,&#92;&quot;number_of_doors&#92;&quot;:2.0,&#92;&quot;market_category&#92;&quot;:&#92;&quot;Luxury,Performance&#92;&quot;,&#92;&quot;vehicle_size&#92;&quot;:&#92;&quot;Compact&#92;&quot;,&#92;&quot;vehicle_style&#92;&quot;:&#92;&quot;Convertible&#92;&quot;,&#92;&quot;highway_mpg&#92;&quot;:28,&#92;&quot;city_mpg&#92;&quot;:19,&#92;&quot;popularity&#92;&quot;:3916,&#92;&quot;msrp&#92;&quot;:40650},{&#92;&quot;make&#92;&quot;:&#92;&quot;BMW&#92;&quot;,&#92;&quot;model&#92;&quot;:&#92;&quot;1 Series&#92;&quot;,&#92;&quot;year&#92;&quot;:2011,&#92;&quot;engine_fuel_type&#92;&quot;:&#92;&quot;premium unleaded (required)&#92;&quot;,&#92;&quot;engine_hp&#92;&quot;:300.0,&#92;&quot;engine_cylinders&#92;&quot;:6.0,&#92;&quot;transmission_type&#92;&quot;:&#92;&quot;MANUAL&#92;&quot;,&#92;&quot;driven_wheels&#92;&quot;:&#92;&quot;rear wheel drive&#92;&quot;,&#92;&quot;number_of_doors&#92;&quot;:2.0,&#92;&quot;market_category&#92;&quot;:&#92;&quot;Luxury,High-Performance&#92;&quot;,&#92;&quot;vehicle_size&#92;&quot;:&#92;&quot;Compact&#92;&quot;,&#92;&quot;vehicle_style&#92;&quot;:&#92;&quot;Coupe&#92;&quot;,&#92;&quot;highway_mpg&#92;&quot;:28,&#92;&quot;city_mpg&#92;&quot;:20,&#92;&quot;popularity&#92;&quot;:3916,&#92;&quot;msrp&#92;&quot;:36350},{&#92;&quot;make&#92;&quot;:&#92;&quot;BMW&#92;&quot;,&#92;&quot;model&#92;&quot;:&#92;&quot;1 Series&#92;&quot;,&#92;&quot;year&#92;&quot;:2011,&#92;&quot;engine_fuel_type&#92;&quot;:&#92;&quot;premium unleaded (required)&#92;&quot;,&#92;&quot;engine_hp&#92;&quot;:230.0,&#92;&quot;engine_cylinders&#92;&quot;:6.0,&#92;&quot;transmission_type&#92;&quot;:&#92;&quot;MANUAL&#92;&quot;,&#92;&quot;driven_wheels&#92;&quot;:&#92;&quot;rear wheel drive&#92;&quot;,&#92;&quot;number_of_doors&#92;&quot;:2.0,&#92;&quot;market_category&#92;&quot;:&#92;&quot;Luxury,Performance&#92;&quot;,&#92;&quot;vehicle_size&#92;&quot;:&#92;&quot;Compact&#92;&quot;,&#92;&quot;vehicle_style&#92;&quot;:&#92;&quot;Coupe&#92;&quot;,&#92;&quot;highway_mpg&#92;&quot;:28,&#92;&quot;city_mpg&#92;&quot;:18,&#92;&quot;popularity&#92;&quot;:3916,&#92;&quot;msrp&#92;&quot;:29450},{&#92;&quot;make&#92;&quot;:&#92;&quot;BMW&#92;&quot;,&#92;&quot;model&#92;&quot;:&#92;&quot;1 Series&#92;&quot;,&#92;&quot;year&#92;&quot;:2011,&#92;&quot;engine_fuel_type&#92;&quot;:&#92;&quot;premium unleaded (required)&#92;&quot;,&#92;&quot;engine_hp&#92;&quot;:230.0,&#92;&quot;engine_cylinders&#92;&quot;:6.0,&#92;&quot;transmission_type&#92;&quot;:&#92;&quot;MANUAL&#92;&quot;,&#92;&quot;driven_wheels&#92;&quot;:&#92;&quot;rear wheel drive&#92;&quot;,&#92;&quot;number_of_doors&#92;&quot;:2.0,&#92;&quot;market_category&#92;&quot;:&#92;&quot;Luxury&#92;&quot;,&#92;&quot;vehicle_size&#92;&quot;:&#92;&quot;Compact&#92;&quot;,&#92;&quot;vehicle_style&#92;&quot;:&#92;&quot;Convertible&#92;&quot;,&#92;&quot;highway_mpg&#92;&quot;:28,&#92;&quot;city_mpg&#92;&quot;:18,&#92;&quot;popularity&#92;&quot;:3916,&#92;&quot;msrp&#92;&quot;:34500}]&quot;' data-total-rows='5' data-total-columns='16' data-max-columns='50' data-banner-text='&quot;&quot;' data-pagination='true' data-page-size='10' data-field-types='[[&quot;make&quot;,[&quot;string&quot;,&quot;object&quot;]],[&quot;model&quot;,[&quot;string&quot;,&quot;object&quot;]],[&quot;year&quot;,[&quot;integer&quot;,&quot;int64&quot;]],[&quot;engine_fuel_type&quot;,[&quot;string&quot;,&quot;object&quot;]],[&quot;engine_hp&quot;,[&quot;number&quot;,&quot;float64&quot;]],[&quot;engine_cylinders&quot;,[&quot;number&quot;,&quot;float64&quot;]],[&quot;transmission_type&quot;,[&quot;string&quot;,&quot;object&quot;]],[&quot;driven_wheels&quot;,[&quot;string&quot;,&quot;object&quot;]],[&quot;number_of_doors&quot;,[&quot;number&quot;,&quot;float64&quot;]],[&quot;market_category&quot;,[&quot;string&quot;,&quot;object&quot;]],[&quot;vehicle_size&quot;,[&quot;string&quot;,&quot;object&quot;]],[&quot;vehicle_style&quot;,[&quot;string&quot;,&quot;object&quot;]],[&quot;highway_mpg&quot;,[&quot;integer&quot;,&quot;int64&quot;]],[&quot;city_mpg&quot;,[&quot;integer&quot;,&quot;int64&quot;]],[&quot;popularity&quot;,[&quot;integer&quot;,&quot;int64&quot;]],[&quot;msrp&quot;,[&quot;integer&quot;,&quot;int64&quot;]]]' data-show-filters='true' data-show-download='true' data-show-column-summaries='false' data-show-data-types='true' data-show-page-size-selector='false' data-show-column-explorer='true' data-show-chart-builder='true' data-row-headers='[]' data-has-stable-row-id='false' data-lazy='false' data-preload='false'></marimo-table></marimo-ui-element>"}, "type": "data"}]}, {"code_hash": "a8fd1747efc75f553a8fbbc6ec5e0ec6", "console": [], "id": "RGSE", "outputs": [{"data": {"text/html": "<span class=\"markdown prose dark:prose-invert\"><h3 id=\"standardize-values\">Standardize Values</h3>\n<span class=\"paragraph\">First we'll get the list of all string columns.</span></span>"}, "type": "data"}]}, {"code_hash": "ad720e3bfb7c47ad367a1dde9b5a33b1", "console": [], "id": "Kclp", "outputs": [{"data": {"application/json": "[\"make\", \"model\", \"engine_fuel_type\", \"transmission_type\", \"driven_wheels\", \"market_category\", \"vehicle_size\", \"vehicle_style\"]"}, "type": "data"}]}, {"code_hash": "dce44a41405e788fe629687dc8a99a4e", "console": [], "id": "emfo", "outputs": [{"data": {"text/html": "<marimo-ui-element object-id='emfo-0' random-id='de739c02-721a-681a-4e03-d54193bf290a'><marimo-table data-initial-value='[]' data-label='null' data-data='&quot;[{&#92;&quot;make&#92;&quot;:&#92;&quot;bmw&#92;&quot;,&#92;&quot;model&#92;&quot;:&#92;&quot;1_series_m&#92;&quot;,&#92;&quot;year&#92;&quot;:2011,&#92;&quot;engine_fuel_type&#92;&quot;:&#92;&quot;premium_unleaded_(required)&#92;&quot;,&#92;&quot;engine_hp&#92;&quot;:335.0,&#92;&quot;engine_cylinders&#92;&quot;:6.0,&#92;&quot;transmission_type&#92;&quot;:&#92;&quot;manual&#92;&quot;,&#92;&quot;driven_wheels&#92;&quot;:&#92;&quot;rear_wheel_drive&#92;&quot;,&#92;&quot;number_of_doors&#92;&quot;:2.0,&#92;&quot;market_category&#92;&quot;:&#92;&quot;factory_tuner,luxury,high-performance&#92;&quot;,&#92;&quot;vehicle_size&#92;&quot;:&#92;&quot;compact&#92;&quot;,&#92;&quot;vehicle_style&#92;&quot;:&#92;&quot;coupe&#92;&quot;,&#92;&quot;highway_mpg&#92;&quot;:26,&#92;&quot;city_mpg&#92;&quot;:19,&#92;&quot;popularity&#92;&quot;:3916,&#92;&quot;msrp&#92;&quot;:46135},{&#92;&quot;make&#92;&quot;:&#92;&quot;bmw&#92;&quot;,&#92;&quot;model&#92;&quot;:&#92;&quot;1_series&#92;&quot;,&#92;&quot;year&#92;&quot;:2011,&#92;&quot;engine_fuel_type&#92;&quot;:&#92;&quot;premium_unleaded_(required)&#92;&quot;,&#92;&quot;engine_hp&#92;&quot;:300.0,&#92;&quot;engine_cylinders&#92;&quot;:6.0,&#92;&quot;transmission_type&#92;&quot;:&#92;&quot;manual&#92;&quot;,&#92;&quot;driven_wheels&#92;&quot;:&#92;&quot;rear_wheel_drive&#92;&quot;,&#92;&quot;number_of_doors&#92;&quot;:2.0,&#92;&quot;market_category&#92;&quot;:&#92;&quot;luxury,performance&#92;&quot;,&#92;&quot;vehicle_size&#92;&quot;:&#92;&quot;compact&#92;&quot;,&#92;&quot;vehicle_style&#92;&quot;:&#92;&quot;convertible&#92;&quot;,&#92;&quot;highway_mpg&#92;&quot;:28,&#92;&quot;city_mpg&#92;&quot;:19,&#92;&quot;popularity&#92;&quot;:3916,&#92;&quot;msrp&#92;&quot;:40650},{&#92;&quot;make&#92;&quot;:&#92;&quot;bmw&#92;&quot;,&#92;&quot;model&#92;&quot;:&#92;&quot;1_series&#92;&quot;,&#92;&quot;year&#92;&quot;:2011,&#92;&quot;engine_fuel_type&#92;&quot;:&#92;&quot;premium_unleaded_(required)&#92;&quot;,&#92;&quot;engine_hp&#92;&quot;:300.0,&#92;&quot;engine_cylinders&#92;&quot;:6.0,&#92;&quot;transmission_type&#92;&quot;:&#92;&quot;manual&#92;&quot;,&#92;&quot;driven_wheels&#92;&quot;:&#92;&quot;rear_wheel_drive&#92;&quot;,&#92;&quot;number_of_doors&#92;&quot;:2.0,&#92;&quot;market_category&#92;&quot;:&#92;&quot;luxury,high-performance&#92;&quot;,&#92;&quot;vehicle_size&#92;&quot;:&#92;&quot;compact&#92;&quot;,&#92;&quot;vehicle_style&#92;&quot;:&#92;&quot;coupe&#92;&quot;,&#92;&quot;highway_mpg&#92;&quot;:28,&#92;&quot;city_mpg&#92;&quot;:20,&#92;&quot;popularity&#92;&quot;:3916,&#92;&quot;msrp&#92;&quot;:36350},{&#92;&quot;make&#92;&quot;:&#92;&quot;bmw&#92;&quot;,&#92;&quot;model&#92;&quot;:&#92;&quot;1_series&#92;&quot;,&#92;&quot;year&#92;&quot;:2011,&#92;&quot;engine_fuel_type&#92;&quot;:&#92;&quot;premium_unleaded_(required)&#92;&quot;,&#92;&quot;engine_hp&#92;&quot;:230.0,&#92;&quot;engine_cylinders&#92;&quot;:6.0,&#92;&quot;transmission_type&#92;&quot;:&#92;&quot;manual&#92;&quot;,&#92;&quot;driven_wheels&#92;&quot;:&#92;&quot;rear_wheel_drive&#92;&quot;,&#92;&quot;number_of_doors&#92;&quot;:2.0,&#92;&quot;market_category&#92;&quot;:&#92;&quot;luxury,performance&#92;&quot;,&#92;&quot;vehicle_size&#92;&quot;:&#92;&quot;compact&#92;&quot;,&#92;&quot;vehicle_style&#92;&quot;:&#92;&quot;coupe&#92;&quot;,&#92;&quot;highway_mpg&#92;&quot;:28,&#92;&quot;city_mpg&#92;&quot;:18,&#92;&quot;popularity&#92;&quot;:3916,&#92;&quot;msrp&#92;&quot;:29450},{&#92;&quot;make&#92;&quot;:&#92;&quot;bmw&#92;&quot;,&#92;&quot;model&#92;&quot;:&#92;&quot;1_series&#92;&quot;,&#92;&quot;year&#92;&quot;:2011,&#92;&quot;engine_fuel_type&#92;&quot;:&#92;&quot;premium_unleaded_(required)&#92;&quot;,&#92;&quot;engine_hp&#92;&quot;:230.0,&#92;&quot;engine_cylinders&#92;&quot;:6.0,&#92;&quot;transmission_type&#92;&quot;:&#92;&quot;manual&#92;&quot;,&#92;&quot;driven_wheels&#92;&quot;:&#92;&quot;rear_wheel_drive&#92;&quot;,&#92;&quot;number_of_doors&#92;&quot;:2.0,&#92;&quot;market_category&#92;&quot;:&#92;&quot;luxury&#92;&quot;,&#92;&quot;vehicle_size&#92;&quot;:&#92;&quot;compact&#92;&quot;,&#92;&quot;vehicle_style&#92;&quot;:&#92;&quot;convertible&#92;&quot;,&#92;&quot;highway_mpg&#92;&quot;:28,&#92;&quot;city_mpg&#92;&quot;:18,&#92;&quot;popularity&#92;&quot;:3916,&#92;&quot;msrp&#92;&quot;:34500}]&quot;' data-total-rows='5' data-total-columns='16' data-max-columns='50' data-banner-text='&quot;&quot;' data-pagination='true' data-page-size='10' data-field-types='[[&quot;make&quot;,[&quot;string&quot;,&quot;object&quot;]],[&quot;model&quot;,[&quot;string&quot;,&quot;object&quot;]],[&quot;year&quot;,[&quot;integer&quot;,&quot;int64&quot;]],[&quot;engine_fuel_type&quot;,[&quot;string&quot;,&quot;object&quot;]],[&quot;engine_hp&quot;,[&quot;number&quot;,&quot;float64&quot;]],[&quot;engine_cylinders&quot;,[&quot;number&quot;,&quot;float64&quot;]],[&quot;transmission_type&quot;,[&quot;string&quot;,&quot;object&quot;]],[&quot;driven_wheels&quot;,[&quot;string&quot;,&quot;object&quot;]],[&quot;number_of_doors&quot;,[&quot;number&quot;,&quot;float64&quot;]],[&quot;market_category&quot;,[&quot;string&quot;,&quot;object&quot;]],[&quot;vehicle_size&quot;,[&quot;string&quot;,&quot;object&quot;]],[&quot;vehicle_style&quot;,[&quot;string&quot;,&quot;object&quot;]],[&quot;highway_mpg&quot;,[&quot;integer&quot;,&quot;int64&quot;]],[&quot;city_mpg&quot;,[&quot;integer&quot;,&quot;int64&quot;]],[&quot;popularity&quot;,[&quot;integer&quot;,&quot;int64&quot;]],[&quot;msrp&quot;,[&quot;integer&quot;,&quot;int64&quot;]]]' data-show-filters='true' data-show-download='true' data-show-column-summaries='false' data-show-data-types='true' data-show-page-size-selector='false' data-show-column-explorer='true' data-show-chart-builder='true' data-row-headers='[]' data-has-stable-row-id='false' data-lazy='false' data-preload='false'></marimo-table></marimo-ui-element>"}, "type": "data"}]}, {"code_hash": "6d5010ff652e368df7b670074d9c0d3f", "console": [], "id": "Hstk", "outputs": [{"data": {"text/html": "<span class=\"markdown prose dark:prose-invert\"><h2 id=\"exploratory-data-analysis\">Exploratory Data Analysis</h2>\n<h3 id=\"check-unique-values-per-column\">Check Unique Values per Column</h3></span>"}, "type": "data"}]}, {"code_hash": "79f009049d480fe18ff2b7e61711ac0e", "console": [], "id": "nWHF", "outputs": [{"data": {"application/json": "{\"make\": {\"sample\": \"text/plain:['bmw' 'audi' 'fiat' 'mercedes-benz' 'chrysler']\", \"count\": 48}, \"model\": {\"sample\": \"text/plain:['1_series_m' '1_series' '100' '124_spider' '190-class']\", \"count\": 914}, \"year\": {\"sample\": \"text/plain:[2011 2012 2013 1992 1993]\", \"count\": 28}, \"engine_fuel_type\": {\"sample\": \"text/plain:['premium_unleaded_(required)' 'regular_unleaded'\\n 'premium_unleaded_(recommended)' 'flex-fuel_(unleaded/e85)' 'diesel']\", \"count\": 10}, \"engine_hp\": {\"sample\": \"text/plain:[335. 300. 230. 320. 172.]\", \"count\": 356}, \"engine_cylinders\": {\"sample\": \"text/plain:[ 6.  4.  5.  8. 12.]\", \"count\": 9}, \"transmission_type\": {\"sample\": \"text/plain:['manual' 'automatic' 'automated_manual' 'direct_drive' 'unknown']\", \"count\": 5}, \"driven_wheels\": {\"sample\": \"text/plain:['rear_wheel_drive' 'front_wheel_drive' 'all_wheel_drive'\\n 'four_wheel_drive']\", \"count\": 4}, \"number_of_doors\": {\"sample\": \"text/plain:[ 2.  4.  3. nan]\", \"count\": 3}, \"market_category\": {\"sample\": \"text/plain:['factory_tuner,luxury,high-performance' 'luxury,performance'\\n 'luxury,high-performance' 'luxury' 'performance']\", \"count\": 71}, \"vehicle_size\": {\"sample\": \"text/plain:['compact' 'midsize' 'large']\", \"count\": 3}, \"vehicle_style\": {\"sample\": \"text/plain:['coupe' 'convertible' 'sedan' 'wagon' '4dr_hatchback']\", \"count\": 16}, \"highway_mpg\": {\"sample\": \"text/plain:[26 28 27 25 24]\", \"count\": 59}, \"city_mpg\": {\"sample\": \"text/plain:[19 20 18 17 16]\", \"count\": 69}, \"popularity\": {\"sample\": \"text/plain:[3916 3105  819  617 1013]\", \"count\": 48}, \"msrp\": {\"sample\": \"text/plain:[46135 40650 36350 29450 34500]\", \"count\": 6049}}"}, "type": "data"}]}, {"code_hash": "9ee48e97a45745667c20e61ca1179d8f", "console": [], "id": "iLit", "outputs": [{"data": {"text/html": "<span class=\"markdown prose dark:prose-invert\"><h3 id=\"check-the-price-column\">Check the Price Column</h3>\n<span class=\"paragraph\">A tiny number of cars with a very high price is ruining our plot.</span></span>"}, "type": "data"}]}, {"code_hash": "e2060c13af97e5753962d9599ef97dcf", "console": [], "id": "ZHCJ", "outputs": [{"data": {"image/png": "data:image/png;base64,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KFBiYqJat26tLl26aM6cOTp16pRXzebNmzV8+HDZ7Xb16dNHGRkZdTlsAADQQtXpHqLPP/9cQ4cOlSTt3r3ba642N1h369ZNjz32mC699FJZlqVXX31Vt9xyi3bt2qUBAwZo9uzZyszM1OrVqxUSEqLk5GRNmDBBn3zyiaRffh07MTFR4eHhys7O1uHDhzV16lQFBgbqP//zPyX98hMBiYmJuvfee/XGG28oKytLM2bMUNeuXZWQkFCXwwcAAC2MzbIsy9dNnK5Dhw564okndOutt6pz585avny5br31VknSF198oejoaOXk5GjUqFF6//33ddNNN+nQoUMKCwuT9MsN3w888IB++OEHBQUF6YEHHlBmZqZXcJs0aZJKSkq0bt26i+rJ7XYrJCREpaWlcjgc9Xq82dnZmv/ObnXqPUiS9NXWNQoMCVePIaM8Nf/an6eFtwzkvi0AAGqhNp/fdfrKrCFUVlZqxYoVOn78uJxOp1wulyoqKhQfH++p6d+/v7p3766cnBxJUk5OjgYNGuQJQ5KUkJAgt9utPXv2eGpO30d1TfU+alJWVia32+21AACAlqtOX5mNGTPmvF+Nbdq06aL3lZeXJ6fTqZMnT6pt27Z6++23FRMTo9zcXAUFBSk0NNSrPiwsTIWFhZKkwsJCrzBUPV89d74at9utEydOqFWrVmf1tGjRIi1YsOCijwEAADRvdQpE1fcPVauoqFBubq5279591h99vZB+/fopNzdXpaWl+p//+R9NmzZNW7ZsqUtb9SYtLc3r5nC3263IyEgfdgQAABpSnQLRkiVLahx/5JFHdOzYsVrtKygoSH369JEkxcbGaseOHXrmmWd02223qby8XCUlJV5XiYqKihQeHi5JCg8P1/bt2732V/0U2uk1Zz6ZVlRUJIfDUePVIUmy2+2y2+21Og4AANB81es9RL/73e9+9d8xq6qqUllZmWJjYxUYGKisrCzPXH5+vgoKCuR0OiVJTqdTeXl5Ki4u9tRs3LhRDodDMTExnprT91FdU70PAACAOv9x15rk5OQoODj4ouvT0tI0btw4de/eXUePHtXy5cu1efNmrV+/XiEhIZo+fbpSU1PVoUMHORwOzZo1S06nU6NG/fIE1tixYxUTE6MpU6bo8ccfV2FhoebNm6ekpCTPFZ57771Xzz//vObOnas777xTmzZt0qpVq5SZmVmfhw4AAJqxOgWiCRMmeK1blqXDhw/rs88+00MPPXTR+ykuLtbUqVN1+PBhhYSEaPDgwVq/fr2uv/56Sb98Nefn56eJEyeqrKxMCQkJeuGFFzzb+/v7a+3atZo5c6acTqfatGmjadOmaeHChZ6aqKgoZWZmavbs2XrmmWfUrVs3vfTSS/wGEQAA8KhTIAoJCfFa9/PzU79+/bRw4UKNHTv2ovfz8ssvn3c+ODhY6enpSk9PP2dNjx499N577513P6NHj9auXbsuui8AAGCWOgWiZcuW1XcfAAAAPvOr7iFyuVzat2+fJGnAgAEaNmxYvTQFAADQmOoUiIqLizVp0iRt3rzZ80h8SUmJxowZoxUrVqhz58712SMAAECDqtNj97NmzdLRo0e1Z88eHTlyREeOHNHu3bvldrv1hz/8ob57BAAAaFB1ukK0bt06ffDBB4qOjvaMxcTEKD09vVY3VQMAADQFdbpCVFVVpcDAwLPGAwMDVVVV9aubAgAAaEx1CkTXXnut7rvvPh06dMgz9v3332v27Nm67rrr6q05AACAxlCnQPT888/L7XarZ8+e6t27t3r37q2oqCi53W4999xz9d0jAABAg6rTPUSRkZHauXOnPvjgA33xxReSpOjoaMXHx9drcwAAAI2hVleINm3apJiYGLndbtlsNl1//fWaNWuWZs2apcsvv1wDBgzQRx991FC9AgAANIhaBaKnn35ad911lxwOx1lzISEhuueee7R48eJ6aw4AAKAx1CoQ/fOf/9QNN9xwzvmxY8fK5XL96qYAAAAaU60CUVFRUY2P21cLCAjQDz/88KubAgAAaEy1CkSXXHKJdu/efc75zz//XF27dv3VTQEAADSmWgWiG2+8UQ899JBOnjx51tyJEyf08MMP66abbqq35gAAABpDrR67nzdvnt566y317dtXycnJ6tevnyTpiy++UHp6uiorK/XHP/6xQRoFAABoKLUKRGFhYcrOztbMmTOVlpYmy7IkSTabTQkJCUpPT1dYWFiDNAoAANBQav3DjD169NB7772nn376SV999ZUsy9Kll16q9u3bN0R/AAAADa5Ov1QtSe3bt9fll19en70AAAD4RJ3+lhkAAEBLQiACAADGIxABAADjEYgAAIDxCEQAAMB4BCIAAGA8AhEAADAegQgAABiPQAQAAIxHIAIAAMYjEAEAAOMRiAAAgPEIRAAAwHgEIgAAYDwCEQAAMB6BCAAAGI9ABAAAjEcgAgAAxiMQAQAA4xGIAACA8QhEAADAeAQiAABgPAIRAAAwHoEIAAAYj0AEAACMRyACAADGIxABAADjEYgAAIDxCEQAAMB4BCIAAGA8AhEAADAegQgAABiPQAQAAIzn00C0aNEiXX755WrXrp26dOmi8ePHKz8/36vm5MmTSkpKUseOHdW2bVtNnDhRRUVFXjUFBQVKTExU69at1aVLF82ZM0enTp3yqtm8ebOGDx8uu92uPn36KCMjo6EPDwAANBM+DURbtmxRUlKStm3bpo0bN6qiokJjx47V8ePHPTWzZ8/Wu+++q9WrV2vLli06dOiQJkyY4JmvrKxUYmKiysvLlZ2drVdffVUZGRmaP3++p+bAgQNKTEzUmDFjlJubq5SUFM2YMUPr169v1OMFAABNU4AvX3zdunVe6xkZGerSpYtcLpeuvvpqlZaW6uWXX9by5ct17bXXSpKWLVum6Ohobdu2TaNGjdKGDRu0d+9effDBBwoLC9PQoUP16KOP6oEHHtAjjzyioKAgLV26VFFRUXrqqackSdHR0fr444+1ZMkSJSQknNVXWVmZysrKPOtut7sB/ysAAABfa1L3EJWWlkqSOnToIElyuVyqqKhQfHy8p6Z///7q3r27cnJyJEk5OTkaNGiQwsLCPDUJCQlyu93as2ePp+b0fVTXVO/jTIsWLVJISIhniYyMrL+DBAAATU6TCURVVVVKSUnRFVdcoYEDB0qSCgsLFRQUpNDQUK/asLAwFRYWempOD0PV89Vz56txu906ceLEWb2kpaWptLTUsxw8eLBejhEAADRNPv3K7HRJSUnavXu3Pv74Y1+3IrvdLrvd7us2AABAI2kSV4iSk5O1du1affjhh+rWrZtnPDw8XOXl5SopKfGqLyoqUnh4uKfmzKfOqtcvVONwONSqVav6PhwAANDM+DQQWZal5ORkvf3229q0aZOioqK85mNjYxUYGKisrCzPWH5+vgoKCuR0OiVJTqdTeXl5Ki4u9tRs3LhRDodDMTExnprT91FdU70PAABgNp9+ZZaUlKTly5frnXfeUbt27Tz3/ISEhKhVq1YKCQnR9OnTlZqaqg4dOsjhcGjWrFlyOp0aNWqUJGns2LGKiYnRlClT9Pjjj6uwsFDz5s1TUlKS52uve++9V88//7zmzp2rO++8U5s2bdKqVauUmZnps2MHAABNh0+vEL344osqLS3V6NGj1bVrV8+ycuVKT82SJUt00003aeLEibr66qsVHh6ut956yzPv7++vtWvXyt/fX06nU7/73e80depULVy40FMTFRWlzMxMbdy4UUOGDNFTTz2ll156qcZH7gEAgHl8eoXIsqwL1gQHBys9PV3p6ennrOnRo4fee++98+5n9OjR2rVrV617BAAALV+TuKkaAADAlwhEAADAeAQiAABgPAIRAAAwHoEIAAAYj0AEAACMRyACAADGIxABAADjEYgAAIDxCEQAAMB4BCIAAGA8AhEAADAegQgAABiPQAQAAIxHIAIAAMYjEAEAAOMRiAAAgPEIRAAAwHgBvm4AF1Z1qkJ5eXleY7GxsbLb7T7qCACAloVA1Ay4iwr03DcnFP61TZJU8v1+Pft7KS4uzsedAQDQMhCImol24VHq1HuQr9sAAKBF4h4iAABgPAIRAAAwHoEIAAAYj0AEAACMRyACAADGIxABAADjEYgAAIDxCEQAAMB4BCIAAGA8AhEAADAegQgAABiPQAQAAIxHIAIAAMYjEAEAAOMRiAAAgPEIRAAAwHgEIgAAYDwCEQAAMB6BCAAAGI9ABAAAjEcgAgAAxiMQAQAA4xGIAACA8QhEAADAeAQiAABgPAIRAAAwHoEIAAAYj0AEAACMRyACAADGIxABAADj+TQQbd26VTfffLMiIiJks9m0Zs0ar3nLsjR//nx17dpVrVq1Unx8vL788kuvmiNHjmjy5MlyOBwKDQ3V9OnTdezYMa+azz//XFdddZWCg4MVGRmpxx9/vKEPDQAANCM+DUTHjx/XkCFDlJ6eXuP8448/rmeffVZLly7Vp59+qjZt2ighIUEnT5701EyePFl79uzRxo0btXbtWm3dulV33323Z97tdmvs2LHq0aOHXC6XnnjiCT3yyCP629/+1uDHBwAAmocAX774uHHjNG7cuBrnLMvS008/rXnz5umWW26RJL322msKCwvTmjVrNGnSJO3bt0/r1q3Tjh07dNlll0mSnnvuOd1444168sknFRERoTfeeEPl5eV65ZVXFBQUpAEDBig3N1eLFy/2Ck4AAMBcTfYeogMHDqiwsFDx8fGesZCQEI0cOVI5OTmSpJycHIWGhnrCkCTFx8fL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GRnW3r17rbvvvtsKDQ21CgsLLcuyrClTplgPPvigp/6TTz6xAgICrCeffNLat2+f9fDDD1uBgYFWXl6erw7BSLU9bwsWLLDWr19v7d+/33K5XNakSZOs4OBga8+ePb46BOMcPXrU2rVrl7Vr1y5LkrV48WJr165d1rfffmtZlmU9+OCD1pQpUzz1X3/9tdW6dWtrzpw51r59+6z09HTL39/fWrduna8OwTi1PWdLliyx1qxZY3355ZdWXl6edd9991l+fn7WBx984KtDMM7MmTOtkJAQa/Pmzdbhw4c9y88//+ypac6fawSiBvbcc89Z3bt3t4KCgqwRI0ZY27Zt88xdc8011rRp07zqV61aZfXt29cKCgqyBgwYYGVmZjZyx7Cs2p23lJQUT21YWJh14403Wjt37vRB1+aqfiT7zKX6PE2bNs265pprztpm6NChVlBQkNWrVy9r2bJljd63yWp7zv7yl79YvXv3toKDg60OHTpYo0ePtjZt2uSb5g1V0/mS5PXeac6fazbLsqzGvioFAADQlHAPEQAAMB6BCAAAGI9ABAAAjEcgAgAAxiMQAQAA4xGIAACA8QhEAADAeAQiAADgM1u3btXNN9+siIgI2Ww2rVmzptb7sCxLTz75pPr27Su73a5LLrlEf/7zn2u1D/7aPQAA8Jnjx49ryJAhuvPOOzVhwoQ67eO+++7Thg0b9OSTT2rQoEE6cuSIjhw5Uqt98EvVAACgSbDZbHr77bc1fvx4z1hZWZn++Mc/6r//+79VUlKigQMH6i9/+YtGjx4tSdq3b58GDx6s3bt3q1+/fnV+bb4yA4ALqKio8HULgLGSk5OVk5OjFStW6PPPP9dvfvMb3XDDDfryyy8lSe+++6569eqltWvXKioqSj179tSMGTNqfYWIQASg2Rs9erRmzZqllJQUtW/fXmFhYfr73/+u48eP64477lC7du3Up08fvf/++5Kkn376SZMnT1bnzp3VqlUrXXrppVq2bJkk6ZtvvpHNZtPKlSt1zTXXKDg4WG+88YYyMjIUGhqqNWvW6NJLL1VwcLASEhJ08OBBXx460KIVFBRo2bJlWr16ta666ir17t1b999/v6688krPe/brr7/Wt99+q9WrV+u1115TRkaGXC6Xbr311lq9FoEIQIvw6quvqlOnTtq+fbtmzZqlmTNn6je/+Y3i4uK0c+dOjR07VlOmTNHPP/+shx56SHv37tX777+vffv26cUXX1SnTp289vfggw/qvvvu0759+5SQkCBJ+vnnn/XnP/9Zr732mj755BOVlJRo0qRJvjhcwAh5eXmqrKxU37591bZtW8+yZcsW7d+/X5JUVVWlsrIyvfbaa7rqqqs0evRovfzyy/rwww+Vn59/0a/FTdUAWoQhQ4Zo3rx5kqS0tDQ99thj6tSpk+666y5J0vz58/Xiiy/q888/V0FBgYYNG6bLLrtMktSzZ8+z9peSknLWDZ4VFRV6/vnnNXLkSEm/hLDo6Ght375dI0aMaMCjA8x07Ngx+fv7y+Vyyd/f32uubdu2kqSuXbsqICBAffv29cxFR0dL+uUK08XeV8QVIgAtwuDBgz3/9vf3V8eOHTVo0CDPWFhYmCSpuLhYM2fO1IoVKzR06FDNnTtX2dnZZ+2vOiydLiAgQJdffrlnvX///goNDdW+ffvq81AA/H/Dhg1TZWWliouL1adPH68lPDxcknTFFVfo1KlTnitGkvS///u/kqQePXpc9GsRiAC0CIGBgV7rNpvNa8xms0n65fL6uHHj9O2332r27Nk6dOiQrrvuOt1///1e27dp06bhmwagY8eOKTc3V7m5uZKkAwcOKDc3VwUFBerbt68mT56sqVOn6q233tKBAwe0fft2LVq0SJmZmZKk+Ph4DR8+XHfeead27doll8ule+65R9dff73XVaMLIRABMFLnzp01bdo0vf7663r66af1t7/97YLbnDp1Sp999plnPT8/XyUlJZ7L8wBq77PPPtOwYcM0bNgwSVJqaqqGDRum+fPnS5KWLVumqVOn6j/+4z/Ur18/jR8/Xjt27FD37t0lSX5+fnr33XfVqVMnXX311UpMTFR0dLRWrFhRqz64hwiAcebPn6/Y2FgNGDBAZWVlWrt27UWFmsDAQM2aNUvPPvusAgIClJycrFGjRnH/EPArjB49Wuf7ScTAwEAtWLBACxYsOGdNRESE3nzzzV/VB1eIABgnKChIaWlpGjx4sK6++mr5+/tf1P+bbN26tR544AH99re/1RVXXKG2bdtq5cqVjdAxgIbGL1UDwEXIyMhQSkqKSkpKfN0KgAbAFSIAAGA8AhEAADAeX5kBAADjcYUIAAAYj0AEAACMRyACAADGIxABAADjEYgAAIDxCEQAAMB4BCIAAGA8AhEAADDe/wOrSC7xKaSGEQAAAABJRU5ErkJggg=="}, "type": "data"}]}, {"code_hash": "17b063052123f6191e5e0454a99d37dc", "console": [], "id": "ROlb", "outputs": [{"data": {"text/html": "<span class=\"markdown prose dark:prose-invert\"><span class=\"paragraph\">We could filter them to get a better view but that implies making a choice on where to cut. Which could confuse our model.</span></span>"}, "type": "data"}]}, {"code_hash": "5c0989b50daa5e2a46fe7793965fea12", "console": [], "id": "qnkX", "outputs": [{"data": {"image/png": "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAkgAAAGwCAYAAABSN5pGAAAAOnRFWHRTb2Z0d2FyZQBNYXRwbG90bGliIHZlcnNpb24zLjEwLjYsIGh0dHBzOi8vbWF0cGxvdGxpYi5vcmcvq6yFwwAAAAlwSFlzAAAPYQAAD2EBqD+naQAANu9JREFUeJzt3Xt0VNXB/vEnIVcumRBiZogGiEi5hCCUSAxeqiUv4VKrr7xtqSmllhcsTRCkL2pWAe9i0SJCIxRXubgainUtRUs1GoMalRAgGLk22orCD5ykbUhGUJKQ7N8fbU6Zk4ghTDKT5PtZa9bynL3nnH32yMyTc/Y+J8gYYwQAAABLsL8bAAAAEGgISAAAADYEJAAAABsCEgAAgA0BCQAAwIaABAAAYENAAgAAsAnxdwM6g8bGRp04cUJ9+vRRUFCQv5sDAABawRijzz//XPHx8QoOvrBzQgSkVjhx4oQSEhL83QwAANAGx44d02WXXXZB7yEgtUKfPn0k/auDo6Ki/NwaAADQGh6PRwkJCdbv+IUgILVC02W1qKgoAhIAAJ1MW4bHMEgbAADAhoAEAABgQ0ACAACwISABAADYEJAAAABsCEgAAAA2BCQAAAAbAhIAAIANAQkAAMCGgAQAAGBDQAIAALAhIAEAANgQkAAAAGwISAAAADYh/m5Ad1dbW6vS0lKvdWPHjlV4eLifWgQAAAhIflZaWqo7n35J0ZcOliRVH/+bVv1cGj9+vJ9bBgBA90VACgDRlw5W7OBkfzcDAAD8m1/HIBUVFemmm25SfHy8goKCtHXr1q+s+7Of/UxBQUFauXKl1/qqqiplZmYqKipK0dHRmjVrlk6dOuVVZ9++fbruuusUERGhhIQELV++vB2OBgAAdBV+DUinT5/WlVdeqdzc3PPWe/HFF7Vz507Fx8c3K8vMzNTBgwdVUFCgbdu2qaioSHPmzLHKPR6PJk6cqIEDB6q0tFSPP/647r//fq1bt87nxwMAALoGv15imzx5siZPnnzeOsePH9e8efP02muvaerUqV5lhw8fVn5+vnbv3q2UlBRJ0urVqzVlyhQ98cQTio+PV15enurq6rR+/XqFhYUpKSlJZWVlWrFihVeQOldtba1qa2utZY/Hc5FHCgAAOpOAnubf2NioGTNmaNGiRUpKSmpWXlxcrOjoaCscSVJ6erqCg4NVUlJi1bn++usVFhZm1cnIyFB5eblOnjzZ4n6XLVsmh8NhvRISEnx8ZAAAIJAFdED61a9+pZCQEN15550tlrvdbsXFxXmtCwkJUUxMjNxut1XH6XR61Wlabqpjl5OTo5qaGut17Nixiz0UAADQiQTsLLbS0lI99dRT2rt3r4KCgjp03+Hh4dyHCACAbixgzyC98847qqys1IABAxQSEqKQkBB9+umn+sUvfqFBgwZJklwulyorK73ed/bsWVVVVcnlcll1KioqvOo0LTfVAQAAOFfABqQZM2Zo3759Kisrs17x8fFatGiRXnvtNUlSWlqaqqurve5EvX37djU2Nio1NdWqU1RUpPr6eqtOQUGBhg4dqr59+3bsQQEAgE7Br5fYTp06pb/+9a/W8pEjR1RWVqaYmBgNGDBA/fr186ofGhoql8uloUOHSpKGDx+uSZMmafbs2Vq7dq3q6+uVnZ2t6dOnW7cEuO222/TAAw9o1qxZuueee3TgwAE99dRTevLJJzvuQAEAQKfi14C0Z88e3XjjjdbywoULJUkzZ87Uxo0bW7WNvLw8ZWdna8KECQoODta0adO0atUqq9zhcOj1119XVlaWxo4dq9jYWC1duvQrp/gDAAD4NSDdcMMNMsa0uv4nn3zSbF1MTIw2b9583veNGjVK77zzzoU2DwAAdFMBOwYJAADAXwhIAAAANgQkAAAAGwISAACADQEJAADAhoAEAABgQ0ACAACwISABAADYEJAAAABsCEgAAAA2BCQAAAAbAhIAAIANAQkAAMCGgAQAAGBDQAIAALAhIAEAANgQkAAAAGwISAAAADYEJAAAABsCEgAAgA0BCQAAwIaABAAAYENAAgAAsCEgAQAA2BCQAAAAbAhIAAAANgQkAAAAGwISAACADQEJAADAhoAEAABgQ0ACAACwISABAADYEJAAAABsCEgAAAA2BCQAAAAbAhIAAIANAQkAAMCGgAQAAGDj14BUVFSkm266SfHx8QoKCtLWrVutsvr6et1zzz1KTk5Wr169FB8frx//+Mc6ceKE1zaqqqqUmZmpqKgoRUdHa9asWTp16pRXnX379um6665TRESEEhIStHz58o44PAAA0En5NSCdPn1aV155pXJzc5uVffHFF9q7d6+WLFmivXv36oUXXlB5ebm++93vetXLzMzUwYMHVVBQoG3btqmoqEhz5syxyj0ejyZOnKiBAweqtLRUjz/+uO6//36tW7eu3Y8PAAB0TiH+3PnkyZM1efLkFsscDocKCgq81v3mN7/RuHHjdPToUQ0YMECHDx9Wfn6+du/erZSUFEnS6tWrNWXKFD3xxBOKj49XXl6e6urqtH79eoWFhSkpKUllZWVasWKFV5ACAABo0qnGINXU1CgoKEjR0dGSpOLiYkVHR1vhSJLS09MVHByskpISq87111+vsLAwq05GRobKy8t18uTJFvdTW1srj8fj9QIAAN1HpwlIZ86c0T333KMf/vCHioqKkiS53W7FxcV51QsJCVFMTIzcbrdVx+l0etVpWm6qY7ds2TI5HA7rlZCQ4OvDAQAAAaxTBKT6+np9//vflzFGa9asaff95eTkqKamxnodO3as3fcJAAACh1/HILVGUzj69NNPtX37duvskSS5XC5VVlZ61T979qyqqqrkcrmsOhUVFV51mpab6tiFh4crPDzcl4cBAAA6kYA+g9QUjj766CO98cYb6tevn1d5WlqaqqurVVpaaq3bvn27GhsblZqaatUpKipSfX29VaegoEBDhw5V3759O+ZAAABAp+LXgHTq1CmVlZWprKxMknTkyBGVlZXp6NGjqq+v1//8z/9oz549ysvLU0NDg9xut9xut+rq6iRJw4cP16RJkzR79mzt2rVL7733nrKzszV9+nTFx8dLkm677TaFhYVp1qxZOnjwoJ577jk99dRTWrhwob8OGwAABDi/XmLbs2ePbrzxRmu5KbTMnDlT999/v15++WVJ0ujRo73e9+abb+qGG26QJOXl5Sk7O1sTJkxQcHCwpk2bplWrVll1HQ6HXn/9dWVlZWns2LGKjY3V0qVLmeIPAAC+kl8D0g033CBjzFeWn6+sSUxMjDZv3nzeOqNGjdI777xzwe0DAADdU0CPQQIAAPAHAhIAAIANAQkAAMCGgAQAAGBDQAIAALAhIAEAANgQkAAAAGwISAAAADYEJAAAABsCEgAAgA0BCQAAwIaABAAAYENAAgAAsCEgAQAA2BCQAAAAbAhIAAAANgQkAAAAGwISAACADQEJAADAhoAEAABgQ0ACAACwISABAADYEJAAAABsCEgAAAA2BCQAAAAbAhIAAIANAQkAAMCGgAQAAGBDQAIAALAhIAEAANgQkAAAAGwISAAAADYEJAAAABsCEgAAgA0B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JbbGxkalpKTo0UcflSSNGTNGBw4c0Nq1azVz5sx22294eLjCw8PbbfsAACCwBfQZpP79+2vEiBFe64YPH66jR49KklwulySpoqLCq05FRYVV5nK5VFlZ6VV+9uxZVVVVWXUAAADOFdAB6ZprrlF5ebnXug8//FADBw6U9K8B2y6XS4WFhVa5x+NRSUmJ0tLSJElpaWmqrq5WaWmpVWf79u1qbGxUampqBxwFAADobAL6Ettdd92l8ePH69FHH9X3v/997dq1S+vWrdO6deskSUFBQVqwYIEefvhhDRkyRImJiVqyZIni4+N1yy23SPrXGadJkyZp9uzZWrt2rerr65Wdna3p06e3OIMNAAAgoAPSVVddpRdffFE5OTl68MEHlZiYqJUrVyozM9Oqc/fdd+v06dOaM2eOqqurde211yo/P18RERFWnby8PGVnZ2vChAkKDg7WtGnTtGrVKn8cEgAA6ASCjDHG340IdB6PRw6HQzU1NYqKivLptnfs2KGlLx1Q7OBkSdI//rZfD948UuPHj/fpfgAA6G4u5vc7oMcgAQAA+AMBCQAAwIaABAAAYENAAgAAsCEgAQAA2BCQAAAAbAhIAAAANgQkAAAAGwISAACADQEJAADAhoAEAABgQ0ACAACwISABAADYEJAAAABsCEgAAAA2BCQAAAAbAhIAAIANAQkAAMCGgAQAAGBDQAIAALAhIAEAANgQkAAAAGwISAAAADYEJAAAABsCEgAAgA0BCQAAwIaABAAAYENAAgAAsCEgAQAA2BCQAAAAbAhIAAAANgQkAAAAGwISAACADQEJAADAhoAEAABgQ0ACAACwISABAADYEJAAAABsOlVAeuyxxxQUFKQFCxZY686cOaOsrCz169dPvXv31rRp01RRUeH1vqNHj2rq1Knq2bOn4uLitGjRIp09e7aDWw8AADqLThOQdu/erd/+9rcaNWqU1/q77rpLf/rTn/T888/r7bff1okTJ3Trrbda5Q0NDZo6darq6uq0Y8cObdq0SRs3btTSpUs7+hAAAEAn0SkC0qlTp5SZmalnnnlGffv2tdbX1NTod7/7nVasWKFvf/vbGjt2rDZs2KAdO3Zo586dkqTXX39dhw4d0u9//3uNHj1akydP1kMPPaTc3FzV1dX565AAAEAA6xQBKSsrS1OnTlV6errX+tLSUtXX13utHzZs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IzVkyBBt2LBBkvTJJ58oKChIzz33nL71rW8pIiJCeXl52rhxo6Kjo7V161YNGTJEERERysjI0LFjx/x56ADaCQEJQJewadMmxcbGateuXZo3b57mzp2r733vexo/frz27t2riRMnasaMGfriiy+0ZMkSHTp0SK+++qoOHz6sNWvWKDY21mt79957r+bPn6/Dhw8rIyNDkvTFF1/okUce0bPPPqv33ntP1dXVmj59uj8OF0A7CzLGGH83AgAuxg033KCGhga98847kqSGhgY5HA7deuutevbZZyVJbrdb/fv3V3FxsR599FHFxsZq/fr1zbb1ySefKDExUStXrtT8+fOt9Rs3btTtt9+unTt3KjU1VZL0l7/8RcOHD1dJSYnGjRvXAUcKoKNwBglAlzBq1Cjrv3v06KF+/fopOTnZWud0OiVJlZWVmjt3rrZs2aLRo0fr7rvv1o4dO5ptLyUlpdm6kJAQXXXVVdbysGHDFB0drcOHD/vyUAAEAAISgC4hNDTUazkoKMhrXVBQkCSpsbFRkydP1qeffqq77rpLJ06c0IQJE/R///d/Xu/v1atX+zcaQMAiIAHoli655BLNnDlTv//977Vy5UqtW7fua99z9uxZ7dmzx1ouLy9XdXW1hg8f3p5NBeAHIf5uAAB0tKVLl2rs2LFKSkpSbW2ttm3b1qqQExoaqnnz5mnVqlUKCQlRdna2rr76asYfAV0QZ5AAdDthYWHKycnRqFGjdP3116tHjx7asmXL176vZ8+euueee3TbbbfpmmuuUe/evfXcc891QIsBdDRmsQFAK2zcuFELFixQdXW1v5sCoANwBgkAAMCGgAQAAGDDJTYAAAAbziABAADYEJAAAABsCEgAAAA2BCQAAAAbAhIAAIANAQkAAMCGgAQAAGBDQAIAALD5/7B1FfQP1Y+GAAAAAElFTkSuQmCC"}, "type": "data"}]}, {"code_hash": "be67f77fe9c3fa8ad3526d8063a8ee15", "console": [], "id": "TqIu", "outputs": [{"data": {"text/html": "<span class=\"markdown prose dark:prose-invert\"><span class=\"paragraph\">Instead of making a manual cut, we can take the logarithm of the price. By doing so, outlier (few cases with extreme values) are handled in a more elegant way.</span></span>"}, "type": "data"}]}, {"code_hash": "5a976750f915df8ddbd13c90434aad5d", "console": [], "id": "Vxnm", "outputs": [{"data": {"image/png": "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAkQAAAGwCAYAAABIC3rIAAAAOnRFWHRTb2Z0d2FyZQBNYXRwbG90bGliIHZlcnNpb24zLjEwLjYsIGh0dHBzOi8vbWF0cGxvdGxpYi5vcmcvq6yFwwAAAAlwSFlzAAAPYQAAD2EBqD+naQAALx1JREFUeJzt3X90VPWd//HXhJBJjCThh8wklB8xUPlhlDYoJrquSJaIVKGyumlTyiqFLj8FdlE4ElQUWdBFmhhh6VHAFtT2fBUtqygEC9rEgIPRARERQTA0iS0mIyCTkJnvHy6zTAgS4mTuJJ/n45w5h/ncz8y87z1JeM3nfu792Px+v18AAAAGi7K6AAAAAKsRiAAAgPEIRAAAwHgEIgAAYDwCEQAAMB6BCAAAGI9ABAAAjBdtdQFtgc/n09GjR9WpUyfZbDarywEAAM3g9/v19ddfKyUlRVFR3z0GRCBqhqNHj6pnz55WlwEAAFrgyJEj+sEPfvCdfQhEzdCpUydJ3x7QhIQEi6sBAADN4fF41LNnz8D/49+FQNQMZ06TJSQkEIgAAGhjmjPdhUnVAADAeAQiAABgPAIRAAAwHoEIAAAYj0AEAACMRyACAADGIxABAADjEYgAAIDxCEQAAMB4BCIAAGA8AhEAADAegQgAABiPQAQAAIxHIAIAAMaLtroA03m9XrlcrqC2jIwM2e12iyoCAMA8BCKLuVwuzXj6FSX1SJMk1VQcUMEUKSsry+LKAAAwB4EoAiT1SFO3tHSrywAAwFjMIQIAAMYjEAEAAOMRiAAAgPEIRAAAwHgEIgAAYDwCEQAAMB6BCAAAGI9ABAAAjEcgAgAAxiMQAQAA4xGIAACA8QhEAADAeAQiAABgPAIRAAAwHoEIAAAYj0AEAACMRyACAADGIxABAADjEYgAAIDxCEQAAMB4BCIAAGA8AhEAADAegQgAABiPQAQAAIxHIAIAAMYjEAEAAOMRiAAAgPEIRAAAwHgEIgAAYDwCEQAAMB6BCAAAGI9ABAAAjEcgAgAAxiMQAQAA41kaiLZv367bbrtNKSkpstls2rBhQ9B2v9+vBQsWKDk5WXFxccrOztb+/fuD+hw7dkx5eXlKSEhQUlKSJkyYoOPHjwf1+fDDD/UP//APio2NVc+ePbV06dLW3jUAANCGWBqITpw4oauvvlpFRUVNbl+6dKkKCgq0cuVKlZWVKT4+Xjk5OTp16lSgT15envbs2aPNmzdr48aN2r59uyZNmhTY7vF4NGLECPXu3Vsul0uPP/64HnroIa1atarV9w8AALQN0VZ++MiRIzVy5Mgmt/n9fi1fvlzz58/X6NGjJUnPPfecHA6HNmzYoNzcXO3du1ebNm3Szp07NWTIEElSYWGhbr31Vj3xxBNKSUnRunXrVFdXp2effVYxMTEaNGiQysvLtWzZsqDgdDav1yuv1xt47vF4QrznAAAgkkTsHKKDBw+qsrJS2dnZgbbExEQNHTpUpaWlkqTS0lIlJSUFwpAkZWdnKyoqSmVlZYE+N954o2JiYgJ9cnJytG/fPn311VdNfvbixYuVmJgYePTs2bM1dhEAAESIiA1ElZWVkiSHwxHU7nA4AtsqKyvVvXv3oO3R0dHq0qVLUJ+m3uPsz2hs3rx5qq2tDTyOHDny/XcIAABELEtPmUUqu90uu91udRkAACBMInaEyOl0SpKqqqqC2quqqgLbnE6nqqurg7afPn1ax44dC+rT1Huc/RkAAMBsERuIUlNT5XQ6VVxcHGjzeDwqKytTZmamJCkzM1M1NTVyuVyBPlu3bpXP59PQoUMDfbZv3676+vpAn82bN+uKK65Q586dw7Q3AAAgklkaiI4fP67y8nKVl5dL+nYidXl5uQ4fPiybzaaZM2fq0Ucf1auvviq3261f/vKXSklJ0ZgxYyRJAwYM0C233KKJEydqx44d+stf/qJp06YpNzdXKSkpkqSf//zniomJ0YQJE7Rnzx69+OKL+s1vfqPZs2dbtNcAACDSWDqH6L333tOwYcMCz8+ElPHjx2vNmjW67777dOLECU2aNEk1NTW64YYbtGnTJsXGxgZes27dOk2bNk3Dhw9XVFSUxo4dq4KCgsD2xMREvfnmm5o6daoyMjLUrVs3LViw4LyX3AMAAPPY/H6/3+oiIp3H41FiYqJqa2uVkJAQ0vcuKSnRgld2q1tauiTpbwfcWjj6SmVlZYX0cwAAMM3F/P8dsXOIAAAAwoVABAAAjEcgAgAAxiMQAQAA4xGIAACA8QhEAADAeAQiAABgPAIRAAAwHoEIAAAYj0AEAACMRyACAADGIxABAADjEYgAAIDxCEQAAMB4BCIAAGA8AhEAADAegQgAABiPQAQAAIxHIAIAAMYjEAEAAOMRiAAAgPEIRAAAwHgEIgAAYDwCEQAAMB6BCAAAGI9ABAAAjEcgAgAAxiMQAQAA4xGIAACA8QhEAADAeAQiAABgPAIRAAAwHoEIAAAYj0AEAACMRyACAADGIxABAADjEYgAAIDxCEQAAMB4BCIAAGA8AhEAADAegQgAABiPQAQAAIxHIAIAAMYjEAEAAOMRiAAAgPEIRAAAwHgEIgAAYDwCEQAAMB6BCAAAGI9ABAAAjEcgAgAAxovoQNTQ0KD8/HylpqYqLi5OaWlpeuSRR+T3+wN9/H6/FixYoOTkZMXFxSk7O1v79+8Pep9jx44pLy9PCQkJSkpK0oQJE3T8+PFw7w4AAIhQER2IlixZohUrVuipp57S3r17tWTJEi1dulSFhYWBPkuXLlVBQYFWrlypsrIyxcfHKycnR6dOnQr0ycvL0549e7R582Zt3LhR27dv16RJk6zYJQAAEIGirS7gu5SUlGj06NEaNWqUJKlPnz56/vnntWPHDknfjg4tX75c8+fP1+jRoyVJzz33nBwOhzZs2KDc3Fzt3btXmzZt0s6dOzVkyBBJUmFhoW699VY98cQTSklJsWbnAABAxIjoEaKsrCwVFxfrk08+kSR98MEHeueddzRy5EhJ0sGDB1VZWans7OzAaxITEzV06FCVlpZKkkpLS5WUlBQIQ5KUnZ2tqKgolZWVNfm5Xq9XHo8n6AEAANqviB4hmjt3rjwej/r3768OHTqooaFBixYtUl5eniSpsrJSkuRwOIJe53A4AtsqKyvVvXv3oO3R0dHq0qVLoE9jixcv1sMPPxzq3QEAABEqokeI/vCHP2jdunVav369du3apbVr1+qJJ57Q2rVrW/Vz582bp9ra2sDjyJEjrfp5AADAWhE9QjRnzhzNnTtXubm5kqT09HR9/vnnWrx4scaPHy+n0ylJqqqqUnJycuB1VVVVGjx4sCTJ6XSquro66H1Pnz6tY8eOBV7fmN1ul91ub4U9AgAAkSiiR4hOnjypqKjgEjt06CCfzydJSk1NldPpVHFxcWC7x+NRWVmZMjMzJUmZmZmqqamRy+UK9Nm6dat8Pp+GDh0ahr0AAACRLqJHiG677TYtWrRIvXr10qBBg/T+++9r2bJluueeeyRJNptNM2fO1KOPPqp+/fopNTVV+fn5SklJ0ZgxYyRJAwYM0C233KKJEydq5cqVqq+v17Rp05Sbm8sVZgAAQFKEB6LCwkLl5+drypQpqq6uVkpKin79619rwYIFgT733XefTpw4oUmTJqmmpkY33HCDNm3apNjY2ECfdevWadq0aRo+fLiioqI0duxYFRQUWLFLAAAgAtn8Z9/2GU3yeDxKTExUbW2tEhISQvreJSUlWvDKbnVLS5ck/e2AWwtHX6msrKyQfg4AAKa5mP+/I3oOEQAAQDgQiAAAgPEIRAAAwHgEIgAAYDwCEQAAMB6BCAAAGI9ABAAAjEcgAgAAxiMQAQAA4xGIAACA8QhEAADAeAQiAABgPAIRAAAwHoEIAAAYj0AEAACMRyACAADGIxABAADjEYgAAIDxCEQAAMB40VYXAKDt8nq9crlcQW0ZGRmy2+0WVQQALUMgAtBiLpdLM55+RUk90iRJNRUHVDBFysrKsrgyALg4BCIA30tSjzR1S0u3ugwA+F6YQwQAAIxHIAIAAMYjEAEAAOMRiAAAgPEIRAAAwHgEIgAAYDwCEQAAMB6BCAAAGI9ABAAAjEcgAgAAxiMQAQAA4xGIAACA8QhEAADAeAQiAABgvGirCwDQNni9XrlcrqA2t9stn8+iggAghAhEAJrF5XJpxtOvKKlHWqDti/K31blvhoVVAUBoEIgANFtSjzR1S0sPPK+pOGBhNQAQOswhAgAAxmtRILr88sv197///Zz2mpoaXX755d+7KAAAgHBqUSA6dOiQGhoazmn3er2qqKj43kUBAACE00XNIXr11VcD/37jjTeUmJgYeN7Q0KDi4mL16dMnZMUBsE7jq8q4ogxAe3ZRgWjMmDGSJJvNpvHjxwdt69ixo/r06aP/+q//CllxAKzT+KoyrigD0J5dVCDy/e/Xw9TUVO3cuVPdunVrlaIARIazryrjijIA7VmLLrs/ePBgqOsAAACwTIvvQ1RcXKzi4mJVV1cHRo7OePbZZ793YQAAAOHSokD08MMPa+HChRoyZIiSk5Nls9lCXReANsh3ul5ut/uc9oyMDNntdgsqAoDmaVEgWrlypdasWaNx48aFuh4AFgjVOmWeqsMqPPSNnJ/935ekmooDKpgiZWVlhaJUAGgVLQpEdXV1/HED2pFQrlPWyZkatLwHALQFLQpEv/rVr7R+/Xrl5+eHuh4AFmmtdcqaOo3GKTQAkaZFgejUqVNatWqVtmzZoquuukodO3YM2r5s2bKQFAeg7Wt8Go1TaAAiUYuW7vjwww81ePBgRUVFaffu3Xr//fcDj/Ly8pAWWFFRoV/84hfq2rWr4uLilJ6ervfeey+w3e/3a8GCBUpOTlZcXJyys7O1f//+oPc4duyY8vLylJCQoKSkJE2YMEHHjx8PaZ0Azu/MabRuaelBp+UAIFK0aITorbfeCnUdTfrqq690/fXXa9iwYXr99dd12WWXaf/+/ercuXOgz9KlS1VQUKC1a9cqNTVV+fn5ysnJ0UcffaTY2FhJUl5env76179q8+bNqq+v1913361JkyZp/fr1YdkPAAAQ2Vp8H6JwWLJkiXr27KnVq1cH2lJTUwP/9vv9Wr58uebPn6/Ro0dLkp577jk5HA5t2LBBubm52rt3rzZt2qSdO3dqyJAhkqTCwkLdeuuteuKJJ5SSknLO53q9Xnm93sBzj8fTWrsIAAAiQIsC0bBhw77z3kNbt25tcUFne/XVV5WTk6M777xT27ZtU48ePTRlyhRNnDhR0rd3zK6srFR2dnbgNYmJiRo6dKhKS0uVm5ur0tJSJSUlBcKQJGVnZysqKkplZWX66U9/es7nLl68WA8//HBI9gEAAES+Fs0hGjx4sK6++urAY+DAgaqrq9OuXbuUnh66y20/++wzrVixQv369dMbb7yhyZMna8aMGVq7dq0kqbKyUpLkcDiCXudwOALbKisr1b1796Dt0dHR6tKlS6BPY/PmzVNtbW3gceTIkZDtEwAAiDwtGiF68sknm2x/6KGHQjpZ2efzaciQIXrsscckST/60Y+0e/durVy5UuPHjw/Z5zRmt9u5JBgAAIO0aITofH7xi1+EdB2z5ORkDRw4MKhtwIABOnz4sCTJ6XRKkqqqqoL6VFVVBbY5nU5VV1cHbT99+rSOHTsW6AMAAMwW0kBUWloauLIrFK6//nrt27cvqO2TTz5R7969JX07wdrpdKq4uDiw3ePxqKysTJmZmZKkzMxM1dTUBC1LsHXrVvl8Pg0dOjRktQIAgLarRafM7rjjjqDnfr9ff/3rX/Xee++F9O7Vs2bNUlZWlh577DHddddd2rFjh1atWqVVq1ZJkmw2m2bOnKlHH31U/fr1C1x2n5KSojFjxkj6dkTplltu0cSJE7Vy5UrV19dr2rRpys3NbfIKMwAAYJ4WBaLExMSg51FRUbriiiu0cOFCjRgxIiSFSdI111yjl19+WfPmzdPChQuVmpqq5cuXKy8vL9Dnvvvu04kTJzRp0iTV1NTohhtu0KZNm4JGqtatW6dp06Zp+PDhioqK0tixY1VQUBCyOgEAQNvWokB09n2BWttPfvIT/eQnPznvdpvNpoULF2rhwoXn7dOlSxduwggAAM7re92Y0eVyae/evZKkQYMG6Uc/+lFIigLQfjW12KvEgq8ArNWiQFRdXa3c3Fz9+c9/VlJSkiSppqZGw4YN0wsvvKDLLrsslDUCaEcaL/YqseArAOu16Cqz6dOn6+uvv9aePXt07NgxHTt2TLt375bH49GMGTNCXSOAdubsxV5Z8BVAJGjRCNGmTZu0ZcsWDRgwINA2cOBAFRUVhXRSNQAAQDi0aITI5/OpY8eO57R37NhRPp/vexcFAAAQTi0KRDfffLPuvfdeHT16NNBWUVGhWbNmafjw4SErDgAAIBxaFIieeuopeTwe9enTR2lpaUpLS1Nqaqo8Ho8KCwtDXSMAAECratEcop49e2rXrl3asmWLPv74Y0nf3hE6Ozs7pMUBAACEw0WNEG3dulUDBw6Ux+ORzWbTP/3TP2n69OmaPn26rrnmGg0aNEhvv/12a9UKAADQKi4qEC1fvlwTJ05UQkLCOdsSExP161//WsuWLQtZcQAAAOFwUYHogw8+0C233HLe7SNGjAhaVR4AAKAtuKhAVFVV1eTl9mdER0fryy+//N5FAQAAhNNFBaIePXpo9+7d593+4YcfKjk5+XsXBQAAEE4XFYhuvfVW5efn69SpU+ds++abb/Tggw9+58r0AAAAkeiiLrufP3++XnrpJf3whz/UtGnTdMUVV0iSPv74YxUVFamhoUEPPPBAqxQKAADQWi4qEDkcDpWUlGjy5MmaN2+e/H6/JMlmsyknJ0dFRUVyOBytUigAAEBruegbM/bu3VuvvfaavvrqK3366afy+/3q16+fOnfu3Br1AQAAtLoW3alakjp37qxrrrkmlLUACBOv1xt0iwy32y3WZQZgshYHIgBtl8vl0oynX1FSjzRJ0hflb6tz3wyLqwIA6xCIAEMl9UhTt7R0SVJNxQGLqwEAa7VotXsAAID2hEAEAACMRyACAADGYw4RAMv5TtfL7XYHtWVkZMhut1tUEQDTEIgAWM5TdViFh76R8zObpG8neRdMkbKysiyuDIApCEQAIkInZ2rgqjcACDfmEAEAAOMRiAAAgPE4ZQa0c42X6ZBYqgMAGiMQAe1c42U6JJbqAIDGCESAAc5epkNiqQ4AaIw5RAAAwHgEIgAAYDwCEQAAMB6BCAAAGI9ABAAAjEcgAgAAxiMQAQAA4xGIAACA8QhEAADAeNypGkDE8Z2ul9vtPqc9IyNDdrvdgooAtHcEIgARx1N1WIWHvpHzM1ugrabigAqmSFlZWRZWBqC9IhABiEidnKlB668BQGtiDhEAADAegQgAABiPQAQAAIxHIAIAAMYjEAEAAOMRiAAAgPEIRAAAwHgEIgAAYLw2FYj+8z//UzabTTNnzgy0nTp1SlOnTlXXrl116aWXauzYsaqqqgp63eHDhzVq1Chdcskl6t69u+bMmaPTp0+HuXoAABCp2kwg2rlzp/77v/9bV111VVD7rFmz9Kc//Ul//OMftW3bNh09elR33HFHYHtDQ4NGjRqluro6lZSUaO3atVqzZo0WLFgQ7l0AAAARqk0EouPHjysvL0+//e1v1blz50B7bW2tnnnmGS1btkw333yzMjIytHr1apWUlOjdd9+VJL355pv66KOP9Pvf/16DBw/WyJEj9cgjj6ioqEh1dXVW7RIAAIggbSIQTZ06VaNGjVJ2dnZQu8vlUn19fVB7//791atXL5WWlkqSSktLlZ6eLofDEeiTk5Mjj8ejPXv2NPl5Xq9XHo8n6AEAANqviF/c9YUXXtCuXbu0c+fOc7ZVVlYqJiZGSUlJQe0Oh0OVlZWBPmeHoTPbz2xryuLFi/Xwww+HoHoAANAWRPQI0ZEjR3Tvvfdq3bp1io2NDdvnzps3T7W1tYHHkSNHwvbZAAAg/CI6ELlcLlVXV+vHP/6xoqOjFR0drW3btqmgoEDR0dFyOByqq6tTTU1N0OuqqqrkdDolSU6n85yrzs48P9OnMbvdroSEhKAHAABovyI6EA0fPlxut1vl5eWBx5AhQ5SXlxf4d8eOHVVcXBx4zb59+3T48GFlZmZKkjIzM+V2u1VdXR3os3nzZiUkJGjgwIFh3ycAABB5InoOUadOnXTllVcGtcXHx6tr166B9gkTJmj27Nnq0qWLEhISNH36dGVmZuq6666TJI0YMUIDBw7UuHHjtHTpUlVWVmr+/PmaOnWq7HZ72PcJAABEnogORM3x5JNPKioqSmPHjpXX61VOTo6efvrpwPYOHTpo48aNmjx5sjIzMxUfH6/x48dr4cKFFlYNAAAiSZsLRH/+85+DnsfGxqqoqEhFRUXnfU3v3r312muvtXJlAFqT73S93G53UFtGRgYjvQBCos0FIgBm8lQdVuGhb+T8zCZJqqk4oIIpUlZWlsWVAWgPCERAO+P1euVyuQLP3W63fD4LCwqhTs5UdUtLt7oMAO0QgQhoZ1wul2Y8/YqSeqRJkr4of1ud+2ZYXBUARDYCEdAOJfVIC4yk1FQcsLgaAIh8EX0fIgAAgHAgEAEAAOMRiAAAgPEIRAAAwHgEIgAAYDwCEQAAMB6BCAAAGI9ABAAAjEcgAgAAxiMQAQAA4xGIAACA8QhEAADAeCzuCqBN8p2ul9vtPqc9IyNDdrvdgooAtGUEIgBtkqfqsAoPfSPnZ7ZAW03FARVMkbKysiysDEBbRCAC0GZ1cqaqW1q61WUAaAeYQwQAAIxHIAIAAMYjEAEAAOMRiAAAgPEIRAAAwHgEIgAAYDwCEQAAMB6BCAAAGI9ABAAAjEcgAgAAxiMQAQAA4xGIAACA8QhEAADAeAQiAABgvGirCwDQcl6vVy6XK6jN7XbL57OoIABoowhEQBvmcrk04+lXlNQjLdD2Rfnb6tw3w8KqAKDtIRABbVxSjzR1S0sPPK+pOGBhNQDQNjGHCAAAGI9ABAAAjEcgAgAAxiMQAQAA4xGIAACA8QhEAADAeFx2D6Dd8J2ul9vtDmrLyMiQ3W63qCIAbQWBCEC74ak6rMJD38j5mU3St/dkKpgiZWVlWVwZgEhHIALQrnRypgbdqBIAmoM5RAAAwHgEIgAAYDwCEQAAMB6BCAAAGI9ABAAAjEcgAgAAxiMQAQAA40V0IFq8eLGuueYaderUSd27d9eYMWO0b9++oD6nTp3S1KlT1bVrV1166aUaO3asqqqqgvocPnxYo0aN0iWXXKLu3btrzpw5On36dDh3BQAARLCIDkTbtm3T1KlT9e6772rz5s2qr6/XiBEjdOLEiUCfWbNm6U9/+pP++Mc/atu2bTp69KjuuOOOwPaGhgaNGjVKdXV1Kikp0dq1a7VmzRotWLDAil0CAAARKKLvVL1p06ag52vWrFH37t3lcrl04403qra2Vs8884zWr1+vm2++WZK0evVqDRgwQO+++66uu+46vfnmm/roo4+0ZcsWORwODR48WI888ojuv/9+PfTQQ4qJiTnnc71er7xeb+C5x+Np3R0FAACWiugRosZqa2slSV26dJEkuVwu1dfXKzs7O9Cnf//+6tWrl0pLSyVJpaWlSk9Pl8PhCPTJycmRx+PRnj17mvycxYsXKzExMfDo2bNna+0ScFG8Xq9KSkoCD7fbLZ/Pb3VZANDmRfQI0dl8Pp9mzpyp66+/XldeeaUkqbKyUjExMUpKSgrq63A4VFlZGehzdhg6s/3MtqbMmzdPs2fPDjz3eDyEIkQEl8ulGU+/oqQeaZKkL8rfVue+GRZX1bZ4vV65XK6gtoyMDNntdosqAhAJ2kwgmjp1qnbv3q133nmn1T/LbrfzxxERK6lHWmDx0pqKAxZX0/Y0DpU1FQdUMEXKysqyuDIAVmoTgWjatGnauHGjtm/frh/84AeBdqfTqbq6OtXU1ASNElVVVcnpdAb67NixI+j9zlyFdqYPALOcHSoBQIrwOUR+v1/Tpk3Tyy+/rK1btyo1NTVoe0ZGhjp27Kji4uJA2759+3T48GFlZmZKkjIzM+V2u1VdXR3os3nzZiUkJGjgwIHh2RGgBRrPF2LOEAC0nogeIZo6darWr1+vV155RZ06dQrM+UlMTFRcXJwSExM1YcIEzZ49W126dFFCQoKmT5+uzMxMXXfddZKkESNGaODAgRo3bpyWLl2qyspKzZ8/X1OnTuW0GCJa41M7EnOGAKC1RHQgWrFihSTppptuCmpfvXq1/vVf/1WS9OSTTyoqKkpjx46V1+tVTk6Onn766UDfDh06aOPGjZo8ebIyMzMVHx+v8ePHa+HCheHaDaDFGp/aYc4QALSOiA5Efv+FTw3ExsaqqKhIRUVF5+3Tu3dvvfbaa6EsDQAAtCMRPYcIAAAgHAhEAADAeAQiAABgPAIRAAAwXkRPqgZM0nhJiW/vOWRhQQBgEAIRECFYpyz0fKfr5Xa7g9oImgCaQiACIgjrlIWWp+qwCg99I+dntkAbQRNAUwhEANq1Ts5Ubm4J4IIIRACM1tRpNenbtRJZ3gcwB4EIgNGaOq1WU3FABVOkrKwsCysDEE4EIgDGa3xaDYB5uA8RAAAwHoEIAAAYj0AEAACMRyACAADGIxABAADjEYgAAIDxCEQAAMB4BCIAAGA8AhEAADAegQgAABiPpTsAC3i9XrlcrqA2t9stn8+iggDAcAQiwAIul0sznn5FST3SAm1flL+tzn0zLKwKAMxFIAIsktQjLWhB0ZqKAxZWg4vV1ChfRkaG7Ha7RRUB+D4IRADQAo1H+WoqDqhgipSVlWVxZQBagkAEAC3UeJQPQNtFIAKAC2ASPND+EYgijO90vdxu9zntzE0ArMMkeKD9IxBFGE/VYRUe+kbOz2yBNuYmAOHV+IuJ2+1WQvLlTIIH2jECUQTq5ExlXgJgocZfTBgNAto/AhEANOHsLybNGQ3idDfQthGIACAEmjrdfezwPv36JrfS0/9vxJeABEQmAhEAhEjj0901FQdU+OaeQEhiPiAQuQhEbUBTQ/F8ywTaBuYEAm0DgagNaDwUz7dMAABCi0DURvAtEwCA1kMgaoNaejVLU3fbbc7rAABo7whEbVBLb97Y1N12Of0GhA+X5gORi0DURjU+hdbcidcsRglYpzlfZiJxJLepmghxaG8IRO1E4z+0Td3/hMUoAetdaD5gJI7kNq7J6nqA1kAgakca31n37PufSCw/AESi5qybFgkYXUZ7RyBqx5q6SRyAyNIW101r6hR9XV2dJCkmJibQxmk1tCUEIgCw2MWum9aa84yaeu/Gp9ubmgv1Rfl2RV/aRc6+V0ritBraHgKR4bgLNtD2NDXPqKl5g9LF/z439d5NjVo1NQLdMdHJaTW0WQQiwzVnMrZESPq+Gn/rZoI7vq/Gc3qamjfY0sVlm3pvoL0jEOGCk7EZ+v7+Gn/rbgvzRBA5mpp43VSgbmuLy0biLQZgLgIRzsEyIa3j7G/dfOPGxfg+E6/P/n2OtBtDRuItBmAuAhEQYs2ZlApcrIudeN2UpiZDNz6t1po/q02dOm58iwHmNcIqBCIgxJo7KRWwwoVOq4XqZ7WpYON2u7Vq+wF1/kHf835W49DGiBHChUCEC2r8h62p+41Iwd/iTJ8bwKRUtCWhGH1qrOlL878NQBf6rEg+zYf2i0CECzp3/kLw/Uakc7/FmTQ3gCvIgKaF4uawLV3Mujnrr7FGG85mVCAqKirS448/rsrKSl199dUqLCzUtddea3VZbULjb5CN7zcSquUHIv0P1PnmB13oNACAlmvJhR6Nv5Sdb33Hs393ue2I2YwJRC+++KJmz56tlStXaujQoVq+fLlycnK0b98+de/e3ery2rzmXAXTnMmSzVlEMpyhqanRn7P/gErNPw0AIDSacxq/8Zey71rfkduOQDIoEC1btkwTJ07U3XffLUlauXKl/ud//kfPPvus5s6da3F17cOF5iE05yaQjf+INWdiZlPv0/gPZFN/MJvT53yjP8wPAqzTnNP4zb27dmON+7Tkqrf2Moey8X6Eav5opB4fIwJRXV2dXC6X5s2bF2iLiopSdna2SktLz+nv9Xrl9XoDz2trayVJHo8n5LWdOHFCfz/0kU57v/n2s/56SNGeWtk7Rv3f5zdqC1Wf1nzv8/aJ7xzY16+rv9Cjz36kJOeuQJ+/H/pIib0HyVd/SpJU4S7Ro+94muzT6QLv0yH2UiU5ezX5/GL6nP1ZDafrVXNkn7XHkD70idTfb4v+ljScrpetvi7w/Ezb2b+rLf2sxn+DTh6r1PSxwzRo0CCdz549e1T4/97SJV2cgbbmvC7SNN6Ppv5GNt6v5uz7+fqsXDBNQ4cODek+nPl/2+/3X7iz3wAVFRV+Sf6SkpKg9jlz5vivvfbac/o/+OCDfkk8ePDgwYMHj3bwOHLkyAWzghEjRBdr3rx5mj17duC5z+fTsWPH1LVrV9lstu94ZeTyeDzq2bOnjhw5ooSEBKvLsQTHgGMgcQwkjoHEMZDMOAZ+v19ff/21UlJSLtjXiEDUrVs3dejQQVVVVUHtVVVVcjqd5/S32+3nnMdMSkpqzRLDJiEhod3+4DcXx4BjIHEMJI6BxDGQ2v8xSExMbFa/qAt3aftiYmKUkZGh4uLiQJvP51NxcbEyMzMtrAwAAEQCI0aIJGn27NkaP368hgwZomuvvVbLly/XiRMnAledAQAAcxkTiP7lX/5FX375pRYsWKDKykoNHjxYmzZtksPhsLq0sLDb7XrwwQfb1CWfocYx4BhIHAOJYyBxDCSOQWM2v78516IBAAC0X0bMIQIAAPguBCIAAGA8AhEAADAegQgAABiPQNSONTQ0KD8/X6mpqYqLi1NaWpoeeeSR5q3p0o58/fXXmjlzpnr37q24uDhlZWVp586dVpfVqrZv367bbrtNKSkpstls2rBhQ9B2v9+vBQsWKDk5WXFxccrOztb+/futKbYVXGj/X3rpJY0YMSJw9/ny8nJL6mxN33UM6uvrdf/99ys9PV3x8fFKSUnRL3/5Sx09etS6glvBhX4OHnroIfXv31/x8fHq3LmzsrOzVVZWZk2xreRCx+Bs//Zv/yabzably5eHrb5IQiBqx5YsWaIVK1boqaee0t69e7VkyRItXbpUhYWFVpcWVr/61a+0efNm/e53v5Pb7daIESOUnZ2tiooKq0trNSdOnNDVV1+toqKiJrcvXbpUBQUFWrlypcrKyhQfH6+cnBydOnUqzJW2jgvt/4kTJ3TDDTdoyZIlYa4sfL7rGJw8eVK7du1Sfn6+du3apZdeekn79u3T7bffbkGlredCPwc//OEP9dRTT8ntduudd95Rnz59NGLECH355ZdhrrT1XOgYnPHyyy/r3XffbdYSF+1WKBZPRWQaNWqU/5577glqu+OOO/x5eXkWVRR+J0+e9Hfo0MG/cePGoPYf//jH/gceeMCiqsJLkv/ll18OPPf5fH6n0+l//PHHA201NTV+u93uf/755y2osHU13v+zHTx40C/J//7774e1pnD7rmNwxo4dO/yS/J9//nl4igqz5hyD2tpavyT/li1bwlNUmJ3vGHzxxRf+Hj16+Hfv3u3v3bu3/8knnwx7bZGAEaJ2LCsrS8XFxfrkk08kSR988IHeeecdjRw50uLKwuf06dNqaGhQbGxsUHtcXJzeeecdi6qy1sGDB1VZWans7OxAW2JiooYOHarS0lILK4OVamtrZbPZ2s26jRerrq5Oq1atUmJioq6++mqrywkbn8+ncePGac6cORo0aJDV5VjKmDtVm2ju3LnyeDzq37+/OnTooIaGBi1atEh5eXlWlxY2nTp1UmZmph555BENGDBADodDzz//vEpLS9W3b1+ry7NEZWWlJJ1zl3aHwxHYBrOcOnVK999/v372s5+160U+m7Jx40bl5ubq5MmTSk5O1ubNm9WtWzerywqbJUuWKDo6WjNmzLC6FMsxQtSO/eEPf9C6deu0fv167dq1S2vXrtUTTzyhtWvXWl1aWP3ud7+T3+9Xjx49ZLfbVVBQoJ/97GeKiuLHH6ivr9ddd90lv9+vFStWWF1O2A0bNkzl5eUqKSnRLbfcorvuukvV1dVWlxUWLpdLv/nNb7RmzRrZbDary7Ec/yO0Y3PmzNHcuXOVm5ur9PR0jRs3TrNmzdLixYutLi2s0tLStG3bNh0/flxHjhzRjh07VF9fr8svv9zq0izhdDolSVVVVUHtVVVVgW0ww5kw9Pnnn2vz5s3GjQ5JUnx8vPr27avrrrtOzzzzjKKjo/XMM89YXVZYvP3226qurlavXr0UHR2t6Ohoff755/r3f/939enTx+rywo5A1I6dPHnynFGQDh06yOfzWVSRteLj45WcnKyvvvpKb7zxhkaPHm11SZZITU2V0+lUcXFxoM3j8aisrEyZmZkWVoZwOhOG9u/fry1btqhr165WlxQRfD6fvF6v1WWExbhx4/Thhx+qvLw88EhJSdGcOXP0xhtvWF1e2DGHqB277bbbtGjRIvXq1UuDBg3S+++/r2XLlumee+6xurSweuONN+T3+3XFFVfo008/1Zw5c9S/f3/dfffdVpfWao4fP65PP/008PzgwYMqLy9Xly5d1KtXL82cOVOPPvqo+vXrp9TUVOXn5yslJUVjxoyxrugQutD+Hzt2TIcPHw7cd2ffvn2Svh09ay+jZN91DJKTk/XP//zP2rVrlzZu3KiGhobA/LEuXbooJibGqrJD6ruOQdeuXbVo0SLdfvvtSk5O1t/+9jcVFRWpoqJCd955p4VVh9aFfhcaB+GOHTvK6XTqiiuuCHep1rP4Kje0Io/H47/33nv9vXr18sfGxvovv/xy/wMPPOD3er1WlxZWL774ov/yyy/3x8TE+J1Op3/q1Kn+mpoaq8tqVW+99ZZf0jmP8ePH+/3+by+9z8/P9zscDr/dbvcPHz7cv2/fPmuLDqEL7f/q1aub3P7ggw9aWncofdcxOHO7gaYeb731ltWlh8x3HYNvvvnG/9Of/tSfkpLij4mJ8ScnJ/tvv/12/44dO6wuO6Qu9LvQmMmX3dv8fsNuWwwAANAIc4gAAIDxCEQAAMB4BCIAAGA8AhEAADAegQgAABiPQAQAAIxHIAIAAMYjEAEAAOMRiAAAgPEIRAAAwHgEIgC4gPr6eqtLANDKCEQA2rybbrpJ06dP18yZM9W5c2c5HA799re/1YkTJ3T33XerU6dO6tu3r15//XVJ0ldffaW8vDxddtlliouLU79+/bR69WpJ0qFDh2Sz2fTiiy/qH//xHxUbG6t169ZpzZo1SkpK0oYNG9SvXz/FxsYqJydHR44csXLXAYQIgQhAu7B27Vp169ZNO3bs0PTp0zV58mTdeeedysrK0q5duzRixAiNGzdOJ0+eVH5+vj766CO9/vrr2rt3r1asWKFu3boFvd/cuXN17733au/evcrJyZEknTx5UosWLdJzzz2nv/zlL6qpqVFubq4VuwsgxFjtHkCbd9NNN6mhoUFvv/22JKmhoUGJiYm644479Nxzz0mSKisrlZycrNLSUj322GPq1q2bnn322XPe69ChQ0pNTdXy5ct17733BtrXrFmju+++W++++66GDh0qSfr44481YMAAlZWV6dprrw3DngJoLYwQAWgXrrrqqsC/O3TooK5duyo9PT3Q5nA4JEnV1dWaPHmyXnjhBQ0ePFj33XefSkpKznm/IUOGnNMWHR2ta665JvC8f//+SkpK0t69e0O5KwAsQCAC0C507Ngx6LnNZgtqs9lskiSfz6eRI0fq888/16xZs3T06FENHz5c//Ef/xH0+vj4+NYvGkDEIBABMNJll12m8ePH6/e//72WL1+uVatWXfA1p0+f1nvvvRd4vm/fPtXU1GjAgAGtWSqAMIi2ugAACLcFCxYoIyNDgwYNktfr1caNG5sVajp27Kjp06eroKBA0dHRmjZtmq677jrmDwHtACNEAIwTExOjefPm6aqrrtKNN96oDh066IUXXrjg6y655BLdf//9+vnPf67rr79el156qV588cUwVAygtXGVGQA0w5o1azRz5kzV1NRYXQqAVsAIEQAAMB6BCAAAGI9TZgAAwHiMEAEAAOMRiAAAgPEIRAAAwHgEIgAAYDwCEQAAMB6BCAAAGI9ABAAAjEcgAgAAxvv/gbSFXIQ95DQAAAAASUVORK5CYII="}, "type": "data"}]}, {"code_hash": "12e115f873256e9ac70b276ab54a7fb8", "console": [], "id": "DnEU", "outputs": [{"data": {"text/html": "<span class=\"markdown prose dark:prose-invert\"><h3 id=\"check-for-empty-values\">Check for Empty Values</h3></span>"}, "type": "data"}]}, {"code_hash": "98a16a9e0c880538c9ada89c6454fce4", "console": [], "id": "ulZA", "outputs": [{"data": {"text/html": "<marimo-ui-element object-id='ulZA-0' random-id='0a7df5da-f860-aba0-59ef-a09936cce93a'><marimo-table data-initial-value='[]' data-label='null' data-data='&quot;[{&#92;&quot;&#92;&quot;:&#92;&quot;engine_fuel_type&#92;&quot;,&#92;&quot;value&#92;&quot;:3},{&#92;&quot;&#92;&quot;:&#92;&quot;engine_hp&#92;&quot;,&#92;&quot;value&#92;&quot;:69},{&#92;&quot;&#92;&quot;:&#92;&quot;engine_cylinders&#92;&quot;,&#92;&quot;value&#92;&quot;:30},{&#92;&quot;&#92;&quot;:&#92;&quot;number_of_doors&#92;&quot;,&#92;&quot;value&#92;&quot;:6},{&#92;&quot;&#92;&quot;:&#92;&quot;market_category&#92;&quot;,&#92;&quot;value&#92;&quot;:3742}]&quot;' data-total-rows='5' data-total-columns='1' data-max-columns='50' data-banner-text='&quot;&quot;' data-pagination='true' data-page-size='10' data-field-types='[[&quot;value&quot;,[&quot;integer&quot;,&quot;int64&quot;]]]' data-show-filters='true' data-show-download='true' data-show-column-summaries='false' data-show-data-types='true' data-show-page-size-selector='false' data-show-column-explorer='true' data-show-chart-builder='true' data-row-headers='[[&quot;&quot;,[&quot;string&quot;,&quot;object&quot;]]]' data-has-stable-row-id='false' data-lazy='false' data-preload='false'></marimo-table></marimo-ui-element>"}, "type": "data"}]}, {"code_hash": "6f7863f60f4242290a612a5868b6ab9a", "console": [], "id": "ecfG", "outputs": [{"data": {"text/html": "<span class=\"markdown prose dark:prose-invert\"><h2 id=\"setting-up-the-validation-framework\">Setting Up the Validation Framework</h2>\n<span class=\"paragraph\">We want to define our feature matrix <marimo-tex class=\"arithmatex\">||(X||)</marimo-tex> and a target variable <marimo-tex class=\"arithmatex\">||(y||)</marimo-tex> and then separate it into our train <marimo-tex class=\"arithmatex\">||(X_T||)</marimo-tex> and <marimo-tex class=\"arithmatex\">||(y_T||)</marimo-tex>, validation <marimo-tex class=\"arithmatex\">||(X_V||)</marimo-tex> and <marimo-tex class=\"arithmatex\">||(y_V||)</marimo-tex> and test <marimo-tex class=\"arithmatex\">||(X_{test}||)</marimo-tex> and <marimo-tex class=\"arithmatex\">||(t_{test}||)</marimo-tex> splits.</span></span>"}, "type": "data"}]}, {"code_hash": "2ba50adfb09d4f0f4aee0d9cdfdb5920", "console": [], "id": "Pvdt", "outputs": [{"data": {"application/json": "{\"n\": 11914, \"n_train\": 7150, \"n_val\": 2382, \"n_test\": 2382}"}, "type": "data"}]}, {"code_hash": "b668d11b586a25b29b96ea8c0eeddc9f", "console": [], "id": "ZBYS", "outputs": [{"data": {"text/html": "<span class=\"markdown prose dark:prose-invert\"><span class=\"paragraph\">To avoid spliting the records in the same order they have in the dataset (so that we don't get oddly distributed splits), we'll make a randomized selection.</span>\n<span class=\"paragraph\">First, we create a list with the identifiers of each sample in a random order.</span></span>"}, "type": "data"}]}, {"code_hash": "1162fe1261f3c31c6941a28f39ceaed2", "console": [], "id": "aLJB", "outputs": [{"data": {"text/html": "<pre style='font-size: 12px'>array([2735, 6720, 5878, ..., 6637, 2575, 7336], shape=(11914,))</pre>"}, "type": "data"}]}, {"code_hash": "ca78992023d68b6b6037cfcf27a75caf", "console": [], "id": "nHfw", "outputs": [{"data": {"text/html": "<span class=\"markdown prose dark:prose-invert\"><span class=\"paragraph\">Then we use that as our reference for creating our splits.</span></span>"}, "type": "data"}]}, {"code_hash": "ab6c6ddd159058b2754e78c6becf536a", "console": [], "id": "xXTn", "outputs": [{"data": {"text/plain": ""}, "type": "data"}]}, {"code_hash": "b93ef907b4c5c9b45b2093e3d1b68179", "console": [], "id": "AjVT", "outputs": [{"data": {"text/html": "<span class=\"markdown prose dark:prose-invert\"><span class=\"paragraph\">As our index column has now a random order, we'll reset it in each of the splits.</span></span>"}, "type": "data"}]}, {"code_hash": "c57bdbad94234ab00ab9c9f0644ec92b", "console": [], "id": "pHFh", "outputs": [{"data": {"text/plain": ""}, "type": "data"}]}, {"code_hash": "ee8c7e24901ca0bd0a6874e550648aa5", "console": [], "id": "NCOB", "outputs": [{"data": {"text/html": "<span class=\"markdown prose dark:prose-invert\"><span class=\"paragraph\">Now, we'll define our target variables adjusting the price column using the logarithm function described above.</span></span>"}, "type": "data"}]}, {"code_hash": "2648c49e5f26de3da6ed28291f14e08f", "console": [], "id": "aqbW", "outputs": [{"data": {"text/plain": ""}, "type": "data"}]}, {"code_hash": "dfc74a3eb558a94b7871b9c172f9e7d3", "console": [], "id": "TRpd", "outputs": [{"data": {"text/html": "<span class=\"markdown prose dark:prose-invert\"><span class=\"paragraph\">And, finally, we'll define our feature matrices.</span></span>"}, "type": "data"}]}, {"code_hash": "83ac5f280874e244b0dc418c1bcc3e67", "console": [], "id": "TXez", "outputs": [{"data": {"text/plain": ""}, "type": "data"}]}, {"code_hash": "b8f1cd202349ce220f767cea3167aee2", "console": [], "id": "dNNg", "outputs": [{"data": {"text/html": "<span class=\"markdown prose dark:prose-invert\"><h2 id=\"linear-regression\">Linear Regression</h2>\n<span class=\"paragraph\">We are trying to compute a <marimo-tex class=\"arithmatex\">||(g||)</marimo-tex> estimator function so that given the features of a car <marimo-tex class=\"arithmatex\">||(i||)</marimo-tex>:</span>\n<marimo-tex class=\"arithmatex\">||[\n    x_i = (x_{i1}, x_{i2}, ..., x_{in})\n||]</marimo-tex><span class=\"paragraph\">Our function evaluated with those features approaches the target price:</span>\n<marimo-tex class=\"arithmatex\">||[\n    g_i(x_{i1}, x_{i2}, ..., x_{in}) \\approx y_i\n||]</marimo-tex></span>"}, "type": "data"}]}, {"code_hash": "13d223cf2b57785a92400034102f9d89", "console": [], "id": "yCnT", "outputs": [{"data": {"text/plain": ""}, "type": "data"}]}, {"code_hash": "dae63e87aaf90eee5682f12c3a37b991", "console": [], "id": "wlCL", "outputs": [{"data": {"text/html": "<span class=\"markdown prose dark:prose-invert\"><span class=\"paragraph\">In order to show how linear regression works, we'll manually compute it for a selection of features: <code>engine_hp</code>, <code>city_mpg</code> and <code>popularity</code>.</span></span>"}, "type": "data"}]}, {"code_hash": "75428cac41eff0ae7e7434d8180f1c7f", "console": [], "id": "kqZH", "outputs": [{"data": {"text/html": "<marimo-ui-element object-id='kqZH-0' random-id='fa756a45-0bd9-92fc-7611-8f889b037c3a'><marimo-table data-initial-value='[]' data-label='null' data-data='&quot;[{&#92;&quot;make&#92;&quot;:&#92;&quot;rolls-royce&#92;&quot;,&#92;&quot;model&#92;&quot;:&#92;&quot;phantom_drophead_coupe&#92;&quot;,&#92;&quot;engine_hp&#92;&quot;:453.0,&#92;&quot;city_mpg&#92;&quot;:11,&#92;&quot;popularity&#92;&quot;:86}]&quot;' data-total-rows='1' data-total-columns='5' data-max-columns='50' data-banner-text='&quot;&quot;' data-pagination='true' data-page-size='10' data-field-types='[[&quot;make&quot;,[&quot;string&quot;,&quot;object&quot;]],[&quot;model&quot;,[&quot;string&quot;,&quot;object&quot;]],[&quot;engine_hp&quot;,[&quot;number&quot;,&quot;float64&quot;]],[&quot;city_mpg&quot;,[&quot;integer&quot;,&quot;int64&quot;]],[&quot;popularity&quot;,[&quot;integer&quot;,&quot;int64&quot;]]]' data-show-filters='true' data-show-download='true' data-show-column-summaries='false' data-show-data-types='true' data-show-page-size-selector='false' data-show-column-explorer='true' data-show-chart-builder='true' data-row-headers='[]' data-has-stable-row-id='false' data-lazy='false' data-preload='false'></marimo-table></marimo-ui-element>"}, "type": "data"}]}, {"code_hash": "0450cd0eb43a49cd06091167c2d076ea", "console": [], "id": "wAgl", "outputs": [{"data": {"text/html": "<span class=\"markdown prose dark:prose-invert\"><span class=\"paragraph\">Given the \"randomly\" chosen car, we'll extract the selected features and its corresponding price:</span></span>"}, "type": "data"}]}, {"code_hash": "c8900d04d0f934164873f5c5e85ed06d", "console": [], "id": "rEll", "outputs": [{"data": {"application/json": "{\"x\": \"text/plain:[453.  11.  86.]\", \"y\": \"text/plain:[479775]\"}"}, "type": "data"}]}, {"code_hash": "50db720abf4d6a93df4aa415af366a18", "console": [], "id": "dGlV", "outputs": [{"data": {"text/html": "<span class=\"markdown prose dark:prose-invert\"><span class=\"paragraph\">Now we need to define some weights. Typically, we'd be running a process that finds the optimal values but for the moment we'll manually assign them some numbers:</span></span>"}, "type": "data"}]}, {"code_hash": "ba3e8e752c9e1797763fca8de746cfc6", "console": [], "id": "SdmI", "outputs": [{"data": {"text/html": "<pre style='font-size: 12px'>np.int64(468831)</pre>"}, "type": "data"}]}, {"code_hash": "58b88beed45e81cac0d3e46897886aaa", "console": [], "id": "lgWD", "outputs": [{"data": {"text/html": "<span class=\"markdown prose dark:prose-invert\"><h2 id=\"linear-regression-in-vector-form\">Linear Regression in Vector Form</h2>\n<span class=\"paragraph\">We want now to generalize our previous linear regression formula so that it works with any number of features:</span>\n<marimo-tex class=\"arithmatex\">||[\n    g_i(x_i) = w_o + \\sum_{j=1}^n x_{ij} w_j\n||]</marimo-tex><span class=\"paragraph\">As the right term of the equation corresponds with a dot product, we can rewrite it in a simplified form:</span>\n<marimo-tex class=\"arithmatex\">||[\n    g_i(x_i) = w_0 + \\bold{w}^T \\bold{x}_i\n||]</marimo-tex></span>"}, "type": "data"}]}, {"code_hash": "81fed55bcffe0f1e0310f6d149148e2e", "console": [], "id": "yOPj", "outputs": [{"data": {"text/plain": ""}, "type": "data"}]}, {"code_hash": "9911399e1f260ca661c4857dd3dc2278", "console": [], "id": "fwwy", "outputs": [{"data": {"text/html": "<pre style='font-size: 12px'>np.int64(468831)</pre>"}, "type": "data"}]}, {"code_hash": "8f5dea037bfce46f5424d07cb4260bcd", "console": [], "id": "LJZf", "outputs": [{"data": {"text/html": "<span class=\"markdown prose dark:prose-invert\"><span class=\"paragraph\">If we want, we can simplify our expression even further by defining an extra feature that always equals <marimo-tex class=\"arithmatex\">||(1||)</marimo-tex>. By doing so, we'd get <marimo-tex class=\"arithmatex\">||(\\bold{w}||)</marimo-tex> and <marimo-tex class=\"arithmatex\">||(\\bold{x}||)</marimo-tex> vectors with <marimo-tex class=\"arithmatex\">||(n+1||)</marimo-tex> elements:</span>\n<marimo-tex class=\"arithmatex\">||[\n    w = [w_0, w_1, ..., w_n]\n||]</marimo-tex><marimo-tex class=\"arithmatex\">||[\n    x_i = [1, x_{i1}, x_{i2}, ..., x_{in}]\n||]</marimo-tex><span class=\"paragraph\">Therefore, our estimator could be written as:</span>\n<marimo-tex class=\"arithmatex\">||[\n    g_i(x_i) = \\bold{w}^T \\bold{x}_i\n||]</marimo-tex></span>"}, "type": "data"}]}, {"code_hash": "e8309b7e27fc0c90bf983bf69b274468", "console": [], "id": "urSm", "outputs": [{"data": {"text/plain": ""}, "type": "data"}]}, {"code_hash": "c06ecaa40bdd9992811734d44513cd89", "console": [], "id": "jxvo", "outputs": [{"data": {"text/html": "<pre style='font-size: 12px'>np.int64(468831)</pre>"}, "type": "data"}]}, {"code_hash": "8b7032d2d2a6e17c2cf786d18acac8ca", "console": [], "id": "mWxS", "outputs": [{"data": {"text/html": "<span class=\"markdown prose dark:prose-invert\"><span class=\"paragraph\">We can write our <marimo-tex class=\"arithmatex\">||(g||)</marimo-tex> function for all samples as a matrix multiplication.</span>\n<marimo-tex class=\"arithmatex\">||[\n\\bold{y_p} = \n\\begin{bmatrix}\n1 &amp; x_{11} &amp; x_{12} &amp; \\cdots &amp; x_{1n} \\\\\n1 &amp; x_{21} &amp; x_{22} &amp; \\cdots &amp; x_{2n} \\\\\n\\vdots &amp; \\vdots &amp; \\vdots &amp; \\ddots &amp; \\vdots \\\\\n1 &amp; x_{m1} &amp; x_{m2} &amp; \\cdots &amp; x_{mn}\n\\end{bmatrix}\n\\begin{bmatrix}\nw_0 \\\\\nw_1 \\\\\nw_2 \\\\\n\\vdots \\\\\nw_n\n\\end{bmatrix}\n=\n\\begin{bmatrix}\n\\bold{x_1}^T \u00b7 \\bold{w} \\\\\n\\bold{x_2}^T \u00b7 \\bold{w} \\\\\n\\vdots \\\\\n\\bold{x_m}^T \u00b7 \\bold{w} \\\\\n\\end{bmatrix}\n||]</marimo-tex></span>"}, "type": "data"}]}, {"code_hash": "1fe65f3e38345a23bdc6bacc8d5c1790", "console": [], "id": "CcZR", "outputs": [{"data": {"text/html": "<pre style='font-size: 12px'>array([[1.000e+00, 4.530e+02, 1.100e+01, 8.600e+01],\n       [1.000e+00, 1.820e+02, 2.000e+01, 1.385e+03],\n       [1.000e+00, 1.620e+02, 2.000e+01, 4.360e+02],\n       [1.000e+00, 5.530e+02, 1.600e+01, 2.774e+03],\n       [1.000e+00, 2.720e+02, 1.800e+01, 3.105e+03]])</pre>"}, "type": "data"}]}, {"code_hash": "a07074f5d180c282b18b9af0c1e143d8", "console": [], "id": "YWSi", "outputs": [{"data": {"text/html": "<pre style='font-size: 12px'>array([479775,  33669,  27999, 198972,  53200])</pre>"}, "type": "data"}]}, {"code_hash": "645076ba5755c55b8f0c550cda88a859", "console": [], "id": "zlud", "outputs": [{"data": {"application/json": "[\"text/plain+float:7.5\", \"text/plain+float:0.01\", \"text/plain+float:0.07\", \"text/plain+float:0.003\"]"}, "type": "data"}]}, {"code_hash": "b3ee810c904262cfed6e544c3b589f60", "console": [], "id": "tZnO", "outputs": [{"data": {"text/html": "<pre style='font-size: 12px'>array([    468831,    2884896,     137035, 5747322894, 1074369697])</pre>"}, "type": "data"}]}, {"code_hash": "86af77028e786426b99141ca20ae84ab", "console": [], "id": "xvXZ", "outputs": [{"data": {"text/html": "<span class=\"markdown prose dark:prose-invert\"><h2 id=\"training-a-linear-regression-model\">Training a Linear Regression Model</h2>\n<span class=\"paragraph\">We already saw that our <marimo-tex class=\"arithmatex\">||(g||)</marimo-tex> estimator looks like this:</span>\n<marimo-tex class=\"arithmatex\">||[\n    \\bold{X} \\bold{w} \\approx \\bold{y}\n||]</marimo-tex><span class=\"paragraph\">So now we have to solve <marimo-tex class=\"arithmatex\">||(\\bold{w}||)</marimo-tex> so that we can find the weights.</span>\n<marimo-tex class=\"arithmatex\">||[\n    \\bold{X}^{-1} \\bold{X} \\bold{w} \\approx \\bold{X}^{-1} \\bold{y}\n||]</marimo-tex><span class=\"paragraph\">What gives us:</span>\n<marimo-tex class=\"arithmatex\">||[\n    \\bold{w} \\approx \\bold{X}^{-1} \\bold{y}\n||]</marimo-tex><span class=\"paragraph\">But there is an issue: we are working with a rectangular matrix, not with a squared one. So we won't be able to find its inverse.</span></span>"}, "type": "data"}]}, {"code_hash": "28635777c953143e667f88de51502b37", "console": [], "id": "CLip", "outputs": [{"data": {"text/html": "<span class=\"markdown prose dark:prose-invert\"><h3 id=\"gram-matrix\">Gram Matrix</h3>\n<span class=\"paragraph\">The first thing we can do to try to solve this is to take into account that <marimo-tex class=\"arithmatex\">||(X^T X||)</marimo-tex> is actually an squared matrix, it may have an inverse.</span>\n<span class=\"paragraph\">Therefore, we could start with:</span>\n<marimo-tex class=\"arithmatex\">||[\n    \\bold{X}^{T} \\bold{X} \\bold{w} \\approx \\bold{X}^{T} \\bold{y}\n||]</marimo-tex><span class=\"paragraph\">... and try to solve it with:</span>\n<marimo-tex class=\"arithmatex\">||[\n    (\\bold{X}^{T} \\bold{X})^{-1} \\bold{X}^{T} \\bold{X} \\bold{w} \\approx (\\bold{X}^{T} \\bold{X})^{-1} \\bold{X}^{T} \\bold{y}\n||]</marimo-tex><span class=\"paragraph\">... which simplifies to:</span>\n<marimo-tex class=\"arithmatex\">||[\n    \\bold{w} \\approx (\\bold{X}^{T} \\bold{X})^{-1} \\bold{X}^{T} \\bold{y}\n||]</marimo-tex></span>"}, "type": "data"}]}, {"code_hash": "6f7a2578f98ce8ca53626a95eb150ada", "console": [], "id": "YECM", "outputs": [{"data": {"text/html": "<pre style='font-size: 12px'>array([ 1.39547397e+01,  3.05557355e-03, -2.05578865e-01, -5.48993909e-05])</pre>"}, "type": "data"}]}, {"code_hash": "4929953b27f161e47e986a06c3ddc70f", "console": [], "id": "cEAS", "outputs": [{"data": {"text/html": "<pre style='font-size: 12px'>array([475833,  30430,  30157, 199369,  54992])</pre>"}, "type": "data"}]}], "metadata": {"marimo_version": "0.16.0"}, "version": "1"},
            "runtimeConfig": null,
        };
    </script>
  
<marimo-code hidden="">
    import%20marimo%0A%0A__generated_with%20%3D%20%220.16.0%22%0Aapp%20%3D%20marimo.App(width%3D%22medium%22)%0A%0A%0A%40app.cell%0Adef%20_()%3A%0A%20%20%20%20import%20marimo%20as%20mo%0A%20%20%20%20import%20pandas%20as%20pd%0A%20%20%20%20import%20numpy%20as%20np%0A%20%20%20%20import%20matplotlib.pyplot%20as%20plt%0A%20%20%20%20import%20seaborn%20as%20sns%0A%20%20%20%20return%20mo%2C%20np%2C%20pd%2C%20sns%0A%0A%0A%40app.cell(hide_code%3DTrue)%0Adef%20_(mo)%3A%0A%20%20%20%20mo.md(%0A%20%20%20%20%20%20%20%20r%22%22%22%0A%20%20%20%20%23%20Machine%20Learning%20Zoomcamp%0A%0A%20%20%20%20%23%23%20Module%202%3A%20**Regression**%0A%20%20%20%20%22%22%22%0A%20%20%20%20)%0A%20%20%20%20return%0A%0A%0A%40app.cell(hide_code%3DTrue)%0Adef%20_(pd)%3A%0A%20%20%20%20repository_root%20%3D%20%22https%3A%2F%2Fgithub.com%2FDataTalksClub%2Fmachine-learning-zoomcamp%2Fblob%2Fmaster%2F%22%0A%0A%20%20%20%20chapters%20%3D%20pd.DataFrame(%5B%0A%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%22title%22%3A%20%22Car%20price%20prediction%20project%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%22youtube_id%22%3A%20%22vM3SqPNlStE%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%22contents%22%3A%20repository_root%2B%2202-regression%2F01-car-price-intro.md%22%0A%20%20%20%20%20%20%20%20%7D%2C%0A%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%22title%22%3A%20%22Data%20preparation%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%22youtube_id%22%3A%20%22Kd74oR4QWGM%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%22contents%22%3A%20repository_root%2B%2202-regression%2F02-data-preparation.md%22%0A%20%20%20%20%20%20%20%20%7D%2C%0A%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%22title%22%3A%20%22Exploratory%20data%20analysis%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%22youtube_id%22%3A%20%22k6k8sQ0GhPM%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%22contents%22%3A%20repository_root%2B%2202-regression%2F03-eda.md%22%0A%20%20%20%20%20%20%20%20%7D%2C%0A%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%22title%22%3A%20%22Setting%20up%20the%20validation%20framework%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%22youtube_id%22%3A%20%22ck0IfiPaQi0%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%22contents%22%3A%20repository_root%2B%2202-regression%2F04-validation-framework.md%22%0A%20%20%20%20%20%20%20%20%7D%2C%0A%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%22title%22%3A%20%22Linear%20regression%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%22youtube_id%22%3A%20%22Dn1eTQLsOdA%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%22contents%22%3A%20repository_root%2B%2202-regression%2F05-linear-regression-simple.md%22%0A%20%20%20%20%20%20%20%20%7D%2C%0A%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%22title%22%3A%20%22Linear%20regression%3A%20vector%20form%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%22youtube_id%22%3A%20%22YkyevnYyAww%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%22contents%22%3A%20repository_root%2B%2202-regression%2F06-linear-regression-vector.md%22%0A%20%20%20%20%20%20%20%20%7D%2C%0A%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%22title%22%3A%20%22Training%20linear%20regression%3A%20Normal%20equation%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%22youtube_id%22%3A%20%22hx6nak-Y11g%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%22contents%22%3A%20repository_root%2B%2202-regression%2F07-linear-regression-training.md%22%0A%20%20%20%20%20%20%20%20%7D%2C%0A%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%22title%22%3A%20%22Baseline%20model%20for%20car%20price%20prediction%20project%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%22youtube_id%22%3A%20%22SvPpMMYtYbU%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%22contents%22%3A%20repository_root%2B%2202-regression%2F08-baseline-model.md%22%0A%20%20%20%20%20%20%20%20%7D%2C%0A%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%22title%22%3A%20%22Root%20mean%20squared%20error%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%22youtube_id%22%3A%20%220LWoFtbzNUM%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%22contents%22%3A%20repository_root%2B%2202-regression%2F09-rmse.md%22%0A%20%20%20%20%20%20%20%20%7D%2C%0A%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%22title%22%3A%20%22Using%20RMSE%20on%20validation%20data%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%22youtube_id%22%3A%20%22rawGPXg2ofE%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%22contents%22%3A%20repository_root%2B%2202-regression%2F10-car-price-validation.md%22%0A%20%20%20%20%20%20%20%20%7D%2C%0A%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%22title%22%3A%20%22Feature%20engineering%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%22youtube_id%22%3A%20%22-aEShw4ftB0%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%22contents%22%3A%20repository_root%2B%2202-regression%2F11-feature-engineering.md%22%0A%20%20%20%20%20%20%20%20%7D%2C%0A%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%22title%22%3A%20%22Categorical%20variables%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%22youtube_id%22%3A%20%22sGLAToAAMa4%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%22contents%22%3A%20repository_root%2B%2202-regression%2F12-categorical-variables.md%22%0A%20%20%20%20%20%20%20%20%7D%2C%0A%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%22title%22%3A%20%22Regularization%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%22youtube_id%22%3A%20%2291ve3EJlHBc%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%22contents%22%3A%20repository_root%2B%2202-regression%2F13-regularization.md%22%0A%20%20%20%20%20%20%20%20%7D%2C%0A%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%22title%22%3A%20%22Tuning%20the%20model%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%22youtube_id%22%3A%20%22lW-YVxPgzQw%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%22contents%22%3A%20repository_root%2B%2202-regression%2F14-tuning-model.md%22%0A%20%20%20%20%20%20%20%20%7D%2C%0A%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%22title%22%3A%20%22Using%20the%20model%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%22youtube_id%22%3A%20%22KT--uIJozes%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%22contents%22%3A%20repository_root%2B%2202-regression%2F15-using-model.md%22%0A%20%20%20%20%20%20%20%20%7D%2C%0A%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%22title%22%3A%20%22Car%20price%20prediction%20project%20summary%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%22youtube_id%22%3A%20%22_qI01YXbyro%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%22contents%22%3A%20repository_root%2B%2202-regression%2F16-summary.md%22%0A%20%20%20%20%20%20%20%20%7D%2C%0A%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%22title%22%3A%20%22Explore%20more%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%22youtube_id%22%3A%20%22%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%22contents%22%3A%20repository_root%2B%2202-regression%2F17-explore-more.md%22%0A%20%20%20%20%20%20%20%20%7D%2C%0A%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%22title%22%3A%20%22Homework%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%22youtube_id%22%3A%20%22%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%22contents%22%3A%20repository_root%2B%2202-regression%2Fhomework.md%22%0A%20%20%20%20%20%20%20%20%7D%2C%0A%20%20%20%20%5D)%0A%0A%20%20%20%20chapters.insert(loc%3D0%2C%20column%3D%22snapshot%22%2C%20value%3D%22https%3A%2F%2Fimg.youtube.com%2Fvi%2F%22%2Bchapters.youtube_id.astype(str)%2B%22%2Fhqdefault.jpg%22)%0A%20%20%20%20chapters.insert(loc%3D2%2C%20column%3D%22youtube%22%2C%20value%3D%22https%3A%2F%2Fyoutube.com%2Fwatch%3Fv%3D%22%2Bchapters.youtube_id.astype(str))%0A%0A%20%20%20%20videos%20%3D%20chapters%5Bchapters%5B%22youtube_id%22%5D.notnull()%5D%0A%20%20%20%20videos%5B%5B%22snapshot%22%2C%20%22title%22%2C%20%22youtube%22%5D%5D%0A%20%20%20%20return%20(chapters%2C)%0A%0A%0A%40app.cell(hide_code%3DTrue)%0Adef%20_(chapters)%3A%0A%20%20%20%20contents%20%3D%20chapters%5Bchapters%5B%22contents%22%5D.notnull()%5D%0A%20%20%20%20contents%5B%5B%22title%22%2C%20%22contents%22%5D%5D%0A%20%20%20%20return%0A%0A%0A%40app.cell(hide_code%3DTrue)%0Adef%20_(mo)%3A%0A%20%20%20%20mo.md(%0A%20%20%20%20%20%20%20%20r%22%22%22%0A%20%20%20%20%23%23%20Car%20Price%20Prediction%20Project%0A%0A%20%20%20%20In%20this%20chapter%20we'll%20be%20working%20with%20the%20%5BCar%20Features%20and%20MSRP%5D(https%3A%2F%2Fwww.kaggle.com%2Fdatasets%2FCooperUnion%2Fcardataset)%20Kaggle%20dataset.%0A%0A%20%20%20%201.%20Prepare%20the%20data%20and%20do%20some%20Exploratory%20Data%20Analysis%20(EDA)%0A%20%20%20%202.%20Use%20linear%20regression%20for%20predicting%20price%0A%20%20%20%203.%20Understand%20the%20internals%20of%20linear%20regression%0A%20%20%20%204.%20Evaluate%20the%20model%20using%20Root%20Mean%20Square%20Error%20(RMSE)%0A%20%20%20%205.%20Do%20some%20feature%20engineering%0A%20%20%20%206.%20Regualization%0A%20%20%20%207.%20Use%20the%20model%0A%20%20%20%20%22%22%22%0A%20%20%20%20)%0A%20%20%20%20return%0A%0A%0A%40app.cell(hide_code%3DTrue)%0Adef%20_(mo)%3A%0A%20%20%20%20mo.md(%0A%20%20%20%20%20%20%20%20r%22%22%22%0A%20%20%20%20%23%23%20Data%20Preparation%0A%0A%20%20%20%20To%20facilitate%20the%20analysis%2C%20the%20CSV%20file%20has%20been%20already%20downloaded%20in%20**data%2Fcar-prices.csv**.%0A%20%20%20%20%22%22%22%0A%20%20%20%20)%0A%20%20%20%20return%0A%0A%0A%40app.cell(hide_code%3DTrue)%0Adef%20_(pd)%3A%0A%20%20%20%20car_prices%20%3D%20pd.read_csv('.%2Fmodule-2%2Fdata%2Fcar-prices.csv')%0A%20%20%20%20car_prices.head()%0A%20%20%20%20return%20(car_prices%2C)%0A%0A%0A%40app.cell(hide_code%3DTrue)%0Adef%20_(mo)%3A%0A%20%20%20%20mo.md(%0A%20%20%20%20%20%20%20%20r%22%22%22%0A%20%20%20%20%23%23%23%20Standardize%20Column%20Names%0A%0A%20%20%20%20Some%20of%20the%20columns%20are%20named%20using%20spaces%20as%20separator%20and%20other%20columns%20were%20named%20using%20underscores%20as%20a%20separator.%20We'll%20now%20standardize%20their%20names.%0A%20%20%20%20%22%22%22%0A%20%20%20%20)%0A%20%20%20%20return%0A%0A%0A%40app.cell(hide_code%3DTrue)%0Adef%20_(car_prices)%3A%0A%20%20%20%20car_prices.columns%20%3D%20car_prices.columns.str.lower().str.replace('%20'%2C%20'_')%0A%20%20%20%20car_prices.head()%0A%20%20%20%20return%0A%0A%0A%40app.cell(hide_code%3DTrue)%0Adef%20_(mo)%3A%0A%20%20%20%20mo.md(%0A%20%20%20%20%20%20%20%20r%22%22%22%0A%20%20%20%20%23%23%23%20Standardize%20Values%0A%0A%20%20%20%20First%20we'll%20get%20the%20list%20of%20all%20string%20columns.%0A%20%20%20%20%22%22%22%0A%20%20%20%20)%0A%20%20%20%20return%0A%0A%0A%40app.cell(hide_code%3DTrue)%0Adef%20_(car_prices)%3A%0A%20%20%20%20string_columns%20%3D%20list(car_prices.dtypes%5Bcar_prices.dtypes%20%3D%3D%20'object'%5D.index)%0A%20%20%20%20string_columns%0A%20%20%20%20return%20(string_columns%2C)%0A%0A%0A%40app.cell(hide_code%3DTrue)%0Adef%20_(car_prices%2C%20string_columns)%3A%0A%20%20%20%20for%20string_column%20in%20string_columns%3A%0A%20%20%20%20%20%20%20%20car_prices%5Bstring_column%5D%20%3D%20car_prices%5Bstring_column%5D.str.lower().str.replace('%20'%2C%20'_')%0A%20%20%20%20car_prices.head()%0A%20%20%20%20return%0A%0A%0A%40app.cell(hide_code%3DTrue)%0Adef%20_(mo)%3A%0A%20%20%20%20mo.md(%0A%20%20%20%20%20%20%20%20r%22%22%22%0A%20%20%20%20%23%23%20Exploratory%20Data%20Analysis%0A%0A%20%20%20%20%23%23%23%20Check%20Unique%20Values%20per%20Column%0A%20%20%20%20%22%22%22%0A%20%20%20%20)%0A%20%20%20%20return%0A%0A%0A%40app.cell(hide_code%3DTrue)%0Adef%20_(car_prices)%3A%0A%20%20%20%20unique_values%20%3D%20%7B%7D%0A%0A%20%20%20%20for%20described_column%20in%20car_prices.columns%3A%0A%20%20%20%20%20%20%20%20unique_values%5Bdescribed_column%5D%20%3D%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%22sample%22%3A%20car_prices%5Bdescribed_column%5D.unique()%5B%3A5%5D%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%22count%22%3A%20car_prices%5Bdescribed_column%5D.nunique()%0A%20%20%20%20%20%20%20%20%7D%0A%0A%20%20%20%20unique_values%0A%20%20%20%20return%0A%0A%0A%40app.cell(hide_code%3DTrue)%0Adef%20_(mo)%3A%0A%20%20%20%20mo.md(%0A%20%20%20%20%20%20%20%20r%22%22%22%0A%20%20%20%20%23%23%23%20Check%20the%20Price%20Column%0A%0A%20%20%20%20A%20tiny%20number%20of%20cars%20with%20a%20very%20high%20price%20is%20ruining%20our%20plot.%0A%20%20%20%20%22%22%22%0A%20%20%20%20)%0A%20%20%20%20return%0A%0A%0A%40app.cell(hide_code%3DTrue)%0Adef%20_(car_prices%2C%20sns)%3A%0A%20%20%20%20sns.histplot(car_prices.msrp%2C%20bins%3D100)%0A%20%20%20%20return%0A%0A%0A%40app.cell(hide_code%3DTrue)%0Adef%20_(mo)%3A%0A%20%20%20%20mo.md(r%22%22%22We%20could%20filter%20them%20to%20get%20a%20better%20view%20but%20that%20implies%20making%20a%20choice%20on%20where%20to%20cut.%20Which%20could%20confuse%20our%20model.%22%22%22)%0A%20%20%20%20return%0A%0A%0A%40app.cell(hide_code%3DTrue)%0Adef%20_(car_prices%2C%20sns)%3A%0A%20%20%20%20sns.histplot(car_prices.msrp%5Bcar_prices.msrp%20%3C%20100000%5D%2C%20bins%3D100)%0A%20%20%20%20return%0A%0A%0A%40app.cell(hide_code%3DTrue)%0Adef%20_(mo)%3A%0A%20%20%20%20mo.md(r%22%22%22Instead%20of%20making%20a%20manual%20cut%2C%20we%20can%20take%20the%20logarithm%20of%20the%20price.%20By%20doing%20so%2C%20outlier%20(few%20cases%20with%20extreme%20values)%20are%20handled%20in%20a%20more%20elegant%20way.%22%22%22)%0A%20%20%20%20return%0A%0A%0A%40app.cell(hide_code%3DTrue)%0Adef%20_(car_prices%2C%20np%2C%20sns)%3A%0A%20%20%20%20price_logs%20%3D%20np.log1p(car_prices.msrp)%0A%0A%20%20%20%20sns.histplot(price_logs%2C%20bins%3D100)%0A%20%20%20%20return%0A%0A%0A%40app.cell(hide_code%3DTrue)%0Adef%20_(mo)%3A%0A%20%20%20%20mo.md(r%22%22%22%23%23%23%20Check%20for%20Empty%20Values%22%22%22)%0A%20%20%20%20return%0A%0A%0A%40app.cell(hide_code%3DTrue)%0Adef%20_(car_prices)%3A%0A%20%20%20%20car_prices.isna().sum()%5Bcar_prices.isna().any()%5D%0A%20%20%20%20return%0A%0A%0A%40app.cell(hide_code%3DTrue)%0Adef%20_(mo)%3A%0A%20%20%20%20mo.md(%0A%20%20%20%20%20%20%20%20r%22%22%22%0A%20%20%20%20%23%23%20Setting%20Up%20the%20Validation%20Framework%0A%0A%20%20%20%20We%20want%20to%20define%20our%20feature%20matrix%20%24X%24%20and%20a%20target%20variable%20%24y%24%20and%20then%20separate%20it%20into%20our%20train%20%24X_T%24%20and%20%24y_T%24%2C%20validation%20%24X_V%24%20and%20%24y_V%24%20and%20test%20%24X_%7Btest%7D%24%20and%20%24t_%7Btest%7D%24%20splits.%0A%20%20%20%20%22%22%22%0A%20%20%20%20)%0A%20%20%20%20return%0A%0A%0A%40app.cell(hide_code%3DTrue)%0Adef%20_(car_prices)%3A%0A%20%20%20%20n%20%3D%20len(car_prices)%0A%20%20%20%20n_val%20%3D%20n_test%20%3D%20int(len(car_prices)%20*%200.2)%0A%20%20%20%20n_train%20%3D%20len(car_prices)%20-%20n_val%20-%20n_test%0A%0A%20%20%20%20%7B%22n%22%3A%20n%2C%20%22n_train%22%3A%20n_train%2C%20%22n_val%22%3A%20n_val%2C%20%22n_test%22%3A%20n_test%7D%0A%20%20%20%20return%20n%2C%20n_train%2C%20n_val%0A%0A%0A%40app.cell(hide_code%3DTrue)%0Adef%20_(mo)%3A%0A%20%20%20%20mo.md(%0A%20%20%20%20%20%20%20%20r%22%22%22%0A%20%20%20%20To%20avoid%20spliting%20the%20records%20in%20the%20same%20order%20they%20have%20in%20the%20dataset%20(so%20that%20we%20don't%20get%20oddly%20distributed%20splits)%2C%20we'll%20make%20a%20randomized%20selection.%0A%0A%20%20%20%20First%2C%20we%20create%20a%20list%20with%20the%20identifiers%20of%20each%20sample%20in%20a%20random%20order.%0A%20%20%20%20%22%22%22%0A%20%20%20%20)%0A%20%20%20%20return%0A%0A%0A%40app.cell(hide_code%3DTrue)%0Adef%20_(n%2C%20np)%3A%0A%20%20%20%20np.random.seed(2)%0A%20%20%20%20shuffled_indexes%20%3D%20np.arange(n)%0A%20%20%20%20np.random.shuffle(shuffled_indexes)%0A%0A%20%20%20%20shuffled_indexes%0A%20%20%20%20return%20(shuffled_indexes%2C)%0A%0A%0A%40app.cell(hide_code%3DTrue)%0Adef%20_(mo)%3A%0A%20%20%20%20mo.md(r%22%22%22Then%20we%20use%20that%20as%20our%20reference%20for%20creating%20our%20splits.%22%22%22)%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(car_prices%2C%20n_train%2C%20n_val%2C%20shuffled_indexes)%3A%0A%20%20%20%20car_prices_train%20%3D%20car_prices.iloc%5Bshuffled_indexes%5B%3An_train%5D%5D%0A%20%20%20%20car_prices_val%20%3D%20car_prices.iloc%5Bshuffled_indexes%5Bn_train%3An_train%2Bn_val%5D%5D%0A%20%20%20%20car_prices_test%20%3D%20car_prices.iloc%5Bshuffled_indexes%5Bn_train%2Bn_val%3A%5D%5D%0A%20%20%20%20return%20car_prices_test%2C%20car_prices_train%2C%20car_prices_val%0A%0A%0A%40app.cell(hide_code%3DTrue)%0Adef%20_(mo)%3A%0A%20%20%20%20mo.md(r%22%22%22As%20our%20index%20column%20has%20now%20a%20random%20order%2C%20we'll%20reset%20it%20in%20each%20of%20the%20splits.%22%22%22)%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(car_prices_test%2C%20car_prices_train%2C%20car_prices_val)%3A%0A%20%20%20%20car_prices_train.reset_index(drop%3DTrue%2C%20inplace%3DTrue)%0A%20%20%20%20car_prices_val.reset_index(drop%3DTrue%2C%20inplace%3DTrue)%0A%20%20%20%20car_prices_test.reset_index(drop%3DTrue%2C%20inplace%3DTrue)%0A%20%20%20%20return%0A%0A%0A%40app.cell(hide_code%3DTrue)%0Adef%20_(mo)%3A%0A%20%20%20%20mo.md(r%22%22%22Now%2C%20we'll%20define%20our%20target%20variables%20adjusting%20the%20price%20column%20using%20the%20logarithm%20function%20described%20above.%22%22%22)%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(car_prices_test%2C%20car_prices_train%2C%20car_prices_val%2C%20np)%3A%0A%20%20%20%20y_train%20%3D%20np.log1p(car_prices_train.msrp.values)%0A%20%20%20%20y_val%20%3D%20np.log1p(car_prices_val.msrp.values)%0A%20%20%20%20y_test%20%3D%20np.log1p(car_prices_test.msrp.values)%0A%20%20%20%20return%20(y_train%2C)%0A%0A%0A%40app.cell(hide_code%3DTrue)%0Adef%20_(mo)%3A%0A%20%20%20%20mo.md(r%22%22%22And%2C%20finally%2C%20we'll%20define%20our%20feature%20matrices.%22%22%22)%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(car_prices_test%2C%20car_prices_train%2C%20car_prices_val)%3A%0A%20%20%20%20X_train%20%3D%20car_prices_train%0A%20%20%20%20X_val%20%3D%20car_prices_val%0A%20%20%20%20X_test%20%3D%20car_prices_test%0A%0A%20%20%20%20del%20X_train%5B%22msrp%22%5D%0A%20%20%20%20del%20X_val%5B%22msrp%22%5D%0A%20%20%20%20del%20X_test%5B%22msrp%22%5D%0A%20%20%20%20return%20(X_train%2C)%0A%0A%0A%40app.cell(hide_code%3DTrue)%0Adef%20_(mo)%3A%0A%20%20%20%20mo.md(%0A%20%20%20%20%20%20%20%20r%22%22%22%0A%20%20%20%20%23%23%20Linear%20Regression%0A%0A%20%20%20%20We%20are%20trying%20to%20compute%20a%20%24g%24%20estimator%20function%20so%20that%20given%20the%20features%20of%20a%20car%20%24i%24%3A%0A%0A%20%20%20%20%5C%5B%0A%20%20%20%20%20%20%20%20x_i%20%3D%20(x_%7Bi1%7D%2C%20x_%7Bi2%7D%2C%20...%2C%20x_%7Bin%7D)%0A%20%20%20%20%5C%5D%0A%0A%20%20%20%20Our%20function%20evaluated%20with%20those%20features%20approaches%20the%20target%20price%3A%0A%0A%20%20%20%20%5C%5B%0A%20%20%20%20%20%20%20%20g_i(x_%7Bi1%7D%2C%20x_%7Bi2%7D%2C%20...%2C%20x_%7Bin%7D)%20%5Capprox%20y_i%0A%20%20%20%20%5C%5D%0A%20%20%20%20%22%22%22%0A%20%20%20%20)%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(np)%3A%0A%20%20%20%20def%20raw_linear_regression(x%2C%20w)%3A%0A%20%20%20%20%20%20%20%20assert%20len(x)%20%2B%201%20%3D%3D%20len(w)%2C%20%22The%20size%20of%20the%20features%20vector%20does%20not%20match%20the%20size%20of%20the%20weights%22%0A%0A%20%20%20%20%20%20%20%20y_log%20%3D%20w%5B0%5D%20%2B%20np.sum(%5Bx%5Bi%5D%20*%20w%5Bi%20%2B%201%5D%20for%20i%20in%20range(len(x))%5D)%0A%0A%20%20%20%20%20%20%20%20return%20np.expm1(y_log).astype(int)%0A%20%20%20%20return%20(raw_linear_regression%2C)%0A%0A%0A%40app.cell(hide_code%3DTrue)%0Adef%20_(mo)%3A%0A%20%20%20%20mo.md(r%22%22%22In%20order%20to%20show%20how%20linear%20regression%20works%2C%20we'll%20manually%20compute%20it%20for%20a%20selection%20of%20features%3A%20%60engine_hp%60%2C%20%60city_mpg%60%20and%20%60popularity%60.%22%22%22)%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(X_train)%3A%0A%20%20%20%20X_train.iloc%5B10%3A11%5D%5B%5B%22make%22%2C%20%22model%22%2C%20%22engine_hp%22%2C%20%22city_mpg%22%2C%20%22popularity%22%5D%5D%0A%20%20%20%20return%0A%0A%0A%40app.cell(hide_code%3DTrue)%0Adef%20_(mo)%3A%0A%20%20%20%20mo.md(r%22%22%22Given%20the%20%22randomly%22%20chosen%20car%2C%20we'll%20extract%20the%20selected%20features%20and%20its%20corresponding%20price%3A%22%22%22)%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(X_train%2C%20np%2C%20y_train)%3A%0A%20%20%20%20x%20%3D%20X_train.iloc%5B10%3A11%5D%5B%5B%22engine_hp%22%2C%20%22city_mpg%22%2C%20%22popularity%22%5D%5D.values%5B0%5D%0A%0A%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%22x%22%3A%20x%2C%0A%20%20%20%20%20%20%20%20%22y%22%3A%20np.expm1(y_train%5B10%3A11%5D).astype(int)%0A%20%20%20%20%7D%0A%20%20%20%20return%20(x%2C)%0A%0A%0A%40app.cell(hide_code%3DTrue)%0Adef%20_(mo)%3A%0A%20%20%20%20mo.md(r%22%22%22Now%20we%20need%20to%20define%20some%20weights.%20Typically%2C%20we'd%20be%20running%20a%20process%20that%20finds%20the%20optimal%20values%20but%20for%20the%20moment%20we'll%20manually%20assign%20them%20some%20numbers%3A%22%22%22)%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(raw_linear_regression%2C%20x)%3A%0A%20%20%20%20raw_linear_regression(x%2C%20%5B7.5%2C%200.01%2C%200.07%2C%200.003%5D)%0A%20%20%20%20return%0A%0A%0A%40app.cell(hide_code%3DTrue)%0Adef%20_(mo)%3A%0A%20%20%20%20mo.md(%0A%20%20%20%20%20%20%20%20r%22%22%22%0A%20%20%20%20%23%23%20Linear%20Regression%20in%20Vector%20Form%0A%0A%20%20%20%20We%20want%20now%20to%20generalize%20our%20previous%20linear%20regression%20formula%20so%20that%20it%20works%20with%20any%20number%20of%20features%3A%0A%0A%20%20%20%20%5C%5B%0A%20%20%20%20%20%20%20%20g_i(x_i)%20%3D%20w_o%20%2B%20%5Csum_%7Bj%3D1%7D%5En%20x_%7Bij%7D%20w_j%0A%20%20%20%20%5C%5D%0A%0A%20%20%20%20As%20the%20right%20term%20of%20the%20equation%20corresponds%20with%20a%20dot%20product%2C%20we%20can%20rewrite%20it%20in%20a%20simplified%20form%3A%0A%0A%20%20%20%20%5C%5B%0A%20%20%20%20%20%20%20%20g_i(x_i)%20%3D%20w_0%20%2B%20%5Cbold%7Bw%7D%5ET%20%5Cbold%7Bx%7D_i%0A%20%20%20%20%5C%5D%0A%20%20%20%20%22%22%22%0A%20%20%20%20)%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(np)%3A%0A%20%20%20%20def%20vectorial_linear_regression(x%2C%20w)%3A%0A%20%20%20%20%20%20%20%20assert%20len(x)%20%2B%201%20%3D%3D%20len(w)%2C%20%22The%20size%20of%20the%20features%20vector%20does%20not%20match%20the%20size%20of%20the%20weights%22%0A%0A%20%20%20%20%20%20%20%20y_log%20%3D%20w%5B0%5D%20%2B%20np.dot(x%2C%20w%5B1%3A%5D)%0A%0A%20%20%20%20%20%20%20%20return%20np.expm1(y_log).astype(int)%0A%20%20%20%20return%20(vectorial_linear_regression%2C)%0A%0A%0A%40app.cell%0Adef%20_(vectorial_linear_regression%2C%20x)%3A%0A%20%20%20%20vectorial_linear_regression(x%2C%20%5B7.5%2C%200.01%2C%200.07%2C%200.003%5D)%0A%20%20%20%20return%0A%0A%0A%40app.cell(hide_code%3DTrue)%0Adef%20_(mo)%3A%0A%20%20%20%20mo.md(%0A%20%20%20%20%20%20%20%20r%22%22%22%0A%20%20%20%20If%20we%20want%2C%20we%20can%20simplify%20our%20expression%20even%20further%20by%20defining%20an%20extra%20feature%20that%20always%20equals%20%241%24.%20By%20doing%20so%2C%20we'd%20get%20%24%5Cbold%7Bw%7D%24%20and%20%24%5Cbold%7Bx%7D%24%20vectors%20with%20%24n%2B1%24%20elements%3A%0A%0A%20%20%20%20%5C%5B%0A%20%20%20%20%20%20%20%20w%20%3D%20%5Bw_0%2C%20w_1%2C%20...%2C%20w_n%5D%0A%20%20%20%20%5C%5D%0A%0A%20%20%20%20%5C%5B%0A%20%20%20%20%20%20%20%20x_i%20%3D%20%5B1%2C%20x_%7Bi1%7D%2C%20x_%7Bi2%7D%2C%20...%2C%20x_%7Bin%7D%5D%0A%20%20%20%20%5C%5D%0A%0A%20%20%20%20Therefore%2C%20our%20estimator%20could%20be%20written%20as%3A%0A%0A%20%20%20%20%5C%5B%0A%20%20%20%20%20%20%20%20g_i(x_i)%20%3D%20%5Cbold%7Bw%7D%5ET%20%5Cbold%7Bx%7D_i%0A%20%20%20%20%5C%5D%0A%20%20%20%20%22%22%22%0A%20%20%20%20)%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(np)%3A%0A%20%20%20%20def%20final_linear_regression(x%2C%20w)%3A%0A%20%20%20%20%20%20%20%20assert%20len(x)%20%2B%201%20%3D%3D%20len(w)%2C%20%22The%20size%20of%20the%20features%20vector%20does%20not%20match%20the%20size%20of%20the%20weights%22%0A%0A%20%20%20%20%20%20%20%20x%20%3D%20np.concat((np.array(%5B1%5D)%2C%20np.array(x)))%0A%20%20%20%20%20%20%20%20y_log%20%3D%20np.dot(x%2C%20w)%0A%0A%20%20%20%20%20%20%20%20return%20np.expm1(y_log).astype(int)%0A%20%20%20%20return%20(final_linear_regression%2C)%0A%0A%0A%40app.cell%0Adef%20_(final_linear_regression%2C%20x)%3A%0A%20%20%20%20final_linear_regression(x%2C%20%5B7.5%2C%200.01%2C%200.07%2C%200.003%5D)%0A%20%20%20%20return%0A%0A%0A%40app.cell(hide_code%3DTrue)%0Adef%20_(mo)%3A%0A%20%20%20%20mo.md(%0A%20%20%20%20%20%20%20%20r%22%22%22%0A%20%20%20%20We%20can%20write%20our%20%24g%24%20function%20for%20all%20samples%20as%20a%20matrix%20multiplication.%0A%0A%20%20%20%20%5C%5B%0A%20%20%20%20%5Cbold%7By_p%7D%20%3D%20%0A%20%20%20%20%5Cbegin%7Bbmatrix%7D%0A%20%20%20%201%20%26%20x_%7B11%7D%20%26%20x_%7B12%7D%20%26%20%5Ccdots%20%26%20x_%7B1n%7D%20%5C%5C%0A%20%20%20%201%20%26%20x_%7B21%7D%20%26%20x_%7B22%7D%20%26%20%5Ccdots%20%26%20x_%7B2n%7D%20%5C%5C%0A%20%20%20%20%5Cvdots%20%26%20%5Cvdots%20%26%20%5Cvdots%20%26%20%5Cddots%20%26%20%5Cvdots%20%5C%5C%0A%20%20%20%201%20%26%20x_%7Bm1%7D%20%26%20x_%7Bm2%7D%20%26%20%5Ccdots%20%26%20x_%7Bmn%7D%0A%20%20%20%20%5Cend%7Bbmatrix%7D%0A%20%20%20%20%5Cbegin%7Bbmatrix%7D%0A%20%20%20%20w_0%20%5C%5C%0A%20%20%20%20w_1%20%5C%5C%0A%20%20%20%20w_2%20%5C%5C%0A%20%20%20%20%5Cvdots%20%5C%5C%0A%20%20%20%20w_n%0A%20%20%20%20%5Cend%7Bbmatrix%7D%0A%20%20%20%20%3D%0A%20%20%20%20%5Cbegin%7Bbmatrix%7D%0A%20%20%20%20%5Cbold%7Bx_1%7D%5ET%20%C2%B7%20%5Cbold%7Bw%7D%20%5C%5C%0A%20%20%20%20%5Cbold%7Bx_2%7D%5ET%20%C2%B7%20%5Cbold%7Bw%7D%20%5C%5C%0A%20%20%20%20%5Cvdots%20%5C%5C%0A%20%20%20%20%5Cbold%7Bx_m%7D%5ET%20%C2%B7%20%5Cbold%7Bw%7D%20%5C%5C%0A%20%20%20%20%5Cend%7Bbmatrix%7D%0A%20%20%20%20%5C%5D%0A%20%20%20%20%22%22%22%0A%20%20%20%20)%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(X_train%2C%20np)%3A%0A%20%20%20%20X_matrix%20%3D%20X_train.iloc%5B10%3A15%5D%5B%5B%22engine_hp%22%2C%20%22city_mpg%22%2C%20%22popularity%22%5D%5D.values%0A%20%20%20%20X_matrix%20%3D%20np.c_%5Bnp.ones(X_matrix.shape%5B0%5D)%2C%20X_matrix%5D%0A%0A%20%20%20%20X_matrix%0A%20%20%20%20return%20(X_matrix%2C)%0A%0A%0A%40app.cell%0Adef%20_(np%2C%20y_train)%3A%0A%20%20%20%20y_matrix%20%3D%20y_train%5B10%3A15%5D%0A%0A%20%20%20%20np.expm1(y_matrix).astype(int)%0A%20%20%20%20return%20(y_matrix%2C)%0A%0A%0A%40app.cell%0Adef%20_()%3A%0A%20%20%20%20w%20%3D%20%5B7.5%2C%200.01%2C%200.07%2C%200.003%5D%0A%0A%20%20%20%20w%0A%20%20%20%20return%20(w%2C)%0A%0A%0A%40app.cell%0Adef%20_(X_matrix%2C%20np%2C%20w)%3A%0A%20%20%20%20np.expm1(X_matrix.dot(w)).astype(int)%0A%20%20%20%20return%0A%0A%0A%40app.cell(hide_code%3DTrue)%0Adef%20_(mo)%3A%0A%20%20%20%20mo.md(%0A%20%20%20%20%20%20%20%20r%22%22%22%0A%20%20%20%20%23%23%20Training%20a%20Linear%20Regression%20Model%0A%0A%20%20%20%20We%20already%20saw%20that%20our%20%24g%24%20estimator%20looks%20like%20this%3A%0A%0A%20%20%20%20%5C%5B%0A%20%20%20%20%20%20%20%20%5Cbold%7BX%7D%20%5Cbold%7Bw%7D%20%5Capprox%20%5Cbold%7By%7D%0A%20%20%20%20%5C%5D%0A%0A%20%20%20%20So%20now%20we%20have%20to%20solve%20%24%5Cbold%7Bw%7D%24%20so%20that%20we%20can%20find%20the%20weights.%0A%0A%20%20%20%20%5C%5B%0A%20%20%20%20%20%20%20%20%5Cbold%7BX%7D%5E%7B-1%7D%20%5Cbold%7BX%7D%20%5Cbold%7Bw%7D%20%5Capprox%20%5Cbold%7BX%7D%5E%7B-1%7D%20%5Cbold%7By%7D%0A%20%20%20%20%5C%5D%0A%0A%20%20%20%20What%20gives%20us%3A%0A%0A%20%20%20%20%5C%5B%0A%20%20%20%20%20%20%20%20%5Cbold%7Bw%7D%20%5Capprox%20%5Cbold%7BX%7D%5E%7B-1%7D%20%5Cbold%7By%7D%0A%20%20%20%20%5C%5D%0A%0A%20%20%20%20But%20there%20is%20an%20issue%3A%20we%20are%20working%20with%20a%20rectangular%20matrix%2C%20not%20with%20a%20squared%20one.%20So%20we%20won't%20be%20able%20to%20find%20its%20inverse.%0A%20%20%20%20%22%22%22%0A%20%20%20%20)%0A%20%20%20%20return%0A%0A%0A%40app.cell(hide_code%3DTrue)%0Adef%20_(mo)%3A%0A%20%20%20%20mo.md(%0A%20%20%20%20%20%20%20%20r%22%22%22%0A%20%20%20%20%23%23%23%20Gram%20Matrix%0A%0A%20%20%20%20The%20first%20thing%20we%20can%20do%20to%20try%20to%20solve%20this%20is%20to%20take%20into%20account%20that%20%24X%5ET%20X%24%20is%20actually%20an%20squared%20matrix%2C%20it%20may%20have%20an%20inverse.%0A%0A%20%20%20%20Therefore%2C%20we%20could%20start%20with%3A%0A%0A%20%20%20%20%5C%5B%0A%20%20%20%20%20%20%20%20%5Cbold%7BX%7D%5E%7BT%7D%20%5Cbold%7BX%7D%20%5Cbold%7Bw%7D%20%5Capprox%20%5Cbold%7BX%7D%5E%7BT%7D%20%5Cbold%7By%7D%0A%20%20%20%20%5C%5D%0A%0A%20%20%20%20...%20and%20try%20to%20solve%20it%20with%3A%0A%0A%20%20%20%20%5C%5B%0A%20%20%20%20%20%20%20%20(%5Cbold%7BX%7D%5E%7BT%7D%20%5Cbold%7BX%7D)%5E%7B-1%7D%20%5Cbold%7BX%7D%5E%7BT%7D%20%5Cbold%7BX%7D%20%5Cbold%7Bw%7D%20%5Capprox%20(%5Cbold%7BX%7D%5E%7BT%7D%20%5Cbold%7BX%7D)%5E%7B-1%7D%20%5Cbold%7BX%7D%5E%7BT%7D%20%5Cbold%7By%7D%0A%20%20%20%20%5C%5D%0A%0A%20%20%20%20...%20which%20simplifies%20to%3A%0A%0A%20%20%20%20%5C%5B%0A%20%20%20%20%20%20%20%20%5Cbold%7Bw%7D%20%5Capprox%20(%5Cbold%7BX%7D%5E%7BT%7D%20%5Cbold%7BX%7D)%5E%7B-1%7D%20%5Cbold%7BX%7D%5E%7BT%7D%20%5Cbold%7By%7D%0A%20%20%20%20%5C%5D%0A%20%20%20%20%22%22%22%0A%20%20%20%20)%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(X_matrix%2C%20np%2C%20y_matrix)%3A%0A%20%20%20%20w_solved%20%3D%20np.linalg.inv(X_matrix.T.dot(X_matrix)).dot(X_matrix.T).dot(y_matrix)%0A%0A%20%20%20%20w_solved%0A%20%20%20%20return%20(w_solved%2C)%0A%0A%0A%40app.cell%0Adef%20_(X_matrix%2C%20np%2C%20w_solved)%3A%0A%20%20%20%20y_solved%20%3D%20X_matrix.dot(w_solved)%0A%0A%20%20%20%20np.expm1(y_solved).astype(int)%0A%20%20%20%20return%0A%0A%0Aif%20__name__%20%3D%3D%20%22__main__%22%3A%0A%20%20%20%20app.run()%0A
</marimo-code>

<marimo-code-hash hidden="">022e04411c4858bcba893142f0906d68ca8876a0f5605357c74781674071143b</marimo-code-hash>
</body>
</html>
