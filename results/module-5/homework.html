<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <link rel="icon" crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.16.0/dist/favicon.ico" />
    <!-- Preload is necessary because we show these images when we disconnect from the server,
    but at that point we cannot load these images from the server -->
    <link rel="preload" crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.16.0/dist/assets/gradient-yHQUC_QB.png" as="image" />
    <link rel="preload" crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.16.0/dist/assets/noise-60BoTA8O.png" as="image" />
    <!-- Preload the fonts -->
    <link rel="preload" crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.16.0/dist/assets/Lora-VariableFont_wght-B2ootaw-.ttf" as="font" crossorigin="anonymous" />
    <link rel="preload" crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.16.0/dist/assets/PTSans-Regular-CxL0S8W7.ttf" as="font" crossorigin="anonymous" />
    <link rel="preload" crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.16.0/dist/assets/PTSans-Bold-D9fedIX3.ttf" as="font" crossorigin="anonymous" />
    <link rel="preload" crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.16.0/dist/assets/FiraMono-Regular-BTCkDNvf.ttf" as="font" crossorigin="anonymous" />
    <link rel="preload" crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.16.0/dist/assets/FiraMono-Medium-DU3aDxX5.ttf" as="font" crossorigin="anonymous" />
    <link rel="preload" crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.16.0/dist/assets/FiraMono-Bold-CLVRCuM9.ttf" as="font" crossorigin="anonymous" />

    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="theme-color" content="#000000" />
    <meta name="description" content="a marimo app" />
    <link rel="apple-touch-icon" crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.16.0/dist/apple-touch-icon.png" />
    <link rel="manifest" crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.16.0/dist/manifest.json" />

    <script data-marimo="true">
      function __resizeIframe(obj) {
        var scrollbarHeight = 20; // Max between windows, mac, and linux

        function setHeight() {
          var element = obj.contentWindow.document.documentElement;
          // If there is no vertical scrollbar, we don't need to resize the iframe
          if (element.scrollHeight === element.clientHeight) {
            return;
          }

          // Create a new height that includes the scrollbar height if it's visible
          var hasHorizontalScrollbar = element.scrollWidth > element.clientWidth;
          var newHeight = element.scrollHeight + (hasHorizontalScrollbar ? scrollbarHeight : 0);

          // Only update the height if it's different from the current height
          if (obj.style.height !== `${newHeight}px`) {
            obj.style.height = `${newHeight}px`;
          }
        }

        // Resize the iframe to the height of the content and bottom scrollbar height
        setHeight();

        // Resize the iframe when the content changes
        const resizeObserver = new ResizeObserver((entries) => {
          setHeight();
        });
        resizeObserver.observe(obj.contentWindow.document.body);
      }
    </script>
    <marimo-filename hidden>homework.py</marimo-filename>
    <!-- TODO(Trevor): Legacy, required by VS Code plugin. Remove when plugin is updated (see marimo/server/_templates/template.py) -->
    <marimo-version data-version="{{ version }}" hidden></marimo-version>
    <marimo-user-config data-config="{{ user_config }}" hidden></marimo-user-config>
    <marimo-server-token data-token="{{ server_token }}" hidden></marimo-server-token>
    <!-- /TODO -->
    <title>homework</title>
    <script type="module" crossorigin crossorigin="anonymous" src="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.16.0/dist/assets/index-DKEudB02.js"></script>
    <link rel="stylesheet" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.16.0/dist/assets/index-Cx0bsY1w.css">
  
<script data-marimo="true">
    window.__MARIMO_STATIC__ = {};
    window.__MARIMO_STATIC__.files = {};
</script>
</head>
  <body>
    <div id="root"></div>
    <!-- This is a portal for the data editor to render in -->
    <div id="portal" data-testid="glide-portal" style="position: fixed; left: 0; top: 0; z-index: 9999"></div>
    <script data-marimo="true">
      window.__MARIMO_MOUNT_CONFIG__ = {
            "filename": "homework.py",
            "mode": "read",
            "version": "0.16.0",
            "serverToken": "static",
            "config": {"ai": {"models": {"custom_models": [], "displayed_models": []}}, "completion": {"activate_on_typing": true, "copilot": false}, "display": {"cell_output": "above", "code_editor_font_size": 14, "dataframes": "rich", "default_table_max_columns": 50, "default_table_page_size": 10, "default_width": "medium", "reference_highlighting": false, "theme": "light"}, "formatting": {"line_length": 79}, "keymap": {"overrides": {}, "preset": "default"}, "language_servers": {"pylsp": {"enable_flake8": false, "enable_mypy": true, "enable_pydocstyle": false, "enable_pyflakes": false, "enable_pylint": false, "enable_ruff": true, "enabled": true}}, "package_management": {"manager": "pip"}, "runtime": {"auto_instantiate": true, "auto_reload": "off", "default_sql_output": "auto", "on_cell_change": "autorun", "output_max_bytes": 8000000, "reactive_tests": true, "std_stream_max_bytes": 1000000, "watcher_on_save": "lazy"}, "save": {"autosave": "after_delay", "autosave_delay": 1000, "format_on_save": false}, "server": {"browser": "default", "follow_symlink": false}, "snippets": {"custom_paths": [], "include_default_snippets": true}},
            "configOverrides": {},
            "appConfig": {"sql_output": "auto", "width": "medium"},
            "view": {"showAppCode": true},
            "notebook": {"cells": [{"code": "import marimo as mo\nimport pandas as pd\nimport numpy as np\nimport matplotlib.pyplot as plt\nimport seaborn as sns", "code_hash": "e76e8dbe4d9bf74eff98fef5f002130b", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "Hbol", "name": "_"}, {"code": "mo.md(\n    r\"\"\"\n# Module 5: [Deployment](https://github.com/DataTalksClub/machine-learning-zoomcamp/tree/master/05-deployment)\n\n> Note: sometimes your answer doesn't match one of the options exactly. \n> That's fine. \n> Select the option that's closest to your solution.\n> If it's exactly in between two options, select the higher value.\n\nWe recommend using python 3.12 or 3.13 in this homework.\n\nIn this homework, we're going to continue working with the lead scoring dataset. You don't need the dataset: we will provide the model for you.\n\"\"\"\n)", "code_hash": "638246a43114adafb3e9ad33164dc217", "config": {"column": null, "disabled": false, "hide_code": true}, "id": "MJUe", "name": "_"}, {"code": "mo.md(\n    r\"\"\"\n## Question 1\n\n* Install `uv0.7.12`\n* What's the version of uv you installed?\n* Use `--version` to find out\n\n\n## Initialize an empty uv project\n\nYou should create an empty folder for homework\nand do it there.\n\"\"\"\n)", "code_hash": "5ea510f6d9a0f4be3d958fee28727b52", "config": {"column": null, "disabled": false, "hide_code": true}, "id": "vblA", "name": "_"}, {"code": "mo.md(\n    r\"\"\"\n### Answer\n\nFirst, `uv` was installed following the official installation instructions:\n\n```\ncurl -LsSf https://astral.sh/uv/install.sh | sh\n```\n\nThe, with `uv --version` we found that we are using **0.7.12**.\n\"\"\"\n)", "code_hash": "19e07ffc8562eb5df7b3a59da715b34a", "config": {"column": null, "disabled": false, "hide_code": true}, "id": "bkHC", "name": "_"}, {"code": "mo.md(\n    r\"\"\"\n## Question 2\n\n* Use uv to install Scikit-Learn version 1.6.1\n* What's the first hash for Scikit-Learn you get in the lock file?\n* Include the entire string starting with sha256:, don't include quotes\n\"\"\"\n)", "code_hash": "4b07c7cecfcbc8ae845da033c26f1943", "config": {"column": null, "disabled": false, "hide_code": true}, "id": "lEQa", "name": "_"}, {"code": "mo.md(\n    r\"\"\"\n### Answer\n\nThe `scikit-learn` module was installed with:\n\n```bash\nuv init\nuv add scikit-learn==1.6.1\n```\n\nThe first has hound was the one that corresponds with **joblib**:\n\n```\n[[package]]\nname = \"joblib\"\nversion = \"1.5.2\"\nsource = { registry = \"https://pypi.org/simple\" }\nsdist = { url = \"https://files.pythonhosted.org/packages/e8/5d/447af5ea094b9e4c4054f82e223ada074c552335b9b4b2d14bd9b35a67c4/joblib-1.5.2.tar.gz\", hash = \"sha256:3faa5c39054b2f03ca547da9b2f52fde67c06240c31853f306aea97f13647b55\", size = 331077, upload-time = \"2025-08-27T12:15:46.575Z\" }\nwheels = [\n    { url = \"https://files.pythonhosted.org/packages/1e/e8/685f47e0d754320684db4425a0967f7d3fa70126bffd76110b7009a0090f/joblib-1.5.2-py3-none-any.whl\", hash = \"sha256:4e1f0bdbb987e6d843c70cf43714cb276623def372df3c22fe5266b2670bc241\", size = 308396, upload-time = \"2025-08-27T12:15:45.188Z\" },\n]\n```\n\nIn other words, this was the first hash:\n\n```\nsha256:3faa5c39054b2f03ca547da9b2f52fde67c06240c31853f306aea97f13647b55\n```\n\"\"\"\n)", "code_hash": "91941943cb1348a4035045036665d40e", "config": {"column": null, "disabled": false, "hide_code": true}, "id": "PKri", "name": "_"}, {"code": "mo.md(\n    r\"\"\"\n## Models\n\nWe have prepared a pipeline with a dictionary vectorizer and a model.\n\nIt was trained (roughly) using this code:\n\n```python\ncategorical = ['lead_source']\nnumeric = ['number_of_courses_viewed', 'annual_income']\n\ndf[categorical] = df[categorical].fillna('NA')\ndf[numeric] = df[numeric].fillna(0)\n\ntrain_dict = df[categorical + numeric].to_dict(orient='records')\n\npipeline = make_pipeline(\n    DictVectorizer(),\n    LogisticRegression(solver='liblinear')\n)\n\npipeline.fit(train_dict, y_train)\n```\n\n> **Note**: You don't need to train the model. This code is just for your reference.\n\nAnd then saved with Pickle. Download it [here](https://github.com/DataTalksClub/machine-learning-zoomcamp/tree/master/cohorts/2025/05-deployment/pipeline_v1.bin).\n\nWith `wget`:\n\n```bash\nwget https://github.com/DataTalksClub/machine-learning-zoomcamp/raw/refs/heads/master/cohorts/2025/05-deployment/pipeline_v1.bin\n```\n\"\"\"\n)", "code_hash": "dec6e6fd1a1e87005d91029f10dd76da", "config": {"column": null, "disabled": false, "hide_code": true}, "id": "Xref", "name": "_"}, {"code": "mo.md(\n    r\"\"\"\n## Question 3\n\nLet's use the model!\n\n* Write a script for loading the pipeline with pickle\n* Score this record:\n\n```json\n{\n    \"lead_source\": \"paid_ads\",\n    \"number_of_courses_viewed\": 2,\n    \"annual_income\": 79276.0\n}\n```\n\nIf you're getting errors when unpickling the files, check their checksum:\n\n```bash\n$ md5sum pipeline_v1.bin\n7d17d2e4dfbaf1e408e1a62e6e880d49 *pipeline_v1.bin\n```\n\nWhat's the probability that this lead will convert? \n\n* 0.333\n* 0.533\n* 0.733\n* 0.933\n\"\"\"\n)", "code_hash": "b715c93e76c6a2b1b1dda21c44fc425f", "config": {"column": null, "disabled": false, "hide_code": true}, "id": "SFPL", "name": "_"}, {"code": "mo.md(\n    r\"\"\"\n### Answer\n\nWith this code:\n\n```python\nimport pickle\n\nwith open(\"pipeline_v1.bin\", \"rb\") as f:\n    dict_vectorizer, model = pickle.load(f)\n\nrecord = {\n    \"lead_source\": \"paid_ads\",\n    \"number_of_courses_viewed\": 2,\n    \"annual_income\": 79276.0\n}\n\nx = dict_vectorizer.transform(record)\n\nmodel.predict_proba(x)[:, 1]\n```\n\nWe obtain a prediction of a probability of **0.533**.\n\"\"\"\n)", "code_hash": "5ff86887e391ecf7ede915e13280d49f", "config": {"column": null, "disabled": false, "hide_code": true}, "id": "BYtC", "name": "_"}, {"code": "mo.md(\n    r\"\"\"\n## Question 4\n\nNow let's serve this model as a web service\n\n* Install FastAPI\n* Write FastAPI code for serving the model\n* Now score this client using `requests`:\n\n```python\nurl = \"YOUR_URL\"\nclient = {\n    \"lead_source\": \"organic_search\",\n    \"number_of_courses_viewed\": 4,\n    \"annual_income\": 80304.0\n}\nrequests.post(url, json=client).json()\n```\n\nWhat's the probability that this client will get a subscription?\n\n* 0.334\n* 0.534\n* 0.734\n* 0.934\n\"\"\"\n)", "code_hash": "a9388ab42f37dc70360fe925000a0975", "config": {"column": null, "disabled": false, "hide_code": true}, "id": "RGSE", "name": "_"}, {"code": "mo.md(\n    r\"\"\"\n### Answer\n\nA project with these dependencies was created:\n\n```toml\ndependencies = [\n    \"fastapi[standard]>=0.120.0\",\n    \"scikit-learn==1.6.1\",\n]\n```\n\nThen, to set up our FastAPI server, this code was used:\n\n```python\nimport pickle\nfrom fastapi import FastAPI\nfrom pydantic import BaseModel\n\nclass Client(BaseModel):\n    lead_source: str\n    number_of_courses_viewed: int\n    annual_income: float\n\nwith open(\"pipeline_v1.bin\", \"rb\") as f:\n    dict_vectorizer, model = pickle.load(f)\n\napp = FastAPI()\n\n@app.post(\"/predict\")\ndef predict(client: Client):\n    x = dict_vectorizer.transform(client.model_dump())\n\n    return model.predict_proba(x)[:, 1]\n```\n\nThe server was started by running:\n\n```bash\nuv run fastapi dev\n```\n\nWith the code provided above, we obtained **0.534**.\n\"\"\"\n)", "code_hash": "2cde5a9295a9d5ad5c9c65edc0a8128e", "config": {"column": null, "disabled": false, "hide_code": true}, "id": "Kclp", "name": "_"}, {"code": "mo.md(\n    r\"\"\"\n## Docker\n\nInstall [Docker](https://github.com/DataTalksClub/machine-learning-zoomcamp/blob/master/05-deployment/06-docker.md). \nWe will use it for the next two questions.\n\nFor these questions, we prepared a base image: `agrigorev/zoomcamp-model:2025`. \nYou'll need to use it (see Question 5 for an example).\n\nThis image is based on `3.13.5-slim-bookworm` and has\na pipeline with logistic regression (a different one)\nas well a dictionary vectorizer inside. \n\nThis is how the Dockerfile for this image looks like:\n\n```docker \nFROM python:3.13.5-slim-bookworm\nWORKDIR /code\nCOPY pipeline_v2.bin .\n```\n\nWe already built it and then pushed it to [`agrigorev/zoomcamp-model:2025`](https://hub.docker.com/r/agrigorev/zoomcamp-model).\n\n> **Note**: You don't need to build this docker image, it's just for your reference.\n\"\"\"\n)", "code_hash": "8409885e6858284ef9c842f8e9750975", "config": {"column": null, "disabled": false, "hide_code": true}, "id": "emfo", "name": "_"}, {"code": "mo.md(\n    r\"\"\"\n## Question 5\n\nDownload the base image `agrigorev/zoomcamp-model:2025`. You can easily make it by using [docker pull](https://docs.docker.com/engine/reference/commandline/pull/) command.\n\nSo what's the size of this base image?\n\n* 45 MB\n* 121 MB\n* 245 MB\n* 330 MB\n\nYou can get this information when running `docker images` - it'll be in the \"SIZE\" column.\n\"\"\"\n)", "code_hash": "c4bc9f48cd9f226389aa52b7f387fb69", "config": {"column": null, "disabled": false, "hide_code": true}, "id": "Hstk", "name": "_"}, {"code": "mo.md(\n    r\"\"\"\n### Answer\n\nThese commands were used:\n\n```bash\ndocker pull agrigorev/zoomcamp-model:2025\ndocker images | grep \"agrigorev/zoomcamp-model\"\n```\n\n... to check that the size of the image is **121MB**.\n\"\"\"\n)", "code_hash": "683f989f79ec66a52597134efb9f1b73", "config": {"column": null, "disabled": false, "hide_code": true}, "id": "nWHF", "name": "_"}, {"code": "mo.md(\n    r\"\"\"\n## Dockerfile\n\nNow create your own `Dockerfile` based on the image we prepared.\n\nIt should start like that:\n\n```docker\nFROM agrigorev/zoomcamp-model:2025\n# add your stuff here\n```\n\nNow complete it:\n\n* Install all the dependencies from pyproject.toml\n* Copy your FastAPI script\n* Run it with uvicorn \n\nAfter that, you can build your docker image.\n\"\"\"\n)", "code_hash": "a9caf54e688937b260a4008ce270e5e5", "config": {"column": null, "disabled": false, "hide_code": true}, "id": "iLit", "name": "_"}, {"code": "mo.md(\n    r\"\"\"\n### Answer\n\nWe build this image:\n\n```bash\nFROM agrigorev/zoomcamp-model:2025\n\nWORKDIR /code\n\nCOPY --from=ghcr.io/astral-sh/uv:latest /uv /uvx /bin/\nCOPY [\"main.py\", \"pipeline_v1.bin\", \"pyproject.toml\", \"uv.lock\", \"./\"]\n\nRUN uv sync --frozen --no-cache\n\nEXPOSE 8001\nCMD [\"uv\", \"run\", \"uvicorn\", \"main:app\", \"--host\", \"0.0.0.0\", \"--port\", \"8001\"]\n```\n\nand then we built it and run it with:\n\n```bash\ndocker build -t ml-homework .\ndocker run -p 8001:8001 -it --rm ml-homework\n```\n\"\"\"\n)", "code_hash": "0ad6ec3244ae0439fc46a224fc0fc65e", "config": {"column": null, "disabled": false, "hide_code": true}, "id": "ZHCJ", "name": "_"}, {"code": "mo.md(\n    r\"\"\"\n## Question 6\n\nLet's run your docker container!\n\nAfter running it, score this client once again:\n\n```python\nurl = \"YOUR_URL\"\nclient = {\n    \"lead_source\": \"organic_search\",\n    \"number_of_courses_viewed\": 4,\n    \"annual_income\": 80304.0\n}\nrequests.post(url, json=client).json()\n```\n\nWhat's the probability that this lead will convert?\n\n* 0.39\n* 0.59\n* 0.79\n* 0.99\n\"\"\"\n)", "code_hash": "ba878c3023cc80aa404c278d8a61c216", "config": {"column": null, "disabled": false, "hide_code": true}, "id": "ROlb", "name": "_"}, {"code": "mo.md(\n    r\"\"\"\n### Answer\n\nSimilar to what we obtained in question 4 (as we are working with the same model and we used the same input) we obtained a churn estimated probability of: **0.534**.\n\"\"\"\n)", "code_hash": "171abdd8fbd48b4adea88c8dbb57e755", "config": {"column": null, "disabled": false, "hide_code": true}, "id": "qnkX", "name": "_"}, {"code": "mo.md(\n    r\"\"\"\n## Submit the results\n\n* Submit your results here: https://courses.datatalks.club/ml-zoomcamp-2025/homework/hw05\n* If your answer doesn't match options exactly, select the closest one. If the answer is exactly in between two options, select the higher value.\n\n\n\n## Publishing to Docker hub\n\nThis is just for reference, this is how we published an image to Docker hub.\n\n`Dockerfile_base`: \n\n```dockerfile\nFROM python:3.13.5-slim-bookworm\nWORKDIR /code\nCOPY pipeline_v2.bin .\n```\n\nPublishing:\n\n```bash\ndocker build -t mlzoomcamp2025_hw5 -f Dockerfile_base .\ndocker tag mlzoomcamp2025_hw5:latest agrigorev/zoomcamp-model:2025\ndocker push agrigorev/zoomcamp-model:2025\n```\n\"\"\"\n)", "code_hash": "3534ebada2a82d5d44c9990f4dd96ad1", "config": {"column": null, "disabled": false, "hide_code": true}, "id": "TqIu", "name": "_"}], "metadata": {"marimo_version": "0.16.0"}, "version": "1"},
            "session": {"cells": [{"code_hash": "e76e8dbe4d9bf74eff98fef5f002130b", "console": [], "id": "Hbol", "outputs": [{"data": {"text/plain": ""}, "type": "data"}]}, {"code_hash": "638246a43114adafb3e9ad33164dc217", "console": [], "id": "MJUe", "outputs": [{"data": {"text/html": "<span class=\"markdown prose dark:prose-invert\"><h1 id=\"module-5-deployment\">Module 5: <a href=\"https://github.com/DataTalksClub/machine-learning-zoomcamp/tree/master/05-deployment\" rel=\"noopener\" target=\"_blank\">Deployment</a></h1>\n<blockquote>\n<span class=\"paragraph\">Note: sometimes your answer doesn't match one of the options exactly. \nThat's fine. \nSelect the option that's closest to your solution.\nIf it's exactly in between two options, select the higher value.</span>\n</blockquote>\n<span class=\"paragraph\">We recommend using python 3.12 or 3.13 in this homework.</span>\n<span class=\"paragraph\">In this homework, we're going to continue working with the lead scoring dataset. You don't need the dataset: we will provide the model for you.</span></span>"}, "type": "data"}]}, {"code_hash": "5ea510f6d9a0f4be3d958fee28727b52", "console": [], "id": "vblA", "outputs": [{"data": {"text/html": "<span class=\"markdown prose dark:prose-invert\"><h2 id=\"question-1\">Question 1</h2>\n<ul>\n<li>Install <code>uv0.7.12</code></li>\n<li>What's the version of uv you installed?</li>\n<li>Use <code>--version</code> to find out</li>\n</ul>\n<h2 id=\"initialize-an-empty-uv-project\">Initialize an empty uv project</h2>\n<span class=\"paragraph\">You should create an empty folder for homework\nand do it there.</span></span>"}, "type": "data"}]}, {"code_hash": "19e07ffc8562eb5df7b3a59da715b34a", "console": [], "id": "bkHC", "outputs": [{"data": {"text/html": "<span class=\"markdown prose dark:prose-invert\"><h3 id=\"answer\">Answer</h3>\n<span class=\"paragraph\">First, <code>uv</code> was installed following the official installation instructions:</span>\n<div class=\"language-text codehilite\"><pre><span></span><code>curl -LsSf https://astral.sh/uv/install.sh | sh\n</code></pre></div>\n<span class=\"paragraph\">The, with <code>uv --version</code> we found that we are using <strong>0.7.12</strong>.</span></span>"}, "type": "data"}]}, {"code_hash": "4b07c7cecfcbc8ae845da033c26f1943", "console": [], "id": "lEQa", "outputs": [{"data": {"text/html": "<span class=\"markdown prose dark:prose-invert\"><h2 id=\"question-2\">Question 2</h2>\n<ul>\n<li>Use uv to install Scikit-Learn version 1.6.1</li>\n<li>What's the first hash for Scikit-Learn you get in the lock file?</li>\n<li>Include the entire string starting with sha256:, don't include quotes</li>\n</ul></span>"}, "type": "data"}]}, {"code_hash": "91941943cb1348a4035045036665d40e", "console": [], "id": "PKri", "outputs": [{"data": {"text/html": "<span class=\"markdown prose dark:prose-invert\"><h3 id=\"answer\">Answer</h3>\n<span class=\"paragraph\">The <code>scikit-learn</code> module was installed with:</span>\n<div class=\"language-bash codehilite\"><pre><span></span><code>uv<span class=\"w\"> </span>init\nuv<span class=\"w\"> </span>add<span class=\"w\"> </span>scikit-learn<span class=\"o\">==</span><span class=\"m\">1</span>.6.1\n</code></pre></div>\n<span class=\"paragraph\">The first has hound was the one that corresponds with <strong>joblib</strong>:</span>\n<div class=\"language-ini codehilite\"><pre><span></span><code><span class=\"k\">[[package]]</span>\n<span class=\"na\">name</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"s\">&quot;joblib&quot;</span>\n<span class=\"na\">version</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"s\">&quot;1.5.2&quot;</span>\n<span class=\"na\">source = { registry</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"s\">&quot;https://pypi.org/simple&quot;</span><span class=\"w\"> </span><span class=\"na\">}</span>\n<span class=\"na\">sdist = { url</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"s\">&quot;https://files.pythonhosted.org/packages/e8/5d/447af5ea094b9e4c4054f82e223ada074c552335b9b4b2d14bd9b35a67c4/joblib-1.5.2.tar.gz&quot;</span><span class=\"na\">, hash</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"s\">&quot;sha256:3faa5c39054b2f03ca547da9b2f52fde67c06240c31853f306aea97f13647b55&quot;</span><span class=\"na\">, size = 331077, upload-time</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"s\">&quot;2025-08-27T12:15:46.575Z&quot;</span><span class=\"w\"> </span><span class=\"na\">}</span>\n<span class=\"na\">wheels</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"s\">[</span>\n<span class=\"w\">    </span><span class=\"na\">{ url</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"s\">&quot;https://files.pythonhosted.org/packages/1e/e8/685f47e0d754320684db4425a0967f7d3fa70126bffd76110b7009a0090f/joblib-1.5.2-py3-none-any.whl&quot;</span><span class=\"na\">, hash</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"s\">&quot;sha256:4e1f0bdbb987e6d843c70cf43714cb276623def372df3c22fe5266b2670bc241&quot;</span><span class=\"na\">, size = 308396, upload-time</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"s\">&quot;2025-08-27T12:15:45.188Z&quot;</span><span class=\"w\"> </span><span class=\"na\">},</span>\n<span class=\"na\">]</span>\n</code></pre></div>\n<span class=\"paragraph\">In other words, this was the first hash:</span>\n<div class=\"language-actionscript3 codehilite\"><pre><span></span><code><span class=\"n\">sha256</span><span class=\"o\">:</span><span class=\"mi\">3</span><span class=\"n\">faa5c39054b2f03ca547da9b2f52fde67c06240c31853f306aea97f13647b55</span>\n</code></pre></div></span>"}, "type": "data"}]}, {"code_hash": "dec6e6fd1a1e87005d91029f10dd76da", "console": [], "id": "Xref", "outputs": [{"data": {"text/html": "<span class=\"markdown prose dark:prose-invert\"><h2 id=\"models\">Models</h2>\n<span class=\"paragraph\">We have prepared a pipeline with a dictionary vectorizer and a model.</span>\n<span class=\"paragraph\">It was trained (roughly) using this code:</span>\n<div class=\"language-python codehilite\"><pre><span></span><code><span class=\"n\">categorical</span> <span class=\"o\">=</span> <span class=\"p\">[</span><span class=\"s1\">&#39;lead_source&#39;</span><span class=\"p\">]</span>\n<span class=\"n\">numeric</span> <span class=\"o\">=</span> <span class=\"p\">[</span><span class=\"s1\">&#39;number_of_courses_viewed&#39;</span><span class=\"p\">,</span> <span class=\"s1\">&#39;annual_income&#39;</span><span class=\"p\">]</span>\n\n<span class=\"n\">df</span><span class=\"p\">[</span><span class=\"n\">categorical</span><span class=\"p\">]</span> <span class=\"o\">=</span> <span class=\"n\">df</span><span class=\"p\">[</span><span class=\"n\">categorical</span><span class=\"p\">]</span><span class=\"o\">.</span><span class=\"n\">fillna</span><span class=\"p\">(</span><span class=\"s1\">&#39;NA&#39;</span><span class=\"p\">)</span>\n<span class=\"n\">df</span><span class=\"p\">[</span><span class=\"n\">numeric</span><span class=\"p\">]</span> <span class=\"o\">=</span> <span class=\"n\">df</span><span class=\"p\">[</span><span class=\"n\">numeric</span><span class=\"p\">]</span><span class=\"o\">.</span><span class=\"n\">fillna</span><span class=\"p\">(</span><span class=\"mi\">0</span><span class=\"p\">)</span>\n\n<span class=\"n\">train_dict</span> <span class=\"o\">=</span> <span class=\"n\">df</span><span class=\"p\">[</span><span class=\"n\">categorical</span> <span class=\"o\">+</span> <span class=\"n\">numeric</span><span class=\"p\">]</span><span class=\"o\">.</span><span class=\"n\">to_dict</span><span class=\"p\">(</span><span class=\"n\">orient</span><span class=\"o\">=</span><span class=\"s1\">&#39;records&#39;</span><span class=\"p\">)</span>\n\n<span class=\"n\">pipeline</span> <span class=\"o\">=</span> <span class=\"n\">make_pipeline</span><span class=\"p\">(</span>\n    <span class=\"n\">DictVectorizer</span><span class=\"p\">(),</span>\n    <span class=\"n\">LogisticRegression</span><span class=\"p\">(</span><span class=\"n\">solver</span><span class=\"o\">=</span><span class=\"s1\">&#39;liblinear&#39;</span><span class=\"p\">)</span>\n<span class=\"p\">)</span>\n\n<span class=\"n\">pipeline</span><span class=\"o\">.</span><span class=\"n\">fit</span><span class=\"p\">(</span><span class=\"n\">train_dict</span><span class=\"p\">,</span> <span class=\"n\">y_train</span><span class=\"p\">)</span>\n</code></pre></div>\n<blockquote>\n<span class=\"paragraph\"><strong>Note</strong>: You don't need to train the model. This code is just for your reference.</span>\n</blockquote>\n<span class=\"paragraph\">And then saved with Pickle. Download it <a href=\"https://github.com/DataTalksClub/machine-learning-zoomcamp/tree/master/cohorts/2025/05-deployment/pipeline_v1.bin\" rel=\"noopener\" target=\"_blank\">here</a>.</span>\n<span class=\"paragraph\">With <code>wget</code>:</span>\n<div class=\"language-bash codehilite\"><pre><span></span><code>wget<span class=\"w\"> </span>https://github.com/DataTalksClub/machine-learning-zoomcamp/raw/refs/heads/master/cohorts/2025/05-deployment/pipeline_v1.bin\n</code></pre></div></span>"}, "type": "data"}]}, {"code_hash": "b715c93e76c6a2b1b1dda21c44fc425f", "console": [], "id": "SFPL", "outputs": [{"data": {"text/html": "<span class=\"markdown prose dark:prose-invert\"><h2 id=\"question-3\">Question 3</h2>\n<span class=\"paragraph\">Let's use the model!</span>\n<ul>\n<li>Write a script for loading the pipeline with pickle</li>\n<li>Score this record:</li>\n</ul>\n<div class=\"language-json codehilite\"><pre><span></span><code><span class=\"p\">{</span>\n<span class=\"w\">    </span><span class=\"nt\">&quot;lead_source&quot;</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"s2\">&quot;paid_ads&quot;</span><span class=\"p\">,</span>\n<span class=\"w\">    </span><span class=\"nt\">&quot;number_of_courses_viewed&quot;</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"mi\">2</span><span class=\"p\">,</span>\n<span class=\"w\">    </span><span class=\"nt\">&quot;annual_income&quot;</span><span class=\"p\">:</span><span class=\"w\"> </span><span class=\"mf\">79276.0</span>\n<span class=\"p\">}</span>\n</code></pre></div>\n<span class=\"paragraph\">If you're getting errors when unpickling the files, check their checksum:</span>\n<div class=\"language-bash codehilite\"><pre><span></span><code>$<span class=\"w\"> </span>md5sum<span class=\"w\"> </span>pipeline_v1.bin\n7d17d2e4dfbaf1e408e1a62e6e880d49<span class=\"w\"> </span>*pipeline_v1.bin\n</code></pre></div>\n<span class=\"paragraph\">What's the probability that this lead will convert? </span>\n<ul>\n<li>0.333</li>\n<li>0.533</li>\n<li>0.733</li>\n<li>0.933</li>\n</ul></span>"}, "type": "data"}]}, {"code_hash": "5ff86887e391ecf7ede915e13280d49f", "console": [], "id": "BYtC", "outputs": [{"data": {"text/html": "<span class=\"markdown prose dark:prose-invert\"><h3 id=\"answer\">Answer</h3>\n<span class=\"paragraph\">With this code:</span>\n<div class=\"language-python codehilite\"><pre><span></span><code><span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"nn\">pickle</span>\n\n<span class=\"k\">with</span> <span class=\"nb\">open</span><span class=\"p\">(</span><span class=\"s2\">&quot;pipeline_v1.bin&quot;</span><span class=\"p\">,</span> <span class=\"s2\">&quot;rb&quot;</span><span class=\"p\">)</span> <span class=\"k\">as</span> <span class=\"n\">f</span><span class=\"p\">:</span>\n    <span class=\"n\">dict_vectorizer</span><span class=\"p\">,</span> <span class=\"n\">model</span> <span class=\"o\">=</span> <span class=\"n\">pickle</span><span class=\"o\">.</span><span class=\"n\">load</span><span class=\"p\">(</span><span class=\"n\">f</span><span class=\"p\">)</span>\n\n<span class=\"n\">record</span> <span class=\"o\">=</span> <span class=\"p\">{</span>\n    <span class=\"s2\">&quot;lead_source&quot;</span><span class=\"p\">:</span> <span class=\"s2\">&quot;paid_ads&quot;</span><span class=\"p\">,</span>\n    <span class=\"s2\">&quot;number_of_courses_viewed&quot;</span><span class=\"p\">:</span> <span class=\"mi\">2</span><span class=\"p\">,</span>\n    <span class=\"s2\">&quot;annual_income&quot;</span><span class=\"p\">:</span> <span class=\"mf\">79276.0</span>\n<span class=\"p\">}</span>\n\n<span class=\"n\">x</span> <span class=\"o\">=</span> <span class=\"n\">dict_vectorizer</span><span class=\"o\">.</span><span class=\"n\">transform</span><span class=\"p\">(</span><span class=\"n\">record</span><span class=\"p\">)</span>\n\n<span class=\"n\">model</span><span class=\"o\">.</span><span class=\"n\">predict_proba</span><span class=\"p\">(</span><span class=\"n\">x</span><span class=\"p\">)[:,</span> <span class=\"mi\">1</span><span class=\"p\">]</span>\n</code></pre></div>\n<span class=\"paragraph\">We obtain a prediction of a probability of <strong>0.533</strong>.</span></span>"}, "type": "data"}]}, {"code_hash": "a9388ab42f37dc70360fe925000a0975", "console": [], "id": "RGSE", "outputs": [{"data": {"text/html": "<span class=\"markdown prose dark:prose-invert\"><h2 id=\"question-4\">Question 4</h2>\n<span class=\"paragraph\">Now let's serve this model as a web service</span>\n<ul>\n<li>Install FastAPI</li>\n<li>Write FastAPI code for serving the model</li>\n<li>Now score this client using <code>requests</code>:</li>\n</ul>\n<div class=\"language-python codehilite\"><pre><span></span><code><span class=\"n\">url</span> <span class=\"o\">=</span> <span class=\"s2\">&quot;YOUR_URL&quot;</span>\n<span class=\"n\">client</span> <span class=\"o\">=</span> <span class=\"p\">{</span>\n    <span class=\"s2\">&quot;lead_source&quot;</span><span class=\"p\">:</span> <span class=\"s2\">&quot;organic_search&quot;</span><span class=\"p\">,</span>\n    <span class=\"s2\">&quot;number_of_courses_viewed&quot;</span><span class=\"p\">:</span> <span class=\"mi\">4</span><span class=\"p\">,</span>\n    <span class=\"s2\">&quot;annual_income&quot;</span><span class=\"p\">:</span> <span class=\"mf\">80304.0</span>\n<span class=\"p\">}</span>\n<span class=\"n\">requests</span><span class=\"o\">.</span><span class=\"n\">post</span><span class=\"p\">(</span><span class=\"n\">url</span><span class=\"p\">,</span> <span class=\"n\">json</span><span class=\"o\">=</span><span class=\"n\">client</span><span class=\"p\">)</span><span class=\"o\">.</span><span class=\"n\">json</span><span class=\"p\">()</span>\n</code></pre></div>\n<span class=\"paragraph\">What's the probability that this client will get a subscription?</span>\n<ul>\n<li>0.334</li>\n<li>0.534</li>\n<li>0.734</li>\n<li>0.934</li>\n</ul></span>"}, "type": "data"}]}, {"code_hash": "2cde5a9295a9d5ad5c9c65edc0a8128e", "console": [], "id": "Kclp", "outputs": [{"data": {"text/html": "<span class=\"markdown prose dark:prose-invert\"><h3 id=\"answer\">Answer</h3>\n<span class=\"paragraph\">A project with these dependencies was created:</span>\n<div class=\"language-toml codehilite\"><pre><span></span><code><span class=\"n\">dependencies</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"p\">[</span>\n<span class=\"w\">    </span><span class=\"s2\">&quot;fastapi[standard]&gt;=0.120.0&quot;</span><span class=\"p\">,</span>\n<span class=\"w\">    </span><span class=\"s2\">&quot;scikit-learn==1.6.1&quot;</span><span class=\"p\">,</span>\n<span class=\"p\">]</span>\n</code></pre></div>\n<span class=\"paragraph\">Then, to set up our FastAPI server, this code was used:</span>\n<div class=\"language-python codehilite\"><pre><span></span><code><span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"nn\">pickle</span>\n<span class=\"kn\">from</span><span class=\"w\"> </span><span class=\"nn\">fastapi</span><span class=\"w\"> </span><span class=\"kn\">import</span> <span class=\"n\">FastAPI</span>\n<span class=\"kn\">from</span><span class=\"w\"> </span><span class=\"nn\">pydantic</span><span class=\"w\"> </span><span class=\"kn\">import</span> <span class=\"n\">BaseModel</span>\n\n<span class=\"k\">class</span><span class=\"w\"> </span><span class=\"nc\">Client</span><span class=\"p\">(</span><span class=\"n\">BaseModel</span><span class=\"p\">):</span>\n    <span class=\"n\">lead_source</span><span class=\"p\">:</span> <span class=\"nb\">str</span>\n    <span class=\"n\">number_of_courses_viewed</span><span class=\"p\">:</span> <span class=\"nb\">int</span>\n    <span class=\"n\">annual_income</span><span class=\"p\">:</span> <span class=\"nb\">float</span>\n\n<span class=\"k\">with</span> <span class=\"nb\">open</span><span class=\"p\">(</span><span class=\"s2\">&quot;pipeline_v1.bin&quot;</span><span class=\"p\">,</span> <span class=\"s2\">&quot;rb&quot;</span><span class=\"p\">)</span> <span class=\"k\">as</span> <span class=\"n\">f</span><span class=\"p\">:</span>\n    <span class=\"n\">dict_vectorizer</span><span class=\"p\">,</span> <span class=\"n\">model</span> <span class=\"o\">=</span> <span class=\"n\">pickle</span><span class=\"o\">.</span><span class=\"n\">load</span><span class=\"p\">(</span><span class=\"n\">f</span><span class=\"p\">)</span>\n\n<span class=\"n\">app</span> <span class=\"o\">=</span> <span class=\"n\">FastAPI</span><span class=\"p\">()</span>\n\n<span class=\"nd\">@app</span><span class=\"o\">.</span><span class=\"n\">post</span><span class=\"p\">(</span><span class=\"s2\">&quot;/predict&quot;</span><span class=\"p\">)</span>\n<span class=\"k\">def</span><span class=\"w\"> </span><span class=\"nf\">predict</span><span class=\"p\">(</span><span class=\"n\">client</span><span class=\"p\">:</span> <span class=\"n\">Client</span><span class=\"p\">):</span>\n    <span class=\"n\">x</span> <span class=\"o\">=</span> <span class=\"n\">dict_vectorizer</span><span class=\"o\">.</span><span class=\"n\">transform</span><span class=\"p\">(</span><span class=\"n\">client</span><span class=\"o\">.</span><span class=\"n\">model_dump</span><span class=\"p\">())</span>\n\n    <span class=\"k\">return</span> <span class=\"n\">model</span><span class=\"o\">.</span><span class=\"n\">predict_proba</span><span class=\"p\">(</span><span class=\"n\">x</span><span class=\"p\">)[:,</span> <span class=\"mi\">1</span><span class=\"p\">]</span>\n</code></pre></div>\n<span class=\"paragraph\">The server was started by running:</span>\n<div class=\"language-bash codehilite\"><pre><span></span><code>uv<span class=\"w\"> </span>run<span class=\"w\"> </span>fastapi<span class=\"w\"> </span>dev\n</code></pre></div>\n<span class=\"paragraph\">With the code provided above, we obtained <strong>0.534</strong>.</span></span>"}, "type": "data"}]}, {"code_hash": "8409885e6858284ef9c842f8e9750975", "console": [], "id": "emfo", "outputs": [{"data": {"text/html": "<span class=\"markdown prose dark:prose-invert\"><h2 id=\"docker\">Docker</h2>\n<span class=\"paragraph\">Install <a href=\"https://github.com/DataTalksClub/machine-learning-zoomcamp/blob/master/05-deployment/06-docker.md\" rel=\"noopener\" target=\"_blank\">Docker</a>. \nWe will use it for the next two questions.</span>\n<span class=\"paragraph\">For these questions, we prepared a base image: <code>agrigorev/zoomcamp-model:2025</code>. \nYou'll need to use it (see Question 5 for an example).</span>\n<span class=\"paragraph\">This image is based on <code>3.13.5-slim-bookworm</code> and has\na pipeline with logistic regression (a different one)\nas well a dictionary vectorizer inside. </span>\n<span class=\"paragraph\">This is how the Dockerfile for this image looks like:</span>\n<div class=\"language-docker codehilite\"><pre><span></span><code><span class=\"k\">FROM</span><span class=\"w\"> </span><span class=\"s\">python:3.13.5-slim-bookworm</span>\n<span class=\"k\">WORKDIR</span><span class=\"w\"> </span><span class=\"s\">/code</span>\n<span class=\"k\">COPY</span><span class=\"w\"> </span>pipeline_v2.bin<span class=\"w\"> </span>.\n</code></pre></div>\n<span class=\"paragraph\">We already built it and then pushed it to <a href=\"https://hub.docker.com/r/agrigorev/zoomcamp-model\" rel=\"noopener\" target=\"_blank\"><code>agrigorev/zoomcamp-model:2025</code></a>.</span>\n<blockquote>\n<span class=\"paragraph\"><strong>Note</strong>: You don't need to build this docker image, it's just for your reference.</span>\n</blockquote></span>"}, "type": "data"}]}, {"code_hash": "c4bc9f48cd9f226389aa52b7f387fb69", "console": [], "id": "Hstk", "outputs": [{"data": {"text/html": "<span class=\"markdown prose dark:prose-invert\"><h2 id=\"question-5\">Question 5</h2>\n<span class=\"paragraph\">Download the base image <code>agrigorev/zoomcamp-model:2025</code>. You can easily make it by using <a href=\"https://docs.docker.com/engine/reference/commandline/pull/\" rel=\"noopener\" target=\"_blank\">docker pull</a> command.</span>\n<span class=\"paragraph\">So what's the size of this base image?</span>\n<ul>\n<li>45 MB</li>\n<li>121 MB</li>\n<li>245 MB</li>\n<li>330 MB</li>\n</ul>\n<span class=\"paragraph\">You can get this information when running <code>docker images</code> - it'll be in the \"SIZE\" column.</span></span>"}, "type": "data"}]}, {"code_hash": "683f989f79ec66a52597134efb9f1b73", "console": [], "id": "nWHF", "outputs": [{"data": {"text/html": "<span class=\"markdown prose dark:prose-invert\"><h3 id=\"answer\">Answer</h3>\n<span class=\"paragraph\">These commands were used:</span>\n<div class=\"language-bash codehilite\"><pre><span></span><code>docker<span class=\"w\"> </span>pull<span class=\"w\"> </span>agrigorev/zoomcamp-model:2025\ndocker<span class=\"w\"> </span>images<span class=\"w\"> </span><span class=\"p\">|</span><span class=\"w\"> </span>grep<span class=\"w\"> </span><span class=\"s2\">&quot;agrigorev/zoomcamp-model&quot;</span>\n</code></pre></div>\n<span class=\"paragraph\">... to check that the size of the image is <strong>121MB</strong>.</span></span>"}, "type": "data"}]}, {"code_hash": "a9caf54e688937b260a4008ce270e5e5", "console": [], "id": "iLit", "outputs": [{"data": {"text/html": "<span class=\"markdown prose dark:prose-invert\"><h2 id=\"dockerfile\">Dockerfile</h2>\n<span class=\"paragraph\">Now create your own <code>Dockerfile</code> based on the image we prepared.</span>\n<span class=\"paragraph\">It should start like that:</span>\n<div class=\"language-docker codehilite\"><pre><span></span><code><span class=\"k\">FROM</span><span class=\"w\"> </span><span class=\"s\">agrigorev/zoomcamp-model:2025</span>\n<span class=\"c\"># add your stuff here</span>\n</code></pre></div>\n<span class=\"paragraph\">Now complete it:</span>\n<ul>\n<li>Install all the dependencies from pyproject.toml</li>\n<li>Copy your FastAPI script</li>\n<li>Run it with uvicorn </li>\n</ul>\n<span class=\"paragraph\">After that, you can build your docker image.</span></span>"}, "type": "data"}]}, {"code_hash": "0ad6ec3244ae0439fc46a224fc0fc65e", "console": [], "id": "ZHCJ", "outputs": [{"data": {"text/html": "<span class=\"markdown prose dark:prose-invert\"><h3 id=\"answer\">Answer</h3>\n<span class=\"paragraph\">We build this image:</span>\n<div class=\"language-bash codehilite\"><pre><span></span><code>FROM<span class=\"w\"> </span>agrigorev/zoomcamp-model:2025\n\nWORKDIR<span class=\"w\"> </span>/code\n\nCOPY<span class=\"w\"> </span>--from<span class=\"o\">=</span>ghcr.io/astral-sh/uv:latest<span class=\"w\"> </span>/uv<span class=\"w\"> </span>/uvx<span class=\"w\"> </span>/bin/\nCOPY<span class=\"w\"> </span><span class=\"o\">[</span><span class=\"s2\">&quot;main.py&quot;</span>,<span class=\"w\"> </span><span class=\"s2\">&quot;pipeline_v1.bin&quot;</span>,<span class=\"w\"> </span><span class=\"s2\">&quot;pyproject.toml&quot;</span>,<span class=\"w\"> </span><span class=\"s2\">&quot;uv.lock&quot;</span>,<span class=\"w\"> </span><span class=\"s2\">&quot;./&quot;</span><span class=\"o\">]</span>\n\nRUN<span class=\"w\"> </span>uv<span class=\"w\"> </span>sync<span class=\"w\"> </span>--frozen<span class=\"w\"> </span>--no-cache\n\nEXPOSE<span class=\"w\"> </span><span class=\"m\">8001</span>\nCMD<span class=\"w\"> </span><span class=\"o\">[</span><span class=\"s2\">&quot;uv&quot;</span>,<span class=\"w\"> </span><span class=\"s2\">&quot;run&quot;</span>,<span class=\"w\"> </span><span class=\"s2\">&quot;uvicorn&quot;</span>,<span class=\"w\"> </span><span class=\"s2\">&quot;main:app&quot;</span>,<span class=\"w\"> </span><span class=\"s2\">&quot;--host&quot;</span>,<span class=\"w\"> </span><span class=\"s2\">&quot;0.0.0.0&quot;</span>,<span class=\"w\"> </span><span class=\"s2\">&quot;--port&quot;</span>,<span class=\"w\"> </span><span class=\"s2\">&quot;8001&quot;</span><span class=\"o\">]</span>\n</code></pre></div>\n<span class=\"paragraph\">and then we built it and run it with:</span>\n<div class=\"language-bash codehilite\"><pre><span></span><code>docker<span class=\"w\"> </span>build<span class=\"w\"> </span>-t<span class=\"w\"> </span>ml-homework<span class=\"w\"> </span>.\ndocker<span class=\"w\"> </span>run<span class=\"w\"> </span>-p<span class=\"w\"> </span><span class=\"m\">8001</span>:8001<span class=\"w\"> </span>-it<span class=\"w\"> </span>--rm<span class=\"w\"> </span>ml-homework\n</code></pre></div></span>"}, "type": "data"}]}, {"code_hash": "ba878c3023cc80aa404c278d8a61c216", "console": [], "id": "ROlb", "outputs": [{"data": {"text/html": "<span class=\"markdown prose dark:prose-invert\"><h2 id=\"question-6\">Question 6</h2>\n<span class=\"paragraph\">Let's run your docker container!</span>\n<span class=\"paragraph\">After running it, score this client once again:</span>\n<div class=\"language-python codehilite\"><pre><span></span><code><span class=\"n\">url</span> <span class=\"o\">=</span> <span class=\"s2\">&quot;YOUR_URL&quot;</span>\n<span class=\"n\">client</span> <span class=\"o\">=</span> <span class=\"p\">{</span>\n    <span class=\"s2\">&quot;lead_source&quot;</span><span class=\"p\">:</span> <span class=\"s2\">&quot;organic_search&quot;</span><span class=\"p\">,</span>\n    <span class=\"s2\">&quot;number_of_courses_viewed&quot;</span><span class=\"p\">:</span> <span class=\"mi\">4</span><span class=\"p\">,</span>\n    <span class=\"s2\">&quot;annual_income&quot;</span><span class=\"p\">:</span> <span class=\"mf\">80304.0</span>\n<span class=\"p\">}</span>\n<span class=\"n\">requests</span><span class=\"o\">.</span><span class=\"n\">post</span><span class=\"p\">(</span><span class=\"n\">url</span><span class=\"p\">,</span> <span class=\"n\">json</span><span class=\"o\">=</span><span class=\"n\">client</span><span class=\"p\">)</span><span class=\"o\">.</span><span class=\"n\">json</span><span class=\"p\">()</span>\n</code></pre></div>\n<span class=\"paragraph\">What's the probability that this lead will convert?</span>\n<ul>\n<li>0.39</li>\n<li>0.59</li>\n<li>0.79</li>\n<li>0.99</li>\n</ul></span>"}, "type": "data"}]}, {"code_hash": "171abdd8fbd48b4adea88c8dbb57e755", "console": [], "id": "qnkX", "outputs": [{"data": {"text/html": "<span class=\"markdown prose dark:prose-invert\"><h3 id=\"answer\">Answer</h3>\n<span class=\"paragraph\">Similar to what we obtained in question 4 (as we are working with the same model and we used the same input) we obtained a churn estimated probability of: <strong>0.534</strong>.</span></span>"}, "type": "data"}]}, {"code_hash": "3534ebada2a82d5d44c9990f4dd96ad1", "console": [], "id": "TqIu", "outputs": [{"data": {"text/html": "<span class=\"markdown prose dark:prose-invert\"><h2 id=\"submit-the-results\">Submit the results</h2>\n<ul>\n<li>Submit your results here: <a href=\"https://courses.datatalks.club/ml-zoomcamp-2025/homework/hw05\" rel=\"noopener\" target=\"_blank\">https://courses.datatalks.club/ml-zoomcamp-2025/homework/hw05</a></li>\n<li>If your answer doesn't match options exactly, select the closest one. If the answer is exactly in between two options, select the higher value.</li>\n</ul>\n<h2 id=\"publishing-to-docker-hub\">Publishing to Docker hub</h2>\n<span class=\"paragraph\">This is just for reference, this is how we published an image to Docker hub.</span>\n<span class=\"paragraph\"><code>Dockerfile_base</code>: </span>\n<div class=\"language-dockerfile codehilite\"><pre><span></span><code><span class=\"k\">FROM</span><span class=\"w\"> </span><span class=\"s\">python:3.13.5-slim-bookworm</span>\n<span class=\"k\">WORKDIR</span><span class=\"w\"> </span><span class=\"s\">/code</span>\n<span class=\"k\">COPY</span><span class=\"w\"> </span>pipeline_v2.bin<span class=\"w\"> </span>.\n</code></pre></div>\n<span class=\"paragraph\">Publishing:</span>\n<div class=\"language-bash codehilite\"><pre><span></span><code>docker<span class=\"w\"> </span>build<span class=\"w\"> </span>-t<span class=\"w\"> </span>mlzoomcamp2025_hw5<span class=\"w\"> </span>-f<span class=\"w\"> </span>Dockerfile_base<span class=\"w\"> </span>.\ndocker<span class=\"w\"> </span>tag<span class=\"w\"> </span>mlzoomcamp2025_hw5:latest<span class=\"w\"> </span>agrigorev/zoomcamp-model:2025\ndocker<span class=\"w\"> </span>push<span class=\"w\"> </span>agrigorev/zoomcamp-model:2025\n</code></pre></div></span>"}, "type": "data"}]}], "metadata": {"marimo_version": "0.16.0"}, "version": "1"},
            "runtimeConfig": null,
        };
    </script>
  
<marimo-code hidden="">
    import%20marimo%0A%0A__generated_with%20%3D%20%220.16.0%22%0Aapp%20%3D%20marimo.App(width%3D%22medium%22)%0A%0A%0A%40app.cell%0Adef%20_()%3A%0A%20%20%20%20import%20marimo%20as%20mo%0A%20%20%20%20import%20pandas%20as%20pd%0A%20%20%20%20import%20numpy%20as%20np%0A%20%20%20%20import%20matplotlib.pyplot%20as%20plt%0A%20%20%20%20import%20seaborn%20as%20sns%0A%20%20%20%20return%20(mo%2C)%0A%0A%0A%40app.cell(hide_code%3DTrue)%0Adef%20_(mo)%3A%0A%20%20%20%20mo.md(%0A%20%20%20%20%20%20%20%20r%22%22%22%0A%20%20%20%20%23%20Module%205%3A%20%5BDeployment%5D(https%3A%2F%2Fgithub.com%2FDataTalksClub%2Fmachine-learning-zoomcamp%2Ftree%2Fmaster%2F05-deployment)%0A%0A%20%20%20%20%3E%20Note%3A%20sometimes%20your%20answer%20doesn't%20match%20one%20of%20the%20options%20exactly.%20%0A%20%20%20%20%3E%20That's%20fine.%20%0A%20%20%20%20%3E%20Select%20the%20option%20that's%20closest%20to%20your%20solution.%0A%20%20%20%20%3E%20If%20it's%20exactly%20in%20between%20two%20options%2C%20select%20the%20higher%20value.%0A%0A%20%20%20%20We%20recommend%20using%20python%203.12%20or%203.13%20in%20this%20homework.%0A%0A%20%20%20%20In%20this%20homework%2C%20we're%20going%20to%20continue%20working%20with%20the%20lead%20scoring%20dataset.%20You%20don't%20need%20the%20dataset%3A%20we%20will%20provide%20the%20model%20for%20you.%0A%20%20%20%20%22%22%22%0A%20%20%20%20)%0A%20%20%20%20return%0A%0A%0A%40app.cell(hide_code%3DTrue)%0Adef%20_(mo)%3A%0A%20%20%20%20mo.md(%0A%20%20%20%20%20%20%20%20r%22%22%22%0A%20%20%20%20%23%23%20Question%201%0A%0A%20%20%20%20*%20Install%20%60uv0.7.12%60%0A%20%20%20%20*%20What's%20the%20version%20of%20uv%20you%20installed%3F%0A%20%20%20%20*%20Use%20%60--version%60%20to%20find%20out%0A%0A%0A%20%20%20%20%23%23%20Initialize%20an%20empty%20uv%20project%0A%0A%20%20%20%20You%20should%20create%20an%20empty%20folder%20for%20homework%0A%20%20%20%20and%20do%20it%20there.%0A%20%20%20%20%22%22%22%0A%20%20%20%20)%0A%20%20%20%20return%0A%0A%0A%40app.cell(hide_code%3DTrue)%0Adef%20_(mo)%3A%0A%20%20%20%20mo.md(%0A%20%20%20%20%20%20%20%20r%22%22%22%0A%20%20%20%20%23%23%23%20Answer%0A%0A%20%20%20%20First%2C%20%60uv%60%20was%20installed%20following%20the%20official%20installation%20instructions%3A%0A%0A%20%20%20%20%60%60%60%0A%20%20%20%20curl%20-LsSf%20https%3A%2F%2Fastral.sh%2Fuv%2Finstall.sh%20%7C%20sh%0A%20%20%20%20%60%60%60%0A%0A%20%20%20%20The%2C%20with%20%60uv%20--version%60%20we%20found%20that%20we%20are%20using%20**0.7.12**.%0A%20%20%20%20%22%22%22%0A%20%20%20%20)%0A%20%20%20%20return%0A%0A%0A%40app.cell(hide_code%3DTrue)%0Adef%20_(mo)%3A%0A%20%20%20%20mo.md(%0A%20%20%20%20%20%20%20%20r%22%22%22%0A%20%20%20%20%23%23%20Question%202%0A%0A%20%20%20%20*%20Use%20uv%20to%20install%20Scikit-Learn%20version%201.6.1%0A%20%20%20%20*%20What's%20the%20first%20hash%20for%20Scikit-Learn%20you%20get%20in%20the%20lock%20file%3F%0A%20%20%20%20*%20Include%20the%20entire%20string%20starting%20with%20sha256%3A%2C%20don't%20include%20quotes%0A%20%20%20%20%22%22%22%0A%20%20%20%20)%0A%20%20%20%20return%0A%0A%0A%40app.cell(hide_code%3DTrue)%0Adef%20_(mo)%3A%0A%20%20%20%20mo.md(%0A%20%20%20%20%20%20%20%20r%22%22%22%0A%20%20%20%20%23%23%23%20Answer%0A%0A%20%20%20%20The%20%60scikit-learn%60%20module%20was%20installed%20with%3A%0A%0A%20%20%20%20%60%60%60bash%0A%20%20%20%20uv%20init%0A%20%20%20%20uv%20add%20scikit-learn%3D%3D1.6.1%0A%20%20%20%20%60%60%60%0A%0A%20%20%20%20The%20first%20has%20hound%20was%20the%20one%20that%20corresponds%20with%20**joblib**%3A%0A%0A%20%20%20%20%60%60%60%0A%20%20%20%20%5B%5Bpackage%5D%5D%0A%20%20%20%20name%20%3D%20%22joblib%22%0A%20%20%20%20version%20%3D%20%221.5.2%22%0A%20%20%20%20source%20%3D%20%7B%20registry%20%3D%20%22https%3A%2F%2Fpypi.org%2Fsimple%22%20%7D%0A%20%20%20%20sdist%20%3D%20%7B%20url%20%3D%20%22https%3A%2F%2Ffiles.pythonhosted.org%2Fpackages%2Fe8%2F5d%2F447af5ea094b9e4c4054f82e223ada074c552335b9b4b2d14bd9b35a67c4%2Fjoblib-1.5.2.tar.gz%22%2C%20hash%20%3D%20%22sha256%3A3faa5c39054b2f03ca547da9b2f52fde67c06240c31853f306aea97f13647b55%22%2C%20size%20%3D%20331077%2C%20upload-time%20%3D%20%222025-08-27T12%3A15%3A46.575Z%22%20%7D%0A%20%20%20%20wheels%20%3D%20%5B%0A%20%20%20%20%20%20%20%20%7B%20url%20%3D%20%22https%3A%2F%2Ffiles.pythonhosted.org%2Fpackages%2F1e%2Fe8%2F685f47e0d754320684db4425a0967f7d3fa70126bffd76110b7009a0090f%2Fjoblib-1.5.2-py3-none-any.whl%22%2C%20hash%20%3D%20%22sha256%3A4e1f0bdbb987e6d843c70cf43714cb276623def372df3c22fe5266b2670bc241%22%2C%20size%20%3D%20308396%2C%20upload-time%20%3D%20%222025-08-27T12%3A15%3A45.188Z%22%20%7D%2C%0A%20%20%20%20%5D%0A%20%20%20%20%60%60%60%0A%0A%20%20%20%20In%20other%20words%2C%20this%20was%20the%20first%20hash%3A%0A%0A%20%20%20%20%60%60%60%0A%20%20%20%20sha256%3A3faa5c39054b2f03ca547da9b2f52fde67c06240c31853f306aea97f13647b55%0A%20%20%20%20%60%60%60%0A%20%20%20%20%22%22%22%0A%20%20%20%20)%0A%20%20%20%20return%0A%0A%0A%40app.cell(hide_code%3DTrue)%0Adef%20_(mo)%3A%0A%20%20%20%20mo.md(%0A%20%20%20%20%20%20%20%20r%22%22%22%0A%20%20%20%20%23%23%20Models%0A%0A%20%20%20%20We%20have%20prepared%20a%20pipeline%20with%20a%20dictionary%20vectorizer%20and%20a%20model.%0A%0A%20%20%20%20It%20was%20trained%20(roughly)%20using%20this%20code%3A%0A%0A%20%20%20%20%60%60%60python%0A%20%20%20%20categorical%20%3D%20%5B'lead_source'%5D%0A%20%20%20%20numeric%20%3D%20%5B'number_of_courses_viewed'%2C%20'annual_income'%5D%0A%0A%20%20%20%20df%5Bcategorical%5D%20%3D%20df%5Bcategorical%5D.fillna('NA')%0A%20%20%20%20df%5Bnumeric%5D%20%3D%20df%5Bnumeric%5D.fillna(0)%0A%0A%20%20%20%20train_dict%20%3D%20df%5Bcategorical%20%2B%20numeric%5D.to_dict(orient%3D'records')%0A%0A%20%20%20%20pipeline%20%3D%20make_pipeline(%0A%20%20%20%20%20%20%20%20DictVectorizer()%2C%0A%20%20%20%20%20%20%20%20LogisticRegression(solver%3D'liblinear')%0A%20%20%20%20)%0A%0A%20%20%20%20pipeline.fit(train_dict%2C%20y_train)%0A%20%20%20%20%60%60%60%0A%0A%20%20%20%20%3E%20**Note**%3A%20You%20don't%20need%20to%20train%20the%20model.%20This%20code%20is%20just%20for%20your%20reference.%0A%0A%20%20%20%20And%20then%20saved%20with%20Pickle.%20Download%20it%20%5Bhere%5D(https%3A%2F%2Fgithub.com%2FDataTalksClub%2Fmachine-learning-zoomcamp%2Ftree%2Fmaster%2Fcohorts%2F2025%2F05-deployment%2Fpipeline_v1.bin).%0A%0A%20%20%20%20With%20%60wget%60%3A%0A%0A%20%20%20%20%60%60%60bash%0A%20%20%20%20wget%20https%3A%2F%2Fgithub.com%2FDataTalksClub%2Fmachine-learning-zoomcamp%2Fraw%2Frefs%2Fheads%2Fmaster%2Fcohorts%2F2025%2F05-deployment%2Fpipeline_v1.bin%0A%20%20%20%20%60%60%60%0A%20%20%20%20%22%22%22%0A%20%20%20%20)%0A%20%20%20%20return%0A%0A%0A%40app.cell(hide_code%3DTrue)%0Adef%20_(mo)%3A%0A%20%20%20%20mo.md(%0A%20%20%20%20%20%20%20%20r%22%22%22%0A%20%20%20%20%23%23%20Question%203%0A%0A%20%20%20%20Let's%20use%20the%20model!%0A%0A%20%20%20%20*%20Write%20a%20script%20for%20loading%20the%20pipeline%20with%20pickle%0A%20%20%20%20*%20Score%20this%20record%3A%0A%0A%20%20%20%20%60%60%60json%0A%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%22lead_source%22%3A%20%22paid_ads%22%2C%0A%20%20%20%20%20%20%20%20%22number_of_courses_viewed%22%3A%202%2C%0A%20%20%20%20%20%20%20%20%22annual_income%22%3A%2079276.0%0A%20%20%20%20%7D%0A%20%20%20%20%60%60%60%0A%0A%20%20%20%20If%20you're%20getting%20errors%20when%20unpickling%20the%20files%2C%20check%20their%20checksum%3A%0A%0A%20%20%20%20%60%60%60bash%0A%20%20%20%20%24%20md5sum%20pipeline_v1.bin%0A%20%20%20%207d17d2e4dfbaf1e408e1a62e6e880d49%20*pipeline_v1.bin%0A%20%20%20%20%60%60%60%0A%0A%20%20%20%20What's%20the%20probability%20that%20this%20lead%20will%20convert%3F%20%0A%0A%20%20%20%20*%200.333%0A%20%20%20%20*%200.533%0A%20%20%20%20*%200.733%0A%20%20%20%20*%200.933%0A%20%20%20%20%22%22%22%0A%20%20%20%20)%0A%20%20%20%20return%0A%0A%0A%40app.cell(hide_code%3DTrue)%0Adef%20_(mo)%3A%0A%20%20%20%20mo.md(%0A%20%20%20%20%20%20%20%20r%22%22%22%0A%20%20%20%20%23%23%23%20Answer%0A%0A%20%20%20%20With%20this%20code%3A%0A%0A%20%20%20%20%60%60%60python%0A%20%20%20%20import%20pickle%0A%0A%20%20%20%20with%20open(%22pipeline_v1.bin%22%2C%20%22rb%22)%20as%20f%3A%0A%20%20%20%20%20%20%20%20dict_vectorizer%2C%20model%20%3D%20pickle.load(f)%0A%0A%20%20%20%20record%20%3D%20%7B%0A%20%20%20%20%20%20%20%20%22lead_source%22%3A%20%22paid_ads%22%2C%0A%20%20%20%20%20%20%20%20%22number_of_courses_viewed%22%3A%202%2C%0A%20%20%20%20%20%20%20%20%22annual_income%22%3A%2079276.0%0A%20%20%20%20%7D%0A%0A%20%20%20%20x%20%3D%20dict_vectorizer.transform(record)%0A%0A%20%20%20%20model.predict_proba(x)%5B%3A%2C%201%5D%0A%20%20%20%20%60%60%60%0A%0A%20%20%20%20We%20obtain%20a%20prediction%20of%20a%20probability%20of%20**0.533**.%0A%20%20%20%20%22%22%22%0A%20%20%20%20)%0A%20%20%20%20return%0A%0A%0A%40app.cell(hide_code%3DTrue)%0Adef%20_(mo)%3A%0A%20%20%20%20mo.md(%0A%20%20%20%20%20%20%20%20r%22%22%22%0A%20%20%20%20%23%23%20Question%204%0A%0A%20%20%20%20Now%20let's%20serve%20this%20model%20as%20a%20web%20service%0A%0A%20%20%20%20*%20Install%20FastAPI%0A%20%20%20%20*%20Write%20FastAPI%20code%20for%20serving%20the%20model%0A%20%20%20%20*%20Now%20score%20this%20client%20using%20%60requests%60%3A%0A%0A%20%20%20%20%60%60%60python%0A%20%20%20%20url%20%3D%20%22YOUR_URL%22%0A%20%20%20%20client%20%3D%20%7B%0A%20%20%20%20%20%20%20%20%22lead_source%22%3A%20%22organic_search%22%2C%0A%20%20%20%20%20%20%20%20%22number_of_courses_viewed%22%3A%204%2C%0A%20%20%20%20%20%20%20%20%22annual_income%22%3A%2080304.0%0A%20%20%20%20%7D%0A%20%20%20%20requests.post(url%2C%20json%3Dclient).json()%0A%20%20%20%20%60%60%60%0A%0A%20%20%20%20What's%20the%20probability%20that%20this%20client%20will%20get%20a%20subscription%3F%0A%0A%20%20%20%20*%200.334%0A%20%20%20%20*%200.534%0A%20%20%20%20*%200.734%0A%20%20%20%20*%200.934%0A%20%20%20%20%22%22%22%0A%20%20%20%20)%0A%20%20%20%20return%0A%0A%0A%40app.cell(hide_code%3DTrue)%0Adef%20_(mo)%3A%0A%20%20%20%20mo.md(%0A%20%20%20%20%20%20%20%20r%22%22%22%0A%20%20%20%20%23%23%23%20Answer%0A%0A%20%20%20%20A%20project%20with%20these%20dependencies%20was%20created%3A%0A%0A%20%20%20%20%60%60%60toml%0A%20%20%20%20dependencies%20%3D%20%5B%0A%20%20%20%20%20%20%20%20%22fastapi%5Bstandard%5D%3E%3D0.120.0%22%2C%0A%20%20%20%20%20%20%20%20%22scikit-learn%3D%3D1.6.1%22%2C%0A%20%20%20%20%5D%0A%20%20%20%20%60%60%60%0A%0A%20%20%20%20Then%2C%20to%20set%20up%20our%20FastAPI%20server%2C%20this%20code%20was%20used%3A%0A%0A%20%20%20%20%60%60%60python%0A%20%20%20%20import%20pickle%0A%20%20%20%20from%20fastapi%20import%20FastAPI%0A%20%20%20%20from%20pydantic%20import%20BaseModel%0A%0A%20%20%20%20class%20Client(BaseModel)%3A%0A%20%20%20%20%20%20%20%20lead_source%3A%20str%0A%20%20%20%20%20%20%20%20number_of_courses_viewed%3A%20int%0A%20%20%20%20%20%20%20%20annual_income%3A%20float%0A%0A%20%20%20%20with%20open(%22pipeline_v1.bin%22%2C%20%22rb%22)%20as%20f%3A%0A%20%20%20%20%20%20%20%20dict_vectorizer%2C%20model%20%3D%20pickle.load(f)%0A%0A%20%20%20%20app%20%3D%20FastAPI()%0A%0A%20%20%20%20%40app.post(%22%2Fpredict%22)%0A%20%20%20%20def%20predict(client%3A%20Client)%3A%0A%20%20%20%20%20%20%20%20x%20%3D%20dict_vectorizer.transform(client.model_dump())%0A%0A%20%20%20%20%20%20%20%20return%20model.predict_proba(x)%5B%3A%2C%201%5D%0A%20%20%20%20%60%60%60%0A%0A%20%20%20%20The%20server%20was%20started%20by%20running%3A%0A%0A%20%20%20%20%60%60%60bash%0A%20%20%20%20uv%20run%20fastapi%20dev%0A%20%20%20%20%60%60%60%0A%0A%20%20%20%20With%20the%20code%20provided%20above%2C%20we%20obtained%20**0.534**.%0A%20%20%20%20%22%22%22%0A%20%20%20%20)%0A%20%20%20%20return%0A%0A%0A%40app.cell(hide_code%3DTrue)%0Adef%20_(mo)%3A%0A%20%20%20%20mo.md(%0A%20%20%20%20%20%20%20%20r%22%22%22%0A%20%20%20%20%23%23%20Docker%0A%0A%20%20%20%20Install%20%5BDocker%5D(https%3A%2F%2Fgithub.com%2FDataTalksClub%2Fmachine-learning-zoomcamp%2Fblob%2Fmaster%2F05-deployment%2F06-docker.md).%20%0A%20%20%20%20We%20will%20use%20it%20for%20the%20next%20two%20questions.%0A%0A%20%20%20%20For%20these%20questions%2C%20we%20prepared%20a%20base%20image%3A%20%60agrigorev%2Fzoomcamp-model%3A2025%60.%20%0A%20%20%20%20You'll%20need%20to%20use%20it%20(see%20Question%205%20for%20an%20example).%0A%0A%20%20%20%20This%20image%20is%20based%20on%20%603.13.5-slim-bookworm%60%20and%20has%0A%20%20%20%20a%20pipeline%20with%20logistic%20regression%20(a%20different%20one)%0A%20%20%20%20as%20well%20a%20dictionary%20vectorizer%20inside.%20%0A%0A%20%20%20%20This%20is%20how%20the%20Dockerfile%20for%20this%20image%20looks%20like%3A%0A%0A%20%20%20%20%60%60%60docker%20%0A%20%20%20%20FROM%20python%3A3.13.5-slim-bookworm%0A%20%20%20%20WORKDIR%20%2Fcode%0A%20%20%20%20COPY%20pipeline_v2.bin%20.%0A%20%20%20%20%60%60%60%0A%0A%20%20%20%20We%20already%20built%20it%20and%20then%20pushed%20it%20to%20%5B%60agrigorev%2Fzoomcamp-model%3A2025%60%5D(https%3A%2F%2Fhub.docker.com%2Fr%2Fagrigorev%2Fzoomcamp-model).%0A%0A%20%20%20%20%3E%20**Note**%3A%20You%20don't%20need%20to%20build%20this%20docker%20image%2C%20it's%20just%20for%20your%20reference.%0A%20%20%20%20%22%22%22%0A%20%20%20%20)%0A%20%20%20%20return%0A%0A%0A%40app.cell(hide_code%3DTrue)%0Adef%20_(mo)%3A%0A%20%20%20%20mo.md(%0A%20%20%20%20%20%20%20%20r%22%22%22%0A%20%20%20%20%23%23%20Question%205%0A%0A%20%20%20%20Download%20the%20base%20image%20%60agrigorev%2Fzoomcamp-model%3A2025%60.%20You%20can%20easily%20make%20it%20by%20using%20%5Bdocker%20pull%5D(https%3A%2F%2Fdocs.docker.com%2Fengine%2Freference%2Fcommandline%2Fpull%2F)%20command.%0A%0A%20%20%20%20So%20what's%20the%20size%20of%20this%20base%20image%3F%0A%0A%20%20%20%20*%2045%20MB%0A%20%20%20%20*%20121%20MB%0A%20%20%20%20*%20245%20MB%0A%20%20%20%20*%20330%20MB%0A%0A%20%20%20%20You%20can%20get%20this%20information%20when%20running%20%60docker%20images%60%20-%20it'll%20be%20in%20the%20%22SIZE%22%20column.%0A%20%20%20%20%22%22%22%0A%20%20%20%20)%0A%20%20%20%20return%0A%0A%0A%40app.cell(hide_code%3DTrue)%0Adef%20_(mo)%3A%0A%20%20%20%20mo.md(%0A%20%20%20%20%20%20%20%20r%22%22%22%0A%20%20%20%20%23%23%23%20Answer%0A%0A%20%20%20%20These%20commands%20were%20used%3A%0A%0A%20%20%20%20%60%60%60bash%0A%20%20%20%20docker%20pull%20agrigorev%2Fzoomcamp-model%3A2025%0A%20%20%20%20docker%20images%20%7C%20grep%20%22agrigorev%2Fzoomcamp-model%22%0A%20%20%20%20%60%60%60%0A%0A%20%20%20%20...%20to%20check%20that%20the%20size%20of%20the%20image%20is%20**121MB**.%0A%20%20%20%20%22%22%22%0A%20%20%20%20)%0A%20%20%20%20return%0A%0A%0A%40app.cell(hide_code%3DTrue)%0Adef%20_(mo)%3A%0A%20%20%20%20mo.md(%0A%20%20%20%20%20%20%20%20r%22%22%22%0A%20%20%20%20%23%23%20Dockerfile%0A%0A%20%20%20%20Now%20create%20your%20own%20%60Dockerfile%60%20based%20on%20the%20image%20we%20prepared.%0A%0A%20%20%20%20It%20should%20start%20like%20that%3A%0A%0A%20%20%20%20%60%60%60docker%0A%20%20%20%20FROM%20agrigorev%2Fzoomcamp-model%3A2025%0A%20%20%20%20%23%20add%20your%20stuff%20here%0A%20%20%20%20%60%60%60%0A%0A%20%20%20%20Now%20complete%20it%3A%0A%0A%20%20%20%20*%20Install%20all%20the%20dependencies%20from%20pyproject.toml%0A%20%20%20%20*%20Copy%20your%20FastAPI%20script%0A%20%20%20%20*%20Run%20it%20with%20uvicorn%20%0A%0A%20%20%20%20After%20that%2C%20you%20can%20build%20your%20docker%20image.%0A%20%20%20%20%22%22%22%0A%20%20%20%20)%0A%20%20%20%20return%0A%0A%0A%40app.cell(hide_code%3DTrue)%0Adef%20_(mo)%3A%0A%20%20%20%20mo.md(%0A%20%20%20%20%20%20%20%20r%22%22%22%0A%20%20%20%20%23%23%23%20Answer%0A%0A%20%20%20%20We%20build%20this%20image%3A%0A%0A%20%20%20%20%60%60%60bash%0A%20%20%20%20FROM%20agrigorev%2Fzoomcamp-model%3A2025%0A%0A%20%20%20%20WORKDIR%20%2Fcode%0A%0A%20%20%20%20COPY%20--from%3Dghcr.io%2Fastral-sh%2Fuv%3Alatest%20%2Fuv%20%2Fuvx%20%2Fbin%2F%0A%20%20%20%20COPY%20%5B%22main.py%22%2C%20%22pipeline_v1.bin%22%2C%20%22pyproject.toml%22%2C%20%22uv.lock%22%2C%20%22.%2F%22%5D%0A%0A%20%20%20%20RUN%20uv%20sync%20--frozen%20--no-cache%0A%0A%20%20%20%20EXPOSE%208001%0A%20%20%20%20CMD%20%5B%22uv%22%2C%20%22run%22%2C%20%22uvicorn%22%2C%20%22main%3Aapp%22%2C%20%22--host%22%2C%20%220.0.0.0%22%2C%20%22--port%22%2C%20%228001%22%5D%0A%20%20%20%20%60%60%60%0A%0A%20%20%20%20and%20then%20we%20built%20it%20and%20run%20it%20with%3A%0A%0A%20%20%20%20%60%60%60bash%0A%20%20%20%20docker%20build%20-t%20ml-homework%20.%0A%20%20%20%20docker%20run%20-p%208001%3A8001%20-it%20--rm%20ml-homework%0A%20%20%20%20%60%60%60%0A%20%20%20%20%22%22%22%0A%20%20%20%20)%0A%20%20%20%20return%0A%0A%0A%40app.cell(hide_code%3DTrue)%0Adef%20_(mo)%3A%0A%20%20%20%20mo.md(%0A%20%20%20%20%20%20%20%20r%22%22%22%0A%20%20%20%20%23%23%20Question%206%0A%0A%20%20%20%20Let's%20run%20your%20docker%20container!%0A%0A%20%20%20%20After%20running%20it%2C%20score%20this%20client%20once%20again%3A%0A%0A%20%20%20%20%60%60%60python%0A%20%20%20%20url%20%3D%20%22YOUR_URL%22%0A%20%20%20%20client%20%3D%20%7B%0A%20%20%20%20%20%20%20%20%22lead_source%22%3A%20%22organic_search%22%2C%0A%20%20%20%20%20%20%20%20%22number_of_courses_viewed%22%3A%204%2C%0A%20%20%20%20%20%20%20%20%22annual_income%22%3A%2080304.0%0A%20%20%20%20%7D%0A%20%20%20%20requests.post(url%2C%20json%3Dclient).json()%0A%20%20%20%20%60%60%60%0A%0A%20%20%20%20What's%20the%20probability%20that%20this%20lead%20will%20convert%3F%0A%0A%20%20%20%20*%200.39%0A%20%20%20%20*%200.59%0A%20%20%20%20*%200.79%0A%20%20%20%20*%200.99%0A%20%20%20%20%22%22%22%0A%20%20%20%20)%0A%20%20%20%20return%0A%0A%0A%40app.cell(hide_code%3DTrue)%0Adef%20_(mo)%3A%0A%20%20%20%20mo.md(%0A%20%20%20%20%20%20%20%20r%22%22%22%0A%20%20%20%20%23%23%23%20Answer%0A%0A%20%20%20%20Similar%20to%20what%20we%20obtained%20in%20question%204%20(as%20we%20are%20working%20with%20the%20same%20model%20and%20we%20used%20the%20same%20input)%20we%20obtained%20a%20churn%20estimated%20probability%20of%3A%20**0.534**.%0A%20%20%20%20%22%22%22%0A%20%20%20%20)%0A%20%20%20%20return%0A%0A%0A%40app.cell(hide_code%3DTrue)%0Adef%20_(mo)%3A%0A%20%20%20%20mo.md(%0A%20%20%20%20%20%20%20%20r%22%22%22%0A%20%20%20%20%23%23%20Submit%20the%20results%0A%0A%20%20%20%20*%20Submit%20your%20results%20here%3A%20https%3A%2F%2Fcourses.datatalks.club%2Fml-zoomcamp-2025%2Fhomework%2Fhw05%0A%20%20%20%20*%20If%20your%20answer%20doesn't%20match%20options%20exactly%2C%20select%20the%20closest%20one.%20If%20the%20answer%20is%20exactly%20in%20between%20two%20options%2C%20select%20the%20higher%20value.%0A%0A%0A%0A%20%20%20%20%23%23%20Publishing%20to%20Docker%20hub%0A%0A%20%20%20%20This%20is%20just%20for%20reference%2C%20this%20is%20how%20we%20published%20an%20image%20to%20Docker%20hub.%0A%0A%20%20%20%20%60Dockerfile_base%60%3A%20%0A%0A%20%20%20%20%60%60%60dockerfile%0A%20%20%20%20FROM%20python%3A3.13.5-slim-bookworm%0A%20%20%20%20WORKDIR%20%2Fcode%0A%20%20%20%20COPY%20pipeline_v2.bin%20.%0A%20%20%20%20%60%60%60%0A%0A%20%20%20%20Publishing%3A%0A%0A%20%20%20%20%60%60%60bash%0A%20%20%20%20docker%20build%20-t%20mlzoomcamp2025_hw5%20-f%20Dockerfile_base%20.%0A%20%20%20%20docker%20tag%20mlzoomcamp2025_hw5%3Alatest%20agrigorev%2Fzoomcamp-model%3A2025%0A%20%20%20%20docker%20push%20agrigorev%2Fzoomcamp-model%3A2025%0A%20%20%20%20%60%60%60%0A%20%20%20%20%22%22%22%0A%20%20%20%20)%0A%20%20%20%20return%0A%0A%0Aif%20__name__%20%3D%3D%20%22__main__%22%3A%0A%20%20%20%20app.run()%0A
</marimo-code>

<marimo-code-hash hidden="">3cd4d71cdfe13bd8338a094585ad52e1148ccdcdbfdeae64392494e378a8d482</marimo-code-hash>
</body>
</html>
