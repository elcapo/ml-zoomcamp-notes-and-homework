<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <link rel="icon" crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.16.0/dist/favicon.ico" />
    <!-- Preload is necessary because we show these images when we disconnect from the server,
    but at that point we cannot load these images from the server -->
    <link rel="preload" crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.16.0/dist/assets/gradient-yHQUC_QB.png" as="image" />
    <link rel="preload" crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.16.0/dist/assets/noise-60BoTA8O.png" as="image" />
    <!-- Preload the fonts -->
    <link rel="preload" crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.16.0/dist/assets/Lora-VariableFont_wght-B2ootaw-.ttf" as="font" crossorigin="anonymous" />
    <link rel="preload" crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.16.0/dist/assets/PTSans-Regular-CxL0S8W7.ttf" as="font" crossorigin="anonymous" />
    <link rel="preload" crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.16.0/dist/assets/PTSans-Bold-D9fedIX3.ttf" as="font" crossorigin="anonymous" />
    <link rel="preload" crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.16.0/dist/assets/FiraMono-Regular-BTCkDNvf.ttf" as="font" crossorigin="anonymous" />
    <link rel="preload" crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.16.0/dist/assets/FiraMono-Medium-DU3aDxX5.ttf" as="font" crossorigin="anonymous" />
    <link rel="preload" crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.16.0/dist/assets/FiraMono-Bold-CLVRCuM9.ttf" as="font" crossorigin="anonymous" />

    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="theme-color" content="#000000" />
    <meta name="description" content="a marimo app" />
    <link rel="apple-touch-icon" crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.16.0/dist/apple-touch-icon.png" />
    <link rel="manifest" crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.16.0/dist/manifest.json" />

    <script data-marimo="true">
      function __resizeIframe(obj) {
        var scrollbarHeight = 20; // Max between windows, mac, and linux

        function setHeight() {
          var element = obj.contentWindow.document.documentElement;
          // If there is no vertical scrollbar, we don't need to resize the iframe
          if (element.scrollHeight === element.clientHeight) {
            return;
          }

          // Create a new height that includes the scrollbar height if it's visible
          var hasHorizontalScrollbar = element.scrollWidth > element.clientWidth;
          var newHeight = element.scrollHeight + (hasHorizontalScrollbar ? scrollbarHeight : 0);

          // Only update the height if it's different from the current height
          if (obj.style.height !== `${newHeight}px`) {
            obj.style.height = `${newHeight}px`;
          }
        }

        // Resize the iframe to the height of the content and bottom scrollbar height
        setHeight();

        // Resize the iframe when the content changes
        const resizeObserver = new ResizeObserver((entries) => {
          setHeight();
        });
        resizeObserver.observe(obj.contentWindow.document.body);
      }
    </script>
    <marimo-filename hidden>homework.py</marimo-filename>
    <!-- TODO(Trevor): Legacy, required by VS Code plugin. Remove when plugin is updated (see marimo/server/_templates/template.py) -->
    <marimo-version data-version="{{ version }}" hidden></marimo-version>
    <marimo-user-config data-config="{{ user_config }}" hidden></marimo-user-config>
    <marimo-server-token data-token="{{ server_token }}" hidden></marimo-server-token>
    <!-- /TODO -->
    <title>homework</title>
    <script type="module" crossorigin crossorigin="anonymous" src="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.16.0/dist/assets/index-DKEudB02.js"></script>
    <link rel="stylesheet" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.16.0/dist/assets/index-Cx0bsY1w.css">
  
<script data-marimo="true">
    window.__MARIMO_STATIC__ = {};
    window.__MARIMO_STATIC__.files = {};
</script>
</head>
  <body>
    <div id="root"></div>
    <!-- This is a portal for the data editor to render in -->
    <div id="portal" data-testid="glide-portal" style="position: fixed; left: 0; top: 0; z-index: 9999"></div>
    <script data-marimo="true">
      window.__MARIMO_MOUNT_CONFIG__ = {
            "filename": "homework.py",
            "mode": "read",
            "version": "0.16.0",
            "serverToken": "static",
            "config": {"ai": {"models": {"custom_models": [], "displayed_models": []}}, "completion": {"activate_on_typing": true, "copilot": false}, "display": {"cell_output": "above", "code_editor_font_size": 14, "dataframes": "rich", "default_table_max_columns": 50, "default_table_page_size": 10, "default_width": "medium", "reference_highlighting": false, "theme": "light"}, "formatting": {"line_length": 79}, "keymap": {"overrides": {}, "preset": "default"}, "language_servers": {"pylsp": {"enable_flake8": false, "enable_mypy": true, "enable_pydocstyle": false, "enable_pyflakes": false, "enable_pylint": false, "enable_ruff": true, "enabled": true}}, "package_management": {"manager": "pip"}, "runtime": {"auto_instantiate": true, "auto_reload": "off", "default_sql_output": "auto", "on_cell_change": "autorun", "output_max_bytes": 8000000, "reactive_tests": true, "std_stream_max_bytes": 1000000, "watcher_on_save": "lazy"}, "save": {"autosave": "after_delay", "autosave_delay": 1000, "format_on_save": false}, "server": {"browser": "default", "follow_symlink": false}, "snippets": {"custom_paths": [], "include_default_snippets": true}},
            "configOverrides": {},
            "appConfig": {"sql_output": "auto", "width": "medium"},
            "view": {"showAppCode": true},
            "notebook": {"cells": [{"code": "import marimo as mo\nimport pandas as pd\nimport numpy as np\nimport matplotlib.pyplot as plt\nimport seaborn as sns", "code_hash": "e76e8dbe4d9bf74eff98fef5f002130b", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "Hbol", "name": "_"}, {"code": "mo.md(\n    r\"\"\"\n# Module 4: [Evaluation](https://github.com/DataTalksClub/machine-learning-zoomcamp/tree/master/04-evaluation)\n\n## Homework\n\n### Dataset\n\nFor this homework, we'll use the lead scoring Bank Marketing dataset. Download it from here. You can do it with wget:\n\nwget [https://raw.githubusercontent.com/alexeygrigorev/datasets/master/course_lead_scoring.csv](https://raw.githubusercontent.com/alexeygrigorev/datasets/master/course_lead_scoring.csv)\n\nIn this dataset our desired target for classification task will be **converted** variable - has the client signed up to the platform or not.\n\"\"\"\n)", "code_hash": "5935c1aff22d411ae290e429520e51d5", "config": {"column": null, "disabled": false, "hide_code": true}, "id": "MJUe", "name": "_"}, {"code": "def read_dataframe():\n    return pd.read_csv(\"./module-4/data/course_lead_scoring.csv\")\n\nraw_dataframe = read_dataframe()\nraw_dataframe.head()", "code_hash": "2d7ae8cfb88a00fc323d840f14c1f81e", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "vblA", "name": "_"}, {"code": "mo.md(\n    r\"\"\"\n## Data preparation\n\n### Check if the missing values are presented in the features\n\"\"\"\n)", "code_hash": "04e7f3ba0031727b2c3ccfe11cc6da3e", "config": {"column": null, "disabled": false, "hide_code": true}, "id": "bkHC", "name": "_"}, {"code": "raw_dataframe.isnull().sum()", "code_hash": "03967554aa13b8649ea859cee703e506", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "lEQa", "name": "_"}, {"code": "mo.md(\n    r\"\"\"\n### If there are missing values:\n\n#### For categorical features, replace them with 'NA'\n\"\"\"\n)", "code_hash": "7c11c1bfa5ee3a31b904e319bf2425c1", "config": {"column": null, "disabled": false, "hide_code": true}, "id": "PKri", "name": "_"}, {"code": "categorical_columns = [\"lead_source\", \"industry\", \"employment_status\", \"location\"]\n\ndef fill_categorical_values(dataframe):\n    dataframe[categorical_columns] = dataframe[categorical_columns].fillna('NA')\n\n    return dataframe\n\nfill_categorical_values(raw_dataframe).head()", "code_hash": "bcb93a5fba257250f4ed8448c4b1b4b0", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "Xref", "name": "_"}, {"code": "mo.md(r\"\"\"#### For numerical features, replace with with 0.0\"\"\")", "code_hash": "0cc9e64f50f00f179f271a5088c6bcbf", "config": {"column": null, "disabled": false, "hide_code": true}, "id": "SFPL", "name": "_"}, {"code": "numeric_columns = [\"number_of_courses_viewed\", \"annual_income\", \"interaction_count\", \"lead_score\"]\n\ndef fill_numerical_values(dataframe):\n    dataframe[numeric_columns] = dataframe[numeric_columns].fillna(0.0)\n\n    return dataframe\n\nfill_numerical_values(raw_dataframe).head()", "code_hash": "fdbb551bb24285c4818cea49cb225d40", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "BYtC", "name": "_"}, {"code": "filled_dataframe = fill_numerical_values(fill_categorical_values(raw_dataframe.copy()))\nfilled_dataframe.head()", "code_hash": "6bf4b01a402e968d37afda08ae2b8054", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "RGSE", "name": "_"}, {"code": "mo.md(\n    r\"\"\"\n#### Split the data into 3 parts\n\nSplit the data into 3 parts: train/validation/test with 60% / 20% / 20% distribution. Use train_test_split function for that with random_state=1.\n\"\"\"\n)", "code_hash": "bc1e10e642a8e75e830e53d677d99a58", "config": {"column": null, "disabled": false, "hide_code": true}, "id": "Kclp", "name": "_"}, {"code": "from sklearn.model_selection import train_test_split\n\nfull_dataframe, test_dataframe = train_test_split(filled_dataframe, test_size=0.2, random_state=1)\ntrain_dataframe, val_dataframe = train_test_split(full_dataframe, test_size=0.25, random_state=1)\n\n{\n    \"len(train_dataframe)\": len(train_dataframe),\n    \"len(val_dataframe)\": len(val_dataframe),\n    \"len(test_dataframe)\": len(test_dataframe),\n}", "code_hash": "67d57567961c161b7d6612aab59b6345", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "emfo", "name": "_"}, {"code": "mo.md(\n    r\"\"\"\n## Question 1: ROC AUC feature importance\n\nROC AUC could also be used to evaluate feature importance of numerical variables. \n\nLet's do that\n\n* For each numerical variable, use it as score (aka prediction) and compute the AUC with the `y` variable as ground truth.\n* Use the training dataset for that\n\n\nIf your AUC is < 0.5, invert this variable by putting \"-\" in front\n\n(e.g. `-df_train['balance']`)\n\nAUC can go below 0.5 if the variable is negatively correlated with the target variable. You can change the direction of the correlation by negating this variable - then negative correlation becomes positive.\n\"\"\"\n)", "code_hash": "485e279a2e672f13266c042264563ec6", "config": {"column": null, "disabled": false, "hide_code": true}, "id": "Hstk", "name": "_"}, {"code": "from sklearn.metrics import roc_auc_score\n\ndef compute_auc_for_numeric_features(dataframe: pd.DataFrame) -> dict:\n    auc_scores = {}\n\n    for feature in numeric_columns:\n        auc_scores[feature] = roc_auc_score(dataframe.converted, dataframe[feature])\n\n    return auc_scores\n\ncompute_auc_for_numeric_features(train_dataframe)", "code_hash": "5db208473013165ef8b7af585357f2ea", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "nWHF", "name": "_"}, {"code": "mo.md(\n    r\"\"\"\nWhich numerical variable (among the following 4) has the highest AUC?\n\n- `lead_score`\n- `number_of_courses_viewed`\n- `interaction_count`\n- `annual_income`\n\"\"\"\n)", "code_hash": "49f125d5b1530c70882e6c8f64fe3c2f", "config": {"column": null, "disabled": false, "hide_code": true}, "id": "iLit", "name": "_"}, {"code": "mo.md(r\"\"\"The `number_of_courses_viewed` feature has the highest AUC with a value of $0.7564$.\"\"\")", "code_hash": "cfe901da89c18e563e763f4307a1f903", "config": {"column": null, "disabled": false, "hide_code": true}, "id": "ZHCJ", "name": "_"}, {"code": "mo.md(\n    r\"\"\"\n### Question 2: Training the model\n\nApply one-hot-encoding using `DictVectorizer` and train the logistic regression with these parameters:\n\n```python\nLogisticRegression(solver='liblinear', C=1.0, max_iter=1000)\n```\n\"\"\"\n)", "code_hash": "ca351cd24e9137492607482f23cca337", "config": {"column": null, "disabled": false, "hide_code": true}, "id": "ROlb", "name": "_"}, {"code": "from sklearn.linear_model import LogisticRegression\nfrom sklearn.feature_extraction import DictVectorizer\n\ndef separate_target(dataframe: pd.DataFrame):\n    y = dataframe.converted\n    X = dataframe.drop(columns=['converted'])\n    return X[numeric_columns + categorical_columns], y\n\ndef train(dataframe: pd.DataFrame):\n    X, y = separate_target(dataframe)\n\n    dict_vectorizer = DictVectorizer(sparse=False)\n    X_dict = dict_vectorizer.fit_transform(X.to_dict(orient=\"records\"))\n\n    model = LogisticRegression(solver='liblinear', C=1.0, max_iter=1000, random_state=1)\n    model.fit(X_dict, y)\n\n    return dict_vectorizer, model\n\ndef evaluate(\n    model: LogisticRegression,\n    dict_vectorizer: DictVectorizer,\n    dataframe: pd.DataFrame\n) -> float:\n    X, y = separate_target(dataframe)\n    X_dict = dict_vectorizer.transform(X.to_dict(orient=\"records\"))\n\n    y_pred = model.predict_proba(X_dict)[:, 1] >= 0.55\n\n    return round(roc_auc_score(y, y_pred), 3)\n\ndict_vectorizer, model = train(train_dataframe)\nevaluate(model, dict_vectorizer, val_dataframe)", "code_hash": "d3991a63b92369be080291ea0fb57309", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "qnkX", "name": "_"}, {"code": "mo.md(\n    r\"\"\"\nWhat's the AUC of this model on the validation dataset? (round to 3 digits)\n\n- 0.32\n- 0.52\n- 0.72\n- 0.92\n\"\"\"\n)", "code_hash": "17fcf33ebc7a4c24e8cf2b24c5b6aa3b", "config": {"column": null, "disabled": false, "hide_code": true}, "id": "TqIu", "name": "_"}, {"code": "mo.md(r\"\"\"The closest suggested answer to the AUC of this model is 0.72.\"\"\")", "code_hash": "9e7bfa835d94bcfbeb969ad1946a3ca2", "config": {"column": null, "disabled": false, "hide_code": true}, "id": "Vxnm", "name": "_"}, {"code": "mo.md(\n    r\"\"\"\n### Question 3: Precision and Recall\n\nNow let's compute precision and recall for our model.\n\n* Evaluate the model on all thresholds from 0.0 to 1.0 with step 0.01\n* For each threshold, compute precision and recall\n* Plot them\n\"\"\"\n)", "code_hash": "e91df18f7d004ab032b841aa6d1db6c9", "config": {"column": null, "disabled": false, "hide_code": true}, "id": "DnEU", "name": "_"}, {"code": "from sklearn.metrics import recall_score, precision_score\n\ndef precision_and_recall_for_threshold(\n    model: LogisticRegression,\n    dict_vectorizer: DictVectorizer,\n    dataframe: pd.DataFrame,\n    threshold: float\n) -> tuple:\n    X, y = separate_target(dataframe)\n    X_dict = dict_vectorizer.transform(X.to_dict(orient=\"records\"))\n    y_pred = model.predict_proba(X_dict)[:, 1] >= threshold\n\n    return precision_score(y, y_pred, zero_division=1.0), recall_score(y, y_pred)\n\ndef evaluate_precision_and_recall(\n    model: LogisticRegression,\n    dict_vectorizer: DictVectorizer,\n    dataframe: pd.DataFrame,\n) -> list:\n    evaluation = []\n\n    for threshold in np.linspace(0, 1, 100):\n        precision, recall = precision_and_recall_for_threshold(model, dict_vectorizer, dataframe, threshold)\n        evaluation.append((threshold, precision, recall,))\n\n    return pd.DataFrame(evaluation, columns=[\"threshold\", \"precision\", \"recall\"])\n\ndef plot_precision_and_recall(\n    model: LogisticRegression,\n    dict_vectorizer: DictVectorizer,\n    dataframe: pd.DataFrame,\n):\n    evaluation = evaluate_precision_and_recall(model, dict_vectorizer, dataframe)\n\n    plt.plot(evaluation.threshold, evaluation.precision, label=\"Precision\", color=\"g\")\n    plt.plot(evaluation.threshold, evaluation.recall, label=\"Recall\", color=\"r\")\n    plt.vlines(0.64, 0, 1)\n    plt.xlabel(\"Threshold\")\n    plt.show()\n\nplot_precision_and_recall(model, dict_vectorizer, val_dataframe)", "code_hash": "7176a08ad86999a7b55097c0eeebc370", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "ulZA", "name": "_"}, {"code": "mo.md(\n    r\"\"\"\nAt which threshold precision and recall curves intersect?\n\n* 0.145\n* 0.345\n* 0.545\n* 0.745\n\"\"\"\n)", "code_hash": "64fcc06bea26d9772927dab1c0b6ac20", "config": {"column": null, "disabled": false, "hide_code": true}, "id": "ecfG", "name": "_"}, {"code": "mo.md(r\"\"\"The closest suggested is 0.545.\"\"\")", "code_hash": "ea81a6eb5eb43c8c6251399a4c92c92a", "config": {"column": null, "disabled": false, "hide_code": true}, "id": "Pvdt", "name": "_"}, {"code": "mo.md(\n    r\"\"\"\n### Question 4: F1 score\n\nPrecision and recall are conflicting - when one grows, the other goes down. That's why they are often combined into the F1 score - a metrics that takes into account both\n\nThis is the formula for computing F1:\n\n$$F_1 = 2 \\cdot \\cfrac{P \\cdot R}{P + R}$$\n\nWhere $P$ is precision and $R$ is recall.\n\nLet's compute F1 for all thresholds from 0.0 to 1.0 with increment 0.01\n\"\"\"\n)", "code_hash": "a7cbb97b422ddff86e6e66416adacada", "config": {"column": null, "disabled": false, "hide_code": true}, "id": "ZBYS", "name": "_"}, {"code": "def evaluate_with_f1(\n    model: LogisticRegression,\n    dict_vectorizer: DictVectorizer,\n    dataframe: pd.DataFrame,\n):\n    evaluation = evaluate_precision_and_recall(model, dict_vectorizer, dataframe)\n    evaluation[\"f1\"] = 2 * evaluation.precision * evaluation.recall / (evaluation.precision + evaluation.recall)\n\n    return evaluation\n\ndef plot_f1(evaluation: pd.DataFrame):\n    plt.plot(evaluation.threshold, evaluation.f1, label=\"F1\", color=\"b\")\n    plt.xlabel(\"Threshold\")\n    plt.show()\n\ndef find_max(evaluation: pd.DataFrame):\n    f1_max = evaluation[evaluation.f1 == evaluation.f1.max()].iloc[0]\n    print(\"F1 max is {:.3f} and it's reach at {:.3f}\".format(f1_max.f1, f1_max.threshold))\n\nf1_evaluation = evaluate_with_f1(model, dict_vectorizer, val_dataframe)\nplot_f1(f1_evaluation)\nfind_max(f1_evaluation)", "code_hash": "53d76db0edd07fea59effbb1d3b408ff", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "aLJB", "name": "_"}, {"code": "mo.md(\n    r\"\"\"\nAt which threshold F1 is maximal?\n\n- 0.14\n- 0.34\n- 0.54\n- 0.74\n\"\"\"\n)", "code_hash": "95ce9198c365fd65cdca84f2dfee198c", "config": {"column": null, "disabled": false, "hide_code": true}, "id": "nHfw", "name": "_"}, {"code": "mo.md(r\"\"\"The closest suggested option to the threshold where F1 is maximal is 0.54.\"\"\")", "code_hash": "04a5905af0ad0c18ece1361d22910a10", "config": {"column": null, "disabled": false, "hide_code": true}, "id": "xXTn", "name": "_"}, {"code": "mo.md(\n    r\"\"\"\n## Question 5: 5-Fold CV\n\n\nUse the `KFold` class from Scikit-Learn to evaluate our model on 5 different folds:\n\n```\nKFold(n_splits=5, shuffle=True, random_state=1)\n```\n\n* Iterate over different folds of `df_full_train`\n* Split the data into train and validation\n* Train the model on train with these parameters: `LogisticRegression(solver='liblinear', C=1.0, max_iter=1000)`\n* Use AUC to evaluate the model on validation\n\"\"\"\n)", "code_hash": "bf9bfafe3e3d64ece01622d5e1eb2c9f", "config": {"column": null, "disabled": false, "hide_code": true}, "id": "AjVT", "name": "_"}, {"code": "from sklearn.model_selection import KFold\n\ndef get_trained_vectorizer(dataframe: pd.DataFrame) -> list[dict]:\n    copy = dataframe.copy()\n    del copy[\"converted\"]\n    dictionary = copy.to_dict(orient=\"records\")\n\n    dict_vectorizer = DictVectorizer(sparse=False)\n    dict_vectorizer.fit(dictionary)\n\n    return dict_vectorizer, dictionary\n\ndef get_features_and_target(dataframe: pd.DataFrame, dict_vectorizer: DictVectorizer, dictionary):\n    X = dict_vectorizer.transform(dictionary)\n    y = dataframe.converted == 1\n\n    return X, y\n\ndef train_folds(df_full: pd.DataFrame):\n    kfolds = KFold(n_splits=5, shuffle=True, random_state=1)\n\n    auc_scores = []\n    for train_idx, val_idx in kfolds.split(df_full):\n        df_train = df_full.iloc[train_idx]\n        df_val = df_full.iloc[val_idx]\n\n        dict_vectorizer, dictionary = get_trained_vectorizer(df_train)\n        X_train, y_train = get_features_and_target(df_train, dict_vectorizer, dictionary)\n\n        model = LogisticRegression(solver='liblinear', C=1.0, max_iter=1000)\n        model.fit(X_train, y_train)\n\n        dictionary_val = df_val[numeric_columns + categorical_columns].to_dict(orient=\"records\")\n        X_val, y_val = get_features_and_target(df_val, dict_vectorizer, dictionary_val)\n        y_pred = model.predict_proba(X_val)[:,1]\n\n        auc_scores.append(roc_auc_score(y_val, y_pred))\n\n    print(\"{:.3f} +- {:.3f}\".format(np.mean(auc_scores), np.std(auc_scores)))\n\n    return auc_scores\n\ntrain_folds(full_dataframe)", "code_hash": "4ce5e4021bab2861a8cc18ca7712d400", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "pHFh", "name": "_"}, {"code": "mo.md(\n    r\"\"\"\nHow large is standard deviation of the scores across different folds?\n\n- 0.0001\n- 0.006\n- 0.06\n- 0.36\n\"\"\"\n)", "code_hash": "712db2359ce2b2894bbbc33fec5558ba", "config": {"column": null, "disabled": false, "hide_code": true}, "id": "NCOB", "name": "_"}, {"code": "mo.md(r\"\"\"The closest value to the standard deviation across folds is $0.06$.\"\"\")", "code_hash": "f65e5fac26d801cc9e0def75172c9563", "config": {"column": null, "disabled": false, "hide_code": true}, "id": "aqbW", "name": "_"}, {"code": "mo.md(\n    r\"\"\"\n### Question 6: Hyperparameter Tuning\n\nNow let's use 5-Fold cross-validation to find the best parameter `C`\n\n* Iterate over the following `C` values: `[0.000001, 0.001, 1]`\n* Initialize `KFold` with the same parameters as previously\n* Use these parameters for the model: `LogisticRegression(solver='liblinear', C=C, max_iter=1000)`\n* Compute the mean score as well as the std (round the mean and std to 3 decimal digits)\n\"\"\"\n)", "code_hash": "2fa6fbc273f7c15d820188b7d7486c24", "config": {"column": null, "disabled": false, "hide_code": true}, "id": "TRpd", "name": "_"}, {"code": "def hypertune_folds(df_full: pd.DataFrame, C: float):\n    kfolds = KFold(n_splits=5, shuffle=True, random_state=1)\n\n    auc_scores = []\n    for train_idx, val_idx in kfolds.split(df_full):\n        df_train = df_full.iloc[train_idx]\n        df_val = df_full.iloc[val_idx]\n\n        dict_vectorizer, dictionary = get_trained_vectorizer(df_train)\n        X_train, y_train = get_features_and_target(df_train, dict_vectorizer, dictionary)\n\n        model = LogisticRegression(solver='liblinear', C=C, max_iter=1000)\n        model.fit(X_train, y_train)\n\n        dictionary_val = df_val[numeric_columns + categorical_columns].to_dict(orient=\"records\")\n        X_val, y_val = get_features_and_target(df_val, dict_vectorizer, dictionary_val)\n        y_pred = model.predict_proba(X_val)[:,1]\n\n        auc_scores.append(roc_auc_score(y_val, y_pred))\n\n    print(\"C={:.3f}: {:.3f} +- {:.3f}\".format(C, np.mean(auc_scores), np.std(auc_scores)))\n\n    return auc_scores\n\ndef test_c_values(df_full: pd.DataFrame, C_values: list[float]):\n    auc_scores = []\n    for C_value in C_values:\n        auc_scores.append(hypertune_folds(full_dataframe, C_value))\n\n    return auc_scores\n\ntest_c_values(full_dataframe, [0.000001, 0.001, 1])", "code_hash": "18970ed384b81483f5cf72352b07f066", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "TXez", "name": "_"}, {"code": "mo.md(\n    r\"\"\"\nWhich `C` leads to the best mean score?\n\n- 0.000001\n- 0.001\n- 1\n\"\"\"\n)", "code_hash": "f27c1cacf78cde56544040a25ecccb5a", "config": {"column": null, "disabled": false, "hide_code": true}, "id": "dNNg", "name": "_"}, {"code": "mo.md(r\"\"\"The best score corresponds to $C = 0.001$.\"\"\")", "code_hash": "53030797b16d22625eb489d11f202249", "config": {"column": null, "disabled": false, "hide_code": true}, "id": "yCnT", "name": "_"}], "metadata": {"marimo_version": "0.16.0"}, "version": "1"},
            "session": {"cells": [{"code_hash": "e76e8dbe4d9bf74eff98fef5f002130b", "console": [], "id": "Hbol", "outputs": [{"data": {"text/plain": ""}, "type": "data"}]}, {"code_hash": "5935c1aff22d411ae290e429520e51d5", "console": [], "id": "MJUe", "outputs": [{"data": {"text/html": "<span class=\"markdown prose dark:prose-invert\"><h1 id=\"module-4-evaluation\">Module 4: <a href=\"https://github.com/DataTalksClub/machine-learning-zoomcamp/tree/master/04-evaluation\" rel=\"noopener\" target=\"_blank\">Evaluation</a></h1>\n<h2 id=\"homework\">Homework</h2>\n<h3 id=\"dataset\">Dataset</h3>\n<span class=\"paragraph\">For this homework, we'll use the lead scoring Bank Marketing dataset. Download it from here. You can do it with wget:</span>\n<span class=\"paragraph\">wget <a href=\"https://raw.githubusercontent.com/alexeygrigorev/datasets/master/course_lead_scoring.csv\" rel=\"noopener\" target=\"_blank\">https://raw.githubusercontent.com/alexeygrigorev/datasets/master/course_lead_scoring.csv</a></span>\n<span class=\"paragraph\">In this dataset our desired target for classification task will be <strong>converted</strong> variable - has the client signed up to the platform or not.</span></span>"}, "type": "data"}]}, {"code_hash": "2d7ae8cfb88a00fc323d840f14c1f81e", "console": [], "id": "vblA", "outputs": [{"data": {"text/html": "<marimo-ui-element object-id='vblA-0' random-id='e6405b0d-a9fe-e1d5-823c-ab9dceccb9a8'><marimo-table data-initial-value='[]' data-label='null' data-data='&quot;[{&#92;&quot;lead_source&#92;&quot;:&#92;&quot;paid_ads&#92;&quot;,&#92;&quot;industry&#92;&quot;:null,&#92;&quot;number_of_courses_viewed&#92;&quot;:1,&#92;&quot;annual_income&#92;&quot;:79450.0,&#92;&quot;employment_status&#92;&quot;:&#92;&quot;unemployed&#92;&quot;,&#92;&quot;location&#92;&quot;:&#92;&quot;south_america&#92;&quot;,&#92;&quot;interaction_count&#92;&quot;:4,&#92;&quot;lead_score&#92;&quot;:0.94,&#92;&quot;converted&#92;&quot;:1},{&#92;&quot;lead_source&#92;&quot;:&#92;&quot;social_media&#92;&quot;,&#92;&quot;industry&#92;&quot;:&#92;&quot;retail&#92;&quot;,&#92;&quot;number_of_courses_viewed&#92;&quot;:1,&#92;&quot;annual_income&#92;&quot;:46992.0,&#92;&quot;employment_status&#92;&quot;:&#92;&quot;employed&#92;&quot;,&#92;&quot;location&#92;&quot;:&#92;&quot;south_america&#92;&quot;,&#92;&quot;interaction_count&#92;&quot;:1,&#92;&quot;lead_score&#92;&quot;:0.8,&#92;&quot;converted&#92;&quot;:0},{&#92;&quot;lead_source&#92;&quot;:&#92;&quot;events&#92;&quot;,&#92;&quot;industry&#92;&quot;:&#92;&quot;healthcare&#92;&quot;,&#92;&quot;number_of_courses_viewed&#92;&quot;:5,&#92;&quot;annual_income&#92;&quot;:78796.0,&#92;&quot;employment_status&#92;&quot;:&#92;&quot;unemployed&#92;&quot;,&#92;&quot;location&#92;&quot;:&#92;&quot;australia&#92;&quot;,&#92;&quot;interaction_count&#92;&quot;:3,&#92;&quot;lead_score&#92;&quot;:0.69,&#92;&quot;converted&#92;&quot;:1},{&#92;&quot;lead_source&#92;&quot;:&#92;&quot;paid_ads&#92;&quot;,&#92;&quot;industry&#92;&quot;:&#92;&quot;retail&#92;&quot;,&#92;&quot;number_of_courses_viewed&#92;&quot;:2,&#92;&quot;annual_income&#92;&quot;:83843.0,&#92;&quot;employment_status&#92;&quot;:null,&#92;&quot;location&#92;&quot;:&#92;&quot;australia&#92;&quot;,&#92;&quot;interaction_count&#92;&quot;:1,&#92;&quot;lead_score&#92;&quot;:0.87,&#92;&quot;converted&#92;&quot;:0},{&#92;&quot;lead_source&#92;&quot;:&#92;&quot;referral&#92;&quot;,&#92;&quot;industry&#92;&quot;:&#92;&quot;education&#92;&quot;,&#92;&quot;number_of_courses_viewed&#92;&quot;:3,&#92;&quot;annual_income&#92;&quot;:85012.0,&#92;&quot;employment_status&#92;&quot;:&#92;&quot;self_employed&#92;&quot;,&#92;&quot;location&#92;&quot;:&#92;&quot;europe&#92;&quot;,&#92;&quot;interaction_count&#92;&quot;:3,&#92;&quot;lead_score&#92;&quot;:0.62,&#92;&quot;converted&#92;&quot;:1}]&quot;' data-total-rows='5' data-total-columns='9' data-max-columns='50' data-banner-text='&quot;&quot;' data-pagination='true' data-page-size='10' data-field-types='[[&quot;lead_source&quot;,[&quot;string&quot;,&quot;object&quot;]],[&quot;industry&quot;,[&quot;string&quot;,&quot;object&quot;]],[&quot;number_of_courses_viewed&quot;,[&quot;integer&quot;,&quot;int64&quot;]],[&quot;annual_income&quot;,[&quot;number&quot;,&quot;float64&quot;]],[&quot;employment_status&quot;,[&quot;string&quot;,&quot;object&quot;]],[&quot;location&quot;,[&quot;string&quot;,&quot;object&quot;]],[&quot;interaction_count&quot;,[&quot;integer&quot;,&quot;int64&quot;]],[&quot;lead_score&quot;,[&quot;number&quot;,&quot;float64&quot;]],[&quot;converted&quot;,[&quot;integer&quot;,&quot;int64&quot;]]]' data-show-filters='true' data-show-download='true' data-show-column-summaries='false' data-show-data-types='true' data-show-page-size-selector='false' data-show-column-explorer='true' data-show-chart-builder='true' data-row-headers='[]' data-has-stable-row-id='false' data-lazy='false' data-preload='false'></marimo-table></marimo-ui-element>"}, "type": "data"}]}, {"code_hash": "04e7f3ba0031727b2c3ccfe11cc6da3e", "console": [], "id": "bkHC", "outputs": [{"data": {"text/html": "<span class=\"markdown prose dark:prose-invert\"><h2 id=\"data-preparation\">Data preparation</h2>\n<h3 id=\"check-if-the-missing-values-are-presented-in-the-features\">Check if the missing values are presented in the features</h3></span>"}, "type": "data"}]}, {"code_hash": "03967554aa13b8649ea859cee703e506", "console": [], "id": "lEQa", "outputs": [{"data": {"text/html": "<marimo-ui-element object-id='lEQa-0' random-id='4fcb9b89-c77f-0836-2049-9569c5c2a8b5'><marimo-table data-initial-value='[]' data-label='null' data-data='&quot;[{&#92;&quot;&#92;&quot;:&#92;&quot;lead_source&#92;&quot;,&#92;&quot;value&#92;&quot;:128},{&#92;&quot;&#92;&quot;:&#92;&quot;industry&#92;&quot;,&#92;&quot;value&#92;&quot;:134},{&#92;&quot;&#92;&quot;:&#92;&quot;number_of_courses_viewed&#92;&quot;,&#92;&quot;value&#92;&quot;:0},{&#92;&quot;&#92;&quot;:&#92;&quot;annual_income&#92;&quot;,&#92;&quot;value&#92;&quot;:181},{&#92;&quot;&#92;&quot;:&#92;&quot;employment_status&#92;&quot;,&#92;&quot;value&#92;&quot;:100},{&#92;&quot;&#92;&quot;:&#92;&quot;location&#92;&quot;,&#92;&quot;value&#92;&quot;:63},{&#92;&quot;&#92;&quot;:&#92;&quot;interaction_count&#92;&quot;,&#92;&quot;value&#92;&quot;:0},{&#92;&quot;&#92;&quot;:&#92;&quot;lead_score&#92;&quot;,&#92;&quot;value&#92;&quot;:0},{&#92;&quot;&#92;&quot;:&#92;&quot;converted&#92;&quot;,&#92;&quot;value&#92;&quot;:0}]&quot;' data-total-rows='9' data-total-columns='1' data-max-columns='50' data-banner-text='&quot;&quot;' data-pagination='true' data-page-size='10' data-field-types='[[&quot;value&quot;,[&quot;integer&quot;,&quot;int64&quot;]]]' data-show-filters='true' data-show-download='true' data-show-column-summaries='false' data-show-data-types='true' data-show-page-size-selector='true' data-show-column-explorer='true' data-show-chart-builder='true' data-row-headers='[[&quot;&quot;,[&quot;string&quot;,&quot;object&quot;]]]' data-has-stable-row-id='false' data-lazy='false' data-preload='false'></marimo-table></marimo-ui-element>"}, "type": "data"}]}, {"code_hash": "7c11c1bfa5ee3a31b904e319bf2425c1", "console": [], "id": "PKri", "outputs": [{"data": {"text/html": "<span class=\"markdown prose dark:prose-invert\"><h3 id=\"if-there-are-missing-values\">If there are missing values:</h3>\n<h4 id=\"for-categorical-features-replace-them-with-na\">For categorical features, replace them with 'NA'</h4></span>"}, "type": "data"}]}, {"code_hash": "bcb93a5fba257250f4ed8448c4b1b4b0", "console": [], "id": "Xref", "outputs": [{"data": {"text/html": "<marimo-ui-element object-id='Xref-0' random-id='5c1e813a-5a48-9a32-1212-2a0f17d7ec8e'><marimo-table data-initial-value='[]' data-label='null' data-data='&quot;[{&#92;&quot;lead_source&#92;&quot;:&#92;&quot;paid_ads&#92;&quot;,&#92;&quot;industry&#92;&quot;:&#92;&quot;NA&#92;&quot;,&#92;&quot;number_of_courses_viewed&#92;&quot;:1,&#92;&quot;annual_income&#92;&quot;:79450.0,&#92;&quot;employment_status&#92;&quot;:&#92;&quot;unemployed&#92;&quot;,&#92;&quot;location&#92;&quot;:&#92;&quot;south_america&#92;&quot;,&#92;&quot;interaction_count&#92;&quot;:4,&#92;&quot;lead_score&#92;&quot;:0.94,&#92;&quot;converted&#92;&quot;:1},{&#92;&quot;lead_source&#92;&quot;:&#92;&quot;social_media&#92;&quot;,&#92;&quot;industry&#92;&quot;:&#92;&quot;retail&#92;&quot;,&#92;&quot;number_of_courses_viewed&#92;&quot;:1,&#92;&quot;annual_income&#92;&quot;:46992.0,&#92;&quot;employment_status&#92;&quot;:&#92;&quot;employed&#92;&quot;,&#92;&quot;location&#92;&quot;:&#92;&quot;south_america&#92;&quot;,&#92;&quot;interaction_count&#92;&quot;:1,&#92;&quot;lead_score&#92;&quot;:0.8,&#92;&quot;converted&#92;&quot;:0},{&#92;&quot;lead_source&#92;&quot;:&#92;&quot;events&#92;&quot;,&#92;&quot;industry&#92;&quot;:&#92;&quot;healthcare&#92;&quot;,&#92;&quot;number_of_courses_viewed&#92;&quot;:5,&#92;&quot;annual_income&#92;&quot;:78796.0,&#92;&quot;employment_status&#92;&quot;:&#92;&quot;unemployed&#92;&quot;,&#92;&quot;location&#92;&quot;:&#92;&quot;australia&#92;&quot;,&#92;&quot;interaction_count&#92;&quot;:3,&#92;&quot;lead_score&#92;&quot;:0.69,&#92;&quot;converted&#92;&quot;:1},{&#92;&quot;lead_source&#92;&quot;:&#92;&quot;paid_ads&#92;&quot;,&#92;&quot;industry&#92;&quot;:&#92;&quot;retail&#92;&quot;,&#92;&quot;number_of_courses_viewed&#92;&quot;:2,&#92;&quot;annual_income&#92;&quot;:83843.0,&#92;&quot;employment_status&#92;&quot;:&#92;&quot;NA&#92;&quot;,&#92;&quot;location&#92;&quot;:&#92;&quot;australia&#92;&quot;,&#92;&quot;interaction_count&#92;&quot;:1,&#92;&quot;lead_score&#92;&quot;:0.87,&#92;&quot;converted&#92;&quot;:0},{&#92;&quot;lead_source&#92;&quot;:&#92;&quot;referral&#92;&quot;,&#92;&quot;industry&#92;&quot;:&#92;&quot;education&#92;&quot;,&#92;&quot;number_of_courses_viewed&#92;&quot;:3,&#92;&quot;annual_income&#92;&quot;:85012.0,&#92;&quot;employment_status&#92;&quot;:&#92;&quot;self_employed&#92;&quot;,&#92;&quot;location&#92;&quot;:&#92;&quot;europe&#92;&quot;,&#92;&quot;interaction_count&#92;&quot;:3,&#92;&quot;lead_score&#92;&quot;:0.62,&#92;&quot;converted&#92;&quot;:1}]&quot;' data-total-rows='5' data-total-columns='9' data-max-columns='50' data-banner-text='&quot;&quot;' data-pagination='true' data-page-size='10' data-field-types='[[&quot;lead_source&quot;,[&quot;string&quot;,&quot;object&quot;]],[&quot;industry&quot;,[&quot;string&quot;,&quot;object&quot;]],[&quot;number_of_courses_viewed&quot;,[&quot;integer&quot;,&quot;int64&quot;]],[&quot;annual_income&quot;,[&quot;number&quot;,&quot;float64&quot;]],[&quot;employment_status&quot;,[&quot;string&quot;,&quot;object&quot;]],[&quot;location&quot;,[&quot;string&quot;,&quot;object&quot;]],[&quot;interaction_count&quot;,[&quot;integer&quot;,&quot;int64&quot;]],[&quot;lead_score&quot;,[&quot;number&quot;,&quot;float64&quot;]],[&quot;converted&quot;,[&quot;integer&quot;,&quot;int64&quot;]]]' data-show-filters='true' data-show-download='true' data-show-column-summaries='false' data-show-data-types='true' data-show-page-size-selector='false' data-show-column-explorer='true' data-show-chart-builder='true' data-row-headers='[]' data-has-stable-row-id='false' data-lazy='false' data-preload='false'></marimo-table></marimo-ui-element>"}, "type": "data"}]}, {"code_hash": "0cc9e64f50f00f179f271a5088c6bcbf", "console": [], "id": "SFPL", "outputs": [{"data": {"text/html": "<span class=\"markdown prose dark:prose-invert\"><h4 id=\"for-numerical-features-replace-with-with-00\">For numerical features, replace with with 0.0</h4></span>"}, "type": "data"}]}, {"code_hash": "fdbb551bb24285c4818cea49cb225d40", "console": [], "id": "BYtC", "outputs": [{"data": {"text/html": "<marimo-ui-element object-id='BYtC-0' random-id='c50f0925-864d-acef-1d73-da3191695725'><marimo-table data-initial-value='[]' data-label='null' data-data='&quot;[{&#92;&quot;lead_source&#92;&quot;:&#92;&quot;paid_ads&#92;&quot;,&#92;&quot;industry&#92;&quot;:&#92;&quot;NA&#92;&quot;,&#92;&quot;number_of_courses_viewed&#92;&quot;:1,&#92;&quot;annual_income&#92;&quot;:79450.0,&#92;&quot;employment_status&#92;&quot;:&#92;&quot;unemployed&#92;&quot;,&#92;&quot;location&#92;&quot;:&#92;&quot;south_america&#92;&quot;,&#92;&quot;interaction_count&#92;&quot;:4,&#92;&quot;lead_score&#92;&quot;:0.94,&#92;&quot;converted&#92;&quot;:1},{&#92;&quot;lead_source&#92;&quot;:&#92;&quot;social_media&#92;&quot;,&#92;&quot;industry&#92;&quot;:&#92;&quot;retail&#92;&quot;,&#92;&quot;number_of_courses_viewed&#92;&quot;:1,&#92;&quot;annual_income&#92;&quot;:46992.0,&#92;&quot;employment_status&#92;&quot;:&#92;&quot;employed&#92;&quot;,&#92;&quot;location&#92;&quot;:&#92;&quot;south_america&#92;&quot;,&#92;&quot;interaction_count&#92;&quot;:1,&#92;&quot;lead_score&#92;&quot;:0.8,&#92;&quot;converted&#92;&quot;:0},{&#92;&quot;lead_source&#92;&quot;:&#92;&quot;events&#92;&quot;,&#92;&quot;industry&#92;&quot;:&#92;&quot;healthcare&#92;&quot;,&#92;&quot;number_of_courses_viewed&#92;&quot;:5,&#92;&quot;annual_income&#92;&quot;:78796.0,&#92;&quot;employment_status&#92;&quot;:&#92;&quot;unemployed&#92;&quot;,&#92;&quot;location&#92;&quot;:&#92;&quot;australia&#92;&quot;,&#92;&quot;interaction_count&#92;&quot;:3,&#92;&quot;lead_score&#92;&quot;:0.69,&#92;&quot;converted&#92;&quot;:1},{&#92;&quot;lead_source&#92;&quot;:&#92;&quot;paid_ads&#92;&quot;,&#92;&quot;industry&#92;&quot;:&#92;&quot;retail&#92;&quot;,&#92;&quot;number_of_courses_viewed&#92;&quot;:2,&#92;&quot;annual_income&#92;&quot;:83843.0,&#92;&quot;employment_status&#92;&quot;:&#92;&quot;NA&#92;&quot;,&#92;&quot;location&#92;&quot;:&#92;&quot;australia&#92;&quot;,&#92;&quot;interaction_count&#92;&quot;:1,&#92;&quot;lead_score&#92;&quot;:0.87,&#92;&quot;converted&#92;&quot;:0},{&#92;&quot;lead_source&#92;&quot;:&#92;&quot;referral&#92;&quot;,&#92;&quot;industry&#92;&quot;:&#92;&quot;education&#92;&quot;,&#92;&quot;number_of_courses_viewed&#92;&quot;:3,&#92;&quot;annual_income&#92;&quot;:85012.0,&#92;&quot;employment_status&#92;&quot;:&#92;&quot;self_employed&#92;&quot;,&#92;&quot;location&#92;&quot;:&#92;&quot;europe&#92;&quot;,&#92;&quot;interaction_count&#92;&quot;:3,&#92;&quot;lead_score&#92;&quot;:0.62,&#92;&quot;converted&#92;&quot;:1}]&quot;' data-total-rows='5' data-total-columns='9' data-max-columns='50' data-banner-text='&quot;&quot;' data-pagination='true' data-page-size='10' data-field-types='[[&quot;lead_source&quot;,[&quot;string&quot;,&quot;object&quot;]],[&quot;industry&quot;,[&quot;string&quot;,&quot;object&quot;]],[&quot;number_of_courses_viewed&quot;,[&quot;integer&quot;,&quot;int64&quot;]],[&quot;annual_income&quot;,[&quot;number&quot;,&quot;float64&quot;]],[&quot;employment_status&quot;,[&quot;string&quot;,&quot;object&quot;]],[&quot;location&quot;,[&quot;string&quot;,&quot;object&quot;]],[&quot;interaction_count&quot;,[&quot;integer&quot;,&quot;int64&quot;]],[&quot;lead_score&quot;,[&quot;number&quot;,&quot;float64&quot;]],[&quot;converted&quot;,[&quot;integer&quot;,&quot;int64&quot;]]]' data-show-filters='true' data-show-download='true' data-show-column-summaries='false' data-show-data-types='true' data-show-page-size-selector='false' data-show-column-explorer='true' data-show-chart-builder='true' data-row-headers='[]' data-has-stable-row-id='false' data-lazy='false' data-preload='false'></marimo-table></marimo-ui-element>"}, "type": "data"}]}, {"code_hash": "6bf4b01a402e968d37afda08ae2b8054", "console": [], "id": "RGSE", "outputs": [{"data": {"text/html": "<marimo-ui-element object-id='RGSE-0' random-id='e2b2565d-3a41-89f6-cb10-1733e6fa77cd'><marimo-table data-initial-value='[]' data-label='null' data-data='&quot;[{&#92;&quot;lead_source&#92;&quot;:&#92;&quot;paid_ads&#92;&quot;,&#92;&quot;industry&#92;&quot;:&#92;&quot;NA&#92;&quot;,&#92;&quot;number_of_courses_viewed&#92;&quot;:1,&#92;&quot;annual_income&#92;&quot;:79450.0,&#92;&quot;employment_status&#92;&quot;:&#92;&quot;unemployed&#92;&quot;,&#92;&quot;location&#92;&quot;:&#92;&quot;south_america&#92;&quot;,&#92;&quot;interaction_count&#92;&quot;:4,&#92;&quot;lead_score&#92;&quot;:0.94,&#92;&quot;converted&#92;&quot;:1},{&#92;&quot;lead_source&#92;&quot;:&#92;&quot;social_media&#92;&quot;,&#92;&quot;industry&#92;&quot;:&#92;&quot;retail&#92;&quot;,&#92;&quot;number_of_courses_viewed&#92;&quot;:1,&#92;&quot;annual_income&#92;&quot;:46992.0,&#92;&quot;employment_status&#92;&quot;:&#92;&quot;employed&#92;&quot;,&#92;&quot;location&#92;&quot;:&#92;&quot;south_america&#92;&quot;,&#92;&quot;interaction_count&#92;&quot;:1,&#92;&quot;lead_score&#92;&quot;:0.8,&#92;&quot;converted&#92;&quot;:0},{&#92;&quot;lead_source&#92;&quot;:&#92;&quot;events&#92;&quot;,&#92;&quot;industry&#92;&quot;:&#92;&quot;healthcare&#92;&quot;,&#92;&quot;number_of_courses_viewed&#92;&quot;:5,&#92;&quot;annual_income&#92;&quot;:78796.0,&#92;&quot;employment_status&#92;&quot;:&#92;&quot;unemployed&#92;&quot;,&#92;&quot;location&#92;&quot;:&#92;&quot;australia&#92;&quot;,&#92;&quot;interaction_count&#92;&quot;:3,&#92;&quot;lead_score&#92;&quot;:0.69,&#92;&quot;converted&#92;&quot;:1},{&#92;&quot;lead_source&#92;&quot;:&#92;&quot;paid_ads&#92;&quot;,&#92;&quot;industry&#92;&quot;:&#92;&quot;retail&#92;&quot;,&#92;&quot;number_of_courses_viewed&#92;&quot;:2,&#92;&quot;annual_income&#92;&quot;:83843.0,&#92;&quot;employment_status&#92;&quot;:&#92;&quot;NA&#92;&quot;,&#92;&quot;location&#92;&quot;:&#92;&quot;australia&#92;&quot;,&#92;&quot;interaction_count&#92;&quot;:1,&#92;&quot;lead_score&#92;&quot;:0.87,&#92;&quot;converted&#92;&quot;:0},{&#92;&quot;lead_source&#92;&quot;:&#92;&quot;referral&#92;&quot;,&#92;&quot;industry&#92;&quot;:&#92;&quot;education&#92;&quot;,&#92;&quot;number_of_courses_viewed&#92;&quot;:3,&#92;&quot;annual_income&#92;&quot;:85012.0,&#92;&quot;employment_status&#92;&quot;:&#92;&quot;self_employed&#92;&quot;,&#92;&quot;location&#92;&quot;:&#92;&quot;europe&#92;&quot;,&#92;&quot;interaction_count&#92;&quot;:3,&#92;&quot;lead_score&#92;&quot;:0.62,&#92;&quot;converted&#92;&quot;:1}]&quot;' data-total-rows='5' data-total-columns='9' data-max-columns='50' data-banner-text='&quot;&quot;' data-pagination='true' data-page-size='10' data-field-types='[[&quot;lead_source&quot;,[&quot;string&quot;,&quot;object&quot;]],[&quot;industry&quot;,[&quot;string&quot;,&quot;object&quot;]],[&quot;number_of_courses_viewed&quot;,[&quot;integer&quot;,&quot;int64&quot;]],[&quot;annual_income&quot;,[&quot;number&quot;,&quot;float64&quot;]],[&quot;employment_status&quot;,[&quot;string&quot;,&quot;object&quot;]],[&quot;location&quot;,[&quot;string&quot;,&quot;object&quot;]],[&quot;interaction_count&quot;,[&quot;integer&quot;,&quot;int64&quot;]],[&quot;lead_score&quot;,[&quot;number&quot;,&quot;float64&quot;]],[&quot;converted&quot;,[&quot;integer&quot;,&quot;int64&quot;]]]' data-show-filters='true' data-show-download='true' data-show-column-summaries='false' data-show-data-types='true' data-show-page-size-selector='false' data-show-column-explorer='true' data-show-chart-builder='true' data-row-headers='[]' data-has-stable-row-id='false' data-lazy='false' data-preload='false'></marimo-table></marimo-ui-element>"}, "type": "data"}]}, {"code_hash": "bc1e10e642a8e75e830e53d677d99a58", "console": [], "id": "Kclp", "outputs": [{"data": {"text/html": "<span class=\"markdown prose dark:prose-invert\"><h4 id=\"split-the-data-into-3-parts\">Split the data into 3 parts</h4>\n<span class=\"paragraph\">Split the data into 3 parts: train/validation/test with 60% / 20% / 20% distribution. Use train_test_split function for that with random_state=1.</span></span>"}, "type": "data"}]}, {"code_hash": "67d57567961c161b7d6612aab59b6345", "console": [], "id": "emfo", "outputs": [{"data": {"application/json": "{\"len(train_dataframe)\": 876, \"len(val_dataframe)\": 293, \"len(test_dataframe)\": 293}"}, "type": "data"}]}, {"code_hash": "485e279a2e672f13266c042264563ec6", "console": [], "id": "Hstk", "outputs": [{"data": {"text/html": "<span class=\"markdown prose dark:prose-invert\"><h2 id=\"question-1-roc-auc-feature-importance\">Question 1: ROC AUC feature importance</h2>\n<span class=\"paragraph\">ROC AUC could also be used to evaluate feature importance of numerical variables. </span>\n<span class=\"paragraph\">Let's do that</span>\n<ul>\n<li>For each numerical variable, use it as score (aka prediction) and compute the AUC with the <code>y</code> variable as ground truth.</li>\n<li>Use the training dataset for that</li>\n</ul>\n<span class=\"paragraph\">If your AUC is &lt; 0.5, invert this variable by putting \"-\" in front</span>\n<span class=\"paragraph\">(e.g. <code>-df_train['balance']</code>)</span>\n<span class=\"paragraph\">AUC can go below 0.5 if the variable is negatively correlated with the target variable. You can change the direction of the correlation by negating this variable - then negative correlation becomes positive.</span></span>"}, "type": "data"}]}, {"code_hash": "5db208473013165ef8b7af585357f2ea", "console": [], "id": "nWHF", "outputs": [{"data": {"application/json": "{\"number_of_courses_viewed\": \"text/plain+float:0.7635680590007088\", \"annual_income\": \"text/plain+float:0.5519578313253012\", \"interaction_count\": \"text/plain+float:0.738270176293409\", \"lead_score\": \"text/plain+float:0.6144993577250176\"}"}, "type": "data"}]}, {"code_hash": "49f125d5b1530c70882e6c8f64fe3c2f", "console": [], "id": "iLit", "outputs": [{"data": {"text/html": "<span class=\"markdown prose dark:prose-invert\"><span class=\"paragraph\">Which numerical variable (among the following 4) has the highest AUC?</span>\n<ul>\n<li><code>lead_score</code></li>\n<li><code>number_of_courses_viewed</code></li>\n<li><code>interaction_count</code></li>\n<li><code>annual_income</code></li>\n</ul></span>"}, "type": "data"}]}, {"code_hash": "cfe901da89c18e563e763f4307a1f903", "console": [], "id": "ZHCJ", "outputs": [{"data": {"text/html": "<span class=\"markdown prose dark:prose-invert\"><span class=\"paragraph\">The <code>number_of_courses_viewed</code> feature has the highest AUC with a value of <marimo-tex class=\"arithmatex\">||(0.7564||)</marimo-tex>.</span></span>"}, "type": "data"}]}, {"code_hash": "ca351cd24e9137492607482f23cca337", "console": [], "id": "ROlb", "outputs": [{"data": {"text/html": "<span class=\"markdown prose dark:prose-invert\"><h3 id=\"question-2-training-the-model\">Question 2: Training the model</h3>\n<span class=\"paragraph\">Apply one-hot-encoding using <code>DictVectorizer</code> and train the logistic regression with these parameters:</span>\n<div class=\"language-python codehilite\"><pre><span></span><code><span class=\"n\">LogisticRegression</span><span class=\"p\">(</span><span class=\"n\">solver</span><span class=\"o\">=</span><span class=\"s1\">&#39;liblinear&#39;</span><span class=\"p\">,</span> <span class=\"n\">C</span><span class=\"o\">=</span><span class=\"mf\">1.0</span><span class=\"p\">,</span> <span class=\"n\">max_iter</span><span class=\"o\">=</span><span class=\"mi\">1000</span><span class=\"p\">)</span>\n</code></pre></div></span>"}, "type": "data"}]}, {"code_hash": "d3991a63b92369be080291ea0fb57309", "console": [], "id": "qnkX", "outputs": [{"data": {"text/html": "<pre style='font-size: 12px'>0.711</pre>"}, "type": "data"}]}, {"code_hash": "17fcf33ebc7a4c24e8cf2b24c5b6aa3b", "console": [], "id": "TqIu", "outputs": [{"data": {"text/html": "<span class=\"markdown prose dark:prose-invert\"><span class=\"paragraph\">What's the AUC of this model on the validation dataset? (round to 3 digits)</span>\n<ul>\n<li>0.32</li>\n<li>0.52</li>\n<li>0.72</li>\n<li>0.92</li>\n</ul></span>"}, "type": "data"}]}, {"code_hash": "9e7bfa835d94bcfbeb969ad1946a3ca2", "console": [], "id": "Vxnm", "outputs": [{"data": {"text/html": "<span class=\"markdown prose dark:prose-invert\"><span class=\"paragraph\">The closest suggested answer to the AUC of this model is 0.72.</span></span>"}, "type": "data"}]}, {"code_hash": "e91df18f7d004ab032b841aa6d1db6c9", "console": [], "id": "DnEU", "outputs": [{"data": {"text/html": "<span class=\"markdown prose dark:prose-invert\"><h3 id=\"question-3-precision-and-recall\">Question 3: Precision and Recall</h3>\n<span class=\"paragraph\">Now let's compute precision and recall for our model.</span>\n<ul>\n<li>Evaluate the model on all thresholds from 0.0 to 1.0 with step 0.01</li>\n<li>For each threshold, compute precision and recall</li>\n<li>Plot them</li>\n</ul></span>"}, "type": "data"}]}, {"code_hash": "7176a08ad86999a7b55097c0eeebc370", "console": [{"data": "data:image/png;base64,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p07m88aNcOKEtVmk0FAZERGRq/z94Y47wDB0VY3kGZURERHJ7MqhGo3GKnlEZURERDK7clXNhg26qkbyhMqIiIhkVrWqea8aw4C337Y6jRQCKiMiInKt9983n6dPh+hoa7NIgacyIiIi12rZErp1M/eODBxoPovkEpURERG5vjFjoGhRc0TWefOsTiMFmMqIiIhcX+XKMGyYOT14MCQlWZtHCiyVERERubFXX4WAADh6FMaOtTqNFFAqIyIicmNFisC4ceb0++/DoUPW5pECSWVERERu7rHH4J574PJlncwquUJlREREbs5mg48/Bnd3WLYMPvrI6kRSwKiMiIjIv2vUCCZONKdffx1+/NHaPFKgqIyIiEjWPP88PP00pKfDE09AXJzViaSAUBkREZGssdlgyhRo0MAsIl26QFqa1amkAFAZERGRrCtWDBYtghIlzBvpvfGG1YmkAFAZERERx9SpAzNnmtMffADjx+sKG7klKiMiIuK4xx+/ulfktdegf38dspFsUxkREZHsefddc6+IzQaffQbt28P581anEiekMiIiItljs0FYmHkOSZEisGIF3HUXHDtmdTJxMiojIiJyazp2hPXroXx5iImBkBBISbE6lTgRlREREbl1LVrAtm3g6wt79pgjtopkkcqIiIjkjIAAGDPGnB45EuLjLY0jzkNlREREck6PHtCsmXkiq8YgkSxSGRERkZzj4nL1EM3MmbBjh7V5xCmojIiISM4KDjbvYWMY8PLLGhBN/pXKiIiI5LwxY6BoUdi8Gf77X6vTSD6nMiIiIjmvUqWr54y8/jpcvGhtHsnXVEZERCR3vPqqeYXNsWPw6adWp5F8TGVERERyh5cXDB9uTn/xhc4dkRtSGRERkdzTpQsUKwZ//AGbNlmdRvIplREREck9JUrAE0+Y0zNmWJtF8i2VERERyV19+pjP8+frrr5yXSojIiKSu1q2hDp1zCtq5s2zOo3kQyojIiKSu2y2q3tHpk+3NovkSyojIiKS+3r0ADc32LoVfv/d6jSSz6iMiIhI7vP1hUcfNae1d0T+QWVERETyxpVDNf/5D6SkWJtF8hWVERERyRsPPgh+fnD6NHz7rdVpJB9RGRERkbzh5gY9e5rTOlQjf6MyIiIiead3b/N55UrYu9faLJJvqIyIiEjeqVULHn7YvE/NuHFWp5F8QmVERETy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u/deCAiAhATzyhrJcyojIiJSuLm4QK9e5rQO1VhCZUREROSZZ8yra9atg337rE5T6KiMiIiIVKkC999vTuvmeXlOZURERASunsg6axakp1sapbBRGREREQFo3x7KlIGjR2H1aqvTFCoqIyIiImAOfvb00+a0TmTNUyojIiIiV1w5VLNsGZw6ZW2WQiRbZWTy5MkEBATg5eVFUFAQ27dvv+Gy06ZNo3Xr1pQqVYpSpUoREhJy0+VFREQs06gRNG8Oqanw1VdWpyk0HC4j8+bNIywsjPDwcKKjo2ncuDGhoaGcPHnyusuvX7+ep556inXr1rFlyxb8/f154IEHOHbs2C2HFxERyXG9e5vP06aZpURync0wDMORFYKCgmjevDmffPIJAHa7HX9/f1566SWGDh36r+unp6dTqlQpPvnkE3r06JGl90xMTMTHx4eEhAS8vb0diSsiki8lpaRRf8QqAH4fGUpRDzeLE0mGhASoWtV8DguD8eOtTuS0svr326E9IykpKURFRRESEnL1BVxcCAkJYcuWLVl6jaSkJFJTUylduvQNl0lOTiYxMTHTQ0REJE/4+MDMmeb0hx/CwoXW5ikEHCojp0+fJj09HV9f30zzfX19iYuLy9JrDBkyhIoVK2YqNP8UERGBj49PxsPf39+RmCIiIremY0cYPNic7tULYmOtzVPA5enVNGPGjGHu3LksWbIELy+vGy43bNgwEhISMh5HjhzJw5QiIiLA6NFw111w4QI8/jhcvGh1ogLLoTJStmxZXF1diY+PzzQ/Pj6eChUq3HTdcePGMWbMGFavXs1tt91202U9PT3x9vbO9BAREclTbm4wbx5UqAC//Qb9+oFjp1lKFjlURjw8PGjatCmRkZEZ8+x2O5GRkQQHB99wvbFjxzJq1ChWrlxJs2bNsp9WREQkL1WoAPPng6srzJkDM2ZYnahAcvgwTVhYGNOmTePLL79k9+7dvPDCC1y8eJFe/7v9co8ePRg2bFjG8u+//z5vvfUWM2bMICAggLi4OOLi4rhw4ULOfQoREZHc0rq1ecgGYMgQOHvW2jwFkMNlpEuXLowbN44RI0YQGBhITEwMK1euzDip9fDhw5w4cSJj+c8++4yUlBQ6deqEn59fxmPcuHE59ylERERyU1gYNGgAZ87A229bnabAcXicEStonBERKWg0zogTioyEkBDzkM3PP0P9+lYnyvdyZZwRERGRQuu++6BDB0hPh1de0cmsOUhlREREJKvGjwcPD1izBr791uo0BYbKiIiISFZVrw6vvmpOh4VBcrK1eQoIlRERERFHvPEG+PnBvn0wYYLVaQoElRERERFHFC8O779vTr/7LvztClLJHpURERERR3XrBnfcYQ4V/8YbVqdxeiojIiIijnJxgYkTzelZs2D7dkvjODuVERERkexo0QJ69jSnBw4Eu93aPE5MZURERCS7IiLMc0i2bTPvXSPZojIiIiKSXX5+8Oab5vSQIeY5JOIwlREREZFb8corUKMGHD9u7ikRh6mMiIiI3ApPT3NkVjCf9++3No8TUhkRERG5Ve3amTfRS06G8HCr0zgdlREREZFbZbPBe++Z0wsWwNmz1uZxMiojIiIiOaF5c2jUyNw7oitrHKIyIiIikhNsNujTx5yeMcPaLE5GZURERCSnPP00eHhAdDTExFidxmmojIiIiOSUMmWgQwdzevp0S6M4E5URERGRnHTlUM3s2XD5srVZnITKiIiISE667z6oUsW8ombJEqvTOAWVERERkZzk6grPPGNO61BNlqiMiIiI5LRevcyrayIj4cABq9PkeyojIiIiOS0gwDxcAzBzpqVRnIHKiIiISG64ciLrrFmQnm5plPxOZURERCQ3dOgApUrBkSOwfr3VafI1lREREZHc4OUFjz9uTi9YYG2WfE5lREREJLd07mw+L14MaWnWZsnHVEZERERyS5s2ULo0nDoFGzZYnSbfUhkRERHJLe7u0LGjOb1wobVZ8jGVERERkdz090M1uqrmulRGREREctO995pX1cTHw48/Wp0mX1IZERERyU3u7lfv5Kuraq5LZURERCS3XTlUs2iRDtVch8qIiIhIbrvvPihZ0jxUs2mT1WnyHZURERGR3ObhAe3bm9M6VHMNlREREZG88PdDNXa7tVnyGZURERGRvHD//eDjAydO6FDNP6iMiIiI5IW/H6qZP9/aLPmMyoiIiEhe6dLFfJ45E44dszZLPqIyIiIiklceegiCg+HiRRg2zOo0+YbKiIiISF6x2eDjj83pr76CrVutzZNPqIyIiIjkpWbNoFcvc3rgQF1Zg8qIiIhI3hs9GkqUgJ9+MveQFHIqIyIiInmtQgV46y1zeuhQOH/e2jwWUxkRERGxwsCBULMmxMXBe+9Z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n1GyZEkjLi7OMAzD6N69uzF06NCM5Tdt2mS4ubkZ48aNM3bv3m2Eh4fr0t4scHQ7jxkzxvDw8DAWLlxonDhxIuNx/vx5qz6C03B0W/+TrqbJGke38+HDh40SJUoYAwYMMGJjY43vvvvOKF++vPHuu+9a9RGcgqPbOTw83ChRooTx3//+19i/f7+xevVqo0aNGsYTTzxh1UdwCufPnzd27txp7Ny50wCMDz/80Ni5c6dx6NAhwzAMY+jQoUb37t0zlr9yae/gwYON3bt3G5MnT9alvbdq0qRJRpUqVQwPDw+jRYsWxtatWzO+d/fddxs9e/bMtPz8+fON2rVrGx4eHkaDBg2M5cuX53Fi5+TIdq5ataoBXPMIDw/P++BOyNGf6b9TGck6R7fz5s2bjaCgIMPT09OoXr268d577xlpaWl5nNr5OLKdU1NTjbffftuoUaOG4eXlZfj7+xsvvviicfbs2bwP7kTWrVt33d+5V7Ztz549jbvvvvuadQIDAw0PDw+jevXqxsyZM3M1o80wtG9LRERErFNgzxkRERER56AyIiIiIpZSGRERERFLqYyIiIiIpVRGRERExFIqIyIiImIplRERERGxlMqIiIiIWEplRERuav369dhsNs6dO5en7ztr1ixKlix5S69x8OBBbDYbMTExN1zGqs8nIlepjIgUYjab7aaPt99+2+qIIlIIuFkdQESsc+LEiYzpefPmMWLECGJjYzPmFS9enB07djj8uikpKbpbrYhkmfaMiBRiFSpUyHj4+Phgs9kyzStevHjGslFRUTRr1oyiRYvSsmXLTKXl7bffJjAwkC+++IJq1arh5eUFwLlz5+jbty/lypXD29ube++9l127dmWst2vXLtq0aUOJEiXw9vamadOm15SfVatWUa9ePYoXL86DDz6YqUDZ7XZGjhxJ5cqV8fT0JDAwkJUrV970M69YsYLatWtTpEgR2rRpw8GDB29lE4pIDlAZEZEsGT58OOPHj2fHjh24ubnRu3fvTN/fu3cvixYtYvHixRnnaHTu3JmTJ0/y/fffExUVRZMmTbjvvvv466+/AOjWrRuVK1fmp59+IioqiqFDh+Lu7p7xmklJSYwbN46vvvqKDRs2cPjwYV577bWM70+cOJHx48czbtw4fv75Z0JDQ2nXrh1//vnndT/DkSNHeOyxx2jbti0xMTH07duXoUOH5vCWEhGH5eo9gUXEacycOdPw8fG5Zv6V24+vXbs2Y97y5csNwLh06ZJhGIYRHh5uuLu7GydPnsxY5scffzS8vb2Ny5cvZ3q9GjVqGJ9//rlhGIZRokQJY9asWTfMAxh79+7NmDd58mTD19c34+uKFSsa7733Xqb1mjdvbrz44ouGYRjGgQMHDMDYuXOnYRiGMWzYMKN+/fqZlh8yZIgB6Db0IhbSnhERyZLbbrstY9rPzw+AkydPZsyrWrUq5cqVy/h6165dXLhwgTJlylC8ePGMx4EDB9i3bx8AYWFh9O3bl5CQEMaMGZMx/4qiRYtSo0aNTO975T0TExM5fvw4rVq1yrROq1at2L1793U/w+7duwkKCso0Lzg4OMvbQERyh05gFZEs+fvhE5vNBpjnbFxRrFixTMtfuHABPz8/1q9ff81rXblk9+2336Zr164sX76c77//nvDwcObOnUvHjh2vec8r72sYRk58HBHJR7RnRERyRZMmTYiLi8PNzY2aNWtmepQtWzZjudq1azNo0CBWr17NY489xsyZM7P0+t7e3lSsWJFNmzZlmr9p0ybq169/3XXq1avH9u3bM83bunWrg59MRHKayoiI5IqQkBCCg4Pp0KEDq1ev5uDBg2zevJnhw4ezY8cOLl26xIABA1i/fj2HDh1i06ZN/PTTT9SrVy/L7zF48GDef/995s2bR2xsLEOHDiUmJoaXX375uss///zz/PnnnwwePJjY2FjmzJnDrFmzcugTi0h26TCNiOQKm83GihUrGD58OL169eLUqVNUqFCBu+66C19fX1xdXTlz5gw9evQgPj6esmXL8thjj/HOO+9k+T0GDhxIQkICr776KidPnqR+/fosW7aMWrVqXXf5KlWqsGjRIgYNGsSkSZNo0aIFo0ePvubKIBHJWzZDB2BFRETEQjpMIyIiIpZSGRERERFLqYyIiIiIpVRGRERExFIqIyIiImIplRERERGxlMqIiIiIWEplRERERCylMiIiIiKWUhkRERERS6mMiIiIiKX+H4wstyn4UBYFAAAAAElFTkSuQmCC", "mimetype": "image/png", "name": "media", "type": "streamMedia"}], "id": "ulZA", "outputs": [{"data": {"text/plain": ""}, "type": "data"}]}, {"code_hash": "64fcc06bea26d9772927dab1c0b6ac20", "console": [], "id": "ecfG", "outputs": [{"data": {"text/html": "<span class=\"markdown prose dark:prose-invert\"><span class=\"paragraph\">At which threshold precision and recall curves intersect?</span>\n<ul>\n<li>0.145</li>\n<li>0.345</li>\n<li>0.545</li>\n<li>0.745</li>\n</ul></span>"}, "type": "data"}]}, {"code_hash": "ea81a6eb5eb43c8c6251399a4c92c92a", "console": [], "id": "Pvdt", "outputs": [{"data": {"text/html": "<span class=\"markdown prose dark:prose-invert\"><span class=\"paragraph\">The closest suggested is 0.545.</span></span>"}, "type": "data"}]}, {"code_hash": "a7cbb97b422ddff86e6e66416adacada", "console": [], "id": "ZBYS", "outputs": [{"data": {"text/html": "<span class=\"markdown prose dark:prose-invert\"><h3 id=\"question-4-f1-score\">Question 4: F1 score</h3>\n<span class=\"paragraph\">Precision and recall are conflicting - when one grows, the other goes down. That's why they are often combined into the F1 score - a metrics that takes into account both</span>\n<span class=\"paragraph\">This is the formula for computing F1:</span>\n<marimo-tex class=\"arithmatex\">||[F_1 = 2 \\cdot \\cfrac{P \\cdot R}{P + R}||]</marimo-tex><span class=\"paragraph\">Where <marimo-tex class=\"arithmatex\">||(P||)</marimo-tex> is precision and <marimo-tex class=\"arithmatex\">||(R||)</marimo-tex> is recall.</span>\n<span class=\"paragraph\">Let's compute F1 for all thresholds from 0.0 to 1.0 with increment 0.01</span></span>"}, "type": "data"}]}, {"code_hash": "53d76db0edd07fea59effbb1d3b408ff", "console": [{"data": "data:image/png;base64,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fvhhZWVladiwYZ4o1ee5e68HDhyoTz/9VPn5+TXb1VdfrUsvvVT5+fmKioryZPk+ozF/p0eNGqVt27bVhD1J2rp1q7p3704QqUdj7vORI0dOChzVAdDiMWvNxpbvwhYbGusFVqxYYTmdTmvZsmXWF198Yd1yyy1Wp06dLJfLZVmWZU2cONGaMWNGzfnr16+3goKCrHnz5lkFBQVWWloaU3sbwN37PHfuXCs4ONh68cUXrX379tVshw4dsutX8Bnu3usfYzZNw7h7nwsLC62OHTtat99+u7Vlyxbrtddes7p162b96U9/sutX8Anu3ue0tDSrY8eO1j//+U9rx44d1ptvvmn169fP+vWvf23Xr+ATDh06ZG3evNnavHmzJclasGCBtXnzZmv37t2WZVnWjBkzrIkTJ9acXz219+6777YKCgqsjIwMpvY21eOPP26deeaZVnBwsDVixAhrw4YNNT8bO3asNWnSpFrn/+tf/7IGDBhgBQcHW+eee661Zs0aD1fsm9y5z71797YknbSlpaV5vnAf5O7f6RMRRhrO3fv8wQcfWLGxsZbT6bT69u1rPfLII9axY8c8XLXvcec+Hz161Jo9e7bVr18/KyQkxIqKirJuu+0267vvvvN84T7k3XffrfO/udX3dtKkSdbYsWNPuiY6OtoKDg62+vbtaz3zzDMtWqPDsmjbAgAA9vHbMSMAAMA3EEYAAICtCCMAAMBWhBEAAGArwggAALAVYQQAANiKMAIAAGxFGAEAALYijAA4pZycHDkcDh08eNCjn7ts2TJ16tSpSe+xa9cuORwO5efn13uOXb8fgOMII0Ar5nA4TrnNnj3b7hIBtAJBdhcAwD779u2r2V+5cqVmzZqlLVu21Bzr0KGDPvroI7fft6KigqfVAmgwWkaAViwyMrJmCwsLk8PhqHWsQ4cONefm5eVp2LBhateunUaOHFkrtMyePVvR0dF6+umnddZZZykkJESSdPDgQU2ePFldu3ZVaGioLrvsMn388cc113388ce69NJL1bFjR4WGhiomJuak8PPGG29o0KBB6tChg6688spaAaqqqkoPPfSQevXqJafTqejoaGVlZZ3yd167dq0GDBigtm3b6tJLL9WuXbuacgsBNAPCCIAGmTlzpubPn6+PPvpIQUFB+u1vf1vr59u2bdNLL72kVatW1YzR+NWvfqX9+/fr9ddfV15eni688EJdfvnl+vbbbyVJN954o3r16qUPP/xQeXl5mjFjhtq0aVPznkeOHNG8efP07LPP6v3331dhYaH++Mc/1vz8L3/5i+bPn6958+bpk08+UUJCgq6++mp99dVXdf4Oe/bs0bXXXqvx48crPz9fkydP1owZM5r5TgFwW4s+ExiAz3jmmWessLCwk45XP3787bffrjm2Zs0aS5L1/fffW5ZlWWlpaVabNm2s/fv315zzn//8xwoNDbV++OGHWu/Xr18/629/+5tlWZbVsWNHa9myZfXWI8natm1bzbGMjAwrIiKi5s89evSwHnnkkVrXDR8+3Lrtttssy7KsnTt3WpKszZs3W5ZlWampqdbgwYNrnX/vvfdakngMPWAjWkYANMiQIUNq9rt37y5J2r9/f82x3r17q2vXrjV//vjjj3X48GGdccYZ6tChQ822c+dObd++XZKUkpKiyZMnKz4+XnPnzq05Xq1du3bq169frc+t/szS0lLt3btXo0aNqnXNqFGjVFBQUOfvUFBQoNjY2FrH4uLiGnwPALQMBrACaJATu08cDockM2ajWvv27Wudf/jwYXXv3l05OTknvVf1lN3Zs2frhhtu0Jo1a/T6668rLS1NK1as0M9//vOTPrP6cy3Lao5fB4AXoWUEQIu48MIL5XK5FBQUpP79+9fawsPDa84bMGCApk+frjfffFPXXnutnnnmmQa9f2hoqHr06KH169fXOr5+/XoNHjy4zmsGDRqkjRs31jq2YcMGN38zAM2NMAKgRcTHxysuLk4TJkzQm2++qV27dumDDz7QzJkz9dFHH+n777/X7bffrpycHO3evVvr16/Xhx9+qEGDBjX4M+6++279+c9/1sqVK7VlyxbNmDFD+fn5uuuuu+o8/9Zbb9VXX32lu+++W1u2bNHzzz+vZcuWNdNvDKCx6KYB0CIcDofWrl2rmTNnKjk5WQcOHFBkZKTGjBmjiIgIBQYG6n//+5+SkpJUVFSk8PBwXXvttXrwwQcb/Bl33nmnSkpK9Ic//EH79+/X4MGD9eqrr+rss8+u8/wzzzxTL730kqZPn67HH39cI0aM0Jw5c06aGQTAsxwWHbAAAMBGdNMAAABbEUYAAICtCCMAAMBWhBEAAGArwggAALAVYQQAANiKMAIAAGxFGAEAALYijAAAAFsRRgAAgK0IIwAAwFb/H23WC3GgjYOfAAAAAElFTkSuQmCC", "mimetype": "image/png", "name": "media", "type": "streamMedia"}, {"name": "stdout", "text": "F1 max is 0.812 and it's reach at 0.556\n", "type": "stream"}], "id": "aLJB", "outputs": [{"data": {"text/plain": ""}, "type": "data"}]}, {"code_hash": "95ce9198c365fd65cdca84f2dfee198c", "console": [], "id": "nHfw", "outputs": [{"data": {"text/html": "<span class=\"markdown prose dark:prose-invert\"><span class=\"paragraph\">At which threshold F1 is maximal?</span>\n<ul>\n<li>0.14</li>\n<li>0.34</li>\n<li>0.54</li>\n<li>0.74</li>\n</ul></span>"}, "type": "data"}]}, {"code_hash": "04a5905af0ad0c18ece1361d22910a10", "console": [], "id": "xXTn", "outputs": [{"data": {"text/html": "<span class=\"markdown prose dark:prose-invert\"><span class=\"paragraph\">The closest suggested option to the threshold where F1 is maximal is 0.54.</span></span>"}, "type": "data"}]}, {"code_hash": "bf9bfafe3e3d64ece01622d5e1eb2c9f", "console": [], "id": "AjVT", "outputs": [{"data": {"text/html": "<span class=\"markdown prose dark:prose-invert\"><h2 id=\"question-5-5-fold-cv\">Question 5: 5-Fold CV</h2>\n<span class=\"paragraph\">Use the <code>KFold</code> class from Scikit-Learn to evaluate our model on 5 different folds:</span>\n<div class=\"language-scdoc codehilite\"><pre><span></span><code>KFold(n_splits=5, shuffle=True, random_state=1)\n</code></pre></div>\n<ul>\n<li>Iterate over different folds of <code>df_full_train</code></li>\n<li>Split the data into train and validation</li>\n<li>Train the model on train with these parameters: <code>LogisticRegression(solver='liblinear', C=1.0, max_iter=1000)</code></li>\n<li>Use AUC to evaluate the model on validation</li>\n</ul></span>"}, "type": "data"}]}, {"code_hash": "4ce5e4021bab2861a8cc18ca7712d400", "console": [{"name": "stdout", "text": "0.822 +- 0.036\n", "type": "stream"}], "id": "pHFh", "outputs": [{"data": {"application/json": "[\"text/plain+float:0.8060745924216483\", \"text/plain+float:0.8713738368910783\", \"text/plain+float:0.7754320118852139\", \"text/plain+float:0.8018368617683685\", \"text/plain+float:0.8558272713202291\"]"}, "type": "data"}]}, {"code_hash": "712db2359ce2b2894bbbc33fec5558ba", "console": [], "id": "NCOB", "outputs": [{"data": {"text/html": "<span class=\"markdown prose dark:prose-invert\"><span class=\"paragraph\">How large is standard deviation of the scores across different folds?</span>\n<ul>\n<li>0.0001</li>\n<li>0.006</li>\n<li>0.06</li>\n<li>0.36</li>\n</ul></span>"}, "type": "data"}]}, {"code_hash": "f65e5fac26d801cc9e0def75172c9563", "console": [], "id": "aqbW", "outputs": [{"data": {"text/html": "<span class=\"markdown prose dark:prose-invert\"><span class=\"paragraph\">The closest value to the standard deviation across folds is <marimo-tex class=\"arithmatex\">||(0.06||)</marimo-tex>.</span></span>"}, "type": "data"}]}, {"code_hash": "2fa6fbc273f7c15d820188b7d7486c24", "console": [], "id": "TRpd", "outputs": [{"data": {"text/html": "<span class=\"markdown prose dark:prose-invert\"><h3 id=\"question-6-hyperparameter-tuning\">Question 6: Hyperparameter Tuning</h3>\n<span class=\"paragraph\">Now let's use 5-Fold cross-validation to find the best parameter <code>C</code></span>\n<ul>\n<li>Iterate over the following <code>C</code> values: <code>[0.000001, 0.001, 1]</code></li>\n<li>Initialize <code>KFold</code> with the same parameters as previously</li>\n<li>Use these parameters for the model: <code>LogisticRegression(solver='liblinear', C=C, max_iter=1000)</code></li>\n<li>Compute the mean score as well as the std (round the mean and std to 3 decimal digits)</li>\n</ul></span>"}, "type": "data"}]}, {"code_hash": "18970ed384b81483f5cf72352b07f066", "console": [{"name": "stdout", "text": "C=0.000: 0.560 +- 0.024\n", "type": "stream"}, {"name": "stdout", "text": "C=0.001: 0.867 +- 0.029\n", "type": "stream"}, {"name": "stdout", "text": "C=1.000: 0.822 +- 0.036\n", "type": "stream"}], "id": "TXez", "outputs": [{"data": {"application/json": "[[\"text/plain+float:0.5572098563239782\", \"text/plain+float:0.5191961842208147\", \"text/plain+float:0.5894909688013137\", \"text/plain+float:0.5582191780821917\", \"text/plain+float:0.5769230769230769\"], [\"text/plain+float:0.8608650338718081\", \"text/plain+float:0.8967081085307685\", \"text/plain+float:0.822816482915005\", \"text/plain+float:0.8539850560398504\", \"text/plain+float:0.9000154774802662\"], [\"text/plain+float:0.8060745924216483\", \"text/plain+float:0.8713738368910783\", \"text/plain+float:0.7754320118852139\", \"text/plain+float:0.8018368617683685\", \"text/plain+float:0.8558272713202291\"]]"}, "type": "data"}]}, {"code_hash": "f27c1cacf78cde56544040a25ecccb5a", "console": [], "id": "dNNg", "outputs": [{"data": {"text/html": "<span class=\"markdown prose dark:prose-invert\"><span class=\"paragraph\">Which <code>C</code> leads to the best mean score?</span>\n<ul>\n<li>0.000001</li>\n<li>0.001</li>\n<li>1</li>\n</ul></span>"}, "type": "data"}]}, {"code_hash": "53030797b16d22625eb489d11f202249", "console": [], "id": "yCnT", "outputs": [{"data": {"text/html": "<span class=\"markdown prose dark:prose-invert\"><span class=\"paragraph\">The best score corresponds to <marimo-tex class=\"arithmatex\">||(C = 0.001||)</marimo-tex>.</span></span>"}, "type": "data"}]}], "metadata": {"marimo_version": "0.16.0"}, "version": "1"},
            "runtimeConfig": null,
        };
    </script>
  
<marimo-code hidden="">
    import%20marimo%0A%0A__generated_with%20%3D%20%220.16.0%22%0Aapp%20%3D%20marimo.App(width%3D%22medium%22)%0A%0A%0A%40app.cell%0Adef%20_()%3A%0A%20%20%20%20import%20marimo%20as%20mo%0A%20%20%20%20import%20pandas%20as%20pd%0A%20%20%20%20import%20numpy%20as%20np%0A%20%20%20%20import%20matplotlib.pyplot%20as%20plt%0A%20%20%20%20import%20seaborn%20as%20sns%0A%20%20%20%20return%20mo%2C%20np%2C%20pd%2C%20plt%0A%0A%0A%40app.cell(hide_code%3DTrue)%0Adef%20_(mo)%3A%0A%20%20%20%20mo.md(%0A%20%20%20%20%20%20%20%20r%22%22%22%0A%20%20%20%20%23%20Module%204%3A%20%5BEvaluation%5D(https%3A%2F%2Fgithub.com%2FDataTalksClub%2Fmachine-learning-zoomcamp%2Ftree%2Fmaster%2F04-evaluation)%0A%0A%20%20%20%20%23%23%20Homework%0A%0A%20%20%20%20%23%23%23%20Dataset%0A%0A%20%20%20%20For%20this%20homework%2C%20we'll%20use%20the%20lead%20scoring%20Bank%20Marketing%20dataset.%20Download%20it%20from%20here.%20You%20can%20do%20it%20with%20wget%3A%0A%0A%20%20%20%20wget%20%5Bhttps%3A%2F%2Fraw.githubusercontent.com%2Falexeygrigorev%2Fdatasets%2Fmaster%2Fcourse_lead_scoring.csv%5D(https%3A%2F%2Fraw.githubusercontent.com%2Falexeygrigorev%2Fdatasets%2Fmaster%2Fcourse_lead_scoring.csv)%0A%0A%20%20%20%20In%20this%20dataset%20our%20desired%20target%20for%20classification%20task%20will%20be%20**converted**%20variable%20-%20has%20the%20client%20signed%20up%20to%20the%20platform%20or%20not.%0A%20%20%20%20%22%22%22%0A%20%20%20%20)%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(pd)%3A%0A%20%20%20%20def%20read_dataframe()%3A%0A%20%20%20%20%20%20%20%20return%20pd.read_csv(%22.%2Fmodule-4%2Fdata%2Fcourse_lead_scoring.csv%22)%0A%0A%20%20%20%20raw_dataframe%20%3D%20read_dataframe()%0A%20%20%20%20raw_dataframe.head()%0A%20%20%20%20return%20(raw_dataframe%2C)%0A%0A%0A%40app.cell(hide_code%3DTrue)%0Adef%20_(mo)%3A%0A%20%20%20%20mo.md(%0A%20%20%20%20%20%20%20%20r%22%22%22%0A%20%20%20%20%23%23%20Data%20preparation%0A%0A%20%20%20%20%23%23%23%20Check%20if%20the%20missing%20values%20are%20presented%20in%20the%20features%0A%20%20%20%20%22%22%22%0A%20%20%20%20)%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(raw_dataframe)%3A%0A%20%20%20%20raw_dataframe.isnull().sum()%0A%20%20%20%20return%0A%0A%0A%40app.cell(hide_code%3DTrue)%0Adef%20_(mo)%3A%0A%20%20%20%20mo.md(%0A%20%20%20%20%20%20%20%20r%22%22%22%0A%20%20%20%20%23%23%23%20If%20there%20are%20missing%20values%3A%0A%0A%20%20%20%20%23%23%23%23%20For%20categorical%20features%2C%20replace%20them%20with%20'NA'%0A%20%20%20%20%22%22%22%0A%20%20%20%20)%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(raw_dataframe)%3A%0A%20%20%20%20categorical_columns%20%3D%20%5B%22lead_source%22%2C%20%22industry%22%2C%20%22employment_status%22%2C%20%22location%22%5D%0A%0A%20%20%20%20def%20fill_categorical_values(dataframe)%3A%0A%20%20%20%20%20%20%20%20dataframe%5Bcategorical_columns%5D%20%3D%20dataframe%5Bcategorical_columns%5D.fillna('NA')%0A%0A%20%20%20%20%20%20%20%20return%20dataframe%0A%0A%20%20%20%20fill_categorical_values(raw_dataframe).head()%0A%20%20%20%20return%20categorical_columns%2C%20fill_categorical_values%0A%0A%0A%40app.cell(hide_code%3DTrue)%0Adef%20_(mo)%3A%0A%20%20%20%20mo.md(r%22%22%22%23%23%23%23%20For%20numerical%20features%2C%20replace%20with%20with%200.0%22%22%22)%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(raw_dataframe)%3A%0A%20%20%20%20numeric_columns%20%3D%20%5B%22number_of_courses_viewed%22%2C%20%22annual_income%22%2C%20%22interaction_count%22%2C%20%22lead_score%22%5D%0A%0A%20%20%20%20def%20fill_numerical_values(dataframe)%3A%0A%20%20%20%20%20%20%20%20dataframe%5Bnumeric_columns%5D%20%3D%20dataframe%5Bnumeric_columns%5D.fillna(0.0)%0A%0A%20%20%20%20%20%20%20%20return%20dataframe%0A%0A%20%20%20%20fill_numerical_values(raw_dataframe).head()%0A%20%20%20%20return%20fill_numerical_values%2C%20numeric_columns%0A%0A%0A%40app.cell%0Adef%20_(fill_categorical_values%2C%20fill_numerical_values%2C%20raw_dataframe)%3A%0A%20%20%20%20filled_dataframe%20%3D%20fill_numerical_values(fill_categorical_values(raw_dataframe.copy()))%0A%20%20%20%20filled_dataframe.head()%0A%20%20%20%20return%20(filled_dataframe%2C)%0A%0A%0A%40app.cell(hide_code%3DTrue)%0Adef%20_(mo)%3A%0A%20%20%20%20mo.md(%0A%20%20%20%20%20%20%20%20r%22%22%22%0A%20%20%20%20%23%23%23%23%20Split%20the%20data%20into%203%20parts%0A%0A%20%20%20%20Split%20the%20data%20into%203%20parts%3A%20train%2Fvalidation%2Ftest%20with%2060%25%20%2F%2020%25%20%2F%2020%25%20distribution.%20Use%20train_test_split%20function%20for%20that%20with%20random_state%3D1.%0A%20%20%20%20%22%22%22%0A%20%20%20%20)%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(filled_dataframe)%3A%0A%20%20%20%20from%20sklearn.model_selection%20import%20train_test_split%0A%0A%20%20%20%20full_dataframe%2C%20test_dataframe%20%3D%20train_test_split(filled_dataframe%2C%20test_size%3D0.2%2C%20random_state%3D1)%0A%20%20%20%20train_dataframe%2C%20val_dataframe%20%3D%20train_test_split(full_dataframe%2C%20test_size%3D0.25%2C%20random_state%3D1)%0A%0A%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%22len(train_dataframe)%22%3A%20len(train_dataframe)%2C%0A%20%20%20%20%20%20%20%20%22len(val_dataframe)%22%3A%20len(val_dataframe)%2C%0A%20%20%20%20%20%20%20%20%22len(test_dataframe)%22%3A%20len(test_dataframe)%2C%0A%20%20%20%20%7D%0A%20%20%20%20return%20full_dataframe%2C%20train_dataframe%2C%20val_dataframe%0A%0A%0A%40app.cell(hide_code%3DTrue)%0Adef%20_(mo)%3A%0A%20%20%20%20mo.md(%0A%20%20%20%20%20%20%20%20r%22%22%22%0A%20%20%20%20%23%23%20Question%201%3A%20ROC%20AUC%20feature%20importance%0A%0A%20%20%20%20ROC%20AUC%20could%20also%20be%20used%20to%20evaluate%20feature%20importance%20of%20numerical%20variables.%20%0A%0A%20%20%20%20Let's%20do%20that%0A%0A%20%20%20%20*%20For%20each%20numerical%20variable%2C%20use%20it%20as%20score%20(aka%20prediction)%20and%20compute%20the%20AUC%20with%20the%20%60y%60%20variable%20as%20ground%20truth.%0A%20%20%20%20*%20Use%20the%20training%20dataset%20for%20that%0A%0A%0A%20%20%20%20If%20your%20AUC%20is%20%3C%200.5%2C%20invert%20this%20variable%20by%20putting%20%22-%22%20in%20front%0A%0A%20%20%20%20(e.g.%20%60-df_train%5B'balance'%5D%60)%0A%0A%20%20%20%20AUC%20can%20go%20below%200.5%20if%20the%20variable%20is%20negatively%20correlated%20with%20the%20target%20variable.%20You%20can%20change%20the%20direction%20of%20the%20correlation%20by%20negating%20this%20variable%20-%20then%20negative%20correlation%20becomes%20positive.%0A%20%20%20%20%22%22%22%0A%20%20%20%20)%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(numeric_columns%2C%20pd%2C%20train_dataframe)%3A%0A%20%20%20%20from%20sklearn.metrics%20import%20roc_auc_score%0A%0A%20%20%20%20def%20compute_auc_for_numeric_features(dataframe%3A%20pd.DataFrame)%20-%3E%20dict%3A%0A%20%20%20%20%20%20%20%20auc_scores%20%3D%20%7B%7D%0A%0A%20%20%20%20%20%20%20%20for%20feature%20in%20numeric_columns%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20auc_scores%5Bfeature%5D%20%3D%20roc_auc_score(dataframe.converted%2C%20dataframe%5Bfeature%5D)%0A%0A%20%20%20%20%20%20%20%20return%20auc_scores%0A%0A%20%20%20%20compute_auc_for_numeric_features(train_dataframe)%0A%20%20%20%20return%20(roc_auc_score%2C)%0A%0A%0A%40app.cell(hide_code%3DTrue)%0Adef%20_(mo)%3A%0A%20%20%20%20mo.md(%0A%20%20%20%20%20%20%20%20r%22%22%22%0A%20%20%20%20Which%20numerical%20variable%20(among%20the%20following%204)%20has%20the%20highest%20AUC%3F%0A%0A%20%20%20%20-%20%60lead_score%60%0A%20%20%20%20-%20%60number_of_courses_viewed%60%0A%20%20%20%20-%20%60interaction_count%60%0A%20%20%20%20-%20%60annual_income%60%0A%20%20%20%20%22%22%22%0A%20%20%20%20)%0A%20%20%20%20return%0A%0A%0A%40app.cell(hide_code%3DTrue)%0Adef%20_(mo)%3A%0A%20%20%20%20mo.md(r%22%22%22The%20%60number_of_courses_viewed%60%20feature%20has%20the%20highest%20AUC%20with%20a%20value%20of%20%240.7564%24.%22%22%22)%0A%20%20%20%20return%0A%0A%0A%40app.cell(hide_code%3DTrue)%0Adef%20_(mo)%3A%0A%20%20%20%20mo.md(%0A%20%20%20%20%20%20%20%20r%22%22%22%0A%20%20%20%20%23%23%23%20Question%202%3A%20Training%20the%20model%0A%0A%20%20%20%20Apply%20one-hot-encoding%20using%20%60DictVectorizer%60%20and%20train%20the%20logistic%20regression%20with%20these%20parameters%3A%0A%0A%20%20%20%20%60%60%60python%0A%20%20%20%20LogisticRegression(solver%3D'liblinear'%2C%20C%3D1.0%2C%20max_iter%3D1000)%0A%20%20%20%20%60%60%60%0A%20%20%20%20%22%22%22%0A%20%20%20%20)%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(%0A%20%20%20%20categorical_columns%2C%0A%20%20%20%20numeric_columns%2C%0A%20%20%20%20pd%2C%0A%20%20%20%20roc_auc_score%2C%0A%20%20%20%20train_dataframe%2C%0A%20%20%20%20val_dataframe%2C%0A)%3A%0A%20%20%20%20from%20sklearn.linear_model%20import%20LogisticRegression%0A%20%20%20%20from%20sklearn.feature_extraction%20import%20DictVectorizer%0A%0A%20%20%20%20def%20separate_target(dataframe%3A%20pd.DataFrame)%3A%0A%20%20%20%20%20%20%20%20y%20%3D%20dataframe.converted%0A%20%20%20%20%20%20%20%20X%20%3D%20dataframe.drop(columns%3D%5B'converted'%5D)%0A%20%20%20%20%20%20%20%20return%20X%5Bnumeric_columns%20%2B%20categorical_columns%5D%2C%20y%0A%0A%20%20%20%20def%20train(dataframe%3A%20pd.DataFrame)%3A%0A%20%20%20%20%20%20%20%20X%2C%20y%20%3D%20separate_target(dataframe)%0A%0A%20%20%20%20%20%20%20%20dict_vectorizer%20%3D%20DictVectorizer(sparse%3DFalse)%0A%20%20%20%20%20%20%20%20X_dict%20%3D%20dict_vectorizer.fit_transform(X.to_dict(orient%3D%22records%22))%0A%0A%20%20%20%20%20%20%20%20model%20%3D%20LogisticRegression(solver%3D'liblinear'%2C%20C%3D1.0%2C%20max_iter%3D1000%2C%20random_state%3D1)%0A%20%20%20%20%20%20%20%20model.fit(X_dict%2C%20y)%0A%0A%20%20%20%20%20%20%20%20return%20dict_vectorizer%2C%20model%0A%0A%20%20%20%20def%20evaluate(%0A%20%20%20%20%20%20%20%20model%3A%20LogisticRegression%2C%0A%20%20%20%20%20%20%20%20dict_vectorizer%3A%20DictVectorizer%2C%0A%20%20%20%20%20%20%20%20dataframe%3A%20pd.DataFrame%0A%20%20%20%20)%20-%3E%20float%3A%0A%20%20%20%20%20%20%20%20X%2C%20y%20%3D%20separate_target(dataframe)%0A%20%20%20%20%20%20%20%20X_dict%20%3D%20dict_vectorizer.transform(X.to_dict(orient%3D%22records%22))%0A%0A%20%20%20%20%20%20%20%20y_pred%20%3D%20model.predict_proba(X_dict)%5B%3A%2C%201%5D%20%3E%3D%200.55%0A%0A%20%20%20%20%20%20%20%20return%20round(roc_auc_score(y%2C%20y_pred)%2C%203)%0A%0A%20%20%20%20dict_vectorizer%2C%20model%20%3D%20train(train_dataframe)%0A%20%20%20%20evaluate(model%2C%20dict_vectorizer%2C%20val_dataframe)%0A%20%20%20%20return%20(%0A%20%20%20%20%20%20%20%20DictVectorizer%2C%0A%20%20%20%20%20%20%20%20LogisticRegression%2C%0A%20%20%20%20%20%20%20%20dict_vectorizer%2C%0A%20%20%20%20%20%20%20%20model%2C%0A%20%20%20%20%20%20%20%20separate_target%2C%0A%20%20%20%20)%0A%0A%0A%40app.cell(hide_code%3DTrue)%0Adef%20_(mo)%3A%0A%20%20%20%20mo.md(%0A%20%20%20%20%20%20%20%20r%22%22%22%0A%20%20%20%20What's%20the%20AUC%20of%20this%20model%20on%20the%20validation%20dataset%3F%20(round%20to%203%20digits)%0A%0A%20%20%20%20-%200.32%0A%20%20%20%20-%200.52%0A%20%20%20%20-%200.72%0A%20%20%20%20-%200.92%0A%20%20%20%20%22%22%22%0A%20%20%20%20)%0A%20%20%20%20return%0A%0A%0A%40app.cell(hide_code%3DTrue)%0Adef%20_(mo)%3A%0A%20%20%20%20mo.md(r%22%22%22The%20closest%20suggested%20answer%20to%20the%20AUC%20of%20this%20model%20is%200.72.%22%22%22)%0A%20%20%20%20return%0A%0A%0A%40app.cell(hide_code%3DTrue)%0Adef%20_(mo)%3A%0A%20%20%20%20mo.md(%0A%20%20%20%20%20%20%20%20r%22%22%22%0A%20%20%20%20%23%23%23%20Question%203%3A%20Precision%20and%20Recall%0A%0A%20%20%20%20Now%20let's%20compute%20precision%20and%20recall%20for%20our%20model.%0A%0A%20%20%20%20*%20Evaluate%20the%20model%20on%20all%20thresholds%20from%200.0%20to%201.0%20with%20step%200.01%0A%20%20%20%20*%20For%20each%20threshold%2C%20compute%20precision%20and%20recall%0A%20%20%20%20*%20Plot%20them%0A%20%20%20%20%22%22%22%0A%20%20%20%20)%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(%0A%20%20%20%20DictVectorizer%2C%0A%20%20%20%20LogisticRegression%2C%0A%20%20%20%20dict_vectorizer%2C%0A%20%20%20%20model%2C%0A%20%20%20%20np%2C%0A%20%20%20%20pd%2C%0A%20%20%20%20plt%2C%0A%20%20%20%20separate_target%2C%0A%20%20%20%20val_dataframe%2C%0A)%3A%0A%20%20%20%20from%20sklearn.metrics%20import%20recall_score%2C%20precision_score%0A%0A%20%20%20%20def%20precision_and_recall_for_threshold(%0A%20%20%20%20%20%20%20%20model%3A%20LogisticRegression%2C%0A%20%20%20%20%20%20%20%20dict_vectorizer%3A%20DictVectorizer%2C%0A%20%20%20%20%20%20%20%20dataframe%3A%20pd.DataFrame%2C%0A%20%20%20%20%20%20%20%20threshold%3A%20float%0A%20%20%20%20)%20-%3E%20tuple%3A%0A%20%20%20%20%20%20%20%20X%2C%20y%20%3D%20separate_target(dataframe)%0A%20%20%20%20%20%20%20%20X_dict%20%3D%20dict_vectorizer.transform(X.to_dict(orient%3D%22records%22))%0A%20%20%20%20%20%20%20%20y_pred%20%3D%20model.predict_proba(X_dict)%5B%3A%2C%201%5D%20%3E%3D%20threshold%0A%0A%20%20%20%20%20%20%20%20return%20precision_score(y%2C%20y_pred%2C%20zero_division%3D1.0)%2C%20recall_score(y%2C%20y_pred)%0A%0A%20%20%20%20def%20evaluate_precision_and_recall(%0A%20%20%20%20%20%20%20%20model%3A%20LogisticRegression%2C%0A%20%20%20%20%20%20%20%20dict_vectorizer%3A%20DictVectorizer%2C%0A%20%20%20%20%20%20%20%20dataframe%3A%20pd.DataFrame%2C%0A%20%20%20%20)%20-%3E%20list%3A%0A%20%20%20%20%20%20%20%20evaluation%20%3D%20%5B%5D%0A%0A%20%20%20%20%20%20%20%20for%20threshold%20in%20np.linspace(0%2C%201%2C%20100)%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20precision%2C%20recall%20%3D%20precision_and_recall_for_threshold(model%2C%20dict_vectorizer%2C%20dataframe%2C%20threshold)%0A%20%20%20%20%20%20%20%20%20%20%20%20evaluation.append((threshold%2C%20precision%2C%20recall%2C))%0A%0A%20%20%20%20%20%20%20%20return%20pd.DataFrame(evaluation%2C%20columns%3D%5B%22threshold%22%2C%20%22precision%22%2C%20%22recall%22%5D)%0A%0A%20%20%20%20def%20plot_precision_and_recall(%0A%20%20%20%20%20%20%20%20model%3A%20LogisticRegression%2C%0A%20%20%20%20%20%20%20%20dict_vectorizer%3A%20DictVectorizer%2C%0A%20%20%20%20%20%20%20%20dataframe%3A%20pd.DataFrame%2C%0A%20%20%20%20)%3A%0A%20%20%20%20%20%20%20%20evaluation%20%3D%20evaluate_precision_and_recall(model%2C%20dict_vectorizer%2C%20dataframe)%0A%0A%20%20%20%20%20%20%20%20plt.plot(evaluation.threshold%2C%20evaluation.precision%2C%20label%3D%22Precision%22%2C%20color%3D%22g%22)%0A%20%20%20%20%20%20%20%20plt.plot(evaluation.threshold%2C%20evaluation.recall%2C%20label%3D%22Recall%22%2C%20color%3D%22r%22)%0A%20%20%20%20%20%20%20%20plt.vlines(0.64%2C%200%2C%201)%0A%20%20%20%20%20%20%20%20plt.xlabel(%22Threshold%22)%0A%20%20%20%20%20%20%20%20plt.show()%0A%0A%20%20%20%20plot_precision_and_recall(model%2C%20dict_vectorizer%2C%20val_dataframe)%0A%20%20%20%20return%20(evaluate_precision_and_recall%2C)%0A%0A%0A%40app.cell(hide_code%3DTrue)%0Adef%20_(mo)%3A%0A%20%20%20%20mo.md(%0A%20%20%20%20%20%20%20%20r%22%22%22%0A%20%20%20%20At%20which%20threshold%20precision%20and%20recall%20curves%20intersect%3F%0A%0A%20%20%20%20*%200.145%0A%20%20%20%20*%200.345%0A%20%20%20%20*%200.545%0A%20%20%20%20*%200.745%0A%20%20%20%20%22%22%22%0A%20%20%20%20)%0A%20%20%20%20return%0A%0A%0A%40app.cell(hide_code%3DTrue)%0Adef%20_(mo)%3A%0A%20%20%20%20mo.md(r%22%22%22The%20closest%20suggested%20is%200.545.%22%22%22)%0A%20%20%20%20return%0A%0A%0A%40app.cell(hide_code%3DTrue)%0Adef%20_(mo)%3A%0A%20%20%20%20mo.md(%0A%20%20%20%20%20%20%20%20r%22%22%22%0A%20%20%20%20%23%23%23%20Question%204%3A%20F1%20score%0A%0A%20%20%20%20Precision%20and%20recall%20are%20conflicting%20-%20when%20one%20grows%2C%20the%20other%20goes%20down.%20That's%20why%20they%20are%20often%20combined%20into%20the%20F1%20score%20-%20a%20metrics%20that%20takes%20into%20account%20both%0A%0A%20%20%20%20This%20is%20the%20formula%20for%20computing%20F1%3A%0A%0A%20%20%20%20%24%24F_1%20%3D%202%20%5Ccdot%20%5Ccfrac%7BP%20%5Ccdot%20R%7D%7BP%20%2B%20R%7D%24%24%0A%0A%20%20%20%20Where%20%24P%24%20is%20precision%20and%20%24R%24%20is%20recall.%0A%0A%20%20%20%20Let's%20compute%20F1%20for%20all%20thresholds%20from%200.0%20to%201.0%20with%20increment%200.01%0A%20%20%20%20%22%22%22%0A%20%20%20%20)%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(%0A%20%20%20%20DictVectorizer%2C%0A%20%20%20%20LogisticRegression%2C%0A%20%20%20%20dict_vectorizer%2C%0A%20%20%20%20evaluate_precision_and_recall%2C%0A%20%20%20%20model%2C%0A%20%20%20%20pd%2C%0A%20%20%20%20plt%2C%0A%20%20%20%20val_dataframe%2C%0A)%3A%0A%20%20%20%20def%20evaluate_with_f1(%0A%20%20%20%20%20%20%20%20model%3A%20LogisticRegression%2C%0A%20%20%20%20%20%20%20%20dict_vectorizer%3A%20DictVectorizer%2C%0A%20%20%20%20%20%20%20%20dataframe%3A%20pd.DataFrame%2C%0A%20%20%20%20)%3A%0A%20%20%20%20%20%20%20%20evaluation%20%3D%20evaluate_precision_and_recall(model%2C%20dict_vectorizer%2C%20dataframe)%0A%20%20%20%20%20%20%20%20evaluation%5B%22f1%22%5D%20%3D%202%20*%20evaluation.precision%20*%20evaluation.recall%20%2F%20(evaluation.precision%20%2B%20evaluation.recall)%0A%0A%20%20%20%20%20%20%20%20return%20evaluation%0A%0A%20%20%20%20def%20plot_f1(evaluation%3A%20pd.DataFrame)%3A%0A%20%20%20%20%20%20%20%20plt.plot(evaluation.threshold%2C%20evaluation.f1%2C%20label%3D%22F1%22%2C%20color%3D%22b%22)%0A%20%20%20%20%20%20%20%20plt.xlabel(%22Threshold%22)%0A%20%20%20%20%20%20%20%20plt.show()%0A%0A%20%20%20%20def%20find_max(evaluation%3A%20pd.DataFrame)%3A%0A%20%20%20%20%20%20%20%20f1_max%20%3D%20evaluation%5Bevaluation.f1%20%3D%3D%20evaluation.f1.max()%5D.iloc%5B0%5D%0A%20%20%20%20%20%20%20%20print(%22F1%20max%20is%20%7B%3A.3f%7D%20and%20it's%20reach%20at%20%7B%3A.3f%7D%22.format(f1_max.f1%2C%20f1_max.threshold))%0A%0A%20%20%20%20f1_evaluation%20%3D%20evaluate_with_f1(model%2C%20dict_vectorizer%2C%20val_dataframe)%0A%20%20%20%20plot_f1(f1_evaluation)%0A%20%20%20%20find_max(f1_evaluation)%0A%20%20%20%20return%0A%0A%0A%40app.cell(hide_code%3DTrue)%0Adef%20_(mo)%3A%0A%20%20%20%20mo.md(%0A%20%20%20%20%20%20%20%20r%22%22%22%0A%20%20%20%20At%20which%20threshold%20F1%20is%20maximal%3F%0A%0A%20%20%20%20-%200.14%0A%20%20%20%20-%200.34%0A%20%20%20%20-%200.54%0A%20%20%20%20-%200.74%0A%20%20%20%20%22%22%22%0A%20%20%20%20)%0A%20%20%20%20return%0A%0A%0A%40app.cell(hide_code%3DTrue)%0Adef%20_(mo)%3A%0A%20%20%20%20mo.md(r%22%22%22The%20closest%20suggested%20option%20to%20the%20threshold%20where%20F1%20is%20maximal%20is%200.54.%22%22%22)%0A%20%20%20%20return%0A%0A%0A%40app.cell(hide_code%3DTrue)%0Adef%20_(mo)%3A%0A%20%20%20%20mo.md(%0A%20%20%20%20%20%20%20%20r%22%22%22%0A%20%20%20%20%23%23%20Question%205%3A%205-Fold%20CV%0A%0A%0A%20%20%20%20Use%20the%20%60KFold%60%20class%20from%20Scikit-Learn%20to%20evaluate%20our%20model%20on%205%20different%20folds%3A%0A%0A%20%20%20%20%60%60%60%0A%20%20%20%20KFold(n_splits%3D5%2C%20shuffle%3DTrue%2C%20random_state%3D1)%0A%20%20%20%20%60%60%60%0A%0A%20%20%20%20*%20Iterate%20over%20different%20folds%20of%20%60df_full_train%60%0A%20%20%20%20*%20Split%20the%20data%20into%20train%20and%20validation%0A%20%20%20%20*%20Train%20the%20model%20on%20train%20with%20these%20parameters%3A%20%60LogisticRegression(solver%3D'liblinear'%2C%20C%3D1.0%2C%20max_iter%3D1000)%60%0A%20%20%20%20*%20Use%20AUC%20to%20evaluate%20the%20model%20on%20validation%0A%20%20%20%20%22%22%22%0A%20%20%20%20)%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(%0A%20%20%20%20DictVectorizer%2C%0A%20%20%20%20LogisticRegression%2C%0A%20%20%20%20categorical_columns%2C%0A%20%20%20%20full_dataframe%2C%0A%20%20%20%20np%2C%0A%20%20%20%20numeric_columns%2C%0A%20%20%20%20pd%2C%0A%20%20%20%20roc_auc_score%2C%0A)%3A%0A%20%20%20%20from%20sklearn.model_selection%20import%20KFold%0A%0A%20%20%20%20def%20get_trained_vectorizer(dataframe%3A%20pd.DataFrame)%20-%3E%20list%5Bdict%5D%3A%0A%20%20%20%20%20%20%20%20copy%20%3D%20dataframe.copy()%0A%20%20%20%20%20%20%20%20del%20copy%5B%22converted%22%5D%0A%20%20%20%20%20%20%20%20dictionary%20%3D%20copy.to_dict(orient%3D%22records%22)%0A%0A%20%20%20%20%20%20%20%20dict_vectorizer%20%3D%20DictVectorizer(sparse%3DFalse)%0A%20%20%20%20%20%20%20%20dict_vectorizer.fit(dictionary)%0A%0A%20%20%20%20%20%20%20%20return%20dict_vectorizer%2C%20dictionary%0A%0A%20%20%20%20def%20get_features_and_target(dataframe%3A%20pd.DataFrame%2C%20dict_vectorizer%3A%20DictVectorizer%2C%20dictionary)%3A%0A%20%20%20%20%20%20%20%20X%20%3D%20dict_vectorizer.transform(dictionary)%0A%20%20%20%20%20%20%20%20y%20%3D%20dataframe.converted%20%3D%3D%201%0A%0A%20%20%20%20%20%20%20%20return%20X%2C%20y%0A%0A%20%20%20%20def%20train_folds(df_full%3A%20pd.DataFrame)%3A%0A%20%20%20%20%20%20%20%20kfolds%20%3D%20KFold(n_splits%3D5%2C%20shuffle%3DTrue%2C%20random_state%3D1)%0A%0A%20%20%20%20%20%20%20%20auc_scores%20%3D%20%5B%5D%0A%20%20%20%20%20%20%20%20for%20train_idx%2C%20val_idx%20in%20kfolds.split(df_full)%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20df_train%20%3D%20df_full.iloc%5Btrain_idx%5D%0A%20%20%20%20%20%20%20%20%20%20%20%20df_val%20%3D%20df_full.iloc%5Bval_idx%5D%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20dict_vectorizer%2C%20dictionary%20%3D%20get_trained_vectorizer(df_train)%0A%20%20%20%20%20%20%20%20%20%20%20%20X_train%2C%20y_train%20%3D%20get_features_and_target(df_train%2C%20dict_vectorizer%2C%20dictionary)%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20model%20%3D%20LogisticRegression(solver%3D'liblinear'%2C%20C%3D1.0%2C%20max_iter%3D1000)%0A%20%20%20%20%20%20%20%20%20%20%20%20model.fit(X_train%2C%20y_train)%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20dictionary_val%20%3D%20df_val%5Bnumeric_columns%20%2B%20categorical_columns%5D.to_dict(orient%3D%22records%22)%0A%20%20%20%20%20%20%20%20%20%20%20%20X_val%2C%20y_val%20%3D%20get_features_and_target(df_val%2C%20dict_vectorizer%2C%20dictionary_val)%0A%20%20%20%20%20%20%20%20%20%20%20%20y_pred%20%3D%20model.predict_proba(X_val)%5B%3A%2C1%5D%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20auc_scores.append(roc_auc_score(y_val%2C%20y_pred))%0A%0A%20%20%20%20%20%20%20%20print(%22%7B%3A.3f%7D%20%2B-%20%7B%3A.3f%7D%22.format(np.mean(auc_scores)%2C%20np.std(auc_scores)))%0A%0A%20%20%20%20%20%20%20%20return%20auc_scores%0A%0A%20%20%20%20train_folds(full_dataframe)%0A%20%20%20%20return%20KFold%2C%20get_features_and_target%2C%20get_trained_vectorizer%0A%0A%0A%40app.cell(hide_code%3DTrue)%0Adef%20_(mo)%3A%0A%20%20%20%20mo.md(%0A%20%20%20%20%20%20%20%20r%22%22%22%0A%20%20%20%20How%20large%20is%20standard%20deviation%20of%20the%20scores%20across%20different%20folds%3F%0A%0A%20%20%20%20-%200.0001%0A%20%20%20%20-%200.006%0A%20%20%20%20-%200.06%0A%20%20%20%20-%200.36%0A%20%20%20%20%22%22%22%0A%20%20%20%20)%0A%20%20%20%20return%0A%0A%0A%40app.cell(hide_code%3DTrue)%0Adef%20_(mo)%3A%0A%20%20%20%20mo.md(r%22%22%22The%20closest%20value%20to%20the%20standard%20deviation%20across%20folds%20is%20%240.06%24.%22%22%22)%0A%20%20%20%20return%0A%0A%0A%40app.cell(hide_code%3DTrue)%0Adef%20_(mo)%3A%0A%20%20%20%20mo.md(%0A%20%20%20%20%20%20%20%20r%22%22%22%0A%20%20%20%20%23%23%23%20Question%206%3A%20Hyperparameter%20Tuning%0A%0A%20%20%20%20Now%20let's%20use%205-Fold%20cross-validation%20to%20find%20the%20best%20parameter%20%60C%60%0A%0A%20%20%20%20*%20Iterate%20over%20the%20following%20%60C%60%20values%3A%20%60%5B0.000001%2C%200.001%2C%201%5D%60%0A%20%20%20%20*%20Initialize%20%60KFold%60%20with%20the%20same%20parameters%20as%20previously%0A%20%20%20%20*%20Use%20these%20parameters%20for%20the%20model%3A%20%60LogisticRegression(solver%3D'liblinear'%2C%20C%3DC%2C%20max_iter%3D1000)%60%0A%20%20%20%20*%20Compute%20the%20mean%20score%20as%20well%20as%20the%20std%20(round%20the%20mean%20and%20std%20to%203%20decimal%20digits)%0A%20%20%20%20%22%22%22%0A%20%20%20%20)%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(%0A%20%20%20%20KFold%2C%0A%20%20%20%20LogisticRegression%2C%0A%20%20%20%20categorical_columns%2C%0A%20%20%20%20full_dataframe%2C%0A%20%20%20%20get_features_and_target%2C%0A%20%20%20%20get_trained_vectorizer%2C%0A%20%20%20%20np%2C%0A%20%20%20%20numeric_columns%2C%0A%20%20%20%20pd%2C%0A%20%20%20%20roc_auc_score%2C%0A)%3A%0A%20%20%20%20def%20hypertune_folds(df_full%3A%20pd.DataFrame%2C%20C%3A%20float)%3A%0A%20%20%20%20%20%20%20%20kfolds%20%3D%20KFold(n_splits%3D5%2C%20shuffle%3DTrue%2C%20random_state%3D1)%0A%0A%20%20%20%20%20%20%20%20auc_scores%20%3D%20%5B%5D%0A%20%20%20%20%20%20%20%20for%20train_idx%2C%20val_idx%20in%20kfolds.split(df_full)%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20df_train%20%3D%20df_full.iloc%5Btrain_idx%5D%0A%20%20%20%20%20%20%20%20%20%20%20%20df_val%20%3D%20df_full.iloc%5Bval_idx%5D%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20dict_vectorizer%2C%20dictionary%20%3D%20get_trained_vectorizer(df_train)%0A%20%20%20%20%20%20%20%20%20%20%20%20X_train%2C%20y_train%20%3D%20get_features_and_target(df_train%2C%20dict_vectorizer%2C%20dictionary)%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20model%20%3D%20LogisticRegression(solver%3D'liblinear'%2C%20C%3DC%2C%20max_iter%3D1000)%0A%20%20%20%20%20%20%20%20%20%20%20%20model.fit(X_train%2C%20y_train)%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20dictionary_val%20%3D%20df_val%5Bnumeric_columns%20%2B%20categorical_columns%5D.to_dict(orient%3D%22records%22)%0A%20%20%20%20%20%20%20%20%20%20%20%20X_val%2C%20y_val%20%3D%20get_features_and_target(df_val%2C%20dict_vectorizer%2C%20dictionary_val)%0A%20%20%20%20%20%20%20%20%20%20%20%20y_pred%20%3D%20model.predict_proba(X_val)%5B%3A%2C1%5D%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20auc_scores.append(roc_auc_score(y_val%2C%20y_pred))%0A%0A%20%20%20%20%20%20%20%20print(%22C%3D%7B%3A.3f%7D%3A%20%7B%3A.3f%7D%20%2B-%20%7B%3A.3f%7D%22.format(C%2C%20np.mean(auc_scores)%2C%20np.std(auc_scores)))%0A%0A%20%20%20%20%20%20%20%20return%20auc_scores%0A%0A%20%20%20%20def%20test_c_values(df_full%3A%20pd.DataFrame%2C%20C_values%3A%20list%5Bfloat%5D)%3A%0A%20%20%20%20%20%20%20%20auc_scores%20%3D%20%5B%5D%0A%20%20%20%20%20%20%20%20for%20C_value%20in%20C_values%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20auc_scores.append(hypertune_folds(full_dataframe%2C%20C_value))%0A%0A%20%20%20%20%20%20%20%20return%20auc_scores%0A%0A%20%20%20%20test_c_values(full_dataframe%2C%20%5B0.000001%2C%200.001%2C%201%5D)%0A%20%20%20%20return%0A%0A%0A%40app.cell(hide_code%3DTrue)%0Adef%20_(mo)%3A%0A%20%20%20%20mo.md(%0A%20%20%20%20%20%20%20%20r%22%22%22%0A%20%20%20%20Which%20%60C%60%20leads%20to%20the%20best%20mean%20score%3F%0A%0A%20%20%20%20-%200.000001%0A%20%20%20%20-%200.001%0A%20%20%20%20-%201%0A%20%20%20%20%22%22%22%0A%20%20%20%20)%0A%20%20%20%20return%0A%0A%0A%40app.cell(hide_code%3DTrue)%0Adef%20_(mo)%3A%0A%20%20%20%20mo.md(r%22%22%22The%20best%20score%20corresponds%20to%20%24C%20%3D%200.001%24.%22%22%22)%0A%20%20%20%20return%0A%0A%0Aif%20__name__%20%3D%3D%20%22__main__%22%3A%0A%20%20%20%20app.run()%0A
</marimo-code>

<marimo-code-hash hidden="">aa721d51eb989cfc1dd742ba21ff20b311cfb726d2e3a3e1a560e2fef3b1aea8</marimo-code-hash>
</body>
</html>
