<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <link rel="icon" crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.16.0/dist/favicon.ico" />
    <!-- Preload is necessary because we show these images when we disconnect from the server,
    but at that point we cannot load these images from the server -->
    <link rel="preload" crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.16.0/dist/assets/gradient-yHQUC_QB.png" as="image" />
    <link rel="preload" crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.16.0/dist/assets/noise-60BoTA8O.png" as="image" />
    <!-- Preload the fonts -->
    <link rel="preload" crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.16.0/dist/assets/Lora-VariableFont_wght-B2ootaw-.ttf" as="font" crossorigin="anonymous" />
    <link rel="preload" crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.16.0/dist/assets/PTSans-Regular-CxL0S8W7.ttf" as="font" crossorigin="anonymous" />
    <link rel="preload" crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.16.0/dist/assets/PTSans-Bold-D9fedIX3.ttf" as="font" crossorigin="anonymous" />
    <link rel="preload" crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.16.0/dist/assets/FiraMono-Regular-BTCkDNvf.ttf" as="font" crossorigin="anonymous" />
    <link rel="preload" crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.16.0/dist/assets/FiraMono-Medium-DU3aDxX5.ttf" as="font" crossorigin="anonymous" />
    <link rel="preload" crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.16.0/dist/assets/FiraMono-Bold-CLVRCuM9.ttf" as="font" crossorigin="anonymous" />

    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="theme-color" content="#000000" />
    <meta name="description" content="a marimo app" />
    <link rel="apple-touch-icon" crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.16.0/dist/apple-touch-icon.png" />
    <link rel="manifest" crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.16.0/dist/manifest.json" />

    <script data-marimo="true">
      function __resizeIframe(obj) {
        var scrollbarHeight = 20; // Max between windows, mac, and linux

        function setHeight() {
          var element = obj.contentWindow.document.documentElement;
          // If there is no vertical scrollbar, we don't need to resize the iframe
          if (element.scrollHeight === element.clientHeight) {
            return;
          }

          // Create a new height that includes the scrollbar height if it's visible
          var hasHorizontalScrollbar = element.scrollWidth > element.clientWidth;
          var newHeight = element.scrollHeight + (hasHorizontalScrollbar ? scrollbarHeight : 0);

          // Only update the height if it's different from the current height
          if (obj.style.height !== `${newHeight}px`) {
            obj.style.height = `${newHeight}px`;
          }
        }

        // Resize the iframe to the height of the content and bottom scrollbar height
        setHeight();

        // Resize the iframe when the content changes
        const resizeObserver = new ResizeObserver((entries) => {
          setHeight();
        });
        resizeObserver.observe(obj.contentWindow.document.body);
      }
    </script>
    <marimo-filename hidden>homework.py</marimo-filename>
    <!-- TODO(Trevor): Legacy, required by VS Code plugin. Remove when plugin is updated (see marimo/server/_templates/template.py) -->
    <marimo-version data-version="{{ version }}" hidden></marimo-version>
    <marimo-user-config data-config="{{ user_config }}" hidden></marimo-user-config>
    <marimo-server-token data-token="{{ server_token }}" hidden></marimo-server-token>
    <!-- /TODO -->
    <title>homework</title>
    <script type="module" crossorigin crossorigin="anonymous" src="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.16.0/dist/assets/index-DKEudB02.js"></script>
    <link rel="stylesheet" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.16.0/dist/assets/index-Cx0bsY1w.css">
  
<script data-marimo="true">
    window.__MARIMO_STATIC__ = {};
    window.__MARIMO_STATIC__.files = {};
</script>
</head>
  <body>
    <div id="root"></div>
    <!-- This is a portal for the data editor to render in -->
    <div id="portal" data-testid="glide-portal" style="position: fixed; left: 0; top: 0; z-index: 9999"></div>
    <script data-marimo="true">
      window.__MARIMO_MOUNT_CONFIG__ = {
            "filename": "homework.py",
            "mode": "read",
            "version": "0.16.0",
            "serverToken": "static",
            "config": {"ai": {"models": {"custom_models": [], "displayed_models": []}}, "completion": {"activate_on_typing": true, "copilot": false}, "display": {"cell_output": "above", "code_editor_font_size": 14, "dataframes": "rich", "default_table_max_columns": 50, "default_table_page_size": 10, "default_width": "medium", "reference_highlighting": false, "theme": "light"}, "formatting": {"line_length": 79}, "keymap": {"overrides": {}, "preset": "default"}, "language_servers": {"pylsp": {"enable_flake8": false, "enable_mypy": true, "enable_pydocstyle": false, "enable_pyflakes": false, "enable_pylint": false, "enable_ruff": true, "enabled": true}}, "package_management": {"manager": "pip"}, "runtime": {"auto_instantiate": true, "auto_reload": "off", "default_sql_output": "auto", "on_cell_change": "autorun", "output_max_bytes": 8000000, "reactive_tests": true, "std_stream_max_bytes": 1000000, "watcher_on_save": "lazy"}, "save": {"autosave": "after_delay", "autosave_delay": 1000, "format_on_save": false}, "server": {"browser": "default", "follow_symlink": false}, "snippets": {"custom_paths": [], "include_default_snippets": true}},
            "configOverrides": {},
            "appConfig": {"sql_output": "auto", "width": "medium"},
            "view": {"showAppCode": true},
            "notebook": {"cells": [{"code": "import marimo as mo\nimport pandas as pd\nimport numpy as np\nimport matplotlib.pyplot as plt\nimport seaborn as sns", "code_hash": "e76e8dbe4d9bf74eff98fef5f002130b", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "Hbol", "name": "_"}, {"code": "mo.md(\n    r\"\"\"\n# Module 4: [Evaluation](https://github.com/DataTalksClub/machine-learning-zoomcamp/tree/master/04-evaluation)\n\n## Homework\n\n### Dataset\n\nFor this homework, we'll use the lead scoring Bank Marketing dataset. Download it from here. You can do it with wget:\n\nwget [https://raw.githubusercontent.com/alexeygrigorev/datasets/master/course_lead_scoring.csv](https://raw.githubusercontent.com/alexeygrigorev/datasets/master/course_lead_scoring.csv)\n\nIn this dataset our desired target for classification task will be **converted** variable - has the client signed up to the platform or not.\n\"\"\"\n)", "code_hash": "5935c1aff22d411ae290e429520e51d5", "config": {"column": null, "disabled": false, "hide_code": true}, "id": "MJUe", "name": "_"}, {"code": "def read_dataframe():\n    return pd.read_csv(\"./module-4/data/course_lead_scoring.csv\")\n\nraw_dataframe = read_dataframe()\nraw_dataframe.head()", "code_hash": "2d7ae8cfb88a00fc323d840f14c1f81e", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "vblA", "name": "_"}, {"code": "mo.md(\n    r\"\"\"\n## Data preparation\n\n### Check if the missing values are presented in the features\n\"\"\"\n)", "code_hash": "04e7f3ba0031727b2c3ccfe11cc6da3e", "config": {"column": null, "disabled": false, "hide_code": true}, "id": "bkHC", "name": "_"}, {"code": "raw_dataframe.isnull().sum()", "code_hash": "03967554aa13b8649ea859cee703e506", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "lEQa", "name": "_"}, {"code": "mo.md(\n    r\"\"\"\n### If there are missing values:\n\n#### For categorical features, replace them with 'NA'\n\"\"\"\n)", "code_hash": "7c11c1bfa5ee3a31b904e319bf2425c1", "config": {"column": null, "disabled": false, "hide_code": true}, "id": "PKri", "name": "_"}, {"code": "categorical_columns = [\"lead_source\", \"industry\", \"employment_status\", \"location\"]\n\ndef fill_categorical_values(dataframe):\n    dataframe[categorical_columns] = dataframe[categorical_columns].fillna('NA')\n\n    return dataframe\n\nfill_categorical_values(raw_dataframe).head()", "code_hash": "bcb93a5fba257250f4ed8448c4b1b4b0", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "Xref", "name": "_"}, {"code": "mo.md(r\"\"\"#### For numerical features, replace with with 0.0\"\"\")", "code_hash": "0cc9e64f50f00f179f271a5088c6bcbf", "config": {"column": null, "disabled": false, "hide_code": true}, "id": "SFPL", "name": "_"}, {"code": "numeric_columns = [\"number_of_courses_viewed\", \"annual_income\", \"interaction_count\", \"lead_score\"]\n\ndef fill_numerical_values(dataframe):\n    dataframe[numeric_columns] = dataframe[numeric_columns].fillna(0.0)\n\n    return dataframe\n\nfill_numerical_values(raw_dataframe).head()", "code_hash": "fdbb551bb24285c4818cea49cb225d40", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "BYtC", "name": "_"}, {"code": "filled_dataframe = fill_numerical_values(fill_categorical_values(raw_dataframe.copy()))\nfilled_dataframe.head()", "code_hash": "6bf4b01a402e968d37afda08ae2b8054", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "RGSE", "name": "_"}, {"code": "mo.md(\n    r\"\"\"\n#### Split the data into 3 parts\n\nSplit the data into 3 parts: train/validation/test with 60% / 20% / 20% distribution. Use train_test_split function for that with random_state=1.\n\"\"\"\n)", "code_hash": "bc1e10e642a8e75e830e53d677d99a58", "config": {"column": null, "disabled": false, "hide_code": true}, "id": "Kclp", "name": "_"}, {"code": "from sklearn.model_selection import train_test_split\n\nfull_dataframe, test_dataframe = train_test_split(filled_dataframe, test_size=0.2, random_state=1)\ntrain_dataframe, val_dataframe = train_test_split(full_dataframe, test_size=0.25, random_state=1)\n\n{\n    \"len(train_dataframe)\": len(train_dataframe),\n    \"len(val_dataframe)\": len(val_dataframe),\n    \"len(test_dataframe)\": len(test_dataframe),\n}", "code_hash": "67d57567961c161b7d6612aab59b6345", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "emfo", "name": "_"}, {"code": "mo.md(\n    r\"\"\"\n## Question 1: ROC AUC feature importance\n\nROC AUC could also be used to evaluate feature importance of numerical variables. \n\nLet's do that\n\n* For each numerical variable, use it as score (aka prediction) and compute the AUC with the `y` variable as ground truth.\n* Use the training dataset for that\n\n\nIf your AUC is < 0.5, invert this variable by putting \"-\" in front\n\n(e.g. `-df_train['balance']`)\n\nAUC can go below 0.5 if the variable is negatively correlated with the target variable. You can change the direction of the correlation by negating this variable - then negative correlation becomes positive.\n\"\"\"\n)", "code_hash": "485e279a2e672f13266c042264563ec6", "config": {"column": null, "disabled": false, "hide_code": true}, "id": "Hstk", "name": "_"}, {"code": "from sklearn.metrics import roc_auc_score\n\ndef compute_auc_for_numeric_features(dataframe: pd.DataFrame) -> dict:\n    auc_scores = {}\n\n    for feature in numeric_columns:\n        auc_scores[feature] = roc_auc_score(dataframe.converted, dataframe[feature])\n\n    return auc_scores\n\ncompute_auc_for_numeric_features(train_dataframe)", "code_hash": "5db208473013165ef8b7af585357f2ea", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "nWHF", "name": "_"}, {"code": "mo.md(\n    r\"\"\"\nWhich numerical variable (among the following 4) has the highest AUC?\n\n- `lead_score`\n- `number_of_courses_viewed`\n- `interaction_count`\n- `annual_income`\n\"\"\"\n)", "code_hash": "49f125d5b1530c70882e6c8f64fe3c2f", "config": {"column": null, "disabled": false, "hide_code": true}, "id": "iLit", "name": "_"}, {"code": "mo.md(r\"\"\"The `number_of_courses_viewed` feature has the highest AUC with a value of $0.7564$.\"\"\")", "code_hash": "cfe901da89c18e563e763f4307a1f903", "config": {"column": null, "disabled": false, "hide_code": true}, "id": "ZHCJ", "name": "_"}, {"code": "mo.md(\n    r\"\"\"\n### Question 2: Training the model\n\nApply one-hot-encoding using `DictVectorizer` and train the logistic regression with these parameters:\n\n```python\nLogisticRegression(solver='liblinear', C=1.0, max_iter=1000)\n```\n\"\"\"\n)", "code_hash": "ca351cd24e9137492607482f23cca337", "config": {"column": null, "disabled": false, "hide_code": true}, "id": "ROlb", "name": "_"}, {"code": "from sklearn.linear_model import LogisticRegression\nfrom sklearn.feature_extraction import DictVectorizer\n\ndef separate_target(dataframe: pd.DataFrame):\n    y = dataframe.converted\n    X = dataframe.drop(columns=['converted'])\n    return X[numeric_columns + categorical_columns], y\n\ndef train(dataframe: pd.DataFrame):\n    X, y = separate_target(dataframe)\n\n    dict_vectorizer = DictVectorizer(sparse=False)\n    X_dict = dict_vectorizer.fit_transform(X.to_dict(orient=\"records\"))\n\n    model = LogisticRegression(solver='liblinear', C=1.0, max_iter=1000, random_state=1)\n    model.fit(X_dict, y)\n\n    return dict_vectorizer, model\n\ndef evaluate(\n    model: LogisticRegression,\n    dict_vectorizer: DictVectorizer,\n    dataframe: pd.DataFrame\n) -> float:\n    X, y = separate_target(dataframe)\n    X_dict = dict_vectorizer.transform(X.to_dict(orient=\"records\"))\n\n    y_pred = model.predict_proba(X_dict)[:, 1] >= 0.55\n\n    return round(roc_auc_score(y, y_pred), 3)\n\ndict_vectorizer, model = train(train_dataframe)\nevaluate(model, dict_vectorizer, val_dataframe)", "code_hash": "d3991a63b92369be080291ea0fb57309", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "qnkX", "name": "_"}, {"code": "mo.md(\n    r\"\"\"\nWhat's the AUC of this model on the validation dataset? (round to 3 digits)\n\n- 0.32\n- 0.52\n- 0.72\n- 0.92\n\"\"\"\n)", "code_hash": "17fcf33ebc7a4c24e8cf2b24c5b6aa3b", "config": {"column": null, "disabled": false, "hide_code": true}, "id": "TqIu", "name": "_"}, {"code": "mo.md(r\"\"\"The AUC of this model is 0.72.\"\"\")", "code_hash": "d3be7e9f58e16b4b4b97395c1a3da83b", "config": {"column": null, "disabled": false, "hide_code": true}, "id": "Vxnm", "name": "_"}, {"code": "mo.md(\n    r\"\"\"\n### Question 3: Precision and Recall\n\nNow let's compute precision and recall for our model.\n\n* Evaluate the model on all thresholds from 0.0 to 1.0 with step 0.01\n* For each threshold, compute precision and recall\n* Plot them\n\"\"\"\n)", "code_hash": "e91df18f7d004ab032b841aa6d1db6c9", "config": {"column": null, "disabled": false, "hide_code": true}, "id": "DnEU", "name": "_"}, {"code": "from sklearn.metrics import recall_score, precision_score\n\ndef precision_and_recall_for_threshold(\n    model: LogisticRegression,\n    dict_vectorizer: DictVectorizer,\n    dataframe: pd.DataFrame,\n    threshold: float\n) -> tuple:\n    X, y = separate_target(dataframe)\n    X_dict = dict_vectorizer.transform(X.to_dict(orient=\"records\"))\n    y_pred = model.predict_proba(X_dict)[:, 1] >= threshold\n\n    return precision_score(y, y_pred, zero_division=1.0), recall_score(y, y_pred)\n\ndef evaluate_precision_and_recall(\n    model: LogisticRegression,\n    dict_vectorizer: DictVectorizer,\n    dataframe: pd.DataFrame,\n) -> list:\n    evaluation = []\n\n    for threshold in np.linspace(0, 1, 100):\n        precision, recall = precision_and_recall_for_threshold(model, dict_vectorizer, dataframe, threshold)\n        evaluation.append((threshold, precision, recall,))\n\n    return pd.DataFrame(evaluation, columns=[\"threshold\", \"precision\", \"recall\"])\n\ndef plot_precision_and_recall(\n    model: LogisticRegression,\n    dict_vectorizer: DictVectorizer,\n    dataframe: pd.DataFrame,\n):\n    evaluation = evaluate_precision_and_recall(model, dict_vectorizer, dataframe)\n\n    plt.plot(evaluation.threshold, evaluation.precision, label=\"Precision\", color=\"g\")\n    plt.plot(evaluation.threshold, evaluation.recall, label=\"Recall\", color=\"r\")\n    plt.xlabel(\"Threshold\")\n    plt.show()\n\nplot_precision_and_recall(model, dict_vectorizer, val_dataframe)", "code_hash": "a3a4b9205812c3205479ee8baa5b108c", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "ulZA", "name": "_"}, {"code": "mo.md(\n    r\"\"\"\nAt which threshold precision and recall curves intersect?\n\n* 0.145\n* 0.345\n* 0.545\n* 0.745\n\"\"\"\n)", "code_hash": "64fcc06bea26d9772927dab1c0b6ac20", "config": {"column": null, "disabled": false, "hide_code": true}, "id": "ecfG", "name": "_"}, {"code": "mo.md(r\"\"\"Precision and recall intersect at 0.745.\"\"\")", "code_hash": "9b35fb50cba56b94f56250bd598939ab", "config": {"column": null, "disabled": false, "hide_code": true}, "id": "Pvdt", "name": "_"}, {"code": "mo.md(\n    r\"\"\"\n### Question 4: F1 score\n\nPrecision and recall are conflicting - when one grows, the other goes down. That's why they are often combined into the F1 score - a metrics that takes into account both\n\nThis is the formula for computing F1:\n\n$$F_1 = 2 \\cdot \\cfrac{P \\cdot R}{P + R}$$\n\nWhere $P$ is precision and $R$ is recall.\n\nLet's compute F1 for all thresholds from 0.0 to 1.0 with increment 0.01\n\"\"\"\n)", "code_hash": "a7cbb97b422ddff86e6e66416adacada", "config": {"column": null, "disabled": false, "hide_code": true}, "id": "ZBYS", "name": "_"}, {"code": "def evaluate_with_f1(\n    model: LogisticRegression,\n    dict_vectorizer: DictVectorizer,\n    dataframe: pd.DataFrame,\n):\n    evaluation = evaluate_precision_and_recall(model, dict_vectorizer, dataframe)\n    evaluation[\"f1\"] = 2 * evaluation.precision * evaluation.recall / (evaluation.precision + evaluation.recall)\n\n    return evaluation\n\ndef plot_f1(\n    model: LogisticRegression,\n    dict_vectorizer: DictVectorizer,\n    dataframe: pd.DataFrame,\n):\n    evaluation = evaluate_with_f1(model, dict_vectorizer, val_dataframe)\n\n    plt.plot(evaluation.threshold, evaluation.f1, label=\"F1\", color=\"b\")\n    plt.xlabel(\"Threshold\")\n    plt.show()\n\nplot_f1(model, dict_vectorizer, val_dataframe)", "code_hash": "de4116df6c5888ab0bacbba5d8dee471", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "aLJB", "name": "_"}, {"code": "mo.md(\n    r\"\"\"\nAt which threshold F1 is maximal?\n\n- 0.14\n- 0.34\n- 0.54\n- 0.74\n\"\"\"\n)", "code_hash": "95ce9198c365fd65cdca84f2dfee198c", "config": {"column": null, "disabled": false, "hide_code": true}, "id": "nHfw", "name": "_"}, {"code": "mo.md(r\"\"\"F1 is maximal at 0.74.\"\"\")", "code_hash": "8832d402f2d6990674f4385f16e25ddd", "config": {"column": null, "disabled": false, "hide_code": true}, "id": "xXTn", "name": "_"}, {"code": "mo.md(\n    r\"\"\"\n## Question 5: 5-Fold CV\n\n\nUse the `KFold` class from Scikit-Learn to evaluate our model on 5 different folds:\n\n```\nKFold(n_splits=5, shuffle=True, random_state=1)\n```\n\n* Iterate over different folds of `df_full_train`\n* Split the data into train and validation\n* Train the model on train with these parameters: `LogisticRegression(solver='liblinear', C=1.0, max_iter=1000)`\n* Use AUC to evaluate the model on validation\n\"\"\"\n)", "code_hash": "bf9bfafe3e3d64ece01622d5e1eb2c9f", "config": {"column": null, "disabled": false, "hide_code": true}, "id": "AjVT", "name": "_"}, {"code": "from sklearn.model_selection import KFold\n\ndef get_trained_vectorizer(dataframe: pd.DataFrame) -> list[dict]:\n    copy = dataframe.copy()\n    del copy[\"converted\"]\n    dictionary = copy.to_dict(orient=\"records\")\n\n    dict_vectorizer = DictVectorizer(sparse=False)\n    dict_vectorizer.fit(dictionary)\n\n    return dict_vectorizer, dictionary\n\ndef get_features_and_target(dataframe: pd.DataFrame, dict_vectorizer: DictVectorizer, dictionary):\n    X = dict_vectorizer.transform(dictionary)\n    y = dataframe.converted == 1\n\n    return X, y\n\ndef train_folds(df_full: pd.DataFrame):\n    kfolds = KFold(n_splits=5, shuffle=True, random_state=1)\n\n    auc_scores = []\n    for train_idx, val_idx in kfolds.split(df_full):\n        df_train = df_full.iloc[train_idx]\n        df_val = df_full.iloc[val_idx]\n\n        dict_vectorizer, dictionary = get_trained_vectorizer(df_train)\n        X_train, y_train = get_features_and_target(df_train, dict_vectorizer, dictionary)\n\n        model = LogisticRegression(solver='liblinear', C=1.0, max_iter=1000)\n        model.fit(X_train, y_train)\n\n        dictionary_val = df_val[numeric_columns + categorical_columns].to_dict(orient=\"records\")\n        X_val, y_val = get_features_and_target(df_val, dict_vectorizer, dictionary_val)\n        y_pred = model.predict_proba(X_val)[:,1]\n\n        auc_scores.append(roc_auc_score(y_val, y_pred))\n\n    print(\"{:.3f} +- {:.3f}\".format(np.mean(auc_scores), np.std(auc_scores)))\n\n    return auc_scores\n\ntrain_folds(full_dataframe)", "code_hash": "4ce5e4021bab2861a8cc18ca7712d400", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "pHFh", "name": "_"}, {"code": "mo.md(\n    r\"\"\"\nHow large is standard deviation of the scores across different folds?\n\n- 0.0001\n- 0.006\n- 0.06\n- 0.36\n\"\"\"\n)", "code_hash": "712db2359ce2b2894bbbc33fec5558ba", "config": {"column": null, "disabled": false, "hide_code": true}, "id": "NCOB", "name": "_"}, {"code": "mo.md(r\"\"\"The closest value to the standard deviation across folds is $0.06$.\"\"\")", "code_hash": "f65e5fac26d801cc9e0def75172c9563", "config": {"column": null, "disabled": false, "hide_code": true}, "id": "aqbW", "name": "_"}, {"code": "mo.md(\n    r\"\"\"\n### Question 6: Hyperparameter Tuning\n\nNow let's use 5-Fold cross-validation to find the best parameter `C`\n\n* Iterate over the following `C` values: `[0.000001, 0.001, 1]`\n* Initialize `KFold` with the same parameters as previously\n* Use these parameters for the model: `LogisticRegression(solver='liblinear', C=C, max_iter=1000)`\n* Compute the mean score as well as the std (round the mean and std to 3 decimal digits)\n\"\"\"\n)", "code_hash": "2fa6fbc273f7c15d820188b7d7486c24", "config": {"column": null, "disabled": false, "hide_code": true}, "id": "TRpd", "name": "_"}, {"code": "def hypertune_folds(df_full: pd.DataFrame, C: float):\n    kfolds = KFold(n_splits=5, shuffle=True, random_state=1)\n\n    auc_scores = []\n    for train_idx, val_idx in kfolds.split(df_full):\n        df_train = df_full.iloc[train_idx]\n        df_val = df_full.iloc[val_idx]\n\n        dict_vectorizer, dictionary = get_trained_vectorizer(df_train)\n        X_train, y_train = get_features_and_target(df_train, dict_vectorizer, dictionary)\n\n        model = LogisticRegression(solver='liblinear', C=C, max_iter=1000)\n        model.fit(X_train, y_train)\n\n        dictionary_val = df_val[numeric_columns + categorical_columns].to_dict(orient=\"records\")\n        X_val, y_val = get_features_and_target(df_val, dict_vectorizer, dictionary_val)\n        y_pred = model.predict_proba(X_val)[:,1]\n\n        auc_scores.append(roc_auc_score(y_val, y_pred))\n\n    print(\"C={:.3f}: {:.3f} +- {:.3f}\".format(C, np.mean(auc_scores), np.std(auc_scores)))\n\n    return auc_scores\n\ndef test_c_values(df_full: pd.DataFrame, C_values: list[float]):\n    auc_scores = []\n    for C_value in C_values:\n        auc_scores.append(hypertune_folds(full_dataframe, C_value))\n\n    return auc_scores\n\ntest_c_values(full_dataframe, [0.000001, 0.001, 1])", "code_hash": "18970ed384b81483f5cf72352b07f066", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "TXez", "name": "_"}, {"code": "mo.md(\n    r\"\"\"\nWhich `C` leads to the best mean score?\n\n- 0.000001\n- 0.001\n- 1\n\"\"\"\n)", "code_hash": "f27c1cacf78cde56544040a25ecccb5a", "config": {"column": null, "disabled": false, "hide_code": true}, "id": "dNNg", "name": "_"}, {"code": "mo.md(r\"\"\"The best score corresponds to $C = 0.001$.\"\"\")", "code_hash": "53030797b16d22625eb489d11f202249", "config": {"column": null, "disabled": false, "hide_code": true}, "id": "yCnT", "name": "_"}], "metadata": {"marimo_version": "0.16.0"}, "version": "1"},
            "session": {"cells": [{"code_hash": "e76e8dbe4d9bf74eff98fef5f002130b", "console": [], "id": "Hbol", "outputs": [{"data": {"text/plain": ""}, "type": "data"}]}, {"code_hash": "5935c1aff22d411ae290e429520e51d5", "console": [], "id": "MJUe", "outputs": [{"data": {"text/html": "<span class=\"markdown prose dark:prose-invert\"><h1 id=\"module-4-evaluation\">Module 4: <a href=\"https://github.com/DataTalksClub/machine-learning-zoomcamp/tree/master/04-evaluation\" rel=\"noopener\" target=\"_blank\">Evaluation</a></h1>\n<h2 id=\"homework\">Homework</h2>\n<h3 id=\"dataset\">Dataset</h3>\n<span class=\"paragraph\">For this homework, we'll use the lead scoring Bank Marketing dataset. Download it from here. You can do it with wget:</span>\n<span class=\"paragraph\">wget <a href=\"https://raw.githubusercontent.com/alexeygrigorev/datasets/master/course_lead_scoring.csv\" rel=\"noopener\" target=\"_blank\">https://raw.githubusercontent.com/alexeygrigorev/datasets/master/course_lead_scoring.csv</a></span>\n<span class=\"paragraph\">In this dataset our desired target for classification task will be <strong>converted</strong> variable - has the client signed up to the platform or not.</span></span>"}, "type": "data"}]}, {"code_hash": "2d7ae8cfb88a00fc323d840f14c1f81e", "console": [], "id": "vblA", "outputs": [{"data": {"text/html": "<marimo-ui-element object-id='vblA-0' random-id='fc6df5d8-547f-6041-1b73-76aaf83769a8'><marimo-table data-initial-value='[]' data-label='null' data-data='&quot;[{&#92;&quot;lead_source&#92;&quot;:&#92;&quot;paid_ads&#92;&quot;,&#92;&quot;industry&#92;&quot;:null,&#92;&quot;number_of_courses_viewed&#92;&quot;:1,&#92;&quot;annual_income&#92;&quot;:79450.0,&#92;&quot;employment_status&#92;&quot;:&#92;&quot;unemployed&#92;&quot;,&#92;&quot;location&#92;&quot;:&#92;&quot;south_america&#92;&quot;,&#92;&quot;interaction_count&#92;&quot;:4,&#92;&quot;lead_score&#92;&quot;:0.94,&#92;&quot;converted&#92;&quot;:1},{&#92;&quot;lead_source&#92;&quot;:&#92;&quot;social_media&#92;&quot;,&#92;&quot;industry&#92;&quot;:&#92;&quot;retail&#92;&quot;,&#92;&quot;number_of_courses_viewed&#92;&quot;:1,&#92;&quot;annual_income&#92;&quot;:46992.0,&#92;&quot;employment_status&#92;&quot;:&#92;&quot;employed&#92;&quot;,&#92;&quot;location&#92;&quot;:&#92;&quot;south_america&#92;&quot;,&#92;&quot;interaction_count&#92;&quot;:1,&#92;&quot;lead_score&#92;&quot;:0.8,&#92;&quot;converted&#92;&quot;:0},{&#92;&quot;lead_source&#92;&quot;:&#92;&quot;events&#92;&quot;,&#92;&quot;industry&#92;&quot;:&#92;&quot;healthcare&#92;&quot;,&#92;&quot;number_of_courses_viewed&#92;&quot;:5,&#92;&quot;annual_income&#92;&quot;:78796.0,&#92;&quot;employment_status&#92;&quot;:&#92;&quot;unemployed&#92;&quot;,&#92;&quot;location&#92;&quot;:&#92;&quot;australia&#92;&quot;,&#92;&quot;interaction_count&#92;&quot;:3,&#92;&quot;lead_score&#92;&quot;:0.69,&#92;&quot;converted&#92;&quot;:1},{&#92;&quot;lead_source&#92;&quot;:&#92;&quot;paid_ads&#92;&quot;,&#92;&quot;industry&#92;&quot;:&#92;&quot;retail&#92;&quot;,&#92;&quot;number_of_courses_viewed&#92;&quot;:2,&#92;&quot;annual_income&#92;&quot;:83843.0,&#92;&quot;employment_status&#92;&quot;:null,&#92;&quot;location&#92;&quot;:&#92;&quot;australia&#92;&quot;,&#92;&quot;interaction_count&#92;&quot;:1,&#92;&quot;lead_score&#92;&quot;:0.87,&#92;&quot;converted&#92;&quot;:0},{&#92;&quot;lead_source&#92;&quot;:&#92;&quot;referral&#92;&quot;,&#92;&quot;industry&#92;&quot;:&#92;&quot;education&#92;&quot;,&#92;&quot;number_of_courses_viewed&#92;&quot;:3,&#92;&quot;annual_income&#92;&quot;:85012.0,&#92;&quot;employment_status&#92;&quot;:&#92;&quot;self_employed&#92;&quot;,&#92;&quot;location&#92;&quot;:&#92;&quot;europe&#92;&quot;,&#92;&quot;interaction_count&#92;&quot;:3,&#92;&quot;lead_score&#92;&quot;:0.62,&#92;&quot;converted&#92;&quot;:1}]&quot;' data-total-rows='5' data-total-columns='9' data-max-columns='50' data-banner-text='&quot;&quot;' data-pagination='true' data-page-size='10' data-field-types='[[&quot;lead_source&quot;,[&quot;string&quot;,&quot;object&quot;]],[&quot;industry&quot;,[&quot;string&quot;,&quot;object&quot;]],[&quot;number_of_courses_viewed&quot;,[&quot;integer&quot;,&quot;int64&quot;]],[&quot;annual_income&quot;,[&quot;number&quot;,&quot;float64&quot;]],[&quot;employment_status&quot;,[&quot;string&quot;,&quot;object&quot;]],[&quot;location&quot;,[&quot;string&quot;,&quot;object&quot;]],[&quot;interaction_count&quot;,[&quot;integer&quot;,&quot;int64&quot;]],[&quot;lead_score&quot;,[&quot;number&quot;,&quot;float64&quot;]],[&quot;converted&quot;,[&quot;integer&quot;,&quot;int64&quot;]]]' data-show-filters='true' data-show-download='true' data-show-column-summaries='false' data-show-data-types='true' data-show-page-size-selector='false' data-show-column-explorer='true' data-show-chart-builder='true' data-row-headers='[]' data-has-stable-row-id='false' data-lazy='false' data-preload='false'></marimo-table></marimo-ui-element>"}, "type": "data"}]}, {"code_hash": "04e7f3ba0031727b2c3ccfe11cc6da3e", "console": [], "id": "bkHC", "outputs": [{"data": {"text/html": "<span class=\"markdown prose dark:prose-invert\"><h2 id=\"data-preparation\">Data preparation</h2>\n<h3 id=\"check-if-the-missing-values-are-presented-in-the-features\">Check if the missing values are presented in the features</h3></span>"}, "type": "data"}]}, {"code_hash": "03967554aa13b8649ea859cee703e506", "console": [], "id": "lEQa", "outputs": [{"data": {"text/html": "<marimo-ui-element object-id='lEQa-0' random-id='496f7b42-5319-bc96-08c1-f858fe26feae'><marimo-table data-initial-value='[]' data-label='null' data-data='&quot;[{&#92;&quot;&#92;&quot;:&#92;&quot;lead_source&#92;&quot;,&#92;&quot;value&#92;&quot;:128},{&#92;&quot;&#92;&quot;:&#92;&quot;industry&#92;&quot;,&#92;&quot;value&#92;&quot;:134},{&#92;&quot;&#92;&quot;:&#92;&quot;number_of_courses_viewed&#92;&quot;,&#92;&quot;value&#92;&quot;:0},{&#92;&quot;&#92;&quot;:&#92;&quot;annual_income&#92;&quot;,&#92;&quot;value&#92;&quot;:181},{&#92;&quot;&#92;&quot;:&#92;&quot;employment_status&#92;&quot;,&#92;&quot;value&#92;&quot;:100},{&#92;&quot;&#92;&quot;:&#92;&quot;location&#92;&quot;,&#92;&quot;value&#92;&quot;:63},{&#92;&quot;&#92;&quot;:&#92;&quot;interaction_count&#92;&quot;,&#92;&quot;value&#92;&quot;:0},{&#92;&quot;&#92;&quot;:&#92;&quot;lead_score&#92;&quot;,&#92;&quot;value&#92;&quot;:0},{&#92;&quot;&#92;&quot;:&#92;&quot;converted&#92;&quot;,&#92;&quot;value&#92;&quot;:0}]&quot;' data-total-rows='9' data-total-columns='1' data-max-columns='50' data-banner-text='&quot;&quot;' data-pagination='true' data-page-size='10' data-field-types='[[&quot;value&quot;,[&quot;integer&quot;,&quot;int64&quot;]]]' data-show-filters='true' data-show-download='true' data-show-column-summaries='false' data-show-data-types='true' data-show-page-size-selector='true' data-show-column-explorer='true' data-show-chart-builder='true' data-row-headers='[[&quot;&quot;,[&quot;string&quot;,&quot;object&quot;]]]' data-has-stable-row-id='false' data-lazy='false' data-preload='false'></marimo-table></marimo-ui-element>"}, "type": "data"}]}, {"code_hash": "7c11c1bfa5ee3a31b904e319bf2425c1", "console": [], "id": "PKri", "outputs": [{"data": {"text/html": "<span class=\"markdown prose dark:prose-invert\"><h3 id=\"if-there-are-missing-values\">If there are missing values:</h3>\n<h4 id=\"for-categorical-features-replace-them-with-na\">For categorical features, replace them with 'NA'</h4></span>"}, "type": "data"}]}, {"code_hash": "bcb93a5fba257250f4ed8448c4b1b4b0", "console": [], "id": "Xref", "outputs": [{"data": {"text/html": "<marimo-ui-element object-id='Xref-0' random-id='ecf49dbd-7745-1c8d-1759-fa390a7bc8f2'><marimo-table data-initial-value='[]' data-label='null' data-data='&quot;[{&#92;&quot;lead_source&#92;&quot;:&#92;&quot;paid_ads&#92;&quot;,&#92;&quot;industry&#92;&quot;:&#92;&quot;NA&#92;&quot;,&#92;&quot;number_of_courses_viewed&#92;&quot;:1,&#92;&quot;annual_income&#92;&quot;:79450.0,&#92;&quot;employment_status&#92;&quot;:&#92;&quot;unemployed&#92;&quot;,&#92;&quot;location&#92;&quot;:&#92;&quot;south_america&#92;&quot;,&#92;&quot;interaction_count&#92;&quot;:4,&#92;&quot;lead_score&#92;&quot;:0.94,&#92;&quot;converted&#92;&quot;:1},{&#92;&quot;lead_source&#92;&quot;:&#92;&quot;social_media&#92;&quot;,&#92;&quot;industry&#92;&quot;:&#92;&quot;retail&#92;&quot;,&#92;&quot;number_of_courses_viewed&#92;&quot;:1,&#92;&quot;annual_income&#92;&quot;:46992.0,&#92;&quot;employment_status&#92;&quot;:&#92;&quot;employed&#92;&quot;,&#92;&quot;location&#92;&quot;:&#92;&quot;south_america&#92;&quot;,&#92;&quot;interaction_count&#92;&quot;:1,&#92;&quot;lead_score&#92;&quot;:0.8,&#92;&quot;converted&#92;&quot;:0},{&#92;&quot;lead_source&#92;&quot;:&#92;&quot;events&#92;&quot;,&#92;&quot;industry&#92;&quot;:&#92;&quot;healthcare&#92;&quot;,&#92;&quot;number_of_courses_viewed&#92;&quot;:5,&#92;&quot;annual_income&#92;&quot;:78796.0,&#92;&quot;employment_status&#92;&quot;:&#92;&quot;unemployed&#92;&quot;,&#92;&quot;location&#92;&quot;:&#92;&quot;australia&#92;&quot;,&#92;&quot;interaction_count&#92;&quot;:3,&#92;&quot;lead_score&#92;&quot;:0.69,&#92;&quot;converted&#92;&quot;:1},{&#92;&quot;lead_source&#92;&quot;:&#92;&quot;paid_ads&#92;&quot;,&#92;&quot;industry&#92;&quot;:&#92;&quot;retail&#92;&quot;,&#92;&quot;number_of_courses_viewed&#92;&quot;:2,&#92;&quot;annual_income&#92;&quot;:83843.0,&#92;&quot;employment_status&#92;&quot;:&#92;&quot;NA&#92;&quot;,&#92;&quot;location&#92;&quot;:&#92;&quot;australia&#92;&quot;,&#92;&quot;interaction_count&#92;&quot;:1,&#92;&quot;lead_score&#92;&quot;:0.87,&#92;&quot;converted&#92;&quot;:0},{&#92;&quot;lead_source&#92;&quot;:&#92;&quot;referral&#92;&quot;,&#92;&quot;industry&#92;&quot;:&#92;&quot;education&#92;&quot;,&#92;&quot;number_of_courses_viewed&#92;&quot;:3,&#92;&quot;annual_income&#92;&quot;:85012.0,&#92;&quot;employment_status&#92;&quot;:&#92;&quot;self_employed&#92;&quot;,&#92;&quot;location&#92;&quot;:&#92;&quot;europe&#92;&quot;,&#92;&quot;interaction_count&#92;&quot;:3,&#92;&quot;lead_score&#92;&quot;:0.62,&#92;&quot;converted&#92;&quot;:1}]&quot;' data-total-rows='5' data-total-columns='9' data-max-columns='50' data-banner-text='&quot;&quot;' data-pagination='true' data-page-size='10' data-field-types='[[&quot;lead_source&quot;,[&quot;string&quot;,&quot;object&quot;]],[&quot;industry&quot;,[&quot;string&quot;,&quot;object&quot;]],[&quot;number_of_courses_viewed&quot;,[&quot;integer&quot;,&quot;int64&quot;]],[&quot;annual_income&quot;,[&quot;number&quot;,&quot;float64&quot;]],[&quot;employment_status&quot;,[&quot;string&quot;,&quot;object&quot;]],[&quot;location&quot;,[&quot;string&quot;,&quot;object&quot;]],[&quot;interaction_count&quot;,[&quot;integer&quot;,&quot;int64&quot;]],[&quot;lead_score&quot;,[&quot;number&quot;,&quot;float64&quot;]],[&quot;converted&quot;,[&quot;integer&quot;,&quot;int64&quot;]]]' data-show-filters='true' data-show-download='true' data-show-column-summaries='false' data-show-data-types='true' data-show-page-size-selector='false' data-show-column-explorer='true' data-show-chart-builder='true' data-row-headers='[]' data-has-stable-row-id='false' data-lazy='false' data-preload='false'></marimo-table></marimo-ui-element>"}, "type": "data"}]}, {"code_hash": "0cc9e64f50f00f179f271a5088c6bcbf", "console": [], "id": "SFPL", "outputs": [{"data": {"text/html": "<span class=\"markdown prose dark:prose-invert\"><h4 id=\"for-numerical-features-replace-with-with-00\">For numerical features, replace with with 0.0</h4></span>"}, "type": "data"}]}, {"code_hash": "fdbb551bb24285c4818cea49cb225d40", "console": [], "id": "BYtC", "outputs": [{"data": {"text/html": "<marimo-ui-element object-id='BYtC-0' random-id='710f069d-b6eb-2139-0eb2-05db0f1fb081'><marimo-table data-initial-value='[]' data-label='null' data-data='&quot;[{&#92;&quot;lead_source&#92;&quot;:&#92;&quot;paid_ads&#92;&quot;,&#92;&quot;industry&#92;&quot;:&#92;&quot;NA&#92;&quot;,&#92;&quot;number_of_courses_viewed&#92;&quot;:1,&#92;&quot;annual_income&#92;&quot;:79450.0,&#92;&quot;employment_status&#92;&quot;:&#92;&quot;unemployed&#92;&quot;,&#92;&quot;location&#92;&quot;:&#92;&quot;south_america&#92;&quot;,&#92;&quot;interaction_count&#92;&quot;:4,&#92;&quot;lead_score&#92;&quot;:0.94,&#92;&quot;converted&#92;&quot;:1},{&#92;&quot;lead_source&#92;&quot;:&#92;&quot;social_media&#92;&quot;,&#92;&quot;industry&#92;&quot;:&#92;&quot;retail&#92;&quot;,&#92;&quot;number_of_courses_viewed&#92;&quot;:1,&#92;&quot;annual_income&#92;&quot;:46992.0,&#92;&quot;employment_status&#92;&quot;:&#92;&quot;employed&#92;&quot;,&#92;&quot;location&#92;&quot;:&#92;&quot;south_america&#92;&quot;,&#92;&quot;interaction_count&#92;&quot;:1,&#92;&quot;lead_score&#92;&quot;:0.8,&#92;&quot;converted&#92;&quot;:0},{&#92;&quot;lead_source&#92;&quot;:&#92;&quot;events&#92;&quot;,&#92;&quot;industry&#92;&quot;:&#92;&quot;healthcare&#92;&quot;,&#92;&quot;number_of_courses_viewed&#92;&quot;:5,&#92;&quot;annual_income&#92;&quot;:78796.0,&#92;&quot;employment_status&#92;&quot;:&#92;&quot;unemployed&#92;&quot;,&#92;&quot;location&#92;&quot;:&#92;&quot;australia&#92;&quot;,&#92;&quot;interaction_count&#92;&quot;:3,&#92;&quot;lead_score&#92;&quot;:0.69,&#92;&quot;converted&#92;&quot;:1},{&#92;&quot;lead_source&#92;&quot;:&#92;&quot;paid_ads&#92;&quot;,&#92;&quot;industry&#92;&quot;:&#92;&quot;retail&#92;&quot;,&#92;&quot;number_of_courses_viewed&#92;&quot;:2,&#92;&quot;annual_income&#92;&quot;:83843.0,&#92;&quot;employment_status&#92;&quot;:&#92;&quot;NA&#92;&quot;,&#92;&quot;location&#92;&quot;:&#92;&quot;australia&#92;&quot;,&#92;&quot;interaction_count&#92;&quot;:1,&#92;&quot;lead_score&#92;&quot;:0.87,&#92;&quot;converted&#92;&quot;:0},{&#92;&quot;lead_source&#92;&quot;:&#92;&quot;referral&#92;&quot;,&#92;&quot;industry&#92;&quot;:&#92;&quot;education&#92;&quot;,&#92;&quot;number_of_courses_viewed&#92;&quot;:3,&#92;&quot;annual_income&#92;&quot;:85012.0,&#92;&quot;employment_status&#92;&quot;:&#92;&quot;self_employed&#92;&quot;,&#92;&quot;location&#92;&quot;:&#92;&quot;europe&#92;&quot;,&#92;&quot;interaction_count&#92;&quot;:3,&#92;&quot;lead_score&#92;&quot;:0.62,&#92;&quot;converted&#92;&quot;:1}]&quot;' data-total-rows='5' data-total-columns='9' data-max-columns='50' data-banner-text='&quot;&quot;' data-pagination='true' data-page-size='10' data-field-types='[[&quot;lead_source&quot;,[&quot;string&quot;,&quot;object&quot;]],[&quot;industry&quot;,[&quot;string&quot;,&quot;object&quot;]],[&quot;number_of_courses_viewed&quot;,[&quot;integer&quot;,&quot;int64&quot;]],[&quot;annual_income&quot;,[&quot;number&quot;,&quot;float64&quot;]],[&quot;employment_status&quot;,[&quot;string&quot;,&quot;object&quot;]],[&quot;location&quot;,[&quot;string&quot;,&quot;object&quot;]],[&quot;interaction_count&quot;,[&quot;integer&quot;,&quot;int64&quot;]],[&quot;lead_score&quot;,[&quot;number&quot;,&quot;float64&quot;]],[&quot;converted&quot;,[&quot;integer&quot;,&quot;int64&quot;]]]' data-show-filters='true' data-show-download='true' data-show-column-summaries='false' data-show-data-types='true' data-show-page-size-selector='false' data-show-column-explorer='true' data-show-chart-builder='true' data-row-headers='[]' data-has-stable-row-id='false' data-lazy='false' data-preload='false'></marimo-table></marimo-ui-element>"}, "type": "data"}]}, {"code_hash": "6bf4b01a402e968d37afda08ae2b8054", "console": [], "id": "RGSE", "outputs": [{"data": {"text/html": "<marimo-ui-element object-id='RGSE-0' random-id='8cc63572-ae52-90cd-0bd0-dccbd4ae8814'><marimo-table data-initial-value='[]' data-label='null' data-data='&quot;[{&#92;&quot;lead_source&#92;&quot;:&#92;&quot;paid_ads&#92;&quot;,&#92;&quot;industry&#92;&quot;:&#92;&quot;NA&#92;&quot;,&#92;&quot;number_of_courses_viewed&#92;&quot;:1,&#92;&quot;annual_income&#92;&quot;:79450.0,&#92;&quot;employment_status&#92;&quot;:&#92;&quot;unemployed&#92;&quot;,&#92;&quot;location&#92;&quot;:&#92;&quot;south_america&#92;&quot;,&#92;&quot;interaction_count&#92;&quot;:4,&#92;&quot;lead_score&#92;&quot;:0.94,&#92;&quot;converted&#92;&quot;:1},{&#92;&quot;lead_source&#92;&quot;:&#92;&quot;social_media&#92;&quot;,&#92;&quot;industry&#92;&quot;:&#92;&quot;retail&#92;&quot;,&#92;&quot;number_of_courses_viewed&#92;&quot;:1,&#92;&quot;annual_income&#92;&quot;:46992.0,&#92;&quot;employment_status&#92;&quot;:&#92;&quot;employed&#92;&quot;,&#92;&quot;location&#92;&quot;:&#92;&quot;south_america&#92;&quot;,&#92;&quot;interaction_count&#92;&quot;:1,&#92;&quot;lead_score&#92;&quot;:0.8,&#92;&quot;converted&#92;&quot;:0},{&#92;&quot;lead_source&#92;&quot;:&#92;&quot;events&#92;&quot;,&#92;&quot;industry&#92;&quot;:&#92;&quot;healthcare&#92;&quot;,&#92;&quot;number_of_courses_viewed&#92;&quot;:5,&#92;&quot;annual_income&#92;&quot;:78796.0,&#92;&quot;employment_status&#92;&quot;:&#92;&quot;unemployed&#92;&quot;,&#92;&quot;location&#92;&quot;:&#92;&quot;australia&#92;&quot;,&#92;&quot;interaction_count&#92;&quot;:3,&#92;&quot;lead_score&#92;&quot;:0.69,&#92;&quot;converted&#92;&quot;:1},{&#92;&quot;lead_source&#92;&quot;:&#92;&quot;paid_ads&#92;&quot;,&#92;&quot;industry&#92;&quot;:&#92;&quot;retail&#92;&quot;,&#92;&quot;number_of_courses_viewed&#92;&quot;:2,&#92;&quot;annual_income&#92;&quot;:83843.0,&#92;&quot;employment_status&#92;&quot;:&#92;&quot;NA&#92;&quot;,&#92;&quot;location&#92;&quot;:&#92;&quot;australia&#92;&quot;,&#92;&quot;interaction_count&#92;&quot;:1,&#92;&quot;lead_score&#92;&quot;:0.87,&#92;&quot;converted&#92;&quot;:0},{&#92;&quot;lead_source&#92;&quot;:&#92;&quot;referral&#92;&quot;,&#92;&quot;industry&#92;&quot;:&#92;&quot;education&#92;&quot;,&#92;&quot;number_of_courses_viewed&#92;&quot;:3,&#92;&quot;annual_income&#92;&quot;:85012.0,&#92;&quot;employment_status&#92;&quot;:&#92;&quot;self_employed&#92;&quot;,&#92;&quot;location&#92;&quot;:&#92;&quot;europe&#92;&quot;,&#92;&quot;interaction_count&#92;&quot;:3,&#92;&quot;lead_score&#92;&quot;:0.62,&#92;&quot;converted&#92;&quot;:1}]&quot;' data-total-rows='5' data-total-columns='9' data-max-columns='50' data-banner-text='&quot;&quot;' data-pagination='true' data-page-size='10' data-field-types='[[&quot;lead_source&quot;,[&quot;string&quot;,&quot;object&quot;]],[&quot;industry&quot;,[&quot;string&quot;,&quot;object&quot;]],[&quot;number_of_courses_viewed&quot;,[&quot;integer&quot;,&quot;int64&quot;]],[&quot;annual_income&quot;,[&quot;number&quot;,&quot;float64&quot;]],[&quot;employment_status&quot;,[&quot;string&quot;,&quot;object&quot;]],[&quot;location&quot;,[&quot;string&quot;,&quot;object&quot;]],[&quot;interaction_count&quot;,[&quot;integer&quot;,&quot;int64&quot;]],[&quot;lead_score&quot;,[&quot;number&quot;,&quot;float64&quot;]],[&quot;converted&quot;,[&quot;integer&quot;,&quot;int64&quot;]]]' data-show-filters='true' data-show-download='true' data-show-column-summaries='false' data-show-data-types='true' data-show-page-size-selector='false' data-show-column-explorer='true' data-show-chart-builder='true' data-row-headers='[]' data-has-stable-row-id='false' data-lazy='false' data-preload='false'></marimo-table></marimo-ui-element>"}, "type": "data"}]}, {"code_hash": "bc1e10e642a8e75e830e53d677d99a58", "console": [], "id": "Kclp", "outputs": [{"data": {"text/html": "<span class=\"markdown prose dark:prose-invert\"><h4 id=\"split-the-data-into-3-parts\">Split the data into 3 parts</h4>\n<span class=\"paragraph\">Split the data into 3 parts: train/validation/test with 60% / 20% / 20% distribution. Use train_test_split function for that with random_state=1.</span></span>"}, "type": "data"}]}, {"code_hash": "67d57567961c161b7d6612aab59b6345", "console": [], "id": "emfo", "outputs": [{"data": {"application/json": "{\"len(train_dataframe)\": 876, \"len(val_dataframe)\": 293, \"len(test_dataframe)\": 293}"}, "type": "data"}]}, {"code_hash": "485e279a2e672f13266c042264563ec6", "console": [], "id": "Hstk", "outputs": [{"data": {"text/html": "<span class=\"markdown prose dark:prose-invert\"><h2 id=\"question-1-roc-auc-feature-importance\">Question 1: ROC AUC feature importance</h2>\n<span class=\"paragraph\">ROC AUC could also be used to evaluate feature importance of numerical variables. </span>\n<span class=\"paragraph\">Let's do that</span>\n<ul>\n<li>For each numerical variable, use it as score (aka prediction) and compute the AUC with the <code>y</code> variable as ground truth.</li>\n<li>Use the training dataset for that</li>\n</ul>\n<span class=\"paragraph\">If your AUC is &lt; 0.5, invert this variable by putting \"-\" in front</span>\n<span class=\"paragraph\">(e.g. <code>-df_train['balance']</code>)</span>\n<span class=\"paragraph\">AUC can go below 0.5 if the variable is negatively correlated with the target variable. You can change the direction of the correlation by negating this variable - then negative correlation becomes positive.</span></span>"}, "type": "data"}]}, {"code_hash": "5db208473013165ef8b7af585357f2ea", "console": [], "id": "nWHF", "outputs": [{"data": {"application/json": "{\"number_of_courses_viewed\": \"text/plain+float:0.7635680590007088\", \"annual_income\": \"text/plain+float:0.5519578313253012\", \"interaction_count\": \"text/plain+float:0.738270176293409\", \"lead_score\": \"text/plain+float:0.6144993577250176\"}"}, "type": "data"}]}, {"code_hash": "49f125d5b1530c70882e6c8f64fe3c2f", "console": [], "id": "iLit", "outputs": [{"data": {"text/html": "<span class=\"markdown prose dark:prose-invert\"><span class=\"paragraph\">Which numerical variable (among the following 4) has the highest AUC?</span>\n<ul>\n<li><code>lead_score</code></li>\n<li><code>number_of_courses_viewed</code></li>\n<li><code>interaction_count</code></li>\n<li><code>annual_income</code></li>\n</ul></span>"}, "type": "data"}]}, {"code_hash": "cfe901da89c18e563e763f4307a1f903", "console": [], "id": "ZHCJ", "outputs": [{"data": {"text/html": "<span class=\"markdown prose dark:prose-invert\"><span class=\"paragraph\">The <code>number_of_courses_viewed</code> feature has the highest AUC with a value of <marimo-tex class=\"arithmatex\">||(0.7564||)</marimo-tex>.</span></span>"}, "type": "data"}]}, {"code_hash": "ca351cd24e9137492607482f23cca337", "console": [], "id": "ROlb", "outputs": [{"data": {"text/html": "<span class=\"markdown prose dark:prose-invert\"><h3 id=\"question-2-training-the-model\">Question 2: Training the model</h3>\n<span class=\"paragraph\">Apply one-hot-encoding using <code>DictVectorizer</code> and train the logistic regression with these parameters:</span>\n<div class=\"language-python codehilite\"><pre><span></span><code><span class=\"n\">LogisticRegression</span><span class=\"p\">(</span><span class=\"n\">solver</span><span class=\"o\">=</span><span class=\"s1\">&#39;liblinear&#39;</span><span class=\"p\">,</span> <span class=\"n\">C</span><span class=\"o\">=</span><span class=\"mf\">1.0</span><span class=\"p\">,</span> <span class=\"n\">max_iter</span><span class=\"o\">=</span><span class=\"mi\">1000</span><span class=\"p\">)</span>\n</code></pre></div></span>"}, "type": "data"}]}, {"code_hash": "d3991a63b92369be080291ea0fb57309", "console": [], "id": "qnkX", "outputs": [{"data": {"text/html": "<pre style='font-size: 12px'>0.711</pre>"}, "type": "data"}]}, {"code_hash": "17fcf33ebc7a4c24e8cf2b24c5b6aa3b", "console": [], "id": "TqIu", "outputs": [{"data": {"text/html": "<span class=\"markdown prose dark:prose-invert\"><span class=\"paragraph\">What's the AUC of this model on the validation dataset? (round to 3 digits)</span>\n<ul>\n<li>0.32</li>\n<li>0.52</li>\n<li>0.72</li>\n<li>0.92</li>\n</ul></span>"}, "type": "data"}]}, {"code_hash": "d3be7e9f58e16b4b4b97395c1a3da83b", "console": [], "id": "Vxnm", "outputs": [{"data": {"text/html": "<span class=\"markdown prose dark:prose-invert\"><span class=\"paragraph\">The AUC of this model is 0.72.</span></span>"}, "type": "data"}]}, {"code_hash": "e91df18f7d004ab032b841aa6d1db6c9", "console": [], "id": "DnEU", "outputs": [{"data": {"text/html": "<span class=\"markdown prose dark:prose-invert\"><h3 id=\"question-3-precision-and-recall\">Question 3: Precision and Recall</h3>\n<span class=\"paragraph\">Now let's compute precision and recall for our model.</span>\n<ul>\n<li>Evaluate the model on all thresholds from 0.0 to 1.0 with step 0.01</li>\n<li>For each threshold, compute precision and recall</li>\n<li>Plot them</li>\n</ul></span>"}, "type": "data"}]}, {"code_hash": "a3a4b9205812c3205479ee8baa5b108c", "console": [{"data": "data:image/png;base64,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Tu6QyoiIiDiHJk3Mc0gOHTKvsileHGJjzZFaxampjIiIiHMJDIT33oOxY82vZ87UvWycnMqIiIg4p2efhUKF4M8/Yf16q9PIHVAZERER51SkiHl1DehQjZNTGREREefVs6f5vGABJCZam0WyTGVEREScV0gI1KwJly/D3LlWp5EsUhkRERHnZbNd3zuiQzVOS2VEREScW5cu4OFhjkOyY4fVaSQLVEZERMS5lSoFLVua09o74pRURkRExPldO1Tz9deQlGRtFnGYyoiIiDi/sDAoUwZOnzZvqCdORWVEREScn4cHdOtmTk+erBFZnYzKiIiIuIbevcHLC/73P+0dcTIqIyIi4hoqVIA33jCnw8N17ogTURkRERHXMXiweSO9/fthwgSr00gmqYyIiIjrKFIEPvzQnP7gAzhxwto8kikqIyIi4lo6dYLgYLh40dxTInmeyoiIiLgWNzf49FNz+quvzJFZJU9TGREREdfTtCl07WpO9+sHdru1eeS2VEZERMQ1jR4NhQvD5s2waJHVaeQ2VEZERMQ1BQZev9T3ww81EFoepjIiIiKuq29fKFAAoqLgxx+tTiO3oDIiIiKuy98fevUyp69d8it5jsqIiIi4tvBwcHeHNWtg2zar08hNqIyIiIhrq1gROnQwp8eOtTSK3JzKiIiIuL633zaf5883h4qXPEVlREREXF/9+hAWZo43Mn681Wnkb1RGREQkfxg40HyeORNOnbI2i2SgMiIiIvnDAw9AkyZw9SpMmmR1GvkLlREREckfbLbr545MmQJJSdbmkXQqIyIikn+0aQNlysDp07BsmdVp5P+pjIiISP7h4QHdupnTM2ZYGkWuUxkREZH8pUcP83n1ajh82NosAqiMiIhIflOlinkyq2HA7NlWpxFURkREJD/q2dN8njXLHHtELKUyIiIi+c/TT4OfHxw8qLv55gEqIyIikv8UKAAdO5rTM2dam0VURkREJJ+6dqhm8WI4e9baLPmcyoiIiORPDRua96xJSoI5c6xOk6+pjIiISP5ks13fO6IxRyylMiIiIvlXp07g7Q0xMRAdbXWafEtlRERE8q/ixaFtW3Nae0csozIiIiL527VDNXPmwJUr1mbJp1RGREQkf3voIahYEc6fN6+skVynMiIiIvmbmxt0725O61CNJVRGREREunUzr65Zuxb27bM6Tb6jMiIi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", "mimetype": "image/png", "name": "media", "type": "streamMedia"}], "id": "ulZA", "outputs": [{"data": {"text/plain": ""}, "type": "data"}]}, {"code_hash": "64fcc06bea26d9772927dab1c0b6ac20", "console": [], "id": "ecfG", "outputs": [{"data": {"text/html": "<span class=\"markdown prose dark:prose-invert\"><span class=\"paragraph\">At which threshold precision and recall curves intersect?</span>\n<ul>\n<li>0.145</li>\n<li>0.345</li>\n<li>0.545</li>\n<li>0.745</li>\n</ul></span>"}, "type": "data"}]}, {"code_hash": "9b35fb50cba56b94f56250bd598939ab", "console": [], "id": "Pvdt", "outputs": [{"data": {"text/html": "<span class=\"markdown prose dark:prose-invert\"><span class=\"paragraph\">Precision and recall intersect at 0.745.</span></span>"}, "type": "data"}]}, {"code_hash": "a7cbb97b422ddff86e6e66416adacada", "console": [], "id": "ZBYS", "outputs": [{"data": {"text/html": "<span class=\"markdown prose dark:prose-invert\"><h3 id=\"question-4-f1-score\">Question 4: F1 score</h3>\n<span class=\"paragraph\">Precision and recall are conflicting - when one grows, the other goes down. That's why they are often combined into the F1 score - a metrics that takes into account both</span>\n<span class=\"paragraph\">This is the formula for computing F1:</span>\n<marimo-tex class=\"arithmatex\">||[F_1 = 2 \\cdot \\cfrac{P \\cdot R}{P + R}||]</marimo-tex><span class=\"paragraph\">Where <marimo-tex class=\"arithmatex\">||(P||)</marimo-tex> is precision and <marimo-tex class=\"arithmatex\">||(R||)</marimo-tex> is recall.</span>\n<span class=\"paragraph\">Let's compute F1 for all thresholds from 0.0 to 1.0 with increment 0.01</span></span>"}, "type": "data"}]}, {"code_hash": "de4116df6c5888ab0bacbba5d8dee471", "console": [{"data": "data:image/png;base64,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fvhhZWVladiwYZ4o1ee5e68HDhyoTz/9VPn5+TXb1VdfrUsvvVT5+fmKioryZPk+ozF/p0eNGqVt27bVhD1J2rp1q7p3704QqUdj7vORI0dOChzVAdDiMWvNxpbvwhYbGusFVqxYYTmdTmvZsmXWF198Yd1yyy1Wp06dLJfLZVmWZU2cONGaMWNGzfnr16+3goKCrHnz5lkFBQVWWloaU3sbwN37PHfuXCs4ONh68cUXrX379tVshw4dsutX8Bnu3usfYzZNw7h7nwsLC62OHTtat99+u7Vlyxbrtddes7p162b96U9/sutX8Anu3ue0tDSrY8eO1j//+U9rx44d1ptvvmn169fP+vWvf23Xr+ATDh06ZG3evNnavHmzJclasGCBtXnzZmv37t2WZVnWjBkzrIkTJ9acXz219+6777YKCgqsjIwMpvY21eOPP26deeaZVnBwsDVixAhrw4YNNT8bO3asNWnSpFrn/+tf/7IGDBhgBQcHW+eee661Zs0aD1fsm9y5z71797YknbSlpaV5vnAf5O7f6RMRRhrO3fv8wQcfWLGxsZbT6bT69u1rPfLII9axY8c8XLXvcec+Hz161Jo9e7bVr18/KyQkxIqKirJuu+0267vvvvN84T7k3XffrfO/udX3dtKkSdbYsWNPuiY6OtoKDg62+vbtaz3zzDMtWqPDsmjbAgAA9vHbMSMAAMA3EEYAAICtCCMAAMBWhBEAAGArwggAALAVYQQAANiKMAIAAGxFGAEAALYijAA4pZycHDkcDh08eNCjn7ts2TJ16tSpSe+xa9cuORwO5efn13uOXb8fgOMII0Ar5nA4TrnNnj3b7hIBtAJBdhcAwD779u2r2V+5cqVmzZqlLVu21Bzr0KGDPvroI7fft6KigqfVAmgwWkaAViwyMrJmCwsLk8PhqHWsQ4cONefm5eVp2LBhateunUaOHFkrtMyePVvR0dF6+umnddZZZykkJESSdPDgQU2ePFldu3ZVaGioLrvsMn388cc113388ce69NJL1bFjR4WGhiomJuak8PPGG29o0KBB6tChg6688spaAaqqqkoPPfSQevXqJafTqejoaGVlZZ3yd167dq0GDBigtm3b6tJLL9WuXbuacgsBNAPCCIAGmTlzpubPn6+PPvpIQUFB+u1vf1vr59u2bdNLL72kVatW1YzR+NWvfqX9+/fr9ddfV15eni688EJdfvnl+vbbbyVJN954o3r16qUPP/xQeXl5mjFjhtq0aVPznkeOHNG8efP07LPP6v3331dhYaH++Mc/1vz8L3/5i+bPn6958+bpk08+UUJCgq6++mp99dVXdf4Oe/bs0bXXXqvx48crPz9fkydP1owZM5r5TgFwW4s+ExiAz3jmmWessLCwk45XP3787bffrjm2Zs0aS5L1/fffW5ZlWWlpaVabNm2s/fv315zzn//8xwoNDbV++OGHWu/Xr18/629/+5tlWZbVsWNHa9myZfXWI8natm1bzbGMjAwrIiKi5s89evSwHnnkkVrXDR8+3Lrtttssy7KsnTt3WpKszZs3W5ZlWampqdbgwYNrnX/vvfdakngMPWAjWkYANMiQIUNq9rt37y5J2r9/f82x3r17q2vXrjV//vjjj3X48GGdccYZ6tChQ822c+dObd++XZKUkpKiyZMnKz4+XnPnzq05Xq1du3bq169frc+t/szS0lLt3btXo0aNqnXNqFGjVFBQUOfvUFBQoNjY2FrH4uLiGnwPALQMBrACaJATu08cDockM2ajWvv27Wudf/jwYXXv3l05OTknvVf1lN3Zs2frhhtu0Jo1a/T6668rLS1NK1as0M9//vOTPrP6cy3Lao5fB4AXoWUEQIu48MIL5XK5FBQUpP79+9fawsPDa84bMGCApk+frjfffFPXXnutnnnmmQa9f2hoqHr06KH169fXOr5+/XoNHjy4zmsGDRqkjRs31jq2YcMGN38zAM2NMAKgRcTHxysuLk4TJkzQm2++qV27dumDDz7QzJkz9dFHH+n777/X7bffrpycHO3evVvr16/Xhx9+qEGDBjX4M+6++279+c9/1sqVK7VlyxbNmDFD+fn5uuuuu+o8/9Zbb9VXX32lu+++W1u2bNHzzz+vZcuWNdNvDKCx6KYB0CIcDofWrl2rmTNnKjk5WQcOHFBkZKTGjBmjiIgIBQYG6n//+5+SkpJUVFSk8PBwXXvttXrwwQcb/Bl33nmnSkpK9Ic//EH79+/X4MGD9eqrr+rss8+u8/wzzzxTL730kqZPn67HH39cI0aM0Jw5c06aGQTAsxwWHbAAAMBGdNMAAABbEUYAAICtCCMAAMBWhBEAAGArwggAALAVYQQAANiKMAIAAGxFGAEAALYijAAAAFsRRgAAgK0IIwAAwFb/H23WC3GgjYOfAAAAAElFTkSuQmCC", "mimetype": "image/png", "name": "media", "type": "streamMedia"}], "id": "aLJB", "outputs": [{"data": {"text/plain": ""}, "type": "data"}]}, {"code_hash": "95ce9198c365fd65cdca84f2dfee198c", "console": [], "id": "nHfw", "outputs": [{"data": {"text/html": "<span class=\"markdown prose dark:prose-invert\"><span class=\"paragraph\">At which threshold F1 is maximal?</span>\n<ul>\n<li>0.14</li>\n<li>0.34</li>\n<li>0.54</li>\n<li>0.74</li>\n</ul></span>"}, "type": "data"}]}, {"code_hash": "8832d402f2d6990674f4385f16e25ddd", "console": [], "id": "xXTn", "outputs": [{"data": {"text/html": "<span class=\"markdown prose dark:prose-invert\"><span class=\"paragraph\">F1 is maximal at 0.74.</span></span>"}, "type": "data"}]}, {"code_hash": "bf9bfafe3e3d64ece01622d5e1eb2c9f", "console": [], "id": "AjVT", "outputs": [{"data": {"text/html": "<span class=\"markdown prose dark:prose-invert\"><h2 id=\"question-5-5-fold-cv\">Question 5: 5-Fold CV</h2>\n<span class=\"paragraph\">Use the <code>KFold</code> class from Scikit-Learn to evaluate our model on 5 different folds:</span>\n<div class=\"language-scdoc codehilite\"><pre><span></span><code>KFold(n_splits=5, shuffle=True, random_state=1)\n</code></pre></div>\n<ul>\n<li>Iterate over different folds of <code>df_full_train</code></li>\n<li>Split the data into train and validation</li>\n<li>Train the model on train with these parameters: <code>LogisticRegression(solver='liblinear', C=1.0, max_iter=1000)</code></li>\n<li>Use AUC to evaluate the model on validation</li>\n</ul></span>"}, "type": "data"}]}, {"code_hash": "4ce5e4021bab2861a8cc18ca7712d400", "console": [{"name": "stdout", "text": "0.822 +- 0.036\n", "type": "stream"}], "id": "pHFh", "outputs": [{"data": {"application/json": "[\"text/plain+float:0.8060745924216483\", \"text/plain+float:0.8713738368910783\", \"text/plain+float:0.7754320118852139\", \"text/plain+float:0.8018368617683685\", \"text/plain+float:0.8558272713202291\"]"}, "type": "data"}]}, {"code_hash": "712db2359ce2b2894bbbc33fec5558ba", "console": [], "id": "NCOB", "outputs": [{"data": {"text/html": "<span class=\"markdown prose dark:prose-invert\"><span class=\"paragraph\">How large is standard deviation of the scores across different folds?</span>\n<ul>\n<li>0.0001</li>\n<li>0.006</li>\n<li>0.06</li>\n<li>0.36</li>\n</ul></span>"}, "type": "data"}]}, {"code_hash": "f65e5fac26d801cc9e0def75172c9563", "console": [], "id": "aqbW", "outputs": [{"data": {"text/html": "<span class=\"markdown prose dark:prose-invert\"><span class=\"paragraph\">The closest value to the standard deviation across folds is <marimo-tex class=\"arithmatex\">||(0.06||)</marimo-tex>.</span></span>"}, "type": "data"}]}, {"code_hash": "2fa6fbc273f7c15d820188b7d7486c24", "console": [], "id": "TRpd", "outputs": [{"data": {"text/html": "<span class=\"markdown prose dark:prose-invert\"><h3 id=\"question-6-hyperparameter-tuning\">Question 6: Hyperparameter Tuning</h3>\n<span class=\"paragraph\">Now let's use 5-Fold cross-validation to find the best parameter <code>C</code></span>\n<ul>\n<li>Iterate over the following <code>C</code> values: <code>[0.000001, 0.001, 1]</code></li>\n<li>Initialize <code>KFold</code> with the same parameters as previously</li>\n<li>Use these parameters for the model: <code>LogisticRegression(solver='liblinear', C=C, max_iter=1000)</code></li>\n<li>Compute the mean score as well as the std (round the mean and std to 3 decimal digits)</li>\n</ul></span>"}, "type": "data"}]}, {"code_hash": "18970ed384b81483f5cf72352b07f066", "console": [{"name": "stdout", "text": "C=0.000: 0.560 +- 0.024\n", "type": "stream"}, {"name": "stdout", "text": "C=0.001: 0.867 +- 0.029\n", "type": "stream"}, {"name": "stdout", "text": "C=1.000: 0.822 +- 0.036\n", "type": "stream"}], "id": "TXez", "outputs": [{"data": {"application/json": "[[\"text/plain+float:0.5572098563239782\", \"text/plain+float:0.5191961842208147\", \"text/plain+float:0.5894909688013137\", \"text/plain+float:0.5582191780821917\", \"text/plain+float:0.5769230769230769\"], [\"text/plain+float:0.8608650338718081\", \"text/plain+float:0.8967081085307685\", \"text/plain+float:0.822816482915005\", \"text/plain+float:0.8539850560398504\", \"text/plain+float:0.9000154774802662\"], [\"text/plain+float:0.8060745924216483\", \"text/plain+float:0.8713738368910783\", \"text/plain+float:0.7754320118852139\", \"text/plain+float:0.8018368617683685\", \"text/plain+float:0.8558272713202291\"]]"}, "type": "data"}]}, {"code_hash": "f27c1cacf78cde56544040a25ecccb5a", "console": [], "id": "dNNg", "outputs": [{"data": {"text/html": "<span class=\"markdown prose dark:prose-invert\"><span class=\"paragraph\">Which <code>C</code> leads to the best mean score?</span>\n<ul>\n<li>0.000001</li>\n<li>0.001</li>\n<li>1</li>\n</ul></span>"}, "type": "data"}]}, {"code_hash": "53030797b16d22625eb489d11f202249", "console": [], "id": "yCnT", "outputs": [{"data": {"text/html": "<span class=\"markdown prose dark:prose-invert\"><span class=\"paragraph\">The best score corresponds to <marimo-tex class=\"arithmatex\">||(C = 0.001||)</marimo-tex>.</span></span>"}, "type": "data"}]}], "metadata": {"marimo_version": "0.16.0"}, "version": "1"},
            "runtimeConfig": null,
        };
    </script>
  
<marimo-code hidden="">
    import%20marimo%0A%0A__generated_with%20%3D%20%220.16.0%22%0Aapp%20%3D%20marimo.App(width%3D%22medium%22)%0A%0A%0A%40app.cell%0Adef%20_()%3A%0A%20%20%20%20import%20marimo%20as%20mo%0A%20%20%20%20import%20pandas%20as%20pd%0A%20%20%20%20import%20numpy%20as%20np%0A%20%20%20%20import%20matplotlib.pyplot%20as%20plt%0A%20%20%20%20import%20seaborn%20as%20sns%0A%20%20%20%20return%20mo%2C%20np%2C%20pd%2C%20plt%0A%0A%0A%40app.cell(hide_code%3DTrue)%0Adef%20_(mo)%3A%0A%20%20%20%20mo.md(%0A%20%20%20%20%20%20%20%20r%22%22%22%0A%20%20%20%20%23%20Module%204%3A%20%5BEvaluation%5D(https%3A%2F%2Fgithub.com%2FDataTalksClub%2Fmachine-learning-zoomcamp%2Ftree%2Fmaster%2F04-evaluation)%0A%0A%20%20%20%20%23%23%20Homework%0A%0A%20%20%20%20%23%23%23%20Dataset%0A%0A%20%20%20%20For%20this%20homework%2C%20we'll%20use%20the%20lead%20scoring%20Bank%20Marketing%20dataset.%20Download%20it%20from%20here.%20You%20can%20do%20it%20with%20wget%3A%0A%0A%20%20%20%20wget%20%5Bhttps%3A%2F%2Fraw.githubusercontent.com%2Falexeygrigorev%2Fdatasets%2Fmaster%2Fcourse_lead_scoring.csv%5D(https%3A%2F%2Fraw.githubusercontent.com%2Falexeygrigorev%2Fdatasets%2Fmaster%2Fcourse_lead_scoring.csv)%0A%0A%20%20%20%20In%20this%20dataset%20our%20desired%20target%20for%20classification%20task%20will%20be%20**converted**%20variable%20-%20has%20the%20client%20signed%20up%20to%20the%20platform%20or%20not.%0A%20%20%20%20%22%22%22%0A%20%20%20%20)%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(pd)%3A%0A%20%20%20%20def%20read_dataframe()%3A%0A%20%20%20%20%20%20%20%20return%20pd.read_csv(%22.%2Fmodule-4%2Fdata%2Fcourse_lead_scoring.csv%22)%0A%0A%20%20%20%20raw_dataframe%20%3D%20read_dataframe()%0A%20%20%20%20raw_dataframe.head()%0A%20%20%20%20return%20(raw_dataframe%2C)%0A%0A%0A%40app.cell(hide_code%3DTrue)%0Adef%20_(mo)%3A%0A%20%20%20%20mo.md(%0A%20%20%20%20%20%20%20%20r%22%22%22%0A%20%20%20%20%23%23%20Data%20preparation%0A%0A%20%20%20%20%23%23%23%20Check%20if%20the%20missing%20values%20are%20presented%20in%20the%20features%0A%20%20%20%20%22%22%22%0A%20%20%20%20)%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(raw_dataframe)%3A%0A%20%20%20%20raw_dataframe.isnull().sum()%0A%20%20%20%20return%0A%0A%0A%40app.cell(hide_code%3DTrue)%0Adef%20_(mo)%3A%0A%20%20%20%20mo.md(%0A%20%20%20%20%20%20%20%20r%22%22%22%0A%20%20%20%20%23%23%23%20If%20there%20are%20missing%20values%3A%0A%0A%20%20%20%20%23%23%23%23%20For%20categorical%20features%2C%20replace%20them%20with%20'NA'%0A%20%20%20%20%22%22%22%0A%20%20%20%20)%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(raw_dataframe)%3A%0A%20%20%20%20categorical_columns%20%3D%20%5B%22lead_source%22%2C%20%22industry%22%2C%20%22employment_status%22%2C%20%22location%22%5D%0A%0A%20%20%20%20def%20fill_categorical_values(dataframe)%3A%0A%20%20%20%20%20%20%20%20dataframe%5Bcategorical_columns%5D%20%3D%20dataframe%5Bcategorical_columns%5D.fillna('NA')%0A%0A%20%20%20%20%20%20%20%20return%20dataframe%0A%0A%20%20%20%20fill_categorical_values(raw_dataframe).head()%0A%20%20%20%20return%20categorical_columns%2C%20fill_categorical_values%0A%0A%0A%40app.cell(hide_code%3DTrue)%0Adef%20_(mo)%3A%0A%20%20%20%20mo.md(r%22%22%22%23%23%23%23%20For%20numerical%20features%2C%20replace%20with%20with%200.0%22%22%22)%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(raw_dataframe)%3A%0A%20%20%20%20numeric_columns%20%3D%20%5B%22number_of_courses_viewed%22%2C%20%22annual_income%22%2C%20%22interaction_count%22%2C%20%22lead_score%22%5D%0A%0A%20%20%20%20def%20fill_numerical_values(dataframe)%3A%0A%20%20%20%20%20%20%20%20dataframe%5Bnumeric_columns%5D%20%3D%20dataframe%5Bnumeric_columns%5D.fillna(0.0)%0A%0A%20%20%20%20%20%20%20%20return%20dataframe%0A%0A%20%20%20%20fill_numerical_values(raw_dataframe).head()%0A%20%20%20%20return%20fill_numerical_values%2C%20numeric_columns%0A%0A%0A%40app.cell%0Adef%20_(fill_categorical_values%2C%20fill_numerical_values%2C%20raw_dataframe)%3A%0A%20%20%20%20filled_dataframe%20%3D%20fill_numerical_values(fill_categorical_values(raw_dataframe.copy()))%0A%20%20%20%20filled_dataframe.head()%0A%20%20%20%20return%20(filled_dataframe%2C)%0A%0A%0A%40app.cell(hide_code%3DTrue)%0Adef%20_(mo)%3A%0A%20%20%20%20mo.md(%0A%20%20%20%20%20%20%20%20r%22%22%22%0A%20%20%20%20%23%23%23%23%20Split%20the%20data%20into%203%20parts%0A%0A%20%20%20%20Split%20the%20data%20into%203%20parts%3A%20train%2Fvalidation%2Ftest%20with%2060%25%20%2F%2020%25%20%2F%2020%25%20distribution.%20Use%20train_test_split%20function%20for%20that%20with%20random_state%3D1.%0A%20%20%20%20%22%22%22%0A%20%20%20%20)%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(filled_dataframe)%3A%0A%20%20%20%20from%20sklearn.model_selection%20import%20train_test_split%0A%0A%20%20%20%20full_dataframe%2C%20test_dataframe%20%3D%20train_test_split(filled_dataframe%2C%20test_size%3D0.2%2C%20random_state%3D1)%0A%20%20%20%20train_dataframe%2C%20val_dataframe%20%3D%20train_test_split(full_dataframe%2C%20test_size%3D0.25%2C%20random_state%3D1)%0A%0A%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%22len(train_dataframe)%22%3A%20len(train_dataframe)%2C%0A%20%20%20%20%20%20%20%20%22len(val_dataframe)%22%3A%20len(val_dataframe)%2C%0A%20%20%20%20%20%20%20%20%22len(test_dataframe)%22%3A%20len(test_dataframe)%2C%0A%20%20%20%20%7D%0A%20%20%20%20return%20full_dataframe%2C%20train_dataframe%2C%20val_dataframe%0A%0A%0A%40app.cell(hide_code%3DTrue)%0Adef%20_(mo)%3A%0A%20%20%20%20mo.md(%0A%20%20%20%20%20%20%20%20r%22%22%22%0A%20%20%20%20%23%23%20Question%201%3A%20ROC%20AUC%20feature%20importance%0A%0A%20%20%20%20ROC%20AUC%20could%20also%20be%20used%20to%20evaluate%20feature%20importance%20of%20numerical%20variables.%20%0A%0A%20%20%20%20Let's%20do%20that%0A%0A%20%20%20%20*%20For%20each%20numerical%20variable%2C%20use%20it%20as%20score%20(aka%20prediction)%20and%20compute%20the%20AUC%20with%20the%20%60y%60%20variable%20as%20ground%20truth.%0A%20%20%20%20*%20Use%20the%20training%20dataset%20for%20that%0A%0A%0A%20%20%20%20If%20your%20AUC%20is%20%3C%200.5%2C%20invert%20this%20variable%20by%20putting%20%22-%22%20in%20front%0A%0A%20%20%20%20(e.g.%20%60-df_train%5B'balance'%5D%60)%0A%0A%20%20%20%20AUC%20can%20go%20below%200.5%20if%20the%20variable%20is%20negatively%20correlated%20with%20the%20target%20variable.%20You%20can%20change%20the%20direction%20of%20the%20correlation%20by%20negating%20this%20variable%20-%20then%20negative%20correlation%20becomes%20positive.%0A%20%20%20%20%22%22%22%0A%20%20%20%20)%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(numeric_columns%2C%20pd%2C%20train_dataframe)%3A%0A%20%20%20%20from%20sklearn.metrics%20import%20roc_auc_score%0A%0A%20%20%20%20def%20compute_auc_for_numeric_features(dataframe%3A%20pd.DataFrame)%20-%3E%20dict%3A%0A%20%20%20%20%20%20%20%20auc_scores%20%3D%20%7B%7D%0A%0A%20%20%20%20%20%20%20%20for%20feature%20in%20numeric_columns%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20auc_scores%5Bfeature%5D%20%3D%20roc_auc_score(dataframe.converted%2C%20dataframe%5Bfeature%5D)%0A%0A%20%20%20%20%20%20%20%20return%20auc_scores%0A%0A%20%20%20%20compute_auc_for_numeric_features(train_dataframe)%0A%20%20%20%20return%20(roc_auc_score%2C)%0A%0A%0A%40app.cell(hide_code%3DTrue)%0Adef%20_(mo)%3A%0A%20%20%20%20mo.md(%0A%20%20%20%20%20%20%20%20r%22%22%22%0A%20%20%20%20Which%20numerical%20variable%20(among%20the%20following%204)%20has%20the%20highest%20AUC%3F%0A%0A%20%20%20%20-%20%60lead_score%60%0A%20%20%20%20-%20%60number_of_courses_viewed%60%0A%20%20%20%20-%20%60interaction_count%60%0A%20%20%20%20-%20%60annual_income%60%0A%20%20%20%20%22%22%22%0A%20%20%20%20)%0A%20%20%20%20return%0A%0A%0A%40app.cell(hide_code%3DTrue)%0Adef%20_(mo)%3A%0A%20%20%20%20mo.md(r%22%22%22The%20%60number_of_courses_viewed%60%20feature%20has%20the%20highest%20AUC%20with%20a%20value%20of%20%240.7564%24.%22%22%22)%0A%20%20%20%20return%0A%0A%0A%40app.cell(hide_code%3DTrue)%0Adef%20_(mo)%3A%0A%20%20%20%20mo.md(%0A%20%20%20%20%20%20%20%20r%22%22%22%0A%20%20%20%20%23%23%23%20Question%202%3A%20Training%20the%20model%0A%0A%20%20%20%20Apply%20one-hot-encoding%20using%20%60DictVectorizer%60%20and%20train%20the%20logistic%20regression%20with%20these%20parameters%3A%0A%0A%20%20%20%20%60%60%60python%0A%20%20%20%20LogisticRegression(solver%3D'liblinear'%2C%20C%3D1.0%2C%20max_iter%3D1000)%0A%20%20%20%20%60%60%60%0A%20%20%20%20%22%22%22%0A%20%20%20%20)%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(%0A%20%20%20%20categorical_columns%2C%0A%20%20%20%20numeric_columns%2C%0A%20%20%20%20pd%2C%0A%20%20%20%20roc_auc_score%2C%0A%20%20%20%20train_dataframe%2C%0A%20%20%20%20val_dataframe%2C%0A)%3A%0A%20%20%20%20from%20sklearn.linear_model%20import%20LogisticRegression%0A%20%20%20%20from%20sklearn.feature_extraction%20import%20DictVectorizer%0A%0A%20%20%20%20def%20separate_target(dataframe%3A%20pd.DataFrame)%3A%0A%20%20%20%20%20%20%20%20y%20%3D%20dataframe.converted%0A%20%20%20%20%20%20%20%20X%20%3D%20dataframe.drop(columns%3D%5B'converted'%5D)%0A%20%20%20%20%20%20%20%20return%20X%5Bnumeric_columns%20%2B%20categorical_columns%5D%2C%20y%0A%0A%20%20%20%20def%20train(dataframe%3A%20pd.DataFrame)%3A%0A%20%20%20%20%20%20%20%20X%2C%20y%20%3D%20separate_target(dataframe)%0A%0A%20%20%20%20%20%20%20%20dict_vectorizer%20%3D%20DictVectorizer(sparse%3DFalse)%0A%20%20%20%20%20%20%20%20X_dict%20%3D%20dict_vectorizer.fit_transform(X.to_dict(orient%3D%22records%22))%0A%0A%20%20%20%20%20%20%20%20model%20%3D%20LogisticRegression(solver%3D'liblinear'%2C%20C%3D1.0%2C%20max_iter%3D1000%2C%20random_state%3D1)%0A%20%20%20%20%20%20%20%20model.fit(X_dict%2C%20y)%0A%0A%20%20%20%20%20%20%20%20return%20dict_vectorizer%2C%20model%0A%0A%20%20%20%20def%20evaluate(%0A%20%20%20%20%20%20%20%20model%3A%20LogisticRegression%2C%0A%20%20%20%20%20%20%20%20dict_vectorizer%3A%20DictVectorizer%2C%0A%20%20%20%20%20%20%20%20dataframe%3A%20pd.DataFrame%0A%20%20%20%20)%20-%3E%20float%3A%0A%20%20%20%20%20%20%20%20X%2C%20y%20%3D%20separate_target(dataframe)%0A%20%20%20%20%20%20%20%20X_dict%20%3D%20dict_vectorizer.transform(X.to_dict(orient%3D%22records%22))%0A%0A%20%20%20%20%20%20%20%20y_pred%20%3D%20model.predict_proba(X_dict)%5B%3A%2C%201%5D%20%3E%3D%200.55%0A%0A%20%20%20%20%20%20%20%20return%20round(roc_auc_score(y%2C%20y_pred)%2C%203)%0A%0A%20%20%20%20dict_vectorizer%2C%20model%20%3D%20train(train_dataframe)%0A%20%20%20%20evaluate(model%2C%20dict_vectorizer%2C%20val_dataframe)%0A%20%20%20%20return%20(%0A%20%20%20%20%20%20%20%20DictVectorizer%2C%0A%20%20%20%20%20%20%20%20LogisticRegression%2C%0A%20%20%20%20%20%20%20%20dict_vectorizer%2C%0A%20%20%20%20%20%20%20%20model%2C%0A%20%20%20%20%20%20%20%20separate_target%2C%0A%20%20%20%20)%0A%0A%0A%40app.cell(hide_code%3DTrue)%0Adef%20_(mo)%3A%0A%20%20%20%20mo.md(%0A%20%20%20%20%20%20%20%20r%22%22%22%0A%20%20%20%20What's%20the%20AUC%20of%20this%20model%20on%20the%20validation%20dataset%3F%20(round%20to%203%20digits)%0A%0A%20%20%20%20-%200.32%0A%20%20%20%20-%200.52%0A%20%20%20%20-%200.72%0A%20%20%20%20-%200.92%0A%20%20%20%20%22%22%22%0A%20%20%20%20)%0A%20%20%20%20return%0A%0A%0A%40app.cell(hide_code%3DTrue)%0Adef%20_(mo)%3A%0A%20%20%20%20mo.md(r%22%22%22The%20AUC%20of%20this%20model%20is%200.72.%22%22%22)%0A%20%20%20%20return%0A%0A%0A%40app.cell(hide_code%3DTrue)%0Adef%20_(mo)%3A%0A%20%20%20%20mo.md(%0A%20%20%20%20%20%20%20%20r%22%22%22%0A%20%20%20%20%23%23%23%20Question%203%3A%20Precision%20and%20Recall%0A%0A%20%20%20%20Now%20let's%20compute%20precision%20and%20recall%20for%20our%20model.%0A%0A%20%20%20%20*%20Evaluate%20the%20model%20on%20all%20thresholds%20from%200.0%20to%201.0%20with%20step%200.01%0A%20%20%20%20*%20For%20each%20threshold%2C%20compute%20precision%20and%20recall%0A%20%20%20%20*%20Plot%20them%0A%20%20%20%20%22%22%22%0A%20%20%20%20)%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(%0A%20%20%20%20DictVectorizer%2C%0A%20%20%20%20LogisticRegression%2C%0A%20%20%20%20dict_vectorizer%2C%0A%20%20%20%20model%2C%0A%20%20%20%20np%2C%0A%20%20%20%20pd%2C%0A%20%20%20%20plt%2C%0A%20%20%20%20separate_target%2C%0A%20%20%20%20val_dataframe%2C%0A)%3A%0A%20%20%20%20from%20sklearn.metrics%20import%20recall_score%2C%20precision_score%0A%0A%20%20%20%20def%20precision_and_recall_for_threshold(%0A%20%20%20%20%20%20%20%20model%3A%20LogisticRegression%2C%0A%20%20%20%20%20%20%20%20dict_vectorizer%3A%20DictVectorizer%2C%0A%20%20%20%20%20%20%20%20dataframe%3A%20pd.DataFrame%2C%0A%20%20%20%20%20%20%20%20threshold%3A%20float%0A%20%20%20%20)%20-%3E%20tuple%3A%0A%20%20%20%20%20%20%20%20X%2C%20y%20%3D%20separate_target(dataframe)%0A%20%20%20%20%20%20%20%20X_dict%20%3D%20dict_vectorizer.transform(X.to_dict(orient%3D%22records%22))%0A%20%20%20%20%20%20%20%20y_pred%20%3D%20model.predict_proba(X_dict)%5B%3A%2C%201%5D%20%3E%3D%20threshold%0A%0A%20%20%20%20%20%20%20%20return%20precision_score(y%2C%20y_pred%2C%20zero_division%3D1.0)%2C%20recall_score(y%2C%20y_pred)%0A%0A%20%20%20%20def%20evaluate_precision_and_recall(%0A%20%20%20%20%20%20%20%20model%3A%20LogisticRegression%2C%0A%20%20%20%20%20%20%20%20dict_vectorizer%3A%20DictVectorizer%2C%0A%20%20%20%20%20%20%20%20dataframe%3A%20pd.DataFrame%2C%0A%20%20%20%20)%20-%3E%20list%3A%0A%20%20%20%20%20%20%20%20evaluation%20%3D%20%5B%5D%0A%0A%20%20%20%20%20%20%20%20for%20threshold%20in%20np.linspace(0%2C%201%2C%20100)%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20precision%2C%20recall%20%3D%20precision_and_recall_for_threshold(model%2C%20dict_vectorizer%2C%20dataframe%2C%20threshold)%0A%20%20%20%20%20%20%20%20%20%20%20%20evaluation.append((threshold%2C%20precision%2C%20recall%2C))%0A%0A%20%20%20%20%20%20%20%20return%20pd.DataFrame(evaluation%2C%20columns%3D%5B%22threshold%22%2C%20%22precision%22%2C%20%22recall%22%5D)%0A%0A%20%20%20%20def%20plot_precision_and_recall(%0A%20%20%20%20%20%20%20%20model%3A%20LogisticRegression%2C%0A%20%20%20%20%20%20%20%20dict_vectorizer%3A%20DictVectorizer%2C%0A%20%20%20%20%20%20%20%20dataframe%3A%20pd.DataFrame%2C%0A%20%20%20%20)%3A%0A%20%20%20%20%20%20%20%20evaluation%20%3D%20evaluate_precision_and_recall(model%2C%20dict_vectorizer%2C%20dataframe)%0A%0A%20%20%20%20%20%20%20%20plt.plot(evaluation.threshold%2C%20evaluation.precision%2C%20label%3D%22Precision%22%2C%20color%3D%22g%22)%0A%20%20%20%20%20%20%20%20plt.plot(evaluation.threshold%2C%20evaluation.recall%2C%20label%3D%22Recall%22%2C%20color%3D%22r%22)%0A%20%20%20%20%20%20%20%20plt.xlabel(%22Threshold%22)%0A%20%20%20%20%20%20%20%20plt.show()%0A%0A%20%20%20%20plot_precision_and_recall(model%2C%20dict_vectorizer%2C%20val_dataframe)%0A%20%20%20%20return%20(evaluate_precision_and_recall%2C)%0A%0A%0A%40app.cell(hide_code%3DTrue)%0Adef%20_(mo)%3A%0A%20%20%20%20mo.md(%0A%20%20%20%20%20%20%20%20r%22%22%22%0A%20%20%20%20At%20which%20threshold%20precision%20and%20recall%20curves%20intersect%3F%0A%0A%20%20%20%20*%200.145%0A%20%20%20%20*%200.345%0A%20%20%20%20*%200.545%0A%20%20%20%20*%200.745%0A%20%20%20%20%22%22%22%0A%20%20%20%20)%0A%20%20%20%20return%0A%0A%0A%40app.cell(hide_code%3DTrue)%0Adef%20_(mo)%3A%0A%20%20%20%20mo.md(r%22%22%22Precision%20and%20recall%20intersect%20at%200.745.%22%22%22)%0A%20%20%20%20return%0A%0A%0A%40app.cell(hide_code%3DTrue)%0Adef%20_(mo)%3A%0A%20%20%20%20mo.md(%0A%20%20%20%20%20%20%20%20r%22%22%22%0A%20%20%20%20%23%23%23%20Question%204%3A%20F1%20score%0A%0A%20%20%20%20Precision%20and%20recall%20are%20conflicting%20-%20when%20one%20grows%2C%20the%20other%20goes%20down.%20That's%20why%20they%20are%20often%20combined%20into%20the%20F1%20score%20-%20a%20metrics%20that%20takes%20into%20account%20both%0A%0A%20%20%20%20This%20is%20the%20formula%20for%20computing%20F1%3A%0A%0A%20%20%20%20%24%24F_1%20%3D%202%20%5Ccdot%20%5Ccfrac%7BP%20%5Ccdot%20R%7D%7BP%20%2B%20R%7D%24%24%0A%0A%20%20%20%20Where%20%24P%24%20is%20precision%20and%20%24R%24%20is%20recall.%0A%0A%20%20%20%20Let's%20compute%20F1%20for%20all%20thresholds%20from%200.0%20to%201.0%20with%20increment%200.01%0A%20%20%20%20%22%22%22%0A%20%20%20%20)%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(%0A%20%20%20%20DictVectorizer%2C%0A%20%20%20%20LogisticRegression%2C%0A%20%20%20%20dict_vectorizer%2C%0A%20%20%20%20evaluate_precision_and_recall%2C%0A%20%20%20%20model%2C%0A%20%20%20%20pd%2C%0A%20%20%20%20plt%2C%0A%20%20%20%20val_dataframe%2C%0A)%3A%0A%20%20%20%20def%20evaluate_with_f1(%0A%20%20%20%20%20%20%20%20model%3A%20LogisticRegression%2C%0A%20%20%20%20%20%20%20%20dict_vectorizer%3A%20DictVectorizer%2C%0A%20%20%20%20%20%20%20%20dataframe%3A%20pd.DataFrame%2C%0A%20%20%20%20)%3A%0A%20%20%20%20%20%20%20%20evaluation%20%3D%20evaluate_precision_and_recall(model%2C%20dict_vectorizer%2C%20dataframe)%0A%20%20%20%20%20%20%20%20evaluation%5B%22f1%22%5D%20%3D%202%20*%20evaluation.precision%20*%20evaluation.recall%20%2F%20(evaluation.precision%20%2B%20evaluation.recall)%0A%0A%20%20%20%20%20%20%20%20return%20evaluation%0A%0A%20%20%20%20def%20plot_f1(%0A%20%20%20%20%20%20%20%20model%3A%20LogisticRegression%2C%0A%20%20%20%20%20%20%20%20dict_vectorizer%3A%20DictVectorizer%2C%0A%20%20%20%20%20%20%20%20dataframe%3A%20pd.DataFrame%2C%0A%20%20%20%20)%3A%0A%20%20%20%20%20%20%20%20evaluation%20%3D%20evaluate_with_f1(model%2C%20dict_vectorizer%2C%20val_dataframe)%0A%0A%20%20%20%20%20%20%20%20plt.plot(evaluation.threshold%2C%20evaluation.f1%2C%20label%3D%22F1%22%2C%20color%3D%22b%22)%0A%20%20%20%20%20%20%20%20plt.xlabel(%22Threshold%22)%0A%20%20%20%20%20%20%20%20plt.show()%0A%0A%20%20%20%20plot_f1(model%2C%20dict_vectorizer%2C%20val_dataframe)%0A%20%20%20%20return%0A%0A%0A%40app.cell(hide_code%3DTrue)%0Adef%20_(mo)%3A%0A%20%20%20%20mo.md(%0A%20%20%20%20%20%20%20%20r%22%22%22%0A%20%20%20%20At%20which%20threshold%20F1%20is%20maximal%3F%0A%0A%20%20%20%20-%200.14%0A%20%20%20%20-%200.34%0A%20%20%20%20-%200.54%0A%20%20%20%20-%200.74%0A%20%20%20%20%22%22%22%0A%20%20%20%20)%0A%20%20%20%20return%0A%0A%0A%40app.cell(hide_code%3DTrue)%0Adef%20_(mo)%3A%0A%20%20%20%20mo.md(r%22%22%22F1%20is%20maximal%20at%200.74.%22%22%22)%0A%20%20%20%20return%0A%0A%0A%40app.cell(hide_code%3DTrue)%0Adef%20_(mo)%3A%0A%20%20%20%20mo.md(%0A%20%20%20%20%20%20%20%20r%22%22%22%0A%20%20%20%20%23%23%20Question%205%3A%205-Fold%20CV%0A%0A%0A%20%20%20%20Use%20the%20%60KFold%60%20class%20from%20Scikit-Learn%20to%20evaluate%20our%20model%20on%205%20different%20folds%3A%0A%0A%20%20%20%20%60%60%60%0A%20%20%20%20KFold(n_splits%3D5%2C%20shuffle%3DTrue%2C%20random_state%3D1)%0A%20%20%20%20%60%60%60%0A%0A%20%20%20%20*%20Iterate%20over%20different%20folds%20of%20%60df_full_train%60%0A%20%20%20%20*%20Split%20the%20data%20into%20train%20and%20validation%0A%20%20%20%20*%20Train%20the%20model%20on%20train%20with%20these%20parameters%3A%20%60LogisticRegression(solver%3D'liblinear'%2C%20C%3D1.0%2C%20max_iter%3D1000)%60%0A%20%20%20%20*%20Use%20AUC%20to%20evaluate%20the%20model%20on%20validation%0A%20%20%20%20%22%22%22%0A%20%20%20%20)%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(%0A%20%20%20%20DictVectorizer%2C%0A%20%20%20%20LogisticRegression%2C%0A%20%20%20%20categorical_columns%2C%0A%20%20%20%20full_dataframe%2C%0A%20%20%20%20np%2C%0A%20%20%20%20numeric_columns%2C%0A%20%20%20%20pd%2C%0A%20%20%20%20roc_auc_score%2C%0A)%3A%0A%20%20%20%20from%20sklearn.model_selection%20import%20KFold%0A%0A%20%20%20%20def%20get_trained_vectorizer(dataframe%3A%20pd.DataFrame)%20-%3E%20list%5Bdict%5D%3A%0A%20%20%20%20%20%20%20%20copy%20%3D%20dataframe.copy()%0A%20%20%20%20%20%20%20%20del%20copy%5B%22converted%22%5D%0A%20%20%20%20%20%20%20%20dictionary%20%3D%20copy.to_dict(orient%3D%22records%22)%0A%0A%20%20%20%20%20%20%20%20dict_vectorizer%20%3D%20DictVectorizer(sparse%3DFalse)%0A%20%20%20%20%20%20%20%20dict_vectorizer.fit(dictionary)%0A%0A%20%20%20%20%20%20%20%20return%20dict_vectorizer%2C%20dictionary%0A%0A%20%20%20%20def%20get_features_and_target(dataframe%3A%20pd.DataFrame%2C%20dict_vectorizer%3A%20DictVectorizer%2C%20dictionary)%3A%0A%20%20%20%20%20%20%20%20X%20%3D%20dict_vectorizer.transform(dictionary)%0A%20%20%20%20%20%20%20%20y%20%3D%20dataframe.converted%20%3D%3D%201%0A%0A%20%20%20%20%20%20%20%20return%20X%2C%20y%0A%0A%20%20%20%20def%20train_folds(df_full%3A%20pd.DataFrame)%3A%0A%20%20%20%20%20%20%20%20kfolds%20%3D%20KFold(n_splits%3D5%2C%20shuffle%3DTrue%2C%20random_state%3D1)%0A%0A%20%20%20%20%20%20%20%20auc_scores%20%3D%20%5B%5D%0A%20%20%20%20%20%20%20%20for%20train_idx%2C%20val_idx%20in%20kfolds.split(df_full)%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20df_train%20%3D%20df_full.iloc%5Btrain_idx%5D%0A%20%20%20%20%20%20%20%20%20%20%20%20df_val%20%3D%20df_full.iloc%5Bval_idx%5D%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20dict_vectorizer%2C%20dictionary%20%3D%20get_trained_vectorizer(df_train)%0A%20%20%20%20%20%20%20%20%20%20%20%20X_train%2C%20y_train%20%3D%20get_features_and_target(df_train%2C%20dict_vectorizer%2C%20dictionary)%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20model%20%3D%20LogisticRegression(solver%3D'liblinear'%2C%20C%3D1.0%2C%20max_iter%3D1000)%0A%20%20%20%20%20%20%20%20%20%20%20%20model.fit(X_train%2C%20y_train)%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20dictionary_val%20%3D%20df_val%5Bnumeric_columns%20%2B%20categorical_columns%5D.to_dict(orient%3D%22records%22)%0A%20%20%20%20%20%20%20%20%20%20%20%20X_val%2C%20y_val%20%3D%20get_features_and_target(df_val%2C%20dict_vectorizer%2C%20dictionary_val)%0A%20%20%20%20%20%20%20%20%20%20%20%20y_pred%20%3D%20model.predict_proba(X_val)%5B%3A%2C1%5D%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20auc_scores.append(roc_auc_score(y_val%2C%20y_pred))%0A%0A%20%20%20%20%20%20%20%20print(%22%7B%3A.3f%7D%20%2B-%20%7B%3A.3f%7D%22.format(np.mean(auc_scores)%2C%20np.std(auc_scores)))%0A%0A%20%20%20%20%20%20%20%20return%20auc_scores%0A%0A%20%20%20%20train_folds(full_dataframe)%0A%20%20%20%20return%20KFold%2C%20get_features_and_target%2C%20get_trained_vectorizer%0A%0A%0A%40app.cell(hide_code%3DTrue)%0Adef%20_(mo)%3A%0A%20%20%20%20mo.md(%0A%20%20%20%20%20%20%20%20r%22%22%22%0A%20%20%20%20How%20large%20is%20standard%20deviation%20of%20the%20scores%20across%20different%20folds%3F%0A%0A%20%20%20%20-%200.0001%0A%20%20%20%20-%200.006%0A%20%20%20%20-%200.06%0A%20%20%20%20-%200.36%0A%20%20%20%20%22%22%22%0A%20%20%20%20)%0A%20%20%20%20return%0A%0A%0A%40app.cell(hide_code%3DTrue)%0Adef%20_(mo)%3A%0A%20%20%20%20mo.md(r%22%22%22The%20closest%20value%20to%20the%20standard%20deviation%20across%20folds%20is%20%240.06%24.%22%22%22)%0A%20%20%20%20return%0A%0A%0A%40app.cell(hide_code%3DTrue)%0Adef%20_(mo)%3A%0A%20%20%20%20mo.md(%0A%20%20%20%20%20%20%20%20r%22%22%22%0A%20%20%20%20%23%23%23%20Question%206%3A%20Hyperparameter%20Tuning%0A%0A%20%20%20%20Now%20let's%20use%205-Fold%20cross-validation%20to%20find%20the%20best%20parameter%20%60C%60%0A%0A%20%20%20%20*%20Iterate%20over%20the%20following%20%60C%60%20values%3A%20%60%5B0.000001%2C%200.001%2C%201%5D%60%0A%20%20%20%20*%20Initialize%20%60KFold%60%20with%20the%20same%20parameters%20as%20previously%0A%20%20%20%20*%20Use%20these%20parameters%20for%20the%20model%3A%20%60LogisticRegression(solver%3D'liblinear'%2C%20C%3DC%2C%20max_iter%3D1000)%60%0A%20%20%20%20*%20Compute%20the%20mean%20score%20as%20well%20as%20the%20std%20(round%20the%20mean%20and%20std%20to%203%20decimal%20digits)%0A%20%20%20%20%22%22%22%0A%20%20%20%20)%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(%0A%20%20%20%20KFold%2C%0A%20%20%20%20LogisticRegression%2C%0A%20%20%20%20categorical_columns%2C%0A%20%20%20%20full_dataframe%2C%0A%20%20%20%20get_features_and_target%2C%0A%20%20%20%20get_trained_vectorizer%2C%0A%20%20%20%20np%2C%0A%20%20%20%20numeric_columns%2C%0A%20%20%20%20pd%2C%0A%20%20%20%20roc_auc_score%2C%0A)%3A%0A%20%20%20%20def%20hypertune_folds(df_full%3A%20pd.DataFrame%2C%20C%3A%20float)%3A%0A%20%20%20%20%20%20%20%20kfolds%20%3D%20KFold(n_splits%3D5%2C%20shuffle%3DTrue%2C%20random_state%3D1)%0A%0A%20%20%20%20%20%20%20%20auc_scores%20%3D%20%5B%5D%0A%20%20%20%20%20%20%20%20for%20train_idx%2C%20val_idx%20in%20kfolds.split(df_full)%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20df_train%20%3D%20df_full.iloc%5Btrain_idx%5D%0A%20%20%20%20%20%20%20%20%20%20%20%20df_val%20%3D%20df_full.iloc%5Bval_idx%5D%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20dict_vectorizer%2C%20dictionary%20%3D%20get_trained_vectorizer(df_train)%0A%20%20%20%20%20%20%20%20%20%20%20%20X_train%2C%20y_train%20%3D%20get_features_and_target(df_train%2C%20dict_vectorizer%2C%20dictionary)%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20model%20%3D%20LogisticRegression(solver%3D'liblinear'%2C%20C%3DC%2C%20max_iter%3D1000)%0A%20%20%20%20%20%20%20%20%20%20%20%20model.fit(X_train%2C%20y_train)%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20dictionary_val%20%3D%20df_val%5Bnumeric_columns%20%2B%20categorical_columns%5D.to_dict(orient%3D%22records%22)%0A%20%20%20%20%20%20%20%20%20%20%20%20X_val%2C%20y_val%20%3D%20get_features_and_target(df_val%2C%20dict_vectorizer%2C%20dictionary_val)%0A%20%20%20%20%20%20%20%20%20%20%20%20y_pred%20%3D%20model.predict_proba(X_val)%5B%3A%2C1%5D%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20auc_scores.append(roc_auc_score(y_val%2C%20y_pred))%0A%0A%20%20%20%20%20%20%20%20print(%22C%3D%7B%3A.3f%7D%3A%20%7B%3A.3f%7D%20%2B-%20%7B%3A.3f%7D%22.format(C%2C%20np.mean(auc_scores)%2C%20np.std(auc_scores)))%0A%0A%20%20%20%20%20%20%20%20return%20auc_scores%0A%0A%20%20%20%20def%20test_c_values(df_full%3A%20pd.DataFrame%2C%20C_values%3A%20list%5Bfloat%5D)%3A%0A%20%20%20%20%20%20%20%20auc_scores%20%3D%20%5B%5D%0A%20%20%20%20%20%20%20%20for%20C_value%20in%20C_values%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20auc_scores.append(hypertune_folds(full_dataframe%2C%20C_value))%0A%0A%20%20%20%20%20%20%20%20return%20auc_scores%0A%0A%20%20%20%20test_c_values(full_dataframe%2C%20%5B0.000001%2C%200.001%2C%201%5D)%0A%20%20%20%20return%0A%0A%0A%40app.cell(hide_code%3DTrue)%0Adef%20_(mo)%3A%0A%20%20%20%20mo.md(%0A%20%20%20%20%20%20%20%20r%22%22%22%0A%20%20%20%20Which%20%60C%60%20leads%20to%20the%20best%20mean%20score%3F%0A%0A%20%20%20%20-%200.000001%0A%20%20%20%20-%200.001%0A%20%20%20%20-%201%0A%20%20%20%20%22%22%22%0A%20%20%20%20)%0A%20%20%20%20return%0A%0A%0A%40app.cell(hide_code%3DTrue)%0Adef%20_(mo)%3A%0A%20%20%20%20mo.md(r%22%22%22The%20best%20score%20corresponds%20to%20%24C%20%3D%200.001%24.%22%22%22)%0A%20%20%20%20return%0A%0A%0Aif%20__name__%20%3D%3D%20%22__main__%22%3A%0A%20%20%20%20app.run()%0A
</marimo-code>

<marimo-code-hash hidden="">7860da8bd8479715ea06961e30749076f63cd9781ec1226e39386194c5784079</marimo-code-hash>
</body>
</html>
